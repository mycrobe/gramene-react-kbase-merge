/*
 RequireJS 2.1.9 Copyright (c) 2010-2012, The Dojo Foundation All Rights Reserved.
 Available via the MIT or new BSD license.
 see: http://github.com/jrburke/requirejs for details
*/

/*! jQuery v1.10.2 | (c) 2005, 2013 jQuery Foundation, Inc. | jquery.org/license
//@ sourceMappingURL=jquery-1.10.2.min.map
*/

/*!

 handlebars v1.3.0

Copyright (C) 2011 by Yehuda Katz

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in
all copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN
THE SOFTWARE.

@license
*/

/*!
 * Bootstrap v3.3.0 (http://getbootstrap.com)
 * Copyright 2011-2014 Twitter, Inc.
 * Licensed under MIT (https://github.com/twbs/bootstrap/blob/master/LICENSE)
 */

function RGBColor(e,t,n){this.r=e,this.g=t,this.b=n}function Point(e,t){this.x=e,this.y=t}function Rectangle(e,t){e==undefined&&(e=new Point(-1,-1)),t==undefined&&(t=new Size(-1,-1)),this.origin=e,this.size=t}function Size(e,t){this.width=e,this.height=t}var requirejs,require,define;(function(Z){function H(e){return"[object Function]"===L.call(e)}function I(e){return"[object Array]"===L.call(e)}function y(e,t){if(e){var n;for(n=0;n<e.length&&(!e[n]||!t(e[n],n,e));n+=1);}}function M(e,t){if(e){var n;for(n=e.length-1;-1<n&&(!e[n]||!t(e[n],n,e));n-=1);}}function t(e,t){return ga.call(e,t)}function l(e,n){return t(e,n)&&e[n]}function F(e,n){for(var r in e)if(t(e,r)&&n(e[r],r))break}function Q(e,n,r,i){return n&&F(n,function(n,s){if(r||!t(e,s))i&&"string"!=typeof n?(e[s]||(e[s]={}),Q(e[s],n,r,i)):e[s]=n}),e}function u(e,t){return function(){return t.apply(e,arguments)}}function aa(e){throw e}function ba(e){if(!e)return e;var t=Z;return y(e.split("."),function(e){t=t[e]}),t}function A(e,t,n,r){return t=Error(t+"\nhttp://requirejs.org/docs/errors.html#"+e),t.requireType=e,t.requireModules=r,n&&(t.originalError=n),t}function ha(e){function n(e,t,n){var r,i,s,o,u,a,f,c=t&&t.split("/");r=c;var h=N.map,p=h&&h["*"];if(e&&"."===e.charAt(0))if(t){r=l(N.pkgs,t)?c=[t]:c.slice(0,c.length-1),t=e=r.concat(e.split("/"));for(r=0;t[r];r+=1)if(i=t[r],"."===i)t.splice(r,1),r-=1;else if(".."===i){if(1===r&&(".."===t[2]||".."===t[0]))break;0<r&&(t.splice(r-1,2),r-=2)}r=l(N.pkgs,t=e[0]),e=e.join("/"),r&&e===t+"/"+r.main&&(e=t)}else 0===e.indexOf("./")&&(e=e.substring(2));if(n&&h&&(c||p)){t=e.split("/");for(r=t.length;0<r;r-=1){s=t.slice(0,r).join("/");if(c)for(i=c.length;0<i;i-=1)if(n=l(h,c.slice(0,i).join("/")))if(n=l(n,s)){o=n,u=r;break}if(o)break;!a&&p&&l(p,s)&&(a=l(p,s),f=r)}!o&&a&&(o=a,u=f),o&&(t.splice(0,u,o),e=t.join("/"))}return e}function r(e){z&&y(document.getElementsByTagName("script"),function(t){if(t.getAttribute("data-requiremodule")===e&&t.getAttribute("data-requirecontext")===S.contextName)return t.parentNode.removeChild(t),!0})}function i(e){var t=l(N.paths,e);if(t&&I(t)&&1<t.length)return t.shift(),S.require.undef(e),S.require([e]),!0}function s(e){var t,n=e?e.indexOf("!"):-1;return-1<n&&(t=e.substring(0,n),e=e.substring(n+1,e.length)),[t,e]}function o(e,t,r,i){var o,u,a=null,f=t?t.name:null,c=e,h=!0,p="";return e||(h=!1,e="_@r"+(B+=1)),e=s(e),a=e[0],e=e[1],a&&(a=n(a,f,i),u=l(_,a)),e&&(a?p=u&&u.normalize?u.normalize(e,function(e){return n(e,f,i)}):n(e,f,i):(p=n(e,f,i),e=s(p),a=e[0],p=e[1],r=!0,o=S.nameToUrl(p))),r=a&&!u&&!r?"_unnormalized"+(q+=1):"",{prefix:a,name:p,parentMap:t,unnormalized:!!r,url:o,originalName:c,isDefine:h,id:(a?a+"!"+p:p)+r}}function a(e){var t=e.id,n=l(C,t);return n||(n=C[t]=new S.Module(e)),n}function f(e,n,r){var i=e.id,s=l(C,i);t(_,i)&&(!s||s.defineEmitComplete)?"defined"===n&&r(_[i]):(s=a(e),s.error&&"error"===n)?r(s.error):s.on(n,r)}function c(e,t){var n=e.requireModules,r=!1;t?t(e):(y(n,function(t){if(t=l(C,t))t.error=e,t.events.error&&(r=!0,t.emit("error",e))}),!r)&&j.onError(e)}function h(){R.length&&(ia.apply(M,[M.length-1,0].concat(R)),R=[])}function p(e){delete C[e],delete k[e]}function d(e,t,n){var r=e.map.id;e.error?e.emit("error",e.error):(t[r]=!0,y(e.depMaps,function(r,i){var s=r.id,o=l(C,s);o&&!e.depMatched[i]&&!n[s]&&(l(t,s)?(e.defineDep(i,_[s]),e.check()):d(o,t,n))}),n[r]=!0)}function v(){var e,t,n,s,o=(n=1e3*N.waitSeconds)&&S.startTime+n<(new Date).getTime(),u=[],a=[],f=!1,l=!0;if(!w){w=!0,F(k,function(n){e=n.map,t=e.id;if(n.enabled&&(e.isDefine||a.push(n),!n.error))if(!n.inited&&o)i(t)?f=s=!0:(u.push(t),r(t));else if(!n.inited&&n.fetched&&e.isDefine&&(f=!0,!e.prefix))return l=!1});if(o&&u.length)return n=A("timeout","Load timeout for modules: "+u,null,u),n.contextName=S.contextName,c(n);l&&y(a,function(e){d(e,{},{})}),(!o||s)&&f&&(z||da)&&!T&&(T=setTimeout(function(){T=0,v()},50)),w=!1}}function m(e){t(_,e[0])||a(o(e[0],null,!0)).init(e[1],e[2])}function g(e){var e=e.currentTarget||e.srcElement,t=S.onScriptLoad;return e.detachEvent&&!W?e.detachEvent("onreadystatechange",t):e.removeEventListener("load",t,!1),t=S.onScriptError,(!e.detachEvent||W)&&e.removeEventListener("error",t,!1),{node:e,id:e&&e.getAttribute("data-requiremodule")}}function b(){var e;for(h();M.length;){e=M.shift();if(null===e[0])return c(A("mismatch","Mismatched anonymous define() module: "+e[e.length-1]));m(e)}}var w,E,S,x,T,N={waitSeconds:7,baseUrl:"./",paths:{},pkgs:{},shim:{},config:{}},C={},k={},L={},M=[],_={},D={},B=1,q=1;return x={require:function(e){return e.require?e.require:e.require=S.makeRequire(e.map)},exports:function(e){e.usingExports=!0;if(e.map.isDefine)return e.exports?e.exports:e.exports=_[e.map.id]={}},module:function(e){return e.module?e.module:e.module={id:e.map.id,uri:e.map.url,config:function(){var t=l(N.pkgs,e.map.id);return(t?l(N.config,e.map.id+"/"+t.main):l(N.config,e.map.id))||{}},exports:_[e.map.id]}}},E=function(e){this.events=l(L,e.id)||{},this.map=e,this.shim=l(N.shim,e.id),this.depExports=[],this.depMaps=[],this.depMatched=[],this.pluginMaps={},this.depCount=0},E.prototype={init:function(e,t,n,r){r=r||{},this.inited||(this.factory=t,n?this.on("error",n):this.events.error&&(n=u(this,function(e){this.emit("error",e)})),this.depMaps=e&&e.slice(0),this.errback=n,this.inited=!0,this.ignore=r.ignore,r.enabled||this.enabled?this.enable():this.check())},defineDep:function(e,t){this.depMatched[e]||(this.depMatched[e]=!0,this.depCount-=1,this.depExports[e]=t)},fetch:function(){if(!this.fetched){this.fetched=!0,S.startTime=(new Date).getTime();var e=this.map;if(!this.shim)return e.prefix?this.callPlugin():this.load();S.makeRequire(this.map,{enableBuildCallback:!0})(this.shim.deps||[],u(this,function(){return e.prefix?this.callPlugin():this.load()}))}},load:function(){var e=this.map.url;D[e]||(D[e]=!0,S.load(this.map.id,e))},check:function(){if(this.enabled&&!this.enabling){var e,t,n=this.map.id;t=this.depExports;var r=this.exports,i=this.factory;if(this.inited){if(this.error)this.emit("error",this.error);else if(!this.defining){this.defining=!0;if(1>this.depCount&&!this.defined){if(H(i)){if(this.events.error&&this.map.isDefine||j.onError!==aa)try{r=S.execCb(n,i,t,r)}catch(s){e=s}else r=S.execCb(n,i,t,r);this.map.isDefine&&((t=this.module)&&void 0!==t.exports&&t.exports!==this.exports?r=t.exports:void 0===r&&this.usingExports&&(r=this.exports));if(e)return e.requireMap=this.map,e.requireModules=this.map.isDefine?[this.map.id]:null,e.requireType=this.map.isDefine?"define":"require",c(this.error=e)}else r=i;this.exports=r,this.map.isDefine&&!this.ignore&&(_[n]=r,j.onResourceLoad)&&j.onResourceLoad(S,this.map,this.depMaps),p(n),this.defined=!0}this.defining=!1,this.defined&&!this.defineEmitted&&(this.defineEmitted=!0,this.emit("defined",this.exports),this.defineEmitComplete=!0)}}else this.fetch()}},callPlugin:function(){var e=this.map,r=e.id,i=o(e.prefix);this.depMaps.push(i),f(i,"defined",u(this,function(i){var s,h;h=this.map.name;var d=this.map.parentMap?this.map.parentMap.name:null,v=S.makeRequire(e.parentMap,{enableBuildCallback:!0});if(this.map.unnormalized){if(i.normalize&&(h=i.normalize(h,function(e){return n(e,d,!0)})||""),i=o(e.prefix+"!"+h,this.map.parentMap),f(i,"defined",u(this,function(e){this.init([],function(){return e},null,{enabled:!0,ignore:!0})})),h=l(C,i.id))this.depMaps.push(i),this.events.error&&h.on("error",u(this,function(e){this.emit("error",e)})),h.enable()}else s=u(this,function(e){this.init([],function(){return e},null,{enabled:!0})}),s.error=u(this,function(e){this.inited=!0,this.error=e,e.requireModules=[r],F(C,function(e){0===e.map.id.indexOf(r+"_unnormalized")&&p(e.map.id)}),c(e)}),s.fromText=u(this,function(n,i){var u=e.name,f=o(u),l=O;i&&(n=i),l&&(O=!1),a(f),t(N.config,r)&&(N.config[u]=N.config[r]);try{j.exec(n)}catch(h){return c(A("fromtexteval","fromText eval for "+r+" failed: "+h,h,[r]))}l&&(O=!0),this.depMaps.push(f),S.completeLoad(u),v([u],s)}),i.load(e.name,v,s,N)})),S.enable(i,this),this.pluginMaps[i.id]=i},enable:function(){k[this.map.id]=this,this.enabling=this.enabled=!0,y(this.depMaps,u(this,function(e,n){var r,i;if("string"==typeof e){e=o(e,this.map.isDefine?this.map:this.map.parentMap,!1,!this.skipMap),this.depMaps[n]=e;if(r=l(x,e.id)){this.depExports[n]=r(this);return}this.depCount+=1,f(e,"defined",u(this,function(e){this.defineDep(n,e),this.check()})),this.errback&&f(e,"error",u(this,this.errback))}r=e.id,i=C[r],!t(x,r)&&i&&!i.enabled&&S.enable(e,this)})),F(this.pluginMaps,u(this,function(e){var t=l(C,e.id);t&&!t.enabled&&S.enable(e,this)})),this.enabling=!1,this.check()},on:function(e,t){var n=this.events[e];n||(n=this.events[e]=[]),n.push(t)},emit:function(e,t){y(this.events[e],function(e){e(t)}),"error"===e&&delete this.events[e]}},S={config:N,contextName:e,registry:C,defined:_,urlFetched:D,defQueue:M,Module:E,makeModuleMap:o,nextTick:j.nextTick,onError:c,configure:function(e){e.baseUrl&&"/"!==e.baseUrl.charAt(e.baseUrl.length-1)&&(e.baseUrl+="/");var t=N.pkgs,n=N.shim,r={paths:!0,config:!0,map:!0};F(e,function(e,t){r[t]?"map"===t?(N.map||(N.map={}),Q(N[t],e,!0,!0)):Q(N[t],e,!0):N[t]=e}),e.shim&&(F(e.shim,function(e,t){I(e)&&(e={deps:e}),(e.exports||e.init)&&!e.exportsFn&&(e.exportsFn=S.makeShimExports(e)),n[t]=e}),N.shim=n),e.packages&&(y(e.packages,function(e){e="string"==typeof e?{name:e}:e,t[e.name]={name:e.name,location:e.location||e.name,main:(e.main||"main").replace(ja,"").replace(ea,"")}}),N.pkgs=t),F(C,function(e,t){!e.inited&&!e.map.unnormalized&&(e.map=o(t))}),(e.deps||e.callback)&&S.require(e.deps||[],e.callback)},makeShimExports:function(e){return function(){var t;return e.init&&(t=e.init.apply(Z,arguments)),t||e.exports&&ba(e.exports)}},makeRequire:function(i,s){function u(n,r,f){var l,h;return s.enableBuildCallback&&r&&H(r)&&(r.__requireJsBuild=!0),"string"==typeof n?H(r)?c(A("requireargs","Invalid require call"),f):i&&t(x,n)?x[n](C[i.id]):j.get?j.get(S,n,i,u):(l=o(n,i,!1,!0),l=l.id,t(_,l)?_[l]:c(A("notloaded",'Module name "'+l+'" has not been loaded yet for context: '+e+(i?"":". Use require([])")))):(b(),S.nextTick(function(){b(),h=a(o(null,i)),h.skipMap=s.skipMap,h.init(n,r,f,{enabled:!0}),v()}),u)}return s=s||{},Q(u,{isBrowser:z,toUrl:function(e){var t,r=e.lastIndexOf("."),s=e.split("/")[0];return-1!==r&&("."!==s&&".."!==s||1<r)&&(t=e.substring(r,e.length),e=e.substring(0,r)),S.nameToUrl(n(e,i&&i.id,!0),t,!0)},defined:function(e){return t(_,o(e,i,!1,!0).id)},specified:function(e){return e=o(e,i,!1,!0).id,t(_,e)||t(C,e)}}),i||(u.undef=function(e){h();var t=o(e,i,!0),n=l(C,e);r(e),delete _[e],delete D[t.url],delete L[e],n&&(n.events.defined&&(L[e]=n.events),p(e))}),u},enable:function(e){l(C,e.id)&&a(e).enable()},completeLoad:function(e){var n,r,s=l(N.shim,e)||{},o=s.exports;for(h();M.length;){r=M.shift();if(null===r[0]){r[0]=e;if(n)break;n=!0}else r[0]===e&&(n=!0);m(r)}r=l(C,e);if(!n&&!t(_,e)&&r&&!r.inited){if(N.enforceDefine&&(!o||!ba(o)))return i(e)?void 0:c(A("nodefine","No define call for "+e,null,[e]));m([e,s.deps||[],s.exportsFn])}v()},nameToUrl:function(e,t,n){var r,i,s,o,u,a;if(j.jsExtRegExp.test(e))o=e+(t||"");else{r=N.paths,i=N.pkgs,o=e.split("/");for(u=o.length;0<u;u-=1){if(a=o.slice(0,u).join("/"),s=l(i,a),a=l(r,a)){I(a)&&(a=a[0]),o.splice(0,u,a);break}if(s){e=e===s.name?s.location+"/"+s.main:s.location,o.splice(0,u,e);break}}o=o.join("/"),o+=t||(/^data\:|\?/.test(o)||n?"":".js"),o=("/"===o.charAt(0)||o.match(/^[\w\+\.\-]+:/)?"":N.baseUrl)+o}return N.urlArgs?o+((-1===o.indexOf("?")?"?":"&")+N.urlArgs):o},load:function(e,t){j.load(S,e,t)},execCb:function(e,t,n,r){return t.apply(r,n)},onScriptLoad:function(e){if("load"===e.type||ka.test((e.currentTarget||e.srcElement).readyState))P=null,e=g(e),S.completeLoad(e.id)},onScriptError:function(e){var t=g(e);if(!i(t.id))return c(A("scripterror","Script error for: "+t.id,e,[t.id]))}},S.require=S.makeRequire(),S}var j,w,x,C,J,D,P,K,q,fa,la=/(\/\*([\s\S]*?)\*\/|([^:]|^)\/\/(.*)$)/mg,ma=/[^.]\s*require\s*\(\s*["']([^'"\s]+)["']\s*\)/g,ea=/\.js$/,ja=/^\.\//;w=Object.prototype;var L=w.toString,ga=w.hasOwnProperty,ia=Array.prototype.splice,z="undefined"!=typeof window&&"undefined"!=typeof navigator&&!!window.document,da=!z&&"undefined"!=typeof importScripts,ka=z&&"PLAYSTATION 3"===navigator.platform?/^complete$/:/^(complete|loaded)$/,W="undefined"!=typeof opera&&"[object Opera]"===opera.toString(),E={},s={},R=[],O=!1;if("undefined"==typeof define){if("undefined"!=typeof requirejs){if(H(requirejs))return;s=requirejs,requirejs=void 0}"undefined"!=typeof require&&!H(require)&&(s=require,require=void 0),j=requirejs=function(e,t,n,r){var i,s="_";return!I(e)&&"string"!=typeof e&&(i=e,I(t)?(e=t,t=n,n=r):e=[]),i&&i.context&&(s=i.context),(r=l(E,s))||(r=E[s]=j.s.newContext(s)),i&&r.configure(i),r.require(e,t,n)},j.config=function(e){return j(e)},j.nextTick="undefined"!=typeof setTimeout?function(e){setTimeout(e,4)}:function(e){e()},require||(require=j),j.version="2.1.9",j.jsExtRegExp=/^\/|:|\?|\.js$/,j.isBrowser=z,w=j.s={contexts:E,newContext:ha},j({}),y(["toUrl","undef","defined","specified"],function(e){j[e]=function(){var t=E._;return t.require[e].apply(t,arguments)}}),z&&(x=w.head=document.getElementsByTagName("head")[0],C=document.getElementsByTagName("base")[0])&&(x=w.head=C.parentNode),j.onError=aa,j.createNode=function(e){var t=e.xhtml?document.createElementNS("http://www.w3.org/1999/xhtml","html:script"):document.createElement("script");return t.type=e.scriptType||"text/javascript",t.charset="utf-8",t.async=!0,t},j.load=function(e,t,n){var r=e&&e.config||{};if(z)return r=j.createNode(r,t,n),r.setAttribute("data-requirecontext",e.contextName),r.setAttribute("data-requiremodule",t),r.attachEvent&&!(r.attachEvent.toString&&0>r.attachEvent.toString().indexOf("[native code"))&&!W?(O=!0,r.attachEvent("onreadystatechange",e.onScriptLoad)):(r.addEventListener("load",e.onScriptLoad,!1),r.addEventListener("error",e.onScriptError,!1)),r.src=n,K=r,C?x.insertBefore(r,C):x.appendChild(r),K=null,r;if(da)try{importScripts(n),e.completeLoad(t)}catch(i){e.onError(A("importscripts","importScripts failed for "+t+" at "+n,i,[t]))}},z&&!s.skipDataMain&&M(document.getElementsByTagName("script"),function(e){x||(x=e.parentNode);if(J=e.getAttribute("data-main"))return q=J,s.baseUrl||(D=q.split("/"),q=D.pop(),fa=D.length?D.join("/")+"/":"./",s.baseUrl=fa),q=q.replace(ea,""),j.jsExtRegExp.test(q)&&(q=J),s.deps=s.deps?s.deps.concat(q):[q],!0}),define=function(e,t,n){var r,i;"string"!=typeof e&&(n=t,t=e,e=null),I(t)||(n=t,t=null),!t&&H(n)&&(t=[],n.length&&(n.toString().replace(la,"").replace(ma,function(e,n){t.push(n)}),t=(1===n.length?["require"]:["require","exports","module"]).concat(t))),O&&((r=K)||(P&&"interactive"===P.readyState||M(document.getElementsByTagName("script"),function(e){if("interactive"===e.readyState)return P=e}),r=P),r&&(e||(e=r.getAttribute("data-requiremodule")),i=E[r.getAttribute("data-requirecontext")])),(i?i.defQueue:R).push([e,t,n])},define.amd={jQuery:!0},j.exec=function(b){return eval(b)},j(s)}})(this),define("requireLib",function(){}),RGBColor.prototype.asString=function(){return"rgb("+this.r+","+this.g+","+this.b+")"},RGBColor.prototype.asStringWithAlpha=function(e){return"rgba("+this.r+","+this.g+","+this.b+","+e+")"},RGBColor.prototype.invert=function(){return new RGBColor(255-this.r,255-this.g,255-this.b)},RGBColor.prototype.darkenBy=function(e){var t=new RGBColor(this.r,this.g,this.b);return t.r-=e,t.g-=e,t.b-=e,t.r<0&&(t.r=0),t.g<0&&(t.g=0),t.b<0&&(t.b=0),t},RGBColor.prototype.lightenBy=function(e){var t=new RGBColor(this.r,this.g,this.b);return t.r+=e,t.g+=e,t.b+=e,t.r>255&&(t.r=255),t.g>255&&(t.g=255),t.b>255&&(t.b=255),t},RGBColor.prototype.subtract=function(e){return new RGBColor(this.r-e.r,this.g-e.g,this.b-e.b)},RGBColor.prototype.rgbFromString=function(e){if(!$)return undefined;var t=$.jqElem("div").css("background-color",e),n=t.css("background-color"),r;if(r=n.match(/rgb\((\d+), (\d+), (\d+)\)/))return{r:+r[1],g:+r[2],b:+r[3]}},define("RGBColor",function(){}),Point.prototype.asString=function(){return"{"+this.x+", "+this.y+"}"},Point.prototype.offset=function(e,t){return new Point(this.x+e,this.y+t)},Point.prototype.rectWithPoint=function(e){var t=this.x<e.x?this.x:e.x,n=this.y<e.y?this.y:e.y,r=Math.abs(this.x-e.x),i=Math.abs(this.y-e.y);return new Rectangle(new Point(t,n),new Size(r,i))},define("geometry_point",function(){}),Rectangle.prototype.invert=function(){return new Rectangle(this.height,this.width)},Rectangle.prototype.lowerRight=function(){return new Point(this.origin.x+this.size.width,this.origin.y+this.size.height)},Rectangle.prototype.insetRect=function(e,t){return new Rectangle(new Point(this.origin.x+e/2,this.origin.y+t/2),new Size(this.size.width-e,this.size.height-t))},Rectangle.prototype.fromString=function(e){var t;return(t=e.match(/{{(.+),\s*(.+)},\s*{(.+),\s*(.+)}}/))?new Rectangle(new Point(parseInt(t[1]),parseInt(t[2])),new Size(parseInt(t[3]),parseInt(t[4]))):undefined},Rectangle.prototype.intersects=function(e){return this.origin.x<e.origin.x+e.size.width&&this.origin.x+this.size.width>e.origin.x&&this.origin.y<e.origin.y+e.size.height&&this.origin.y+this.size.height>e.origin.y?!0:!1},Rectangle.prototype.unionRect=function(e,t){var n=new Rectangle,r=this.lowerRight(),i=e.lowerRight();n.origin.x=Math.min(this.origin.x,e.origin.x),n.origin.y=Math.min(this.origin.y,e.origin.y);var s=Math.max(r.x,i.x),o=Math.max(r.y,i.y);return n.size.width=n.origin.x+s,n.size.height=n.origin.Y+o,t!=undefined&&(n.origin.x-=t,n.origin.y-=t,n.size.width+=t*2,n.size.height+=t*2),n},Rectangle.prototype.isValidRect=function(){return isNaN(this.origin.x)||isNaN(this.origin.y)||isNaN(this.size.width)||isNaN(this.size.height)?!1:!0},Rectangle.prototype.intersectRect=function(e){var t=new Rectangle,n=this.lowerRight(),r=e.lowerRight();t.origin.x=Math.max(this.origin.x,e.origin.x),t.origin.y=Math.max(this.origin.y,e.origin.y);var i=Math.min(n.x,r.x),s=Math.min(n.y,r.y);return t.size.width=i-t.origin.x,t.size.height=s-t.origin.y,t.size.width<=0&&(t.size.width=Number.NaN),t.size.height<=0&&(t.size.height=Number.NaN),t},Rectangle.prototype.containsPoint=function(e){var t=this.origin.x+this.size.width,n=this.origin.y+this.size.height;return e.x>=this.origin.x&&e.x<=t&&e.y>=this.origin.y&&e.y<=n?!0:!1},Rectangle.prototype.equals=function(e){return this==undefined||e==undefined?!1:this.origin.x==e.origin.x&&this.origin.y==e.origin.y&&this.size.width==e.size.width&&this.size.height==e.size.height},Rectangle.prototype.asString=function(){return"{"+this.origin.asString()+", "+this.size.asString()+"}"},define("geometry_rectangle",function(){}),Size.prototype.asString=function(){return"{"+this.width+", "+this.height+"}"},define("geometry_size",function(){}),define("kbaseIrisConfig",[],function(){window.kbaseIrisConfig==undefined&&(window.kbaseIrisConfig={terminal:{invocationURL:"http://kbase.us/services/invocation",searchURL:"https://kbase.us/services/search-api/search/$category/$keyword?start=$start&count=$count&format=json",run_dispatch:[]},tutorial:{config_url:"http://kbase.us/docs/tutorials.cfg",default_tutorial:"tutorial-test.html"},commands:{order:[],include:[],exclude:[]}})}),function(e,t){function H(e){var t=e.length,n=w.type(e);return w.isWindow(e)?!1:1===e.nodeType&&t?!0:"array"===n||"function"!==n&&(0===t||"number"==typeof t&&t>0&&t-1 in e)}function j(e){var t=B[e]={};return w.each(e.match(S)||[],function(e,n){t[n]=!0}),t}function q(e,n,r,i){if(w.acceptData(e)){var s,o,u=w.expando,a=e.nodeType,f=a?w.cache:e,l=a?e[u]:e[u]&&u;if(l&&f[l]&&(i||f[l].data)||r!==t||"string"!=typeof n)return l||(l=a?e[u]=c.pop()||w.guid++:u),f[l]||(f[l]=a?{}:{toJSON:w.noop}),("object"==typeof n||"function"==typeof n)&&(i?f[l]=w.extend(f[l],n):f[l].data=w.extend(f[l].data,n)),o=f[l],i||(o.data||(o.data={}),o=o.data),r!==t&&(o[w.camelCase(n)]=r),"string"==typeof n?(s=o[n],null==s&&(s=o[w.camelCase(n)])):s=o,s}}function R(e,t,n){if(w.acceptData(e)){var r,i,s=e.nodeType,o=s?w.cache:e,u=s?e[w.expando]:w.expando;if(o[u]){if(t&&(r=n?o[u]:o[u].data)){w.isArray(t)?t=t.concat(w.map(t,w.camelCase)):t in r?t=[t]:(t=w.camelCase(t),t=t in r?[t]:t.split(" ")),i=t.length;while(i--)delete r[t[i]];if(n?!z(r):!w.isEmptyObject(r))return}(n||(delete o[u].data,z(o[u])))&&(s?w.cleanData([e],!0):w.support.deleteExpando||o!=o.window?delete o[u]:o[u]=null)}}}function U(e,n,r){if(r===t&&1===e.nodeType){var i="data-"+n.replace(I,"-$1").toLowerCase();if(r=e.getAttribute(i),"string"==typeof r){try{r="true"===r?!0:"false"===r?!1:"null"===r?null:+r+""===r?+r:F.test(r)?w.parseJSON(r):r}catch(s){}w.data(e,n,r)}else r=t}return r}function z(e){var t;for(t in e)if(("data"!==t||!w.isEmptyObject(e[t]))&&"toJSON"!==t)return!1;return!0}function it(){return!0}function st(){return!1}function ot(){try{return o.activeElement}catch(e){}}function ct(e,t){do e=e[t];while(e&&1!==e.nodeType);return e}function ht(e,t,n){if(w.isFunction(t))return w.grep(e,function(e,r){return!!t.call(e,r,e)!==n});if(t.nodeType)return w.grep(e,function(e){return e===t!==n});if("string"==typeof t){if(ut.test(t))return w.filter(t,e,n);t=w.filter(t,e)}return w.grep(e,function(e){return w.inArray(e,t)>=0!==n})}function pt(e){var t=dt.split("|"),n=e.createDocumentFragment();if(n.createElement)while(t.length)n.createElement(t.pop());return n}function Mt(e,t){return w.nodeName(e,"table")&&w.nodeName(1===t.nodeType?t:t.firstChild,"tr")?e.getElementsByTagName("tbody")[0]||e.appendChild(e.ownerDocument.createElement("tbody")):e}function _t(e){return e.type=(null!==w.find.attr(e,"type"))+"/"+e.type,e}function Dt(e){var t=Ct.exec(e.type);return t?e.type=t[1]:e.removeAttribute("type"),e}function Pt(e,t){var n,r=0;for(;null!=(n=e[r]);r++)w._data(n,"globalEval",!t||w._data(t[r],"globalEval"))}function Ht(e,t){if(1===t.nodeType&&w.hasData(e)){var n,r,i,s=w._data(e),o=w._data(t,s),u=s.events;if(u){delete o.handle,o.events={};for(n in u)for(r=0,i=u[n].length;i>r;r++)w.event.add(t,n,u[n][r])}o.data&&(o.data=w.extend({},o.data))}}function Bt(e,t){var n,r,i;if(1===t.nodeType){if(n=t.nodeName.toLowerCase(),!w.support.noCloneEvent&&t[w.expando]){i=w._data(t);for(r in i.events)w.removeEvent(t,r,i.handle);t.removeAttribute(w.expando)}"script"===n&&t.text!==e.text?(_t(t).text=e.text,Dt(t)):"object"===n?(t.parentNode&&(t.outerHTML=e.outerHTML),w.support.html5Clone&&e.innerHTML&&!w.trim(t.innerHTML)&&(t.innerHTML=e.innerHTML)):"input"===n&&xt.test(e.type)?(t.defaultChecked=t.checked=e.checked,t.value!==e.value&&(t.value=e.value)):"option"===n?t.defaultSelected=t.selected=e.defaultSelected:("input"===n||"textarea"===n)&&(t.defaultValue=e.defaultValue)}}function jt(e,n){var r,s,o=0,u=typeof e.getElementsByTagName!==i?e.getElementsByTagName(n||"*"):typeof e.querySelectorAll!==i?e.querySelectorAll(n||"*"):t;if(!u)for(u=[],r=e.childNodes||e;null!=(s=r[o]);o++)!n||w.nodeName(s,n)?u.push(s):w.merge(u,jt(s,n));return n===t||n&&w.nodeName(e,n)?w.merge([e],u):u}function Ft(e){xt.test(e.type)&&(e.defaultChecked=e.checked)}function tn(e,t){if(t in e)return t;var n=t.charAt(0).toUpperCase()+t.slice(1),r=t,i=en.length;while(i--)if(t=en[i]+n,t in e)return t;return r}function nn(e,t){return e=t||e,"none"===w.css(e,"display")||!w.contains(e.ownerDocument,e)}function rn(e,t){var n,r,i,s=[],o=0,u=e.length;for(;u>o;o++)r=e[o],r.style&&(s[o]=w._data(r,"olddisplay"),n=r.style.display,t?(s[o]||"none"!==n||(r.style.display=""),""===r.style.display&&nn(r)&&(s[o]=w._data(r,"olddisplay",an(r.nodeName)))):s[o]||(i=nn(r),(n&&"none"!==n||!i)&&w._data(r,"olddisplay",i?n:w.css(r,"display"))));for(o=0;u>o;o++)r=e[o],r.style&&(t&&"none"!==r.style.display&&""!==r.style.display||(r.style.display=t?s[o]||"":"none"));return e}function sn(e,t,n){var r=$t.exec(t);return r?Math.max(0,r[1]-(n||0))+(r[2]||"px"):t}function on(e,t,n,r,i){var s=n===(r?"border":"content")?4:"width"===t?1:0,o=0;for(;4>s;s+=2)"margin"===n&&(o+=w.css(e,n+Zt[s],!0,i)),r?("content"===n&&(o-=w.css(e,"padding"+Zt[s],!0,i)),"margin"!==n&&(o-=w.css(e,"border"+Zt[s]+"Width",!0,i))):(o+=w.css(e,"padding"+Zt[s],!0,i),"padding"!==n&&(o+=w.css(e,"border"+Zt[s]+"Width",!0,i)));return o}function un(e,t,n){var r=!0,i="width"===t?e.offsetWidth:e.offsetHeight,s=qt(e),o=w.support.boxSizing&&"border-box"===w.css(e,"boxSizing",!1,s);if(0>=i||null==i){if(i=Rt(e,t,s),(0>i||null==i)&&(i=e.style[t]),Jt.test(i))return i;r=o&&(w.support.boxSizingReliable||i===e.style[t]),i=parseFloat(i)||0}return i+on(e,t,n||(o?"border":"content"),r,s)+"px"}function an(e){var t=o,n=Qt[e];return n||(n=fn(e,t),"none"!==n&&n||(It=(It||w("<iframe frameborder='0' width='0' height='0'/>").css("cssText","display:block !important")).appendTo(t.documentElement),t=(It[0].contentWindow||It[0].contentDocument).document,t.write("<!doctype html><html><body>"),t.close(),n=fn(e,t),It.detach()),Qt[e]=n),n}function fn(e,t){var n=w(t.createElement(e)).appendTo(t.body),r=w.css(n[0],"display");return n.remove(),r}function vn(e,t,n,r){var i;if(w.isArray(t))w.each(t,function(t,i){n||cn.test(e)?r(e,i):vn(e+"["+("object"==typeof i?t:"")+"]",i,n,r)});else if(n||"object"!==w.type(t))r(e,t);else for(i in t)vn(e+"["+i+"]",t[i],n,r)}function _n(e){return function(t,n){"string"!=typeof t&&(n=t,t="*");var r,i=0,s=t.toLowerCase().match(S)||[];if(w.isFunction(n))while(r=s[i++])"+"===r[0]?(r=r.slice(1)||"*",(e[r]=e[r]||[]).unshift(n)):(e[r]=e[r]||[]).push(n)}}function Dn(e,n,r,i){function u(a){var f;return s[a]=!0,w.each(e[a]||[],function(e,a){var l=a(n,r,i);return"string"!=typeof l||o||s[l]?o?!(f=l):t:(n.dataTypes.unshift(l),u(l),!1)}),f}var s={},o=e===An;return u(n.dataTypes[0])||!s["*"]&&u("*")}function Pn(e,n){var r,i,s=w.ajaxSettings.flatOptions||{};for(i in n)n[i]!==t&&((s[i]?e:r||(r={}))[i]=n[i]);return r&&w.extend(!0,e,r),e}function Hn(e,n,r){var i,s,o,u,a=e.contents,f=e.dataTypes;while("*"===f[0])f.shift(),s===t&&(s=e.mimeType||n.getResponseHeader("Content-Type"));if(s)for(u in a)if(a[u]&&a[u].test(s)){f.unshift(u);break}if(f[0]in r)o=f[0];else{for(u in r){if(!f[0]||e.converters[u+" "+f[0]]){o=u;break}i||(i=u)}o=o||i}return o?(o!==f[0]&&f.unshift(o),r[o]):t}function Bn(e,t,n,r){var i,s,o,u,a,f={},l=e.dataTypes.slice();if(l[1])for(o in e.converters)f[o.toLowerCase()]=e.converters[o];s=l.shift();while(s)if(e.responseFields[s]&&(n[e.responseFields[s]]=t),!a&&r&&e.dataFilter&&(t=e.dataFilter(t,e.dataType)),a=s,s=l.shift())if("*"===s)s=a;else if("*"!==a&&a!==s){if(o=f[a+" "+s]||f["* "+s],!o)for(i in f)if(u=i.split(" "),u[1]===s&&(o=f[a+" "+u[0]]||f["* "+u[0]])){o===!0?o=f[i]:f[i]!==!0&&(s=u[0],l.unshift(u[1]));break}if(o!==!0)if(o&&e["throws"])t=o(t);else try{t=o(t)}catch(c){return{state:"parsererror",error:o?c:"No conversion from "+a+" to "+s}}}return{state:"success",data:t}}function zn(){try{return new e.XMLHttpRequest}catch(t){}}function Wn(){try{return new e.ActiveXObject("Microsoft.XMLHTTP")}catch(t){}}function Yn(){return setTimeout(function(){Xn=t}),Xn=w.now()}function Zn(e,t,n){var r,i=(Gn[t]||[]).concat(Gn["*"]),s=0,o=i.length;for(;o>s;s++)if(r=i[s].call(n,t,e))return r}function er(e,t,n){var r,i,s=0,o=Qn.length,u=w.Deferred().always(function(){delete a.elem}),a=function(){if(i)return!1;var t=Xn||Yn(),n=Math.max(0,f.startTime+f.duration-t),r=n/f.duration||0,s=1-r,o=0,a=f.tweens.length;for(;a>o;o++)f.tweens[o].run(s);return u.notifyWith(e,[f,s,n]),1>s&&a?n:(u.resolveWith(e,[f]),!1)},f=u.promise({elem:e,props:w.extend({},t),opts:w.extend(!0,{specialEasing:{}},n),originalProperties:t,originalOptions:n,startTime:Xn||Yn(),duration:n.duration,tweens:[],createTween:function(t,n){var r=w.Tween(e,f.opts,t,n,f.opts.specialEasing[t]||f.opts.easing);return f.tweens.push(r),r},stop:function(t){var n=0,r=t?f.tweens.length:0;if(i)return this;for(i=!0;r>n;n++)f.tweens[n].run(1);return t?u.resolveWith(e,[f,t]):u.rejectWith(e,[f,t]),this}}),l=f.props;for(tr(l,f.opts.specialEasing);o>s;s++)if(r=Qn[s].call(f,e,l,f.opts))return r;return w.map(l,Zn,f),w.isFunction(f.opts.start)&&f.opts.start.call(e,f),w.fx.timer(w.extend(a,{elem:e,anim:f,queue:f.opts.queue})),f.progress(f.opts.progress).done(f.opts.done,f.opts.complete).fail(f.opts.fail).always(f.opts.always)}function tr(e,t){var n,r,i,s,o;for(n in e)if(r=w.camelCase(n),i=t[r],s=e[n],w.isArray(s)&&(i=s[1],s=e[n]=s[0]),n!==r&&(e[r]=s,delete e[n]),o=w.cssHooks[r],o&&"expand"in o){s=o.expand(s),delete e[r];for(n in s)n in e||(e[n]=s[n],t[n]=i)}else t[r]=i}function nr(e,t,n){var r,i,s,o,u,a,f=this,l={},c=e.style,h=e.nodeType&&nn(e),p=w._data(e,"fxshow");n.queue||(u=w._queueHooks(e,"fx"),null==u.unqueued&&(u.unqueued=0,a=u.empty.fire,u.empty.fire=function(){u.unqueued||a()}),u.unqueued++,f.always(function(){f.always(function(){u.unqueued--,w.queue(e,"fx").length||u.empty.fire()})})),1===e.nodeType&&("height"in t||"width"in t)&&(n.overflow=[c.overflow,c.overflowX,c.overflowY],"inline"===w.css(e,"display")&&"none"===w.css(e,"float")&&(w.support.inlineBlockNeedsLayout&&"inline"!==an(e.nodeName)?c.zoom=1:c.display="inline-block")),n.overflow&&(c.overflow="hidden",w.support.shrinkWrapBlocks||f.always(function(){c.overflow=n.overflow[0],c.overflowX=n.overflow[1],c.overflowY=n.overflow[2]}));for(r in t)if(i=t[r],$n.exec(i)){if(delete t[r],s=s||"toggle"===i,i===(h?"hide":"show"))continue;l[r]=p&&p[r]||w.style(e,r)}if(!w.isEmptyObject(l)){p?"hidden"in p&&(h=p.hidden):p=w._data(e,"fxshow",{}),s&&(p.hidden=!h),h?w(e).show():f.done(function(){w(e).hide()}),f.done(function(){var t;w._removeData(e,"fxshow");for(t in l)w.style(e,t,l[t])});for(r in l)o=Zn(h?p[r]:0,r,f),r in p||(p[r]=o.start,h&&(o.end=o.start,o.start="width"===r||"height"===r?1:0))}}function rr(e,t,n,r,i){return new rr.prototype.init(e,t,n,r,i)}function ir(e,t){var n,r={height:e},i=0;for(t=t?1:0;4>i;i+=2-t)n=Zt[i],r["margin"+n]=r["padding"+n]=e;return t&&(r.opacity=r.width=e),r}function sr(e){return w.isWindow(e)?e:9===e.nodeType?e.defaultView||e.parentWindow:!1}var n,r,i=typeof t,s=e.location,o=e.document,u=o.documentElement,a=e.jQuery,f=e.$,l={},c=[],h="1.10.2",p=c.concat,d=c.push,v=c.slice,m=c.indexOf,g=l.toString,y=l.hasOwnProperty,b=h.trim,w=function(e,t){return new w.fn.init(e,t,r)},E=/[+-]?(?:\d*\.|)\d+(?:[eE][+-]?\d+|)/.source,S=/\S+/g,x=/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,T=/^(?:\s*(<[\w\W]+>)[^>]*|#([\w-]*))$/,N=/^<(\w+)\s*\/?>(?:<\/\1>|)$/,C=/^[\],:{}\s]*$/,k=/(?:^|:|,)(?:\s*\[)+/g,L=/\\(?:["\\\/bfnrt]|u[\da-fA-F]{4})/g,A=/"[^"\\\r\n]*"|true|false|null|-?(?:\d+\.|)\d+(?:[eE][+-]?\d+|)/g,O=/^-ms-/,M=/-([\da-z])/gi,_=function(e,t){return t.toUpperCase()},D=function(e){(o.addEventListener||"load"===e.type||"complete"===o.readyState)&&(P(),w.ready())},P=function(){o.addEventListener?(o.removeEventListener("DOMContentLoaded",D,!1),e.removeEventListener("load",D,!1)):(o.detachEvent("onreadystatechange",D),e.detachEvent("onload",D))};w.fn=w.prototype={jquery:h,constructor:w,init:function(e,n,r){var i,s;if(!e)return this;if("string"==typeof e){if(i="<"===e.charAt(0)&&">"===e.charAt(e.length-1)&&e.length>=3?[null,e,null]:T.exec(e),!i||!i[1]&&n)return!n||n.jquery?(n||r).find(e):this.constructor(n).find(e);if(i[1]){if(n=n instanceof w?n[0]:n,w.merge(this,w.parseHTML(i[1],n&&n.nodeType?n.ownerDocument||n:o,!0)),N.test(i[1])&&w.isPlainObject(n))for(i in n)w.isFunction(this[i])?this[i](n[i]):this.attr(i,n[i]);return this}if(s=o.getElementById(i[2]),s&&s.parentNode){if(s.id!==i[2])return r.find(e);this.length=1,this[0]=s}return this.context=o,this.selector=e,this}return e.nodeType?(this.context=this[0]=e,this.length=1,this):w.isFunction(e)?r.ready(e):(e.selector!==t&&(this.selector=e.selector,this.context=e.context),w.makeArray(e,this))},selector:"",length:0,toArray:function(){return v.call(this)},get:function(e){return null==e?this.toArray():0>e?this[this.length+e]:this[e]},pushStack:function(e){var t=w.merge(this.constructor(),e);return t.prevObject=this,t.context=this.context,t},each:function(e,t){return w.each(this,e,t)},ready:function(e){return w.ready.promise().done(e),this},slice:function(){return this.pushStack(v.apply(this,arguments))},first:function(){return this.eq(0)},last:function(){return this.eq(-1)},eq:function(e){var t=this.length,n=+e+(0>e?t:0);return this.pushStack(n>=0&&t>n?[this[n]]:[])},map:function(e){return this.pushStack(w.map(this,function(t,n){return e.call(t,n,t)}))},end:function(){return this.prevObject||this.constructor(null)},push:d,sort:[].sort,splice:[].splice},w.fn.init.prototype=w.fn,w.extend=w.fn.extend=function(){var e,n,r,i,s,o,u=arguments[0]||{},a=1,f=arguments.length,l=!1;for("boolean"==typeof u&&(l=u,u=arguments[1]||{},a=2),"object"==typeof u||w.isFunction(u)||(u={}),f===a&&(u=this,--a);f>a;a++)if(null!=(s=arguments[a]))for(i in s)e=u[i],r=s[i],u!==r&&(l&&r&&(w.isPlainObject(r)||(n=w.isArray(r)))?(n?(n=!1,o=e&&w.isArray(e)?e:[]):o=e&&w.isPlainObject(e)?e:{},u[i]=w.extend(l,o,r)):r!==t&&(u[i]=r));return u},w.extend({expando:"jQuery"+(h+Math.random()).replace(/\D/g,""),noConflict:function(t){return e.$===w&&(e.$=f),t&&e.jQuery===w&&(e.jQuery=a),w},isReady:!1,readyWait:1,holdReady:function(e){e?w.readyWait++:w.ready(!0)},ready:function(e){if(e===!0?!--w.readyWait:!w.isReady){if(!o.body)return setTimeout(w.ready);w.isReady=!0,e!==!0&&--w.readyWait>0||(n.resolveWith(o,[w]),w.fn.trigger&&w(o).trigger("ready").off("ready"))}},isFunction:function(e){return"function"===w.type(e)},isArray:Array.isArray||function(e){return"array"===w.type(e)},isWindow:function(e){return null!=e&&e==e.window},isNumeric:function(e){return!isNaN(parseFloat(e))&&isFinite(e)},type:function(e){return null==e?e+"":"object"==typeof e||"function"==typeof e?l[g.call(e)]||"object":typeof e},isPlainObject:function(e){var n;if(!e||"object"!==w.type(e)||e.nodeType||w.isWindow(e))return!1;try{if(e.constructor&&!y.call(e,"constructor")&&!y.call(e.constructor.prototype,"isPrototypeOf"))return!1}catch(r){return!1}if(w.support.ownLast)for(n in e)return y.call(e,n);for(n in e);return n===t||y.call(e,n)},isEmptyObject:function(e){var t;for(t in e)return!1;return!0},error:function(e){throw Error(e)},parseHTML:function(e,t,n){if(!e||"string"!=typeof e)return null;"boolean"==typeof t&&(n=t,t=!1),t=t||o;var r=N.exec(e),i=!n&&[];return r?[t.createElement(r[1])]:(r=w.buildFragment([e],t,i),i&&w(i).remove(),w.merge([],r.childNodes))},parseJSON:function(n){return e.JSON&&e.JSON.parse?e.JSON.parse(n):null===n?n:"string"==typeof n&&(n=w.trim(n),n&&C.test(n.replace(L,"@").replace(A,"]").replace(k,"")))?Function("return "+n)():(w.error("Invalid JSON: "+n),t)},parseXML:function(n){var r,i;if(!n||"string"!=typeof n)return null;try{e.DOMParser?(i=new DOMParser,r=i.parseFromString(n,"text/xml")):(r=new ActiveXObject("Microsoft.XMLDOM"),r.async="false",r.loadXML(n))}catch(s){r=t}return r&&r.documentElement&&!r.getElementsByTagName("parsererror").length||w.error("Invalid XML: "+n),r},noop:function(){},globalEval:function(t){t&&w.trim(t)&&(e.execScript||function(t){e.eval.call(e,t)})(t)},camelCase:function(e){return e.replace(O,"ms-").replace(M,_)},nodeName:function(e,t){return e.nodeName&&e.nodeName.toLowerCase()===t.toLowerCase()},each:function(e,t,n){var r,i=0,s=e.length,o=H(e);if(n){if(o){for(;s>i;i++)if(r=t.apply(e[i],n),r===!1)break}else for(i in e)if(r=t.apply(e[i],n),r===!1)break}else if(o){for(;s>i;i++)if(r=t.call(e[i],i,e[i]),r===!1)break}else for(i in e)if(r=t.call(e[i],i,e[i]),r===!1)break;return e},trim:b&&!b.call("﻿ ")?function(e){return null==e?"":b.call(e)}:function(e){return null==e?"":(e+"").replace(x,"")},makeArray:function(e,t){var n=t||[];return null!=e&&(H(Object(e))?w.merge(n,"string"==typeof e?[e]:e):d.call(n,e)),n},inArray:function(e,t,n){var r;if(t){if(m)return m.call(t,e,n);for(r=t.length,n=n?0>n?Math.max(0,r+n):n:0;r>n;n++)if(n in t&&t[n]===e)return n}return-1},merge:function(e,n){var r=n.length,i=e.length,s=0;if("number"==typeof r)for(;r>s;s++)e[i++]=n[s];else while(n[s]!==t)e[i++]=n[s++];return e.length=i,e},grep:function(e,t,n){var r,i=[],s=0,o=e.length;for(n=!!n;o>s;s++)r=!!t(e[s],s),n!==r&&i.push(e[s]);return i},map:function(e,t,n){var r,i=0,s=e.length,o=H(e),u=[];if(o)for(;s>i;i++)r=t(e[i],i,n),null!=r&&(u[u.length]=r);else for(i in e)r=t(e[i],i,n),null!=r&&(u[u.length]=r);return p.apply([],u)},guid:1,proxy:function(e,n){var r,i,s;return"string"==typeof n&&(s=e[n],n=e,e=s),w.isFunction(e)?(r=v.call(arguments,2),i=function(){return e.apply(n||this,r.concat(v.call(arguments)))},i.guid=e.guid=e.guid||w.guid++,i):t},access:function(e,n,r,i,s,o,u){var a=0,f=e.length,l=null==r;if("object"===w.type(r)){s=!0;for(a in r)w.access(e,n,a,r[a],!0,o,u)}else if(i!==t&&(s=!0,w.isFunction(i)||(u=!0),l&&(u?(n.call(e,i),n=null):(l=n,n=function(e,t,n){return l.call(w(e),n)})),n))for(;f>a;a++)n(e[a],r,u?i:i.call(e[a],a,n(e[a],r)));return s?e:l?n.call(e):f?n(e[0],r):o},now:function(){return(new Date).getTime()},swap:function(e,t,n,r){var i,s,o={};for(s in t)o[s]=e.style[s],e.style[s]=t[s];i=n.apply(e,r||[]);for(s in t)e.style[s]=o[s];return i}}),w.ready.promise=function(t){if(!n)if(n=w.Deferred(),"complete"===o.readyState)setTimeout(w.ready);else if(o.addEventListener)o.addEventListener("DOMContentLoaded",D,!1),e.addEventListener("load",D,!1);else{o.attachEvent("onreadystatechange",D),e.attachEvent("onload",D);var r=!1;try{r=null==e.frameElement&&o.documentElement}catch(i){}r&&r.doScroll&&function s(){if(!w.isReady){try{r.doScroll("left")}catch(e){return setTimeout(s,50)}P(),w.ready()}}()}return n.promise(t)},w.each("Boolean Number String Function Array Date RegExp Object Error".split(" "),function(e,t){l["[object "+t+"]"]=t.toLowerCase()}),r=w(o),function(e,t){function ot(e,t,n,i){var s,o,u,a,f,l,p,m,g,w;if((t?t.ownerDocument||t:E)!==h&&c(t),t=t||h,n=n||[],!e||"string"!=typeof e)return n;if(1!==(a=t.nodeType)&&9!==a)return[];if(d&&!i){if(s=Z.exec(e))if(u=s[1]){if(9===a){if(o=t.getElementById(u),!o||!o.parentNode)return n;if(o.id===u)return n.push(o),n}else if(t.ownerDocument&&(o=t.ownerDocument.getElementById(u))&&y(t,o)&&o.id===u)return n.push(o),n}else{if(s[2])return H.apply(n,t.getElementsByTagName(e)),n;if((u=s[3])&&r.getElementsByClassName&&t.getElementsByClassName)return H.apply(n,t.getElementsByClassName(u)),n}if(r.qsa&&(!v||!v.test(e))){if(m=p=b,g=t,w=9===a&&e,1===a&&"object"!==t.nodeName.toLowerCase()){l=mt(e),(p=t.getAttribute("id"))?m=p.replace(nt,"\\$&"):t.setAttribute("id",m),m="[id='"+m+"'] ",f=l.length;while(f--)l[f]=m+gt(l[f]);g=$.test(e)&&t.parentNode||t,w=l.join(",")}if(w)try{return H.apply(n,g.querySelectorAll(w)),n}catch(S){}finally{p||t.removeAttribute("id")}}}return Nt(e.replace(W,"$1"),t,n,i)}function ut(){function t(n,r){return e.push(n+=" ")>s.cacheLength&&delete t[e.shift()],t[n]=r}var e=[];return t}function at(e){return e[b]=!0,e}function ft(e){var t=h.createElement("div");try{return!!e(t)}catch(n){return!1}finally{t.parentNode&&t.parentNode.removeChild(t),t=null}}function lt(e,t){var n=e.split("|"),r=e.length;while(r--)s.attrHandle[n[r]]=t}function ct(e,t){var n=t&&e,r=n&&1===e.nodeType&&1===t.nodeType&&(~t.sourceIndex||O)-(~e.sourceIndex||O);if(r)return r;if(n)while(n=n.nextSibling)if(n===t)return-1;return e?1:-1}function ht(e){return function(t){var n=t.nodeName.toLowerCase();return"input"===n&&t.type===e}}function pt(e){return function(t){var n=t.nodeName.toLowerCase();return("input"===n||"button"===n)&&t.type===e}}function dt(e){return at(function(t){return t=+t,at(function(n,r){var i,s=e([],n.length,t),o=s.length;while(o--)n[i=s[o]]&&(n[i]=!(r[i]=n[i]))})})}function vt(){}function mt(e,t){var n,r,i,o,u,a,f,l=N[e+" "];if(l)return t?0:l.slice(0);u=e,a=[],f=s.preFilter;while(u){(!n||(r=X.exec(u)))&&(r&&(u=u.slice(r[0].length)||u),a.push(i=[])),n=!1,(r=V.exec(u))&&(n=r.shift(),i.push({value:n,type:r[0].replace(W," ")}),u=u.slice(n.length));for(o in s.filter)!(r=G[o].exec(u))||f[o]&&!(r=f[o](r))||(n=r.shift(),i.push({value:n,type:o,matches:r}),u=u.slice(n.length));if(!n)break}return t?u.length:u?ot.error(e):N(e,a).slice(0)}function gt(e){var t=0,n=e.length,r="";for(;n>t;t++)r+=e[t].value;return r}function yt(e,t,n){var r=t.dir,s=n&&"parentNode"===r,o=x++;return t.first?function(t,n,i){while(t=t[r])if(1===t.nodeType||s)return e(t,n,i)}:function(t,n,u){var a,f,l,c=S+" "+o;if(u){while(t=t[r])if((1===t.nodeType||s)&&e(t,n,u))return!0}else while(t=t[r])if(1===t.nodeType||s)if(l=t[b]||(t[b]={}),(f=l[r])&&f[0]===c){if((a=f[1])===!0||a===i)return a===!0}else if(f=l[r]=[c],f[1]=e(t,n,u)||i,f[1]===!0)return!0}}function bt(e){return e.length>1?function(t,n,r){var i=e.length;while(i--)if(!e[i](t,n,r))return!1;return!0}:e[0]}function wt(e,t,n,r,i){var s,o=[],u=0,a=e.length,f=null!=t;for(;a>u;u++)(s=e[u])&&(!n||n(s,r,i))&&(o.push(s),f&&t.push(u));return o}function Et(e,t,n,r,i,s){return r&&!r[b]&&(r=Et(r)),i&&!i[b]&&(i=Et(i,s)),at(function(s,o,u,a){var f,l,c,h=[],p=[],d=o.length,v=s||Tt(t||"*",u.nodeType?[u]:u,[]),m=!e||!s&&t?v:wt(v,h,e,u,a),g=n?i||(s?e:d||r)?[]:o:m;if(n&&n(m,g,u,a),r){f=wt(g,p),r(f,[],u,a),l=f.length;while(l--)(c=f[l])&&(g[p[l]]=!(m[p[l]]=c))}if(s){if(i||e){if(i){f=[],l=g.length;while(l--)(c=g[l])&&f.push(m[l]=c);i(null,g=[],f,a)}l=g.length;while(l--)(c=g[l])&&(f=i?j.call(s,c):h[l])>-1&&(s[f]=!(o[f]=c))}}else g=wt(g===o?g.splice(d,g.length):g),i?i(null,o,g,a):H.apply(o,g)})}function St(e){var t,n,r,i=e.length,o=s.relative[e[0].type],u=o||s.relative[" "],a=o?1:0,l=yt(function(e){return e===t},u,!0),c=yt(function(e){return j.call(t,e)>-1},u,!0),h=[function(e,n,r){return!o&&(r||n!==f)||((t=n).nodeType?l(e,n,r):c(e,n,r))}];for(;i>a;a++)if(n=s.relative[e[a].type])h=[yt(bt(h),n)];else{if(n=s.filter[e[a].type].apply(null,e[a].matches),n[b]){for(r=++a;i>r;r++)if(s.relative[e[r].type])break;return Et(a>1&&bt(h),a>1&&gt(e.slice(0,a-1).concat({value:" "===e[a-2].type?"*":""})).replace(W,"$1"),n,r>a&&St(e.slice(a,r)),i>r&&St(e=e.slice(r)),i>r&&gt(e))}h.push(n)}return bt(h)}function xt(e,t){var n=0,r=t.length>0,o=e.length>0,u=function(u,a,l,c,p){var d,v,m,g=[],y=0,b="0",w=u&&[],E=null!=p,x=f,T=u||o&&s.find.TAG("*",p&&a.parentNode||a),N=S+=null==x?1:Math.random()||.1;for(E&&(f=a!==h&&a,i=n);null!=(d=T[b]);b++){if(o&&d){v=0;while(m=e[v++])if(m(d,a,l)){c.push(d);break}E&&(S=N,i=++n)}r&&((d=!m&&d)&&y--,u&&w.push(d))}if(y+=b,r&&b!==y){v=0;while(m=t[v++])m(w,g,a,l);if(u){if(y>0)while(b--)w[b]||g[b]||(g[b]=D.call(c));g=wt(g)}H.apply(c,g),E&&!u&&g.length>0&&y+t.length>1&&ot.uniqueSort(c)}return E&&(S=N,f=x),w};return r?at(u):u}function Tt(e,t,n){var r=0,i=t.length;for(;i>r;r++)ot(e,t[r],n);return n}function Nt(e,t,n,i){var o,u,f,l,c,h=mt(e);if(!i&&1===h.length){if(u=h[0]=h[0].slice(0),u.length>2&&"ID"===(f=u[0]).type&&r.getById&&9===t.nodeType&&d&&s.relative[u[1].type]){if(t=(s.find.ID(f.matches[0].replace(rt,it),t)||[])[0],!t)return n;e=e.slice(u.shift().value.length)}o=G.needsContext.test(e)?0:u.length;while(o--){if(f=u[o],s.relative[l=f.type])break;if((c=s.find[l])&&(i=c(f.matches[0].replace(rt,it),$.test(u[0].type)&&t.parentNode||t))){if(u.splice(o,1),e=i.length&&gt(u),!e)return H.apply(n,i),n;break}}}return a(e,h)(i,t,!d,n,$.test(e)),n}var n,r,i,s,o,u,a,f,l,c,h,p,d,v,m,g,y,b="sizzle"+ -(new Date),E=e.document,S=0,x=0,T=ut(),N=ut(),C=ut(),k=!1,L=function(e,t){return e===t?(k=!0,0):0},A=typeof t,O=1<<31,M={}.hasOwnProperty,_=[],D=_.pop,P=_.push,H=_.push,B=_.slice,j=_.indexOf||function(e){var t=0,n=this.length;for(;n>t;t++)if(this[t]===e)return t;return-1},F="checked|selected|async|autofocus|autoplay|controls|defer|disabled|hidden|ismap|loop|multiple|open|readonly|required|scoped",I="[\\x20\\t\\r\\n\\f]",q="(?:\\\\.|[\\w-]|[^\\x00-\\xa0])+",R=q.replace("w","w#"),U="\\["+I+"*("+q+")"+I+"*(?:([*^$|!~]?=)"+I+"*(?:(['\"])((?:\\\\.|[^\\\\])*?)\\3|("+R+")|)|)"+I+"*\\]",z=":("+q+")(?:\\(((['\"])((?:\\\\.|[^\\\\])*?)\\3|((?:\\\\.|[^\\\\()[\\]]|"+U.replace(3,8)+")*)|.*)\\)|)",W=RegExp("^"+I+"+|((?:^|[^\\\\])(?:\\\\.)*)"+I+"+$","g"),X=RegExp("^"+I+"*,"+I+"*"),V=RegExp("^"+I+"*([>+~]|"+I+")"+I+"*"),$=RegExp(I+"*[+~]"),J=RegExp("="+I+"*([^\\]'\"]*)"+I+"*\\]","g"),K=RegExp(z),Q=RegExp("^"+R+"$"),G={ID:RegExp("^#("+q+")"),CLASS:RegExp("^\\.("+q+")"),TAG:RegExp("^("+q.replace("w","w*")+")"),ATTR:RegExp("^"+U),PSEUDO:RegExp("^"+z),CHILD:RegExp("^:(only|first|last|nth|nth-last)-(child|of-type)(?:\\("+I+"*(even|odd|(([+-]|)(\\d*)n|)"+I+"*(?:([+-]|)"+I+"*(\\d+)|))"+I+"*\\)|)","i"),bool:RegExp("^(?:"+F+")$","i"),needsContext:RegExp("^"+I+"*[>+~]|:(even|odd|eq|gt|lt|nth|first|last)(?:\\("+I+"*((?:-\\d)?\\d*)"+I+"*\\)|)(?=[^-]|$)","i")},Y=/^[^{]+\{\s*\[native \w/,Z=/^(?:#([\w-]+)|(\w+)|\.([\w-]+))$/,et=/^(?:input|select|textarea|button)$/i,tt=/^h\d$/i,nt=/'|\\/g,rt=RegExp("\\\\([\\da-f]{1,6}"+I+"?|("+I+")|.)","ig"),it=function(e,t,n){var r="0x"+t-65536;return r!==r||n?t:0>r?String.fromCharCode(r+65536):String.fromCharCode(55296|r>>10,56320|1023&r)};try{H.apply(_=B.call(E.childNodes),E.childNodes),_[E.childNodes.length].nodeType}catch(st){H={apply:_.length?function(e,t){P.apply(e,B.call(t))}:function(e,t){var n=e.length,r=0;while(e[n++]=t[r++]);e.length=n-1}}}u=ot.isXML=function(e){var t=e&&(e.ownerDocument||e).documentElement;return t?"HTML"!==t.nodeName:!1},r=ot.support={},c=ot.setDocument=function(e){var n=e?e.ownerDocument||e:E,i=n.defaultView;return n!==h&&9===n.nodeType&&n.documentElement?(h=n,p=n.documentElement,d=!u(n),i&&i.attachEvent&&i!==i.top&&i.attachEvent("onbeforeunload",function(){c()}),r.attributes=ft(function(e){return e.className="i",!e.getAttribute("className")}),r.getElementsByTagName=ft(function(e){return e.appendChild(n.createComment("")),!e.getElementsByTagName("*").length}),r.getElementsByClassName=ft(function(e){return e.innerHTML="<div class='a'></div><div class='a i'></div>",e.firstChild.className="i",2===e.getElementsByClassName("i").length}),r.getById=ft(function(e){return p.appendChild(e).id=b,!n.getElementsByName||!n.getElementsByName(b).length}),r.getById?(s.find.ID=function(e,t){if(typeof t.getElementById!==A&&d){var n=t.getElementById(e);return n&&n.parentNode?[n]:[]}},s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){return e.getAttribute("id")===t}}):(delete s.find.ID,s.filter.ID=function(e){var t=e.replace(rt,it);return function(e){var n=typeof e.getAttributeNode!==A&&e.getAttributeNode("id");return n&&n.value===t}}),s.find.TAG=r.getElementsByTagName?function(e,n){return typeof n.getElementsByTagName!==A?n.getElementsByTagName(e):t}:function(e,t){var n,r=[],i=0,s=t.getElementsByTagName(e);if("*"===e){while(n=s[i++])1===n.nodeType&&r.push(n);return r}return s},s.find.CLASS=r.getElementsByClassName&&function(e,n){return typeof n.getElementsByClassName!==A&&d?n.getElementsByClassName(e):t},m=[],v=[],(r.qsa=Y.test(n.querySelectorAll))&&(ft(function(e){e.innerHTML="<select><option selected=''></option></select>",e.querySelectorAll("[selected]").length||v.push("\\["+I+"*(?:value|"+F+")"),e.querySelectorAll(":checked").length||v.push(":checked")}),ft(function(e){var t=n.createElement("input");t.setAttribute("type","hidden"),e.appendChild(t).setAttribute("t",""),e.querySelectorAll("[t^='']").length&&v.push("[*^$]="+I+"*(?:''|\"\")"),e.querySelectorAll(":enabled").length||v.push(":enabled",":disabled"),e.querySelectorAll("*,:x"),v.push(",.*:")})),(r.matchesSelector=Y.test(g=p.webkitMatchesSelector||p.mozMatchesSelector||p.oMatchesSelector||p.msMatchesSelector))&&ft(function(e){r.disconnectedMatch=g.call(e,"div"),g.call(e,"[s!='']:x"),m.push("!=",z)}),v=v.length&&RegExp(v.join("|")),m=m.length&&RegExp(m.join("|")),y=Y.test(p.contains)||p.compareDocumentPosition?function(e,t){var n=9===e.nodeType?e.documentElement:e,r=t&&t.parentNode;return e===r||!!r&&1===r.nodeType&&!!(n.contains?n.contains(r):e.compareDocumentPosition&&16&e.compareDocumentPosition(r))}:function(e,t){if(t)while(t=t.parentNode)if(t===e)return!0;return!1},L=p.compareDocumentPosition?function(e,t){if(e===t)return k=!0,0;var i=t.compareDocumentPosition&&e.compareDocumentPosition&&e.compareDocumentPosition(t);return i?1&i||!r.sortDetached&&t.compareDocumentPosition(e)===i?e===n||y(E,e)?-1:t===n||y(E,t)?1:l?j.call(l,e)-j.call(l,t):0:4&i?-1:1:e.compareDocumentPosition?-1:1}:function(e,t){var r,i=0,s=e.parentNode,o=t.parentNode,u=[e],a=[t];if(e===t)return k=!0,0;if(!s||!o)return e===n?-1:t===n?1:s?-1:o?1:l?j.call(l,e)-j.call(l,t):0;if(s===o)return ct(e,t);r=e;while(r=r.parentNode)u.unshift(r);r=t;while(r=r.parentNode)a.unshift(r);while(u[i]===a[i])i++;return i?ct(u[i],a[i]):u[i]===E?-1:a[i]===E?1:0},n):h},ot.matches=function(e,t){return ot(e,null,null,t)},ot.matchesSelector=function(e,t){if((e.ownerDocument||e)!==h&&c(e),t=t.replace(J,"='$1']"),!(!r.matchesSelector||!d||m&&m.test(t)||v&&v.test(t)))try{var n=g.call(e,t);if(n||r.disconnectedMatch||e.document&&11!==e.document.nodeType)return n}catch(i){}return ot(t,h,null,[e]).length>0},ot.contains=function(e,t){return(e.ownerDocument||e)!==h&&c(e),y(e,t)},ot.attr=function(e,n){(e.ownerDocument||e)!==h&&c(e);var i=s.attrHandle[n.toLowerCase()],o=i&&M.call(s.attrHandle,n.toLowerCase())?i(e,n,!d):t;return o===t?r.attributes||!d?e.getAttribute(n):(o=e.getAttributeNode(n))&&o.specified?o.value:null:o},ot.error=function(e){throw Error("Syntax error, unrecognized expression: "+e)},ot.uniqueSort=function(e){var t,n=[],i=0,s=0;if(k=!r.detectDuplicates,l=!r.sortStable&&e.slice(0),e.sort(L),k){while(t=e[s++])t===e[s]&&(i=n.push(s));while(i--)e.splice(n[i],1)}return e},o=ot.getText=function(e){var t,n="",r=0,i=e.nodeType;if(i){if(1===i||9===i||11===i){if("string"==typeof e.textContent)return e.textContent;for(e=e.firstChild;e;e=e.nextSibling)n+=o(e)}else if(3===i||4===i)return e.nodeValue}else for(;t=e[r];r++)n+=o(t);return n},s=ot.selectors={cacheLength:50,createPseudo:at,match:G,attrHandle:{},find:{},relative:{">":{dir:"parentNode",first:!0}," ":{dir:"parentNode"},"+":{dir:"previousSibling",first:!0},"~":{dir:"previousSibling"}},preFilter:{ATTR:function(e){return e[1]=e[1].replace(rt,it),e[3]=(e[4]||e[5]||"").replace(rt,it),"~="===e[2]&&(e[3]=" "+e[3]+" "),e.slice(0,4)},CHILD:function(e){return e[1]=e[1].toLowerCase(),"nth"===e[1].slice(0,3)?(e[3]||ot.error(e[0]),e[4]=+(e[4]?e[5]+(e[6]||1):2*("even"===e[3]||"odd"===e[3])),e[5]=+(e[7]+e[8]||"odd"===e[3])):e[3]&&ot.error(e[0]),e},PSEUDO:function(e){var n,r=!e[5]&&e[2];return G.CHILD.test(e[0])?null:(e[3]&&e[4]!==t?e[2]=e[4]:r&&K.test(r)&&(n=mt(r,!0))&&(n=r.indexOf(")",r.length-n)-r.length)&&(e[0]=e[0].slice(0,n),e[2]=r.slice(0,n)),e.slice(0,3))}},filter:{TAG:function(e){var t=e.replace(rt,it).toLowerCase();return"*"===e?function(){return!0}:function(e){return e.nodeName&&e.nodeName.toLowerCase()===t}},CLASS:function(e){var t=T[e+" "];return t||(t=RegExp("(^|"+I+")"+e+"("+I+"|$)"))&&T(e,function(e){return t.test("string"==typeof e.className&&e.className||typeof e.getAttribute!==A&&e.getAttribute("class")||"")})},ATTR:function(e,t,n){return function(r){var i=ot.attr(r,e);return null==i?"!="===t:t?(i+="","="===t?i===n:"!="===t?i!==n:"^="===t?n&&0===i.indexOf(n):"*="===t?n&&i.indexOf(n)>-1:"$="===t?n&&i.slice(-n.length)===n:"~="===t?(" "+i+" ").indexOf(n)>-1:"|="===t?i===n||i.slice(0,n.length+1)===n+"-":!1):!0}},CHILD:function(e,t,n,r,i){var s="nth"!==e.slice(0,3),o="last"!==e.slice(-4),u="of-type"===t;return 1===r&&0===i?function(e){return!!e.parentNode}:function(t,n,a){var f,l,c,h,p,d,v=s!==o?"nextSibling":"previousSibling",m=t.parentNode,g=u&&t.nodeName.toLowerCase(),y=!a&&!u;if(m){if(s){while(v){c=t;while(c=c[v])if(u?c.nodeName.toLowerCase()===g:1===c.nodeType)return!1;d=v="only"===e&&!d&&"nextSibling"}return!0}if(d=[o?m.firstChild:m.lastChild],o&&y){l=m[b]||(m[b]={}),f=l[e]||[],p=f[0]===S&&f[1],h=f[0]===S&&f[2],c=p&&m.childNodes[p];while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if(1===c.nodeType&&++h&&c===t){l[e]=[S,p,h];break}}else if(y&&(f=(t[b]||(t[b]={}))[e])&&f[0]===S)h=f[1];else while(c=++p&&c&&c[v]||(h=p=0)||d.pop())if((u?c.nodeName.toLowerCase()===g:1===c.nodeType)&&++h&&(y&&((c[b]||(c[b]={}))[e]=[S,h]),c===t))break;return h-=i,h===r||0===h%r&&h/r>=0}}},PSEUDO:function(e,t){var n,r=s.pseudos[e]||s.setFilters[e.toLowerCase()]||ot.error("unsupported pseudo: "+e);return r[b]?r(t):r.length>1?(n=[e,e,"",t],s.setFilters.hasOwnProperty(e.toLowerCase())?at(function(e,n){var i,s=r(e,t),o=s.length;while(o--)i=j.call(e,s[o]),e[i]=!(n[i]=s[o])}):function(e){return r(e,0,n)}):r}},pseudos:{not:at(function(e){var t=[],n=[],r=a(e.replace(W,"$1"));return r[b]?at(function(e,t,n,i){var s,o=r(e,null,i,[]),u=e.length;while(u--)(s=o[u])&&(e[u]=!(t[u]=s))}):function(e,i,s){return t[0]=e,r(t,null,s,n),!n.pop()}}),has:at(function(e){return function(t){return ot(e,t).length>0}}),contains:at(function(e){return function(t){return(t.textContent||t.innerText||o(t)).indexOf(e)>-1}}),lang:at(function(e){return Q.test(e||"")||ot.error("unsupported lang: "+e),e=e.replace(rt,it).toLowerCase(),function(t){var n;do if(n=d?t.lang:t.getAttribute("xml:lang")||t.getAttribute("lang"))return n=n.toLowerCase(),n===e||0===n.indexOf(e+"-");while((t=t.parentNode)&&1===t.nodeType);return!1}}),target:function(t){var n=e.location&&e.location.hash;return n&&n.slice(1)===t.id},root:function(e){return e===p},focus:function(e){return e===h.activeElement&&(!h.hasFocus||h.hasFocus())&&!!(e.type||e.href||~e.tabIndex)},enabled:function(e){return e.disabled===!1},disabled:function(e){return e.disabled===!0},checked:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&!!e.checked||"option"===t&&!!e.selected},selected:function(e){return e.parentNode&&e.parentNode.selectedIndex,e.selected===!0},empty:function(e){for(e=e.firstChild;e;e=e.nextSibling)if(e.nodeName>"@"||3===e.nodeType||4===e.nodeType)return!1;return!0},parent:function(e){return!s.pseudos.empty(e)},header:function(e){return tt.test(e.nodeName)},input:function(e){return et.test(e.nodeName)},button:function(e){var t=e.nodeName.toLowerCase();return"input"===t&&"button"===e.type||"button"===t},text:function(e){var t;return"input"===e.nodeName.toLowerCase()&&"text"===e.type&&(null==(t=e.getAttribute("type"))||t.toLowerCase()===e.type)},first:dt(function(){return[0]}),last:dt(function(e,t){return[t-1]}),eq:dt(function(e,t,n){return[0>n?n+t:n]}),even:dt(function(e,t){var n=0;for(;t>n;n+=2)e.push(n);return e}),odd:dt(function(e,t){var n=1;for(;t>n;n+=2)e.push(n);return e}),lt:dt(function(e,t,n){var r=0>n?n+t:n;for(;--r>=0;)e.push(r);return e}),gt:dt(function(e,t,n){var r=0>n?n+t:n;for(;t>++r;)e.push(r);return e})}},s.pseudos.nth=s.pseudos.eq;for(n in{radio:!0,checkbox:!0,file:!0,password:!0,image:!0})s.pseudos[n]=ht(n);for(n in{submit:!0,reset:!0})s.pseudos[n]=pt(n);vt.prototype=s.filters=s.pseudos,s.setFilters=new vt,a=ot.compile=function(e,t){var n,r=[],i=[],s=C[e+" "];if(!s){t||(t=mt(e)),n=t.length;while(n--)s=St(t[n]),s[b]?r.push(s):i.push(s);s=C(e,xt(i,r))}return s},r.sortStable=b.split("").sort(L).join("")===b,r.detectDuplicates=k,c(),r.sortDetached=ft(function(e){return 1&e.compareDocumentPosition(h.createElement("div"))}),ft(function(e){return e.innerHTML="<a href='#'></a>","#"===e.firstChild.getAttribute("href")})||lt("type|href|height|width",function(e,n,r){return r?t:e.getAttribute(n,"type"===n.toLowerCase()?1:2)}),r.attributes&&ft(function(e){return e.innerHTML="<input/>",e.firstChild.setAttribute("value",""),""===e.firstChild.getAttribute("value")})||lt("value",function(e,n,r){return r||"input"!==e.nodeName.toLowerCase()?t:e.defaultValue}),ft(function(e){return null==e.getAttribute("disabled")})||lt(F,function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&i.specified?i.value:e[n]===!0?n.toLowerCase():null}),w.find=ot,w.expr=ot.selectors,w.expr[":"]=w.expr.pseudos,w.unique=ot.uniqueSort,w.text=ot.getText,w.isXMLDoc=ot.isXML,w.contains=ot.contains}(e);var B={};w.Callbacks=function(e){e="string"==typeof e?B[e]||j(e):w.extend({},e);var n,r,i,s,o,u,a=[],f=!e.once&&[],l=function(t){for(r=e.memory&&t,i=!0,o=u||0,u=0,s=a.length,n=!0;a&&s>o;o++)if(a[o].apply(t[0],t[1])===!1&&e.stopOnFalse){r=!1;break}n=!1,a&&(f?f.length&&l(f.shift()):r?a=[]:c.disable())},c={add:function(){if(a){var t=a.length;(function i(t){w.each(t,function(t,n){var r=w.type(n);"function"===r?e.unique&&c.has(n)||a.push(n):n&&n.length&&"string"!==r&&i(n)})})(arguments),n?s=a.length:r&&(u=t,l(r))}return this},remove:function(){return a&&w.each(arguments,function(e,t){var r;while((r=w.inArray(t,a,r))>-1)a.splice(r,1),n&&(s>=r&&s--,o>=r&&o--)}),this},has:function(e){return e?w.inArray(e,a)>-1:!!a&&!!a.length},empty:function(){return a=[],s=0,this},disable:function(){return a=f=r=t,this},disabled:function(){return!a},lock:function(){return f=t,r||c.disable(),this},locked:function(){return!f},fireWith:function(e,t){return!a||i&&!f||(t=t||[],t=[e,t.slice?t.slice():t],n?f.push(t):l(t)),this},fire:function(){return c.fireWith(this,arguments),this},fired:function(){return!!i}};return c},w.extend({Deferred:function(e){var t=[["resolve","done",w.Callbacks("once memory"),"resolved"],["reject","fail",w.Callbacks("once memory"),"rejected"],["notify","progress",w.Callbacks("memory")]],n="pending",r={state:function(){return n},always:function(){return i.done(arguments).fail(arguments),this},then:function(){var e=arguments;return w.Deferred(function(n){w.each(t,function(t,s){var o=s[0],u=w.isFunction(e[t])&&e[t];i[s[1]](function(){var e=u&&u.apply(this,arguments);e&&w.isFunction(e.promise)?e.promise().done(n.resolve).fail(n.reject).progress(n.notify):n[o+"With"](this===r?n.promise():this,u?[e]:arguments)})}),e=null}).promise()},promise:function(e){return null!=e?w.extend(e,r):r}},i={};return r.pipe=r.then,w.each(t,function(e,s){var o=s[2],u=s[3];r[s[1]]=o.add,u&&o.add(function(){n=u},t[1^e][2].disable,t[2][2].lock),i[s[0]]=function(){return i[s[0]+"With"](this===i?r:this,arguments),this},i[s[0]+"With"]=o.fireWith}),r.promise(i),e&&e.call(i,i),i},when:function(e){var t=0,n=v.call(arguments),r=n.length,i=1!==r||e&&w.isFunction(e.promise)?r:0,s=1===i?e:w.Deferred(),o=function(e,t,n){return function(r){t[e]=this,n[e]=arguments.length>1?v.call(arguments):r,n===u?s.notifyWith(t,n):--i||s.resolveWith(t,n)}},u,a,f;if(r>1)for(u=Array(r),a=Array(r),f=Array(r);r>t;t++)n[t]&&w.isFunction(n[t].promise)?n[t].promise().done(o(t,f,n)).fail(s.reject).progress(o(t,a,u)):--i;return i||s.resolveWith(f,n),s.promise()}}),w.support=function(t){var n,r,s,u,a,f,l,c,h,p=o.createElement("div");if(p.setAttribute("className","t"),p.innerHTML="  <link/><table></table><a href='/a'>a</a><input type='checkbox'/>",n=p.getElementsByTagName("*")||[],r=p.getElementsByTagName("a")[0],!r||!r.style||!n.length)return t;u=o.createElement("select"),f=u.appendChild(o.createElement("option")),s=p.getElementsByTagName("input")[0],r.style.cssText="top:1px;float:left;opacity:.5",t.getSetAttribute="t"!==p.className,t.leadingWhitespace=3===p.firstChild.nodeType,t.tbody=!p.getElementsByTagName("tbody").length,t.htmlSerialize=!!p.getElementsByTagName("link").length,t.style=/top/.test(r.getAttribute("style")),t.hrefNormalized="/a"===r.getAttribute("href"),t.opacity=/^0.5/.test(r.style.opacity),t.cssFloat=!!r.style.cssFloat,t.checkOn=!!s.value,t.optSelected=f.selected,t.enctype=!!o.createElement("form").enctype,t.html5Clone="<:nav></:nav>"!==o.createElement("nav").cloneNode(!0).outerHTML,t.inlineBlockNeedsLayout=!1,t.shrinkWrapBlocks=!1,t.pixelPosition=!1,t.deleteExpando=!0,t.noCloneEvent=!0,t.reliableMarginRight=!0,t.boxSizingReliable=!0,s.checked=!0,t.noCloneChecked=s.cloneNode(!0).checked,u.disabled=!0,t.optDisabled=!f.disabled;try{delete p.test}catch(d){t.deleteExpando=!1}s=o.createElement("input"),s.setAttribute("value",""),t.input=""===s.getAttribute("value"),s.value="t",s.setAttribute("type","radio"),t.radioValue="t"===s.value,s.setAttribute("checked","t"),s.setAttribute("name","t"),a=o.createDocumentFragment(),a.appendChild(s),t.appendChecked=s.checked,t.checkClone=a.cloneNode(!0).cloneNode(!0).lastChild.checked,p.attachEvent&&(p.attachEvent("onclick",function(){t.noCloneEvent=!1}),p.cloneNode(!0).click());for(h in{submit:!0,change:!0,focusin:!0})p.setAttribute(l="on"+h,"t"),t[h+"Bubbles"]=l in e||p.attributes[l].expando===!1;p.style.backgroundClip="content-box",p.cloneNode(!0).style.backgroundClip="",t.clearCloneStyle="content-box"===p.style.backgroundClip;for(h in w(t))break;return t.ownLast="0"!==h,w(function(){var n,r,s,u="padding:0;margin:0;border:0;display:block;box-sizing:content-box;-moz-box-sizing:content-box;-webkit-box-sizing:content-box;",a=o.getElementsByTagName("body")[0];a&&(n=o.createElement("div"),n.style.cssText="border:0;width:0;height:0;position:absolute;top:0;left:-9999px;margin-top:1px",a.appendChild(n).appendChild(p),p.innerHTML="<table><tr><td></td><td>t</td></tr></table>",s=p.getElementsByTagName("td"),s[0].style.cssText="padding:0;margin:0;border:0;display:none",c=0===s[0].offsetHeight,s[0].style.display="",s[1].style.display="none",t.reliableHiddenOffsets=c&&0===s[0].offsetHeight,p.innerHTML="",p.style.cssText="box-sizing:border-box;-moz-box-sizing:border-box;-webkit-box-sizing:border-box;padding:1px;border:1px;display:block;width:4px;margin-top:1%;position:absolute;top:1%;",w.swap(a,null!=a.style.zoom?{zoom:1}:{},function(){t.boxSizing=4===p.offsetWidth}),e.getComputedStyle&&(t.pixelPosition="1%"!==(e.getComputedStyle(p,null)||{}).top,t.boxSizingReliable="4px"===(e.getComputedStyle(p,null)||{width:"4px"}).width,r=p.appendChild(o.createElement("div")),r.style.cssText=p.style.cssText=u,r.style.marginRight=r.style.width="0",p.style.width="1px",t.reliableMarginRight=!parseFloat((e.getComputedStyle(r,null)||{}).marginRight)),typeof p.style.zoom!==i&&(p.innerHTML="",p.style.cssText=u+"width:1px;padding:1px;display:inline;zoom:1",t.inlineBlockNeedsLayout=3===p.offsetWidth,p.style.display="block",p.innerHTML="<div></div>",p.firstChild.style.width="5px",t.shrinkWrapBlocks=3!==p.offsetWidth,t.inlineBlockNeedsLayout&&(a.style.zoom=1)),a.removeChild(n),n=p=s=r=null)}),n=u=a=f=r=s=null,t}({});var F=/(?:\{[\s\S]*\}|\[[\s\S]*\])$/,I=/([A-Z])/g;w.extend({cache:{},noData:{applet:!0,embed:!0,object:"clsid:D27CDB6E-AE6D-11cf-96B8-444553540000"},hasData:function(e){return e=e.nodeType?w.cache[e[w.expando]]:e[w.expando],!!e&&!z(e)},data:function(e,t,n){return q(e,t,n)},removeData:function(e,t){return R(e,t)},_data:function(e,t,n){return q(e,t,n,!0)},_removeData:function(e,t){return R(e,t,!0)},acceptData:function(e){if(e.nodeType&&1!==e.nodeType&&9!==e.nodeType)return!1;var t=e.nodeName&&w.noData[e.nodeName.toLowerCase()];return!t||t!==!0&&e.getAttribute("classid")===t}}),w.fn.extend({data:function(e,n){var r,i,s=null,o=0,u=this[0];if(e===t){if(this.length&&(s=w.data(u),1===u.nodeType&&!w._data(u,"parsedAttrs"))){for(r=u.attributes;r.length>o;o++)i=r[o].name,0===i.indexOf("data-")&&(i=w.camelCase(i.slice(5)),U(u,i,s[i]));w._data(u,"parsedAttrs",!0)}return s}return"object"==typeof e?this.each(function(){w.data(this,e)}):arguments.length>1?this.each(function(){w.data(this,e,n)}):u?U(u,e,w.data(u,e)):null},removeData:function(e){return this.each(function(){w.removeData(this,e)})}}),w.extend({queue:function(e,n,r){var i;return e?(n=(n||"fx")+"queue",i=w._data(e,n),r&&(!i||w.isArray(r)?i=w._data(e,n,w.makeArray(r)):i.push(r)),i||[]):t},dequeue:function(e,t){t=t||"fx";var n=w.queue(e,t),r=n.length,i=n.shift(),s=w._queueHooks(e,t),o=function(){w.dequeue(e,t)};"inprogress"===i&&(i=n.shift(),r--),i&&("fx"===t&&n.unshift("inprogress"),delete s.stop,i.call(e,o,s)),!r&&s&&s.empty.fire()},_queueHooks:function(e,t){var n=t+"queueHooks";return w._data(e,n)||w._data(e,n,{empty:w.Callbacks("once memory").add(function(){w._removeData(e,t+"queue"),w._removeData(e,n)})})}}),w.fn.extend({queue:function(e,n){var r=2;return"string"!=typeof e&&(n=e,e="fx",r--),r>arguments.length?w.queue(this[0],e):n===t?this:this.each(function(){var t=w.queue(this,e,n);w._queueHooks(this,e),"fx"===e&&"inprogress"!==t[0]&&w.dequeue(this,e)})},dequeue:function(e){return this.each(function(){w.dequeue(this,e)})},delay:function(e,t){return e=w.fx?w.fx.speeds[e]||e:e,t=t||"fx",this.queue(t,function(t,n){var r=setTimeout(t,e);n.stop=function(){clearTimeout(r)}})},clearQueue:function(e){return this.queue(e||"fx",[])},promise:function(e,n){var r,i=1,s=w.Deferred(),o=this,u=this.length,a=function(){--i||s.resolveWith(o,[o])};"string"!=typeof e&&(n=e,e=t),e=e||"fx";while(u--)r=w._data(o[u],e+"queueHooks"),r&&r.empty&&(i++,r.empty.add(a));return a(),s.promise(n)}});var W,X,V=/[\t\r\n\f]/g,$=/\r/g,J=/^(?:input|select|textarea|button|object)$/i,K=/^(?:a|area)$/i,Q=/^(?:checked|selected)$/i,G=w.support.getSetAttribute,Y=w.support.input;w.fn.extend({attr:function(e,t){return w.access(this,w.attr,e,t,arguments.length>1)},removeAttr:function(e){return this.each(function(){w.removeAttr(this,e)})},prop:function(e,t){return w.access(this,w.prop,e,t,arguments.length>1)},removeProp:function(e){return e=w.propFix[e]||e,this.each(function(){try{this[e]=t,delete this[e]}catch(n){}})},addClass:function(e){var t,n,r,i,s,o=0,u=this.length,a="string"==typeof e&&e;if(w.isFunction(e))return this.each(function(t){w(this).addClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(S)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(V," "):" ")){s=0;while(i=t[s++])0>r.indexOf(" "+i+" ")&&(r+=i+" ");n.className=w.trim(r)}return this},removeClass:function(e){var t,n,r,i,s,o=0,u=this.length,a=0===arguments.length||"string"==typeof e&&e;if(w.isFunction(e))return this.each(function(t){w(this).removeClass(e.call(this,t,this.className))});if(a)for(t=(e||"").match(S)||[];u>o;o++)if(n=this[o],r=1===n.nodeType&&(n.className?(" "+n.className+" ").replace(V," "):"")){s=0;while(i=t[s++])while(r.indexOf(" "+i+" ")>=0)r=r.replace(" "+i+" "," ");n.className=e?w.trim(r):""}return this},toggleClass:function(e,t){var n=typeof e;return"boolean"==typeof t&&"string"===n?t?this.addClass(e):this.removeClass(e):w.isFunction(e)?this.each(function(n){w(this).toggleClass(e.call(this,n,this.className,t),t)}):this.each(function(){if("string"===n){var t,r=0,s=w(this),o=e.match(S)||[];while(t=o[r++])s.hasClass(t)?s.removeClass(t):s.addClass(t)}else(n===i||"boolean"===n)&&(this.className&&w._data(this,"__className__",this.className),this.className=this.className||e===!1?"":w._data(this,"__className__")||"")})},hasClass:function(e){var t=" "+e+" ",n=0,r=this.length;for(;r>n;n++)if(1===this[n].nodeType&&(" "+this[n].className+" ").replace(V," ").indexOf(t)>=0)return!0;return!1},val:function(e){var n,r,i,s=this[0];if(arguments.length)return i=w.isFunction(e),this.each(function(n){var s;1===this.nodeType&&(s=i?e.call(this,n,w(this).val()):e,null==s?s="":"number"==typeof s?s+="":w.isArray(s)&&(s=w.map(s,function(e){return null==e?"":e+""})),r=w.valHooks[this.type]||w.valHooks[this.nodeName.toLowerCase()],r&&"set"in r&&r.set(this,s,"value")!==t||(this.value=s))});if(s)return r=w.valHooks[s.type]||w.valHooks[s.nodeName.toLowerCase()],r&&"get"in r&&(n=r.get(s,"value"))!==t?n:(n=s.value,"string"==typeof n?n.replace($,""):null==n?"":n)}}),w.extend({valHooks:{option:{get:function(e){var t=w.find.attr(e,"value");return null!=t?t:e.text}},select:{get:function(e){var t,n,r=e.options,i=e.selectedIndex,s="select-one"===e.type||0>i,o=s?null:[],u=s?i+1:r.length,a=0>i?u:s?i:0;for(;u>a;a++)if(n=r[a],!(!n.selected&&a!==i||(w.support.optDisabled?n.disabled:null!==n.getAttribute("disabled"))||n.parentNode.disabled&&w.nodeName(n.parentNode,"optgroup"))){if(t=w(n).val(),s)return t;o.push(t)}return o},set:function(e,t){var n,r,i=e.options,s=w.makeArray(t),o=i.length;while(o--)r=i[o],(r.selected=w.inArray(w(r).val(),s)>=0)&&(n=!0);return n||(e.selectedIndex=-1),s}}},attr:function(e,n,r){var s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return typeof e.getAttribute===i?w.prop(e,n,r):(1===u&&w.isXMLDoc(e)||(n=n.toLowerCase(),s=w.attrHooks[n]||(w.expr.match.bool.test(n)?X:W)),r===t?s&&"get"in s&&null!==(o=s.get(e,n))?o:(o=w.find.attr(e,n),null==o?t:o):null!==r?s&&"set"in s&&(o=s.set(e,r,n))!==t?o:(e.setAttribute(n,r+""),r):(w.removeAttr(e,n),t))},removeAttr:function(e,t){var n,r,i=0,s=t&&t.match(S);if(s&&1===e.nodeType)while(n=s[i++])r=w.propFix[n]||n,w.expr.match.bool.test(n)?Y&&G||!Q.test(n)?e[r]=!1:e[w.camelCase("default-"+n)]=e[r]=!1:w.attr(e,n,""),e.removeAttribute(G?n:r)},attrHooks:{type:{set:function(e,t){if(!w.support.radioValue&&"radio"===t&&w.nodeName(e,"input")){var n=e.value;return e.setAttribute("type",t),n&&(e.value=n),t}}}},propFix:{"for":"htmlFor","class":"className"},prop:function(e,n,r){var i,s,o,u=e.nodeType;if(e&&3!==u&&8!==u&&2!==u)return o=1!==u||!w.isXMLDoc(e),o&&(n=w.propFix[n]||n,s=w.propHooks[n]),r!==t?s&&"set"in s&&(i=s.set(e,r,n))!==t?i:e[n]=r:s&&"get"in s&&null!==(i=s.get(e,n))?i:e[n]},propHooks:{tabIndex:{get:function(e){var t=w.find.attr(e,"tabindex");return t?parseInt(t,10):J.test(e.nodeName)||K.test(e.nodeName)&&e.href?0:-1}}}}),X={set:function(e,t,n){return t===!1?w.removeAttr(e,n):Y&&G||!Q.test(n)?e.setAttribute(!G&&w.propFix[n]||n,n):e[w.camelCase("default-"+n)]=e[n]=!0,n}},w.each(w.expr.match.bool.source.match(/\w+/g),function(e,n){var r=w.expr.attrHandle[n]||w.find.attr;w.expr.attrHandle[n]=Y&&G||!Q.test(n)?function(e,n,i){var s=w.expr.attrHandle[n],o=i?t:(w.expr.attrHandle[n]=t)!=r(e,n,i)?n.toLowerCase():null;return w.expr.attrHandle[n]=s,o}:function(e,n,r){return r?t:e[w.camelCase("default-"+n)]?n.toLowerCase():null}}),Y&&G||(w.attrHooks.value={set:function(e,n,r){return w.nodeName(e,"input")?(e.defaultValue=n,t):W&&W.set(e,n,r)}}),G||(W={set:function(e,n,r){var i=e.getAttributeNode(r);return i||e.setAttributeNode(i=e.ownerDocument.createAttribute(r)),i.value=n+="","value"===r||n===e.getAttribute(r)?n:t}},w.expr.attrHandle.id=w.expr.attrHandle.name=w.expr.attrHandle.coords=function(e,n,r){var i;return r?t:(i=e.getAttributeNode(n))&&""!==i.value?i.value:null},w.valHooks.button={get:function(e,n){var r=e.getAttributeNode(n);return r&&r.specified?r.value:t},set:W.set},w.attrHooks.contenteditable={set:function(e,t,n){W.set(e,""===t?!1:t,n)}},w.each(["width","height"],function(e,n){w.attrHooks[n]={set:function(e,r){return""===r?(e.setAttribute(n,"auto"),r):t}}})),w.support.hrefNormalized||w.each(["href","src"],function(e,t){w.propHooks[t]={get:function(e){return e.getAttribute(t,4)}}}),w.support.style||(w.attrHooks.style={get:function(e){return e.style.cssText||t},set:function(e,t){return e.style.cssText=t+""}}),w.support.optSelected||(w.propHooks.selected={get:function(e){var t=e.parentNode;return t&&(t.selectedIndex,t.parentNode&&t.parentNode.selectedIndex),null}}),w.each(["tabIndex","readOnly","maxLength","cellSpacing","cellPadding","rowSpan","colSpan","useMap","frameBorder","contentEditable"],function(){w.propFix[this.toLowerCase()]=this}),w.support.enctype||(w.propFix.enctype="encoding"),w.each(["radio","checkbox"],function(){w.valHooks[this]={set:function(e,n){return w.isArray(n)?e.checked=w.inArray(w(e).val(),n)>=0:t}},w.support.checkOn||(w.valHooks[this].get=function(e){return null===e.getAttribute("value")?"on":e.value})});var Z=/^(?:input|select|textarea)$/i,et=/^key/,tt=/^(?:mouse|contextmenu)|click/,nt=/^(?:focusinfocus|focusoutblur)$/,rt=/^([^.]*)(?:\.(.+)|)$/;w.event={global:{},add:function(e,n,r,s,o){var u,a,f,l,c,h,p,d,v,m,g,y=w._data(e);if(y){r.handler&&(l=r,r=l.handler,o=l.selector),r.guid||(r.guid=w.guid++),(a=y.events)||(a=y.events={}),(h=y.handle)||(h=y.handle=function(e){return typeof w===i||e&&w.event.triggered===e.type?t:w.event.dispatch.apply(h.elem,arguments)},h.elem=e),n=(n||"").match(S)||[""],f=n.length;while(f--)u=rt.exec(n[f])||[],v=g=u[1],m=(u[2]||"").split(".").sort(),v&&(c=w.event.special[v]||{},v=(o?c.delegateType:c.bindType)||v,c=w.event.special[v]||{},p=w.extend({type:v,origType:g,data:s,handler:r,guid:r.guid,selector:o,needsContext:o&&w.expr.match.needsContext.test(o),namespace:m.join(".")},l),(d=a[v])||(d=a[v]=[],d.delegateCount=0,c.setup&&c.setup.call(e,s,m,h)!==!1||(e.addEventListener?e.addEventListener(v,h,!1):e.attachEvent&&e.attachEvent("on"+v,h))),c.add&&(c.add.call(e,p),p.handler.guid||(p.handler.guid=r.guid)),o?d.splice(d.delegateCount++,0,p):d.push(p),w.event.global[v]=!0);e=null}},remove:function(e,t,n,r,i){var s,o,u,a,f,l,c,h,p,d,v,m=w.hasData(e)&&w._data(e);if(m&&(l=m.events)){t=(t||"").match(S)||[""],f=t.length;while(f--)if(u=rt.exec(t[f])||[],p=v=u[1],d=(u[2]||"").split(".").sort(),p){c=w.event.special[p]||{},p=(r?c.delegateType:c.bindType)||p,h=l[p]||[],u=u[2]&&RegExp("(^|\\.)"+d.join("\\.(?:.*\\.|)")+"(\\.|$)"),a=s=h.length;while(s--)o=h[s],!i&&v!==o.origType||n&&n.guid!==o.guid||u&&!u.test(o.namespace)||r&&r!==o.selector&&("**"!==r||!o.selector)||(h.splice(s,1),o.selector&&h.delegateCount--,c.remove&&c.remove.call(e,o));a&&!h.length&&(c.teardown&&c.teardown.call(e,d,m.handle)!==!1||w.removeEvent(e,p,m.handle),delete l[p])}else for(p in l)w.event.remove(e,p+t[f],n,r,!0);w.isEmptyObject(l)&&(delete m.handle,w._removeData(e,"events"))}},trigger:function(n,r,i,s){var u,a,f,l,c,h,p,d=[i||o],v=y.call(n,"type")?n.type:n,m=y.call(n,"namespace")?n.namespace.split("."):[];if(f=h=i=i||o,3!==i.nodeType&&8!==i.nodeType&&!nt.test(v+w.event.triggered)&&(v.indexOf(".")>=0&&(m=v.split("."),v=m.shift(),m.sort()),a=0>v.indexOf(":")&&"on"+v,n=n[w.expando]?n:new w.Event(v,"object"==typeof n&&n),n.isTrigger=s?2:3,n.namespace=m.join("."),n.namespace_re=n.namespace?RegExp("(^|\\.)"+m.join("\\.(?:.*\\.|)")+"(\\.|$)"):null,n.result=t,n.target||(n.target=i),r=null==r?[n]:w.makeArray(r,[n]),c=w.event.special[v]||{},s||!c.trigger||c.trigger.apply(i,r)!==!1)){if(!s&&!c.noBubble&&!w.isWindow(i)){for(l=c.delegateType||v,nt.test(l+v)||(f=f.parentNode);f;f=f.parentNode)d.push(f),h=f;h===(i.ownerDocument||o)&&d.push(h.defaultView||h.parentWindow||e)}p=0;while((f=d[p++])&&!n.isPropagationStopped())n.type=p>1?l:c.bindType||v,u=(w._data(f,"events")||{})[n.type]&&w._data(f,"handle"),u&&u.apply(f,r),u=a&&f[a],u&&w.acceptData(f)&&u.apply&&u.apply(f,r)===!1&&n.preventDefault();if(n.type=v,!s&&!n.isDefaultPrevented()&&(!c._default||c._default.apply(d.pop(),r)===!1)&&w.acceptData(i)&&a&&i[v]&&!w.isWindow(i)){h=i[a],h&&(i[a]=null),w.event.triggered=v;try{i[v]()}catch(g){}w.event.triggered=t,h&&(i[a]=h)}return n.result}},dispatch:function(e){e=w.event.fix(e);var n,r,i,s,o,u=[],a=v.call(arguments),f=(w._data(this,"events")||{})[e.type]||[],l=w.event.special[e.type]||{};if(a[0]=e,e.delegateTarget=this,!l.preDispatch||l.preDispatch.call(this,e)!==!1){u=w.event.handlers.call(this,e,f),n=0;while((s=u[n++])&&!e.isPropagationStopped()){e.currentTarget=s.elem,o=0;while((i=s.handlers[o++])&&!e.isImmediatePropagationStopped())(!e.namespace_re||e.namespace_re.test(i.namespace))&&(e.handleObj=i,e.data=i.data,r=((w.event.special[i.origType]||{}).handle||i.handler).apply(s.elem,a),r!==t&&(e.result=r)===!1&&(e.preventDefault(),e.stopPropagation()))}return l.postDispatch&&l.postDispatch.call(this,e),e.result}},handlers:function(e,n){var r,i,s,o,u=[],a=n.delegateCount,f=e.target;if(a&&f.nodeType&&(!e.button||"click"!==e.type))for(;f!=this;f=f.parentNode||this)if(1===f.nodeType&&(f.disabled!==!0||"click"!==e.type)){for(s=[],o=0;a>o;o++)i=n[o],r=i.selector+" ",s[r]===t&&(s[r]=i.needsContext?w(r,this).index(f)>=0:w.find(r,this,null,[f]).length),s[r]&&s.push(i);s.length&&u.push({elem:f,handlers:s})}return n.length>a&&u.push({elem:this,handlers:n.slice(a)}),u},fix:function(e){if(e[w.expando])return e;var t,n,r,i=e.type,s=e,u=this.fixHooks[i];u||(this.fixHooks[i]=u=tt.test(i)?this.mouseHooks:et.test(i)?this.keyHooks:{}),r=u.props?this.props.concat(u.props):this.props,e=new w.Event(s),t=r.length;while(t--)n=r[t],e[n]=s[n];return e.target||(e.target=s.srcElement||o),3===e.target.nodeType&&(e.target=e.target.parentNode),e.metaKey=!!e.metaKey,u.filter?u.filter(e,s):e},props:"altKey bubbles cancelable ctrlKey currentTarget eventPhase metaKey relatedTarget shiftKey target timeStamp view which".split(" "),fixHooks:{},keyHooks:{props:"char charCode key keyCode".split(" "),filter:function(e,t){return null==e.which&&(e.which=null!=t.charCode?t.charCode:t.keyCode),e}},mouseHooks:{props:"button buttons clientX clientY fromElement offsetX offsetY pageX pageY screenX screenY toElement".split(" "),filter:function(e,n){var r,i,s,u=n.button,a=n.fromElement;return null==e.pageX&&null!=n.clientX&&(i=e.target.ownerDocument||o,s=i.documentElement,r=i.body,e.pageX=n.clientX+(s&&s.scrollLeft||r&&r.scrollLeft||0)-(s&&s.clientLeft||r&&r.clientLeft||0),e.pageY=n.clientY+(s&&s.scrollTop||r&&r.scrollTop||0)-(s&&s.clientTop||r&&r.clientTop||0)),!e.relatedTarget&&a&&(e.relatedTarget=a===e.target?n.toElement:a),e.which||u===t||(e.which=1&u?1:2&u?3:4&u?2:0),e}},special:{load:{noBubble:!0},focus:{trigger:function(){if(this!==ot()&&this.focus)try{return this.focus(),!1}catch(e){}},delegateType:"focusin"},blur:{trigger:function(){return this===ot()&&this.blur?(this.blur(),!1):t},delegateType:"focusout"},click:{trigger:function(){return w.nodeName(this,"input")&&"checkbox"===this.type&&this.click?(this.click(),!1):t},_default:function(e){return w.nodeName(e.target,"a")}},beforeunload:{postDispatch:function(e){e.result!==t&&(e.originalEvent.returnValue=e.result)}}},simulate:function(e,t,n,r){var i=w.extend(new w.Event,n,{type:e,isSimulated:!0,originalEvent:{}});r?w.event.trigger(i,null,t):w.event.dispatch.call(t,i),i.isDefaultPrevented()&&n.preventDefault()}},w.removeEvent=o.removeEventListener?function(e,t,n){e.removeEventListener&&e.removeEventListener(t,n,!1)}:function(e,t,n){var r="on"+t;e.detachEvent&&(typeof e[r]===i&&(e[r]=null),e.detachEvent(r,n))},w.Event=function(e,n){return this instanceof w.Event?(e&&e.type?(this.originalEvent=e,this.type=e.type,this.isDefaultPrevented=e.defaultPrevented||e.returnValue===!1||e.getPreventDefault&&e.getPreventDefault()?it:st):this.type=e,n&&w.extend(this,n),this.timeStamp=e&&e.timeStamp||w.now(),this[w.expando]=!0,t):new w.Event(e,n)},w.Event.prototype={isDefaultPrevented:st,isPropagationStopped:st,isImmediatePropagationStopped:st,preventDefault:function(){var e=this.originalEvent;this.isDefaultPrevented=it,e&&(e.preventDefault?e.preventDefault():e.returnValue=!1)},stopPropagation:function(){var e=this.originalEvent;this.isPropagationStopped=it,e&&(e.stopPropagation&&e.stopPropagation(),e.cancelBubble=!0)},stopImmediatePropagation:function(){this.isImmediatePropagationStopped=it,this.stopPropagation()}},w.each({mouseenter:"mouseover",mouseleave:"mouseout"},function(e,t){w.event.special[e]={delegateType:t,bindType:t,handle:function(e){var n,r=this,i=e.relatedTarget,s=e.handleObj;return(!i||i!==r&&!w.contains(r,i))&&(e.type=s.origType,n=s.handler.apply(this,arguments),e.type=t),n}}}),w.support.submitBubbles||(w.event.special.submit={setup:function(){return w.nodeName(this,"form")?!1:(w.event.add(this,"click._submit keypress._submit",function(e){var n=e.target,r=w.nodeName(n,"input")||w.nodeName(n,"button")?n.form:t;r&&!w._data(r,"submitBubbles")&&(w.event.add(r,"submit._submit",function(e){e._submit_bubble=!0}),w._data(r,"submitBubbles",!0))}),t)},postDispatch:function(e){e._submit_bubble&&(delete e._submit_bubble,this.parentNode&&!e.isTrigger&&w.event.simulate("submit",this.parentNode,e,!0))},teardown:function(){return w.nodeName(this,"form")?!1:(w.event.remove(this,"._submit"),t)}}),w.support.changeBubbles||(w.event.special.change={setup:function(){return Z.test(this.nodeName)?(("checkbox"===this.type||"radio"===this.type)&&(w.event.add(this,"propertychange._change",function(e){"checked"===e.originalEvent.propertyName&&(this._just_changed=!0)}),w.event.add(this,"click._change",function(e){this._just_changed&&!e.isTrigger&&(this._just_changed=!1),w.event.simulate("change",this,e,!0)})),!1):(w.event.add(this,"beforeactivate._change",function(e){var t=e.target;Z.test(t.nodeName)&&!w._data(t,"changeBubbles")&&(w.event.add(t,"change._change",function(e){!this.parentNode||e.isSimulated||e.isTrigger||w.event.simulate("change",this.parentNode,e,!0)}),w._data(t,"changeBubbles",!0))}),t)},handle:function(e){var n=e.target;return this!==n||e.isSimulated||e.isTrigger||"radio"!==n.type&&"checkbox"!==n.type?e.handleObj.handler.apply(this,arguments):t},teardown:function(){return w.event.remove(this,"._change"),!Z.test(this.nodeName)}}),w.support.focusinBubbles||w.each({focus:"focusin",blur:"focusout"},function(e,t){var n=0,r=function(e){w.event.simulate(t,e.target,w.event.fix(e),!0)};w.event.special[t]={setup:function(){0===n++&&o.addEventListener(e,r,!0)},teardown:function(){0===--n&&o.removeEventListener(e,r,!0)}}}),w.fn.extend({on:function(e,n,r,i,s){var o,u;if("object"==typeof e){"string"!=typeof n&&(r=r||n,n=t);for(o in e)this.on(o,n,r,e[o],s);return this}if(null==r&&null==i?(i=n,r=n=t):null==i&&("string"==typeof n?(i=r,r=t):(i=r,r=n,n=t)),i===!1)i=st;else if(!i)return this;return 1===s&&(u=i,i=function(e){return w().off(e),u.apply(this,arguments)},i.guid=u.guid||(u.guid=w.guid++)),this.each(function(){w.event.add(this,e,i,r,n)})},one:function(e,t,n,r){return this.on(e,t,n,r,1)},off:function(e,n,r){var i,s;if(e&&e.preventDefault&&e.handleObj)return i=e.handleObj,w(e.delegateTarget).off(i.namespace?i.origType+"."+i.namespace:i.origType,i.selector,i.handler),this;if("object"==typeof e){for(s in e)this.off(s,n,e[s]);return this}return(n===!1||"function"==typeof n)&&(r=n,n=t),r===!1&&(r=st),this.each(function(){w.event.remove(this,e,r,n)})},trigger:function(e,t){return this.each(function(){w.event.trigger(e,t,this)})},triggerHandler:function(e,n){var r=this[0];return r?w.event.trigger(e,n,r,!0):t}});var ut=/^.[^:#\[\.,]*$/,at=/^(?:parents|prev(?:Until|All))/,ft=w.expr.match.needsContext,lt={children:!0,contents:!0,next:!0,prev:!0};w.fn.extend({find:function(e){var t,n=[],r=this,i=r.length;if("string"!=typeof e)return this.pushStack(w(e).filter(function(){for(t=0;i>t;t++)if(w.contains(r[t],this))return!0}));for(t=0;i>t;t++)w.find(e,r[t],n);return n=this.pushStack(i>1?w.unique(n):n),n.selector=this.selector?this.selector+" "+e:e,n},has:function(e){var t,n=w(e,this),r=n.length;return this.filter(function(){for(t=0;r>t;t++)if(w.contains(this,n[t]))return!0})},not:function(e){return this.pushStack(ht(this,e||[],!0))},filter:function(e){return this.pushStack(ht(this,e||[],!1))},is:function(e){return!!ht(this,"string"==typeof e&&ft.test(e)?w(e):e||[],!1).length},closest:function(e,t){var n,r=0,i=this.length,s=[],o=ft.test(e)||"string"!=typeof e?w(e,t||this.context):0;for(;i>r;r++)for(n=this[r];n&&n!==t;n=n.parentNode)if(11>n.nodeType&&(o?o.index(n)>-1:1===n.nodeType&&w.find.matchesSelector(n,e))){n=s.push(n);break}return this.pushStack(s.length>1?w.unique(s):s)},index:function(e){return e?"string"==typeof e?w.inArray(this[0],w(e)):w.inArray(e.jquery?e[0]:e,this):this[0]&&this[0].parentNode?this.first().prevAll().length:-1},add:function(e,t){var n="string"==typeof e?w(e,t):w.makeArray(e&&e.nodeType?[e]:e),r=w.merge(this.get(),n);return this.pushStack(w.unique(r))},addBack:function(e){return this.add(null==e?this.prevObject:this.prevObject.filter(e))}}),w.each({parent:function(e){var t=e.parentNode;return t&&11!==t.nodeType?t:null},parents:function(e){return w.dir(e,"parentNode")},parentsUntil:function(e,t,n){return w.dir(e,"parentNode",n)},next:function(e){return ct(e,"nextSibling")},prev:function(e){return ct(e,"previousSibling")},nextAll:function(e){return w.dir(e,"nextSibling")},prevAll:function(e){return w.dir(e,"previousSibling")},nextUntil:function(e,t,n){return w.dir(e,"nextSibling",n)},prevUntil:function(e,t,n){return w.dir(e,"previousSibling",n)},siblings:function(e){return w.sibling((e.parentNode||{}).firstChild,e)},children:function(e){return w.sibling(e.firstChild)},contents:function(e){return w.nodeName(e,"iframe")?e.contentDocument||e.contentWindow.document:w.merge([],e.childNodes)}},function(e,t){w.fn[e]=function(n,r){var i=w.map(this,t,n);return"Until"!==e.slice(-5)&&(r=n),r&&"string"==typeof r&&(i=w.filter(r,i)),this.length>1&&(lt[e]||(i=w.unique(i)),at.test(e)&&(i=i.reverse())),this.pushStack(i)}}),w.extend({filter:function(e,t,n){var r=t[0];return n&&(e=":not("+e+")"),1===t.length&&1===r.nodeType?w.find.matchesSelector(r,e)?[r]:[]:w.find.matches(e,w.grep(t,function(e){return 1===e.nodeType}))},dir:function(e,n,r){var i=[],s=e[n];while(s&&9!==s.nodeType&&(r===t||1!==s.nodeType||!w(s).is(r)))1===s.nodeType&&i.push(s),s=s[n];return i},sibling:function(e,t){var n=[];for(;e;e=e.nextSibling)1===e.nodeType&&e!==t&&n.push(e);return n}});var dt="abbr|article|aside|audio|bdi|canvas|data|datalist|details|figcaption|figure|footer|header|hgroup|mark|meter|nav|output|progress|section|summary|time|video",vt=/ jQuery\d+="(?:null|\d+)"/g,mt=RegExp("<(?:"+dt+")[\\s/>]","i"),gt=/^\s+/,yt=/<(?!area|br|col|embed|hr|img|input|link|meta|param)(([\w:]+)[^>]*)\/>/gi,bt=/<([\w:]+)/,wt=/<tbody/i,Et=/<|&#?\w+;/,St=/<(?:script|style|link)/i,xt=/^(?:checkbox|radio)$/i,Tt=/checked\s*(?:[^=]|=\s*.checked.)/i,Nt=/^$|\/(?:java|ecma)script/i,Ct=/^true\/(.*)/,kt=/^\s*<!(?:\[CDATA\[|--)|(?:\]\]|--)>\s*$/g,Lt={option:[1,"<select multiple='multiple'>","</select>"],legend:[1,"<fieldset>","</fieldset>"],area:[1,"<map>","</map>"],param:[1,"<object>","</object>"],thead:[1,"<table>","</table>"],tr:[2,"<table><tbody>","</tbody></table>"],col:[2,"<table><tbody></tbody><colgroup>","</colgroup></table>"],td:[3,"<table><tbody><tr>","</tr></tbody></table>"],_default:w.support.htmlSerialize?[0,"",""]:[1,"X<div>","</div>"]},At=pt(o),Ot=At.appendChild(o.createElement("div"));Lt.optgroup=Lt.option,Lt.tbody=Lt.tfoot=Lt.colgroup=Lt.caption=Lt.thead,Lt.th=Lt.td,w.fn.extend({text:function(e){return w.access(this,function(e){return e===t?w.text(this):this.empty().append((this[0]&&this[0].ownerDocument||o).createTextNode(e))},null,e,arguments.length)},append:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Mt(this,e);t.appendChild(e)}})},prepend:function(){return this.domManip(arguments,function(e){if(1===this.nodeType||11===this.nodeType||9===this.nodeType){var t=Mt(this,e);t.insertBefore(e,t.firstChild)}})},before:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this)})},after:function(){return this.domManip(arguments,function(e){this.parentNode&&this.parentNode.insertBefore(e,this.nextSibling)})},remove:function(e,t){var n,r=e?w.filter(e,this):this,i=0;for(;null!=(n=r[i]);i++)t||1!==n.nodeType||w.cleanData(jt(n)),n.parentNode&&(t&&w.contains(n.ownerDocument,n)&&Pt(jt(n,"script")),n.parentNode.removeChild(n));return this},empty:function(){var e,t=0;for(;null!=(e=this[t]);t++){1===e.nodeType&&w.cleanData(jt(e,!1));while(e.firstChild)e.removeChild(e.firstChild);e.options&&w.nodeName(e,"select")&&(e.options.length=0)}return this},clone:function(e,t){return e=null==e?!1:e,t=null==t?e:t,this.map(function(){return w.clone(this,e,t)})},html:function(e){return w.access(this,function(e){var n=this[0]||{},r=0,i=this.length;if(e===t)return 1===n.nodeType?n.innerHTML.replace(vt,""):t;if(!("string"!=typeof e||St.test(e)||!w.support.htmlSerialize&&mt.test(e)||!w.support.leadingWhitespace&&gt.test(e)||Lt[(bt.exec(e)||["",""])[1].toLowerCase()])){e=e.replace(yt,"<$1></$2>");try{for(;i>r;r++)n=this[r]||{},1===n.nodeType&&(w.cleanData(jt(n,!1)),n.innerHTML=e);n=0}catch(s){}}n&&this.empty().append(e)},null,e,arguments.length)},replaceWith:function(){var e=w.map(this,function(e){return[e.nextSibling,e.parentNode]}),t=0;return this.domManip(arguments,function(n){var r=e[t++],i=e[t++];i&&(r&&r.parentNode!==i&&(r=this.nextSibling),w(this).remove(),i.insertBefore(n,r))},!0),t?this:this.remove()},detach:function(e){return this.remove(e,!0)},domManip:function(e,t,n){e=p.apply([],e);var r,i,s,o,u,a,f=0,l=this.length,c=this,h=l-1,d=e[0],v=w.isFunction(d);if(v||!(1>=l||"string"!=typeof d||w.support.checkClone)&&Tt.test(d))return this.each(function(r){var i=c.eq(r);v&&(e[0]=d.call(this,r,i.html())),i.domManip(e,t,n)});if(l&&(a=w.buildFragment(e,this[0].ownerDocument,!1,!n&&this),r=a.firstChild,1===a.childNodes.length&&(a=r),r)){for(o=w.map(jt(a,"script"),_t),s=o.length;l>f;f++)i=a,f!==h&&(i=w.clone(i,!0,!0),s&&w.merge(o,jt(i,"script"))),t.call(this[f],i,f);if(s)for(u=o[o.length-1].ownerDocument,w.map(o,Dt),f=0;s>f;f++)i=o[f],Nt.test(i.type||"")&&!w._data(i,"globalEval")&&w.contains(u,i)&&(i.src?w._evalUrl(i.src):w.globalEval((i.text||i.textContent||i.innerHTML||"").replace(kt,"")));a=r=null}return this}}),w.each({appendTo:"append",prependTo:"prepend",insertBefore:"before",insertAfter:"after",replaceAll:"replaceWith"},function(e,t){w.fn[e]=function(e){var n,r=0,i=[],s=w(e),o=s.length-1;for(;o>=r;r++)n=r===o?this:this.clone(!0),w(s[r])[t](n),d.apply(i,n.get());return this.pushStack(i)}}),w.extend({clone:function(e,t,n){var r,i,s,o,u,a=w.contains(e.ownerDocument,e);if(w.support.html5Clone||w.isXMLDoc(e)||!mt.test("<"+e.nodeName+">")?s=e.cloneNode(!0):(Ot.innerHTML=e.outerHTML,Ot.removeChild(s=Ot.firstChild)),!(w.support.noCloneEvent&&w.support.noCloneChecked||1!==e.nodeType&&11!==e.nodeType||w.isXMLDoc(e)))for(r=jt(s),u=jt(e),o=0;null!=(i=u[o]);++o)r[o]&&Bt(i,r[o]);if(t)if(n)for(u=u||jt(e),r=r||jt(s),o=0;null!=(i=u[o]);o++)Ht(i,r[o]);else Ht(e,s);return r=jt(s,"script"),r.length>0&&Pt(r,!a&&jt(e,"script")),r=u=i=null,s},buildFragment:function(e,t,n,r){var i,s,o,u,a,f,l,c=e.length,h=pt(t),p=[],d=0;for(;c>d;d++)if(s=e[d],s||0===s)if("object"===w.type(s))w.merge(p,s.nodeType?[s]:s);else if(Et.test(s)){u=u||h.appendChild(t.createElement("div")),a=(bt.exec(s)||["",""])[1].toLowerCase(),l=Lt[a]||Lt._default,u.innerHTML=l[1]+s.replace(yt,"<$1></$2>")+l[2],i=l[0];while(i--)u=u.lastChild;if(!w.support.leadingWhitespace&&gt.test(s)&&p.push(t.createTextNode(gt.exec(s)[0])),!w.support.tbody){s="table"!==a||wt.test(s)?"<table>"!==l[1]||wt.test(s)?0:u:u.firstChild,i=s&&s.childNodes.length;while(i--)w.nodeName(f=s.childNodes[i],"tbody")&&!f.childNodes.length&&s.removeChild(f)}w.merge(p,u.childNodes),u.textContent="";while(u.firstChild)u.removeChild(u.firstChild);u=h.lastChild}else p.push(t.createTextNode(s));u&&h.removeChild(u),w.support.appendChecked||w.grep(jt(p,"input"),Ft),d=0;while(s=p[d++])if((!r||-1===w.inArray(s,r))&&(o=w.contains(s.ownerDocument,s),u=jt(h.appendChild(s),"script"),o&&Pt(u),n)){i=0;while(s=u[i++])Nt.test(s.type||"")&&n.push(s)}return u=null,h},cleanData:function(e,t){var n,r,s,o,u=0,a=w.expando,f=w.cache,l=w.support.deleteExpando,h=w.event.special;for(;null!=(n=e[u]);u++)if((t||w.acceptData(n))&&(s=n[a],o=s&&f[s])){if(o.events)for(r in o.events)h[r]?w.event.remove(n,r):w.removeEvent(n,r,o.handle);f[s]&&(delete f[s],l?delete n[a]:typeof n.removeAttribute!==i?n.removeAttribute(a):n[a]=null,c.push(s))}},_evalUrl:function(e){return w.ajax({url:e,type:"GET",dataType:"script",async:!1,global:!1,"throws":!0})}}),w.fn.extend({wrapAll:function(e){if(w.isFunction(e))return this.each(function(t){w(this).wrapAll(e.call(this,t))});if(this[0]){var t=w(e,this[0].ownerDocument).eq(0).clone(!0);this[0].parentNode&&t.insertBefore(this[0]),t.map(function(){var e=this;while(e.firstChild&&1===e.firstChild.nodeType)e=e.firstChild;return e}).append(this)}return this},wrapInner:function(e){return w.isFunction(e)?this.each(function(t){w(this).wrapInner(e.call(this,t))}):this.each(function(){var t=w(this),n=t.contents();n.length?n.wrapAll(e):t.append(e)})},wrap:function(e){var t=w.isFunction(e);return this.each(function(n){w(this).wrapAll(t?e.call(this,n):e)})},unwrap:function(){return this.parent().each(function(){w.nodeName(this,"body")||w(this).replaceWith(this.childNodes)}).end()}});var It,qt,Rt,Ut=/alpha\([^)]*\)/i,zt=/opacity\s*=\s*([^)]*)/,Wt=/^(top|right|bottom|left)$/,Xt=/^(none|table(?!-c[ea]).+)/,Vt=/^margin/,$t=RegExp("^("+E+")(.*)$","i"),Jt=RegExp("^("+E+")(?!px)[a-z%]+$","i"),Kt=RegExp("^([+-])=("+E+")","i"),Qt={BODY:"block"},Gt={position:"absolute",visibility:"hidden",display:"block"},Yt={letterSpacing:0,fontWeight:400},Zt=["Top","Right","Bottom","Left"],en=["Webkit","O","Moz","ms"];w.fn.extend({css:function(e,n){return w.access(this,function(e,n,r){var i,s,o={},u=0;if(w.isArray(n)){for(s=qt(e),i=n.length;i>u;u++)o[n[u]]=w.css(e,n[u],!1,s);return o}return r!==t?w.style(e,n,r):w.css(e,n)},e,n,arguments.length>1)},show:function(){return rn(this,!0)},hide:function(){return rn(this)},toggle:function(e){return"boolean"==typeof e?e?this.show():this.hide():this.each(function(){nn(this)?w(this).show():w(this).hide()})}}),w.extend({cssHooks:{opacity:{get:function(e,t){if(t){var n=Rt(e,"opacity");return""===n?"1":n}}}},cssNumber:{columnCount:!0,fillOpacity:!0,fontWeight:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,widows:!0,zIndex:!0,zoom:!0},cssProps:{"float":w.support.cssFloat?"cssFloat":"styleFloat"},style:function(e,n,r,i){if(e&&3!==e.nodeType&&8!==e.nodeType&&e.style){var s,o,u,a=w.camelCase(n),f=e.style;if(n=w.cssProps[a]||(w.cssProps[a]=tn(f,a)),u=w.cssHooks[n]||w.cssHooks[a],r===t)return u&&"get"in u&&(s=u.get(e,!1,i))!==t?s:f[n];if(o=typeof r,"string"===o&&(s=Kt.exec(r))&&(r=(s[1]+1)*s[2]+parseFloat(w.css(e,n)),o="number"),!(null==r||"number"===o&&isNaN(r)||("number"!==o||w.cssNumber[a]||(r+="px"),w.support.clearCloneStyle||""!==r||0!==n.indexOf("background")||(f[n]="inherit"),u&&"set"in u&&(r=u.set(e,r,i))===t)))try{f[n]=r}catch(l){}}},css:function(e,n,r,i){var s,o,u,a=w.camelCase(n);return n=w.cssProps[a]||(w.cssProps[a]=tn(e.style,a)),u=w.cssHooks[n]||w.cssHooks[a],u&&"get"in u&&(o=u.get(e,!0,r)),o===t&&(o=Rt(e,n,i)),"normal"===o&&n in Yt&&(o=Yt[n]),""===r||r?(s=parseFloat(o),r===!0||w.isNumeric(s)?s||0:o):o}}),e.getComputedStyle?(qt=function(t){return e.getComputedStyle(t,null)},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u.getPropertyValue(n)||u[n]:t,f=e.style;return u&&(""!==a||w.contains(e.ownerDocument,e)||(a=w.style(e,n)),Jt.test(a)&&Vt.test(n)&&(i=f.width,s=f.minWidth,o=f.maxWidth,f.minWidth=f.maxWidth=f.width=a,a=u.width,f.width=i,f.minWidth=s,f.maxWidth=o)),a}):o.documentElement.currentStyle&&(qt=function(e){return e.currentStyle},Rt=function(e,n,r){var i,s,o,u=r||qt(e),a=u?u[n]:t,f=e.style;return null==a&&f&&f[n]&&(a=f[n]),Jt.test(a)&&!Wt.test(n)&&(i=f.left,s=e.runtimeStyle,o=s&&s.left,o&&(s.left=e.currentStyle.left),f.left="fontSize"===n?"1em":a,a=f.pixelLeft+"px",f.left=i,o&&(s.left=o)),""===a?"auto":a}),w.each(["height","width"],function(e,n){w.cssHooks[n]={get:function(e,r,i){return r?0===e.offsetWidth&&Xt.test(w.css(e,"display"))?w.swap(e,Gt,function(){return un(e,n,i)}):un(e,n,i):t},set:function(e,t,r){var i=r&&qt(e);return sn(e,t,r?on(e,n,r,w.support.boxSizing&&"border-box"===w.css(e,"boxSizing",!1,i),i):0)}}}),w.support.opacity||(w.cssHooks.opacity={get:function(e,t){return zt.test((t&&e.currentStyle?e.currentStyle.filter:e.style.filter)||"")?.01*parseFloat(RegExp.$1)+"":t?"1":""},set:function(e,t){var n=e.style,r=e.currentStyle,i=w.isNumeric(t)?"alpha(opacity="+100*t+")":"",s=r&&r.filter||n.filter||"";n.zoom=1,(t>=1||""===t)&&""===w.trim(s.replace(Ut,""))&&n.removeAttribute&&(n.removeAttribute("filter"),""===t||r&&!r.filter)||(n.filter=Ut.test(s)?s.replace(Ut,i):s+" "+i)}}),w(function(){w.support.reliableMarginRight||(w.cssHooks.marginRight={get:function(e,n){return n?w.swap(e,{display:"inline-block"},Rt,[e,"marginRight"]):t}}),!w.support.pixelPosition&&w.fn.position&&w.each(["top","left"],function(e,n){w.cssHooks[n]={get:function(e,r){return r?(r=Rt(e,n),Jt.test(r)?w(e).position()[n]+"px":r):t}}})}),w.expr&&w.expr.filters&&(w.expr.filters.hidden=function(e){return 0>=e.offsetWidth&&0>=e.offsetHeight||!w.support.reliableHiddenOffsets&&"none"===(e.style&&e.style.display||w.css(e,"display"))},w.expr.filters.visible=function(e){return!w.expr.filters.hidden(e)}),w.each({margin:"",padding:"",border:"Width"},function(e,t){w.cssHooks[e+t]={expand:function(n){var r=0,i={},s="string"==typeof n?n.split(" "):[n];for(;4>r;r++)i[e+Zt[r]+t]=s[r]||s[r-2]||s[0];return i}},Vt.test(e)||(w.cssHooks[e+t].set=sn)});var ln=/%20/g,cn=/\[\]$/,hn=/\r?\n/g,pn=/^(?:submit|button|image|reset|file)$/i,dn=/^(?:input|select|textarea|keygen)/i;w.fn.extend({serialize:function(){return w.param(this.serializeArray())},serializeArray:function(){return this.map(function(){var e=w.prop(this,"elements");return e?w.makeArray(e):this}).filter(function(){var e=this.type;return this.name&&!w(this).is(":disabled")&&dn.test(this.nodeName)&&!pn.test(e)&&(this.checked||!xt.test(e))}).map(function(e,t){var n=w(this).val();return null==n?null:w.isArray(n)?w.map(n,function(e){return{name:t.name,value:e.replace(hn,"\r\n")}}):{name:t.name,value:n.replace(hn,"\r\n")}}).get()}}),w.param=function(e,n){var r,i=[],s=function(e,t){t=w.isFunction(t)?t():null==t?"":t,i[i.length]=encodeURIComponent(e)+"="+encodeURIComponent(t)};if(n===t&&(n=w.ajaxSettings&&w.ajaxSettings.traditional),w.isArray(e)||e.jquery&&!w.isPlainObject(e))w.each(e,function(){s(this.name,this.value)});else for(r in e)vn(r,e[r],n,s);return i.join("&").replace(ln,"+")},w.each("blur focus focusin focusout load resize scroll unload click dblclick mousedown mouseup mousemove mouseover mouseout mouseenter mouseleave change select submit keydown keypress keyup error contextmenu".split(" "),function(e,t){w.fn[t]=function(e,n){return arguments.length>0?this.on(t,null,e,n):this.trigger(t)}}),w.fn.extend({hover:function(e,t){return this.mouseenter(e).mouseleave(t||e)},bind:function(e,t,n){return this.on(e,null,t,n)},unbind:function(e,t){return this.off(e,null,t)},delegate:function(e,t,n,r){return this.on(t,e,n,r)},undelegate:function(e,t,n){return 1===arguments.length?this.off(e,"**"):this.off(t,e||"**",n)}});var mn,gn,yn=w.now(),bn=/\?/,wn=/#.*$/,En=/([?&])_=[^&]*/,Sn=/^(.*?):[ \t]*([^\r\n]*)\r?$/gm,xn=/^(?:about|app|app-storage|.+-extension|file|res|widget):$/,Tn=/^(?:GET|HEAD)$/,Nn=/^\/\//,Cn=/^([\w.+-]+:)(?:\/\/([^\/?#:]*)(?::(\d+)|)|)/,kn=w.fn.load,Ln={},An={},On="*/".concat("*");try{gn=s.href}catch(Mn){gn=o.createElement("a"),gn.href="",gn=gn.href}mn=Cn.exec(gn.toLowerCase())||[],w.fn.load=function(e,n,r){if("string"!=typeof e&&kn)return kn.apply(this,arguments);var i,s,o,u=this,a=e.indexOf(" ");return a>=0&&(i=e.slice(a,e.length),e=e.slice(0,a)),w.isFunction(n)?(r=n,n=t):n&&"object"==typeof n&&(o="POST"),u.length>0&&w.ajax({url:e,type:o,dataType:"html",data:n}).done(function(e){s=arguments,u.html(i?w("<div>").append(w.parseHTML(e)).find(i):e)}).complete(r&&function(e,t){u.each(r,s||[e.responseText,t,e])}),this},w.each(["ajaxStart","ajaxStop","ajaxComplete","ajaxError","ajaxSuccess","ajaxSend"],function(e,t){w.fn[t]=function(e){return this.on(t,e)}}),w.extend({active:0,lastModified:{},etag:{},ajaxSettings:{url:gn,type:"GET",isLocal:xn.test(mn[1]),global:!0,processData:!0,async:!0,contentType:"application/x-www-form-urlencoded; charset=UTF-8",accepts:{"*":On,text:"text/plain",html:"text/html",xml:"application/xml, text/xml",json:"application/json, text/javascript"},contents:{xml:/xml/,html:/html/,json:/json/},responseFields:{xml:"responseXML",text:"responseText",json:"responseJSON"},converters:{"* text":String,"text html":!0,"text json":w.parseJSON,"text xml":w.parseXML},flatOptions:{url:!0,context:!0}},ajaxSetup:function(e,t){return t?Pn(Pn(e,w.ajaxSettings),t):Pn(w.ajaxSettings,e)},ajaxPrefilter:_n(Ln),ajaxTransport:_n(An),ajax:function(e,n){function N(e,n,r,i){var l,g,y,E,S,T=n;2!==b&&(b=2,u&&clearTimeout(u),f=t,o=i||"",x.readyState=e>0?4:0,l=e>=200&&300>e||304===e,r&&(E=Hn(c,x,r)),E=Bn(c,E,x,l),l?(c.ifModified&&(S=x.getResponseHeader("Last-Modified"),S&&(w.lastModified[s]=S),S=x.getResponseHeader("etag"),S&&(w.etag[s]=S)),204===e||"HEAD"===c.type?T="nocontent":304===e?T="notmodified":(T=E.state,g=E.data,y=E.error,l=!y)):(y=T,(e||!T)&&(T="error",0>e&&(e=0))),x.status=e,x.statusText=(n||T)+"",l?d.resolveWith(h,[g,T,x]):d.rejectWith(h,[x,T,y]),x.statusCode(m),m=t,a&&p.trigger(l?"ajaxSuccess":"ajaxError",[x,c,l?g:y]),v.fireWith(h,[x,T]),a&&(p.trigger("ajaxComplete",[x,c]),--w.active||w.event.trigger("ajaxStop")))}"object"==typeof e&&(n=e,e=t),n=n||{};var r,i,s,o,u,a,f,l,c=w.ajaxSetup({},n),h=c.context||c,p=c.context&&(h.nodeType||h.jquery)?w(h):w.event,d=w.Deferred(),v=w.Callbacks("once memory"),m=c.statusCode||{},g={},y={},b=0,E="canceled",x={readyState:0,getResponseHeader:function(e){var t;if(2===b){if(!l){l={};while(t=Sn.exec(o))l[t[1].toLowerCase()]=t[2]}t=l[e.toLowerCase()]}return null==t?null:t},getAllResponseHeaders:function(){return 2===b?o:null},setRequestHeader:function(e,t){var n=e.toLowerCase();return b||(e=y[n]=y[n]||e,g[e]=t),this},overrideMimeType:function(e){return b||(c.mimeType=e),this},statusCode:function(e){var t;if(e)if(2>b)for(t in e)m[t]=[m[t],e[t]];else x.always(e[x.status]);return this},abort:function(e){var t=e||E;return f&&f.abort(t),N(0,t),this}};if(d.promise(x).complete=v.add,x.success=x.done,x.error=x.fail,c.url=((e||c.url||gn)+"").replace(wn,"").replace(Nn,mn[1]+"//"),c.type=n.method||n.type||c.method||c.type,c.dataTypes=w.trim(c.dataType||"*").toLowerCase().match(S)||[""],null==c.crossDomain&&(r=Cn.exec(c.url.toLowerCase()),c.crossDomain=!(!r||r[1]===mn[1]&&r[2]===mn[2]&&(r[3]||("http:"===r[1]?"80":"443"))===(mn[3]||("http:"===mn[1]?"80":"443")))),c.data&&c.processData&&"string"!=typeof c.data&&(c.data=w.param(c.data,c.traditional)),Dn(Ln,c,n,x),2===b)return x;a=c.global,a&&0===w.active++&&w.event.trigger("ajaxStart"),c.type=c.type.toUpperCase(),c.hasContent=!Tn.test(c.type),s=c.url,c.hasContent||(c.data&&(s=c.url+=(bn.test(s)?"&":"?")+c.data,delete c.data),c.cache===!1&&(c.url=En.test(s)?s.replace(En,"$1_="+yn++):s+(bn.test(s)?"&":"?")+"_="+yn++)),c.ifModified&&(w.lastModified[s]&&x.setRequestHeader("If-Modified-Since",w.lastModified[s]),w.etag[s]&&x.setRequestHeader("If-None-Match",w.etag[s])),(c.data&&c.hasContent&&c.contentType!==!1||n.contentType)&&x.setRequestHeader("Content-Type",c.contentType),x.setRequestHeader("Accept",c.dataTypes[0]&&c.accepts[c.dataTypes[0]]?c.accepts[c.dataTypes[0]]+("*"!==c.dataTypes[0]?", "+On+"; q=0.01":""):c.accepts["*"]);for(i in c.headers)x.setRequestHeader(i,c.headers[i]);if(!c.beforeSend||c.beforeSend.call(h,x,c)!==!1&&2!==b){E="abort";for(i in{success:1,error:1,complete:1})x[i](c[i]);if(f=Dn(An,c,n,x)){x.readyState=1,a&&p.trigger("ajaxSend",[x,c]),c.async&&c.timeout>0&&(u=setTimeout(function(){x.abort("timeout")},c.timeout));try{b=1,f.send(g,N)}catch(T){if(!(2>b))throw T;N(-1,T)}}else N(-1,"No Transport");return x}return x.abort()},getJSON:function(e,t,n){return w.get(e,t,n,"json")},getScript:function(e,n){return w.get(e,t,n,"script")}}),w.each(["get","post"],function(e,n){w[n]=function(e,r,i,s){return w.isFunction(r)&&(s=s||i,i=r,r=t),w.ajax({url:e,type:n,dataType:s,data:r,success:i})}}),w.ajaxSetup({accepts:{script:"text/javascript, application/javascript, application/ecmascript, application/x-ecmascript"},contents:{script:/(?:java|ecma)script/},converters:{"text script":function(e){return w.globalEval(e),e}}}),w.ajaxPrefilter("script",function(e){e.cache===t&&(e.cache=!1),e.crossDomain&&(e.type="GET",e.global=!1)}),w.ajaxTransport("script",function(e){if(e.crossDomain){var n,r=o.head||w("head")[0]||o.documentElement;return{send:function(t,i){n=o.createElement("script"),n.async=!0,e.scriptCharset&&(n.charset=e.scriptCharset),n.src=e.url,n.onload=n.onreadystatechange=function(e,t){(t||!n.readyState||/loaded|complete/.test(n.readyState))&&(n.onload=n.onreadystatechange=null,n.parentNode&&n.parentNode.removeChild(n),n=null,t||i(200,"success"))},r.insertBefore(n,r.firstChild)},abort:function(){n&&n.onload(t,!0)}}}});var jn=[],Fn=/(=)\?(?=&|$)|\?\?/;w.ajaxSetup({jsonp:"callback",jsonpCallback:function(){var e=jn.pop()||w.expando+"_"+yn++;return this[e]=!0,e}}),w.ajaxPrefilter("json jsonp",function(n,r,i){var s,o,u,a=n.jsonp!==!1&&(Fn.test(n.url)?"url":"string"==typeof n.data&&!(n.contentType||"").indexOf("application/x-www-form-urlencoded")&&Fn.test(n.data)&&"data");return a||"jsonp"===n.dataTypes[0]?(s=n.jsonpCallback=w.isFunction(n.jsonpCallback)?n.jsonpCallback():n.jsonpCallback,a?n[a]=n[a].replace(Fn,"$1"+s):n.jsonp!==!1&&(n.url+=(bn.test(n.url)?"&":"?")+n.jsonp+"="+s),n.converters["script json"]=function(){return u||w.error(s+" was not called"),u[0]},n.dataTypes[0]="json",o=e[s],e[s]=function(){u=arguments},i.always(function(){e[s]=o,n[s]&&(n.jsonpCallback=r.jsonpCallback,jn.push(s)),u&&w.isFunction(o)&&o(u[0]),u=o=t}),"script"):t});var In,qn,Rn=0,Un=e.ActiveXObject&&function(){var e;for(e in In)In[e](t,!0)};w.ajaxSettings.xhr=e.ActiveXObject?function(){return!this.isLocal&&zn()||Wn()}:zn,qn=w.ajaxSettings.xhr(),w.support.cors=!!qn&&"withCredentials"in qn,qn=w.support.ajax=!!qn,qn&&w.ajaxTransport(function(n){if(!n.crossDomain||w.support.cors){var r;return{send:function(i,s){var o,u,a=n.xhr();if(n.username?a.open(n.type,n.url,n.async,n.username,n.password):a.open(n.type,n.url,n.async),n.xhrFields)for(u in n.xhrFields)a[u]=n.xhrFields[u];n.mimeType&&a.overrideMimeType&&a.overrideMimeType(n.mimeType),n.crossDomain||i["X-Requested-With"]||(i["X-Requested-With"]="XMLHttpRequest");try{for(u in i)a.setRequestHeader(u,i[u])}catch(f){}a.send(n.hasContent&&n.data||null),r=function(e,i){var u,f,l,c;try{if(r&&(i||4===a.readyState))if(r=t,o&&(a.onreadystatechange=w.noop,Un&&delete In[o]),i)4!==a.readyState&&a.abort();else{c={},u=a.status,f=a.getAllResponseHeaders(),"string"==typeof a.responseText&&(c.text=a.responseText);try{l=a.statusText}catch(h){l=""}u||!n.isLocal||n.crossDomain?1223===u&&(u=204):u=c.text?200:404}}catch(p){i||s(-1,p)}c&&s(u,l,c,f)},n.async?4===a.readyState?setTimeout(r):(o=++Rn,Un&&(In||(In={},w(e).unload(Un)),In[o]=r),a.onreadystatechange=r):r()},abort:function(){r&&r(t,!0)}}}});var Xn,Vn,$n=/^(?:toggle|show|hide)$/,Jn=RegExp("^(?:([+-])=|)("+E+")([a-z%]*)$","i"),Kn=/queueHooks$/,Qn=[nr],Gn={"*":[function(e,t){var n=this.createTween(e,t),r=n.cur(),i=Jn.exec(t),s=i&&i[3]||(w.cssNumber[e]?"":"px"),o=(w.cssNumber[e]||"px"!==s&&+r)&&Jn.exec(w.css(n.elem,e)),u=1,a=20;if(o&&o[3]!==s){s=s||o[3],i=i||[],o=+r||1;do u=u||".5",o/=u,w.style(n.elem,e,o+s);while(u!==(u=n.cur()/r)&&1!==u&&--a)}return i&&(o=n.start=+o||+r||0,n.unit=s,n.end=i[1]?o+(i[1]+1)*i[2]:+i[2]),n}]};w.Animation=w.extend(er,{tweener:function(e,t){w.isFunction(e)?(t=e,e=["*"]):e=e.split(" ");var n,r=0,i=e.length;for(;i>r;r++)n=e[r],Gn[n]=Gn[n]||[],Gn[n].unshift(t)},prefilter:function(e,t){t?Qn.unshift(e):Qn.push(e)}}),w.Tween=rr,rr.prototype={constructor:rr,init:function(e,t,n,r,i,s){this.elem=e,this.prop=n,this.easing=i||"swing",this.options=t,this.start=this.now=this.cur(),this.end=r,this.unit=s||(w.cssNumber[n]?"":"px")},cur:function(){var e=rr.propHooks[this.prop];return e&&e.get?e.get(this):rr.propHooks._default.get(this)},run:function(e){var t,n=rr.propHooks[this.prop];return this.pos=t=this.options.duration?w.easing[this.easing](e,this.options.duration*e,0,1,this.options.duration):e,this.now=(this.end-this.start)*t+this.start,this.options.step&&this.options.step.call(this.elem,this.now,this),n&&n.set?n.set(this):rr.propHooks._default.set(this),this}},rr.prototype.init.prototype=rr.prototype,rr.propHooks={_default:{get:function(e){var t;return null==e.elem[e.prop]||e.elem.style&&null!=e.elem.style[e.prop]?(t=w.css(e.elem,e.prop,""),t&&"auto"!==t?t:0):e.elem[e.prop]},set:function(e){w.fx.step[e.prop]?w.fx.step[e.prop](e):e.elem.style&&(null!=e.elem.style[w.cssProps[e.prop]]||w.cssHooks[e.prop])?w.style(e.elem,e.prop,e.now+e.unit):e.elem[e.prop]=e.now}}},rr.propHooks.scrollTop=rr.propHooks.scrollLeft={set:function(e){e.elem.nodeType&&e.elem.parentNode&&(e.elem[e.prop]=e.now)}},w.each(["toggle","show","hide"],function(e,t){var n=w.fn[t];w.fn[t]=function(e,r,i){return null==e||"boolean"==typeof e?n.apply(this,arguments):this.animate(ir(t,!0),e,r,i)}}),w.fn.extend({fadeTo:function(e,t,n,r){return this.filter(nn).css("opacity",0).show().end().animate({opacity:t},e,n,r)},animate:function(e,t,n,r){var i=w.isEmptyObject(e),s=w.speed(t,n,r),o=function(){var t=er(this,w.extend({},e),s);(i||w._data(this,"finish"))&&t.stop(!0)};return o.finish=o,i||s.queue===!1?this.each(o):this.queue(s.queue,o)},stop:function(e,n,r){var i=function(e){var t=e.stop;delete e.stop,t(r)};return"string"!=typeof e&&(r=n,n=e,e=t),n&&e!==!1&&this.queue(e||"fx",[]),this.each(function(){var t=!0,n=null!=e&&e+"queueHooks",s=w.timers,o=w._data(this);if(n)o[n]&&o[n].stop&&i(o[n]);else for(n in o)o[n]&&o[n].stop&&Kn.test(n)&&i(o[n]);for(n=s.length;n--;)s[n].elem!==this||null!=e&&s[n].queue!==e||(s[n].anim.stop(r),t=!1,s.splice(n,1));(t||!r)&&w.dequeue(this,e)})},finish:function(e){return e!==!1&&(e=e||"fx"),this.each(function(){var t,n=w._data(this),r=n[e+"queue"],i=n[e+"queueHooks"],s=w.timers,o=r?r.length:0;for(n.finish=!0,w.queue(this,e,[]),i&&i.stop&&i.stop.call(this,!0),t=s.length;t--;)s[t].elem===this&&s[t].queue===e&&(s[t].anim.stop(!0),s.splice(t,1));for(t=0;o>t;t++)r[t]&&r[t].finish&&r[t].finish.call(this);delete n.finish})}}),w.each({slideDown:ir("show"),slideUp:ir("hide"),slideToggle:ir("toggle"),fadeIn:{opacity:"show"},fadeOut:{opacity:"hide"},fadeToggle:{opacity:"toggle"}},function(e,t){w.fn[e]=function(e,n,r){return this.animate(t,e,n,r)}}),w.speed=function(e,t,n){var r=e&&"object"==typeof e?w.extend({},e):{complete:n||!n&&t||w.isFunction(e)&&e,duration:e,easing:n&&t||t&&!w.isFunction(t)&&t};return r.duration=w.fx.off?0:"number"==typeof r.duration?r.duration:r.duration in w.fx.speeds?w.fx.speeds[r.duration]:w.fx.speeds._default,(null==r.queue||r.queue===!0)&&(r.queue="fx"),r.old=r.complete,r.complete=function(){w.isFunction(r.old)&&r.old.call(this),r.queue&&w.dequeue(this,r.queue)},r},w.easing={linear:function(e){return e},swing:function(e){return.5-Math.cos(e*Math.PI)/2}},w.timers=[],w.fx=rr.prototype.init,w.fx.tick=function(){var e,n=w.timers,r=0;for(Xn=w.now();n.length>r;r++)e=n[r],e()||n[r]!==e||n.splice(r--,1);n.length||w.fx.stop(),Xn=t},w.fx.timer=function(e){e()&&w.timers.push(e)&&w.fx.start()},w.fx.interval=13,w.fx.start=function(){Vn||(Vn=setInterval(w.fx.tick,w.fx.interval))},w.fx.stop=function(){clearInterval(Vn),Vn=null},w.fx.speeds={slow:600,fast:200,_default:400},w.fx.step={},w.expr&&w.expr.filters&&(w.expr.filters.animated=function(e){return w.grep(w.timers,function(t){return e===t.elem}).length}),w.fn.offset=function(e){if(arguments.length)return e===t?this:this.each(function(t){w.offset.setOffset(this,e,t)});var n,r,s={top:0,left:0},o=this[0],u=o&&o.ownerDocument;if(u)return n=u.documentElement,w.contains(n,o)?(typeof o.getBoundingClientRect!==i&&(s=o.getBoundingClientRect()),r=sr(u),{top:s.top+(r.pageYOffset||n.scrollTop)-(n.clientTop||0),left:s.left+(r.pageXOffset||n.scrollLeft)-(n.clientLeft||0)}):s},w.offset={setOffset:function(e,t,n){var r=w.css(e,"position");"static"===r&&(e.style.position="relative");var i=w(e),s=i.offset(),o=w.css(e,"top"),u=w.css(e,"left"),a=("absolute"===r||"fixed"===r)&&w.inArray("auto",[o,u])>-1,f={},l={},c,h;a?(l=i.position(),c=l.top,h=l.left):(c=parseFloat(o)||0,h=parseFloat(u)||0),w.isFunction(t)&&(t=t.call(e,n,s)),null!=t.top&&(f.top=t.top-s.top+c),null!=t.left&&(f.left=t.left-s.left+h),"using"in t?t.using.call(e,f):i.css(f)}},w.fn.extend({position:function(){if(this[0]){var e,t,n={top:0,left:0},r=this[0];return"fixed"===w.css(r,"position")?t=r.getBoundingClientRect():(e=this.offsetParent(),t=this.offset(),w.nodeName(e[0],"html")||(n=e.offset()),n.top+=w.css(e[0],"borderTopWidth",!0),n.left+=w.css(e[0],"borderLeftWidth",!0)),{top:t.top-n.top-w.css(r,"marginTop",!0),left:t.left-n.left-w.css(r,"marginLeft",!0)}}},offsetParent:function(){return this.map(function(){var e=this.offsetParent||u;while(e&&!w.nodeName(e,"html")&&"static"===w.css(e,"position"))e=e.offsetParent;return e||u})}}),w.each({scrollLeft:"pageXOffset",scrollTop:"pageYOffset"},function(e,n){var r=/Y/.test(n);w.fn[e]=function(i){return w.access(this,function(e,i,s){var o=sr(e);return s===t?o?n in o?o[n]:o.document.documentElement[i]:e[i]:(o?o.scrollTo(r?w(o).scrollLeft():s,r?s:w(o).scrollTop()):e[i]=s,t)},e,i,arguments.length,null)}}),w.each({Height:"height",Width:"width"},function(e,n){w.each({padding:"inner"+e,content:n,"":"outer"+e},function(r,i){w.fn[i]=function(i,s){var o=arguments.length&&(r||"boolean"!=typeof i),u=r||(i===!0||s===!0?"margin":"border");return w.access(this,function(n,r,i){var s;return w.isWindow(n)?n.document.documentElement["client"+e]:9===n.nodeType?(s=n.documentElement,Math.max(n.body["scroll"+e],s["scroll"+e],n.body["offset"+e],s["offset"+e],s["client"+e])):i===t?w.css(n,r,u):w.style(n,r,i,u)},n,o?i:t,o,null)}})}),w.fn.size=function(){return this.length},w.fn.andSelf=w.fn.addBack,"object"==typeof module&&module&&"object"==typeof module.exports?module.exports=w:(e.jQuery=e.$=w,"function"==typeof define&&define.amd&&define("jquery",[],function(){return w}))}(window);var Handlebars=function(){var e=function(){"use strict";function t(e){this.string=e}var e;return t.prototype.toString=function(){return""+this.string},e=t,e}(),t=function(e){"use strict";function o(e){return r[e]||"&amp;"}function u(e,t){for(var n in t)Object.prototype.hasOwnProperty.call(t,n)&&(e[n]=t[n])}function c(e){return e instanceof n?e.toString():!e&&e!==0?"":(e=""+e,s.test(e)?e.replace(i,o):e)}function h(e){return!e&&e!==0?!0:l(e)&&e.length===0?!0:!1}var t={},n=e,r={"&":"&amp;","<":"&lt;",">":"&gt;",'"':"&quot;","'":"&#x27;","`":"&#x60;"},i=/[&<>"'`]/g,s=/[&<>"'`]/;t.extend=u;var a=Object.prototype.toString;t.toString=a;var f=function(e){return typeof e=="function"};f(/x/)&&(f=function(e){return typeof e=="function"&&a.call(e)==="[object Function]"});var f;t.isFunction=f;var l=Array.isArray||function(e){return e&&typeof e=="object"?a.call(e)==="[object Array]":!1};return t.isArray=l,t.escapeExpression=c,t.isEmpty=h,t}(e),n=function(){"use strict";function n(e,n){var r;n&&n.firstLine&&(r=n.firstLine,e+=" - "+r+":"+n.firstColumn);var i=Error.prototype.constructor.call(this,e);for(var s=0;s<t.length;s++)this[t[s]]=i[t[s]];r&&(this.lineNumber=r,this.column=n.firstColumn)}var e,t=["description","fileName","lineNumber","message","name","number","stack"];return n.prototype=new Error,e=n,e}(),r=function(e,t){"use strict";function h(e,t){this.helpers=e||{},this.partials=t||{},p(this)}function p(e){e.registerHelper("helperMissing",function(e){if(arguments.length===2)return undefined;throw new i("Missing helper: '"+e+"'")}),e.registerHelper("blockHelperMissing",function(t,n){var r=n.inverse||function(){},i=n.fn;return f(t)&&(t=t.call(this)),t===!0?i(this):t===!1||t==null?r(this):a(t)?t.length>0?e.helpers.each(t,n):r(this):i(t)}),e.registerHelper("each",function(e,t){var n=t.fn,r=t.inverse,i=0,s="",o;f(e)&&(e=e.call(this)),t.data&&(o=m(t.data));if(e&&typeof e=="object")if(a(e))for(var u=e.length;i<u;i++)o&&(o.index=i,o.first=i===0,o.last=i===e.length-1),s+=n(e[i],{data:o});else for(var l in e)e.hasOwnProperty(l)&&(o&&(o.key=l,o.index=i,o.first=i===0),s+=n(e[l],{data:o}),i++);return i===0&&(s=r(this)),s}),e.registerHelper("if",function(e,t){return f(e)&&(e=e.call(this)),!t.hash.includeZero&&!e||r.isEmpty(e)?t.inverse(this):t.fn(this)}),e.registerHelper("unless",function(t,n){return e.helpers["if"].call(this,t,{fn:n.inverse,inverse:n.fn,hash:n.hash})}),e.registerHelper("with",function(e,t){f(e)&&(e=e.call(this));if(!r.isEmpty(e))return t.fn(e)}),e.registerHelper("log",function(t,n){var r=n.data&&n.data.level!=null?parseInt(n.data.level,10):1;e.log(r,t)})}function v(e,t){d.log(e,t)}var n={},r=e,i=t,s="1.3.0";n.VERSION=s;var o=4;n.COMPILER_REVISION=o;var u={1:"<= 1.0.rc.2",2:"== 1.0.0-rc.3",3:"== 1.0.0-rc.4",4:">= 1.0.0"};n.REVISION_CHANGES=u;var a=r.isArray,f=r.isFunction,l=r.toString,c="[object Object]";n.HandlebarsEnvironment=h,h.prototype={constructor:h,logger:d,log:v,registerHelper:function(e,t,n){if(l.call(e)===c){if(n||t)throw new i("Arg not supported with multiple helpers");r.extend(this.helpers,e)}else n&&(t.not=n),this.helpers[e]=t},registerPartial:function(e,t){l.call(e)===c?r.extend(this.partials,e):this.partials[e]=t}};var d={methodMap:{0:"debug",1:"info",2:"warn",3:"error"},DEBUG:0,INFO:1,WARN:2,ERROR:3,level:3,log:function(e,t){if(d.level<=e){var n=d.methodMap[e];typeof console!="undefined"&&console[n]&&console[n].call(console,t)}}};n.logger=d,n.log=v;var m=function(e){var t={};return r.extend(t,e),t};return n.createFrame=m,n}(t,n),i=function(e,t,n){"use strict";function a(e){var t=e&&e[0]||1,n=o;if(t!==n){if(t<n){var r=u[n],i=u[t];throw new s("Template was precompiled with an older version of Handlebars than the current runtime. Please update your precompiler to a newer version ("+r+") or downgrade your runtime to an older version ("+i+").")}throw new s("Template was precompiled with a newer version of Handlebars than the current runtime. Please update your runtime to a newer version ("+e[1]+").")}}function f(e,t){if(!t)throw new s("No environment passed to template");var n=function(e,n,r,i,o,u){var a=t.VM.invokePartial.apply(this,arguments);if(a!=null)return a;if(t.compile){var f={helpers:i,partials:o,data:u};return o[n]=t.compile(e,{data:u!==undefined},t),o[n](r,f)}throw new s("The partial "+n+" could not be compiled when running in runtime-only mode")},r={escapeExpression:i.escapeExpression,invokePartial:n,programs:[],program:function(e,t,n){var r=this.programs[e];return n?r=c(e,t,n):r||(r=this.programs[e]=c(e,t)),r},merge:function(e,t){var n=e||t;return e&&t&&e!==t&&(n={},i.extend(n,t),i.extend(n,e)),n},programWithDepth:t.VM.programWithDepth,noop:t.VM.noop,compilerInfo:null};return function(n,i){i=i||{};var s=i.partial?i:t,o,u;i.partial||(o=i.helpers,u=i.partials);var a=e.call(r,s,n,o,u,i.data);return i.partial||t.VM.checkRevision(r.compilerInfo),a}}function l(e,t,n){var r=Array.prototype.slice.call(arguments,3),i=function(e,i){return i=i||{},t.apply(this,[e,i.data||n].concat(r))};return i.program=e,i.depth=r.length,i}function c(e,t,n){var r=function(e,r){return r=r||{},t(e,r.data||n)};return r.program=e,r.depth=0,r}function h(e,t,n,r,i,o){var u={partial:!0,helpers:r,partials:i,data:o};if(e===undefined)throw new s("The partial "+t+" could not be found");if(e instanceof Function)return e(n,u)}function p(){return""}var r={},i=e,s=t,o=n.COMPILER_REVISION,u=n.REVISION_CHANGES;return r.checkRevision=a,r.template=f,r.programWithDepth=l,r.program=c,r.invokePartial=h,r.noop=p,r}(t,n,r),s=function(e,t,n,r,i){"use strict";var s,o=e,u=t,a=n,f=r,l=i,c=function(){var e=new o.HandlebarsEnvironment;return f.extend(e,o),e.SafeString=u,e.Exception=a,e.Utils=f,e.VM=l,e.template=function(t){return l.template(t,e)},e},h=c();return h.create=c,s=h,s}(r,e,n,t,i),o=function(e){"use strict";function r(e){e=e||{},this.firstLine=e.first_line,this.firstColumn=e.first_column,this.lastColumn=e.last_column,this.lastLine=e.last_line}var t,n=e,i={ProgramNode:function(e,t,n,s){var o,u;arguments.length===3?(s=n,n=null):arguments.length===2&&(s=t,t=null),r.call(this,s),this.type="program",this.statements=e,this.strip={},n?(u=n[0],u?(o={first_line:u.firstLine,last_line:u.lastLine,last_column:u.lastColumn,first_column:u.firstColumn},this.inverse=new i.ProgramNode(n,t,o)):this.inverse=new i.ProgramNode(n,t),this.strip.right=t.left):t&&(this.strip.left=t.right)},MustacheNode:function(e,t,n,s,o){r.call(this,o),this.type="mustache",this.strip=s;if(n!=null&&n.charAt){var u=n.charAt(3)||n.charAt(2);this.escaped=u!=="{"&&u!=="&"}else this.escaped=!!n;e instanceof i.SexprNode?this.sexpr=e:this.sexpr=new i.SexprNode(e,t),this.sexpr.isRoot=!0,this.id=this.sexpr.id,this.params=this.sexpr.params,this.hash=this.sexpr.hash,this.eligibleHelper=this.sexpr.eligibleHelper,this.isHelper=this.sexpr.isHelper},SexprNode:function(e,t,n){r.call(this,n),this.type="sexpr",this.hash=t;var i=this.id=e[0],s=this.params=e.slice(1),o=this.eligibleHelper=i.isSimple;this.isHelper=o&&(s.length||t)},PartialNode:function(e,t,n,i){r.call(this,i),this.type="partial",this.partialName=e,this.context=t,this.strip=n},BlockNode:function(e,t,i,s,o){r.call(this,o);if(e.sexpr.id.original!==s.path.original)throw new n(e.sexpr.id.original+" doesn't match "+s.path.original,this);this.type="block",this.mustache=e,this.program=t,this.inverse=i,this.strip={left:e.strip.left,right:s.strip.right},(t||i).strip.left=e.strip.right,(i||t).strip.right=s.strip.left,i&&!t&&(this.isInverse=!0)},ContentNode:function(e,t){r.call(this,t),this.type="content",this.string=e},HashNode:function(e,t){r.call(this,t),this.type="hash",this.pairs=e},IdNode:function(e,t){r.call(this,t),this.type="ID";var i="",s=[],o=0;for(var u=0,a=e.length;u<a;u++){var f=e[u].part;i+=(e[u].separator||"")+f;if(f===".."||f==="."||f==="this"){if(s.length>0)throw new n("Invalid path: "+i,this);f===".."?o++:this.isScoped=!0}else s.push(f)}this.original=i,this.parts=s,this.string=s.join("."),this.depth=o,this.isSimple=e.length===1&&!this.isScoped&&o===0,this.stringModeValue=this.string},PartialNameNode:function(e,t){r.call(this,t),this.type="PARTIAL_NAME",this.name=e.original},DataNode:function(e,t){r.call(this,t),this.type="DATA",this.id=e},StringNode:function(e,t){r.call(this,t),this.type="STRING",this.original=this.string=this.stringModeValue=e},IntegerNode:function(e,t){r.call(this,t),this.type="INTEGER",this.original=this.integer=e,this.stringModeValue=Number(e)},BooleanNode:function(e,t){r.call(this,t),this.type="BOOLEAN",this.bool=e,this.stringModeValue=e==="true"},CommentNode:function(e,t){r.call(this,t),this.type="comment",this.comment=e}};return t=i,t}(n),u=function(){"use strict";var e,t=function(){function t(e,t){return{left:e.charAt(2)==="~",right:t.charAt(0)==="~"||t.charAt(1)==="~"}}function r(){this.yy={}}var e={trace:function(){},yy:{},symbols_:{error:2,root:3,statements:4,EOF:5,program:6,simpleInverse:7,statement:8,openInverse:9,closeBlock:10,openBlock:11,mustache:12,partial:13,CONTENT:14,COMMENT:15,OPEN_BLOCK:16,sexpr:17,CLOSE:18,OPEN_INVERSE:19,OPEN_ENDBLOCK:20,path:21,OPEN:22,OPEN_UNESCAPED:23,CLOSE_UNESCAPED:24,OPEN_PARTIAL:25,partialName:26,partial_option0:27,sexpr_repetition0:28,sexpr_option0:29,dataName:30,param:31,STRING:32,INTEGER:33,BOOLEAN:34,OPEN_SEXPR:35,CLOSE_SEXPR:36,hash:37,hash_repetition_plus0:38,hashSegment:39,ID:40,EQUALS:41,DATA:42,pathSegments:43,SEP:44,$accept:0,$end:1},terminals_:{2:"error",5:"EOF",14:"CONTENT",15:"COMMENT",16:"OPEN_BLOCK",18:"CLOSE",19:"OPEN_INVERSE",20:"OPEN_ENDBLOCK",22:"OPEN",23:"OPEN_UNESCAPED",24:"CLOSE_UNESCAPED",25:"OPEN_PARTIAL",32:"STRING",33:"INTEGER",34:"BOOLEAN",35:"OPEN_SEXPR",36:"CLOSE_SEXPR",40:"ID",41:"EQUALS",42:"DATA",44:"SEP"},productions_:[0,[3,2],[3,1],[6,2],[6,3],[6,2],[6,1],[6,1],[6,0],[4,1],[4,2],[8,3],[8,3],[8,1],[8,1],[8,1],[8,1],[11,3],[9,3],[10,3],[12,3],[12,3],[13,4],[7,2],[17,3],[17,1],[31,1],[31,1],[31,1],[31,1],[31,1],[31,3],[37,1],[39,3],[26,1],[26,1],[26,1],[30,2],[21,1],[43,3],[43,1],[27,0],[27,1],[28,0],[28,2],[29,0],[29,1],[38,1],[38,2]],performAction:function(n,r,i,s,o,u,a){var f=u.length-1;switch(o){case 1:return new s.ProgramNode(u[f-1],this._$);case 2:return new s.ProgramNode([],this._$);case 3:this.$=new s.ProgramNode([],u[f-1],u[f],this._$);break;case 4:this.$=new s.ProgramNode(u[f-2],u[f-1],u[f],this._$);break;case 5:this.$=new s.ProgramNode(u[f-1],u[f],[],this._$);break;case 6:this.$=new s.ProgramNode(u[f],this._$);break;case 7:this.$=new s.ProgramNode([],this._$);break;case 8:this.$=new s.ProgramNode([],this._$);break;case 9:this.$=[u[f]];break;case 10:u[f-1].push(u[f]),this.$=u[f-1];break;case 11:this.$=new s.BlockNode(u[f-2],u[f-1].inverse,u[f-1],u[f],this._$);break;case 12:this.$=new s.BlockNode(u[f-2],u[f-1],u[f-1].inverse,u[f],this._$);break;case 13:this.$=u[f];break;case 14:this.$=u[f];break;case 15:this.$=new s.ContentNode(u[f],this._$);break;case 16:this.$=new s.CommentNode(u[f],this._$);break;case 17:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 18:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 19:this.$={path:u[f-1],strip:t(u[f-2],u[f])};break;case 20:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 21:this.$=new s.MustacheNode(u[f-1],null,u[f-2],t(u[f-2],u[f]),this._$);break;case 22:this.$=new s.PartialNode(u[f-2],u[f-1],t(u[f-3],u[f]),this._$);break;case 23:this.$=t(u[f-1],u[f]);break;case 24:this.$=new s.SexprNode([u[f-2]].concat(u[f-1]),u[f],this._$);break;case 25:this.$=new s.SexprNode([u[f]],null,this._$);break;case 26:this.$=u[f];break;case 27:this.$=new s.StringNode(u[f],this._$);break;case 28:this.$=new s.IntegerNode(u[f],this._$);break;case 29:this.$=new s.BooleanNode(u[f],this._$);break;case 30:this.$=u[f];break;case 31:u[f-1].isHelper=!0,this.$=u[f-1];break;case 32:this.$=new s.HashNode(u[f],this._$);break;case 33:this.$=[u[f-2],u[f]];break;case 34:this.$=new s.PartialNameNode(u[f],this._$);break;case 35:this.$=new s.PartialNameNode(new s.StringNode(u[f],this._$),this._$);break;case 36:this.$=new s.PartialNameNode(new s.IntegerNode(u[f],this._$));break;case 37:this.$=new s.DataNode(u[f],this._$);break;case 38:this.$=new s.IdNode(u[f],this._$);break;case 39:u[f-2].push({part:u[f],separator:u[f-1]}),this.$=u[f-2];break;case 40:this.$=[{part:u[f]}];break;case 43:this.$=[];break;case 44:u[f-1].push(u[f]);break;case 47:this.$=[u[f]];break;case 48:u[f-1].push(u[f])}},table:[{3:1,4:2,5:[1,3],8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[3]},{5:[1,16],8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],22:[1,13],23:[1,14],25:[1,15]},{1:[2,2]},{5:[2,9],14:[2,9],15:[2,9],16:[2,9],19:[2,9],20:[2,9],22:[2,9],23:[2,9],25:[2,9]},{4:20,6:18,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{4:20,6:22,7:19,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,8],22:[1,13],23:[1,14],25:[1,15]},{5:[2,13],14:[2,13],15:[2,13],16:[2,13],19:[2,13],20:[2,13],22:[2,13],23:[2,13],25:[2,13]},{5:[2,14],14:[2,14],15:[2,14],16:[2,14],19:[2,14],20:[2,14],22:[2,14],23:[2,14],25:[2,14]},{5:[2,15],14:[2,15],15:[2,15],16:[2,15],19:[2,15],20:[2,15],22:[2,15],23:[2,15],25:[2,15]},{5:[2,16],14:[2,16],15:[2,16],16:[2,16],19:[2,16],20:[2,16],22:[2,16],23:[2,16],25:[2,16]},{17:23,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:29,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:30,21:24,30:25,40:[1,28],42:[1,27],43:26},{17:31,21:24,30:25,40:[1,28],42:[1,27],43:26},{21:33,26:32,32:[1,34],33:[1,35],40:[1,28],43:26},{1:[2,1]},{5:[2,10],14:[2,10],15:[2,10],16:[2,10],19:[2,10],20:[2,10],22:[2,10],23:[2,10],25:[2,10]},{10:36,20:[1,37]},{4:38,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,7],22:[1,13],23:[1,14],25:[1,15]},{7:39,8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,21],20:[2,6],22:[1,13],23:[1,14],25:[1,15]},{17:23,18:[1,40],21:24,30:25,40:[1,28],42:[1,27],43:26},{10:41,20:[1,37]},{18:[1,42]},{18:[2,43],24:[2,43],28:43,32:[2,43],33:[2,43],34:[2,43],35:[2,43],36:[2,43],40:[2,43],42:[2,43]},{18:[2,25],24:[2,25],36:[2,25]},{18:[2,38],24:[2,38],32:[2,38],33:[2,38],34:[2,38],35:[2,38],36:[2,38],40:[2,38],42:[2,38],44:[1,44]},{21:45,40:[1,28],43:26},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],42:[2,40],44:[2,40]},{18:[1,46]},{18:[1,47]},{24:[1,48]},{18:[2,41],21:50,27:49,40:[1,28],43:26},{18:[2,34],40:[2,34]},{18:[2,35],40:[2,35]},{18:[2,36],40:[2,36]},{5:[2,11],14:[2,11],15:[2,11],16:[2,11],19:[2,11],20:[2,11],22:[2,11],23:[2,11],25:[2,11]},{21:51,40:[1,28],43:26},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,3],22:[1,13],23:[1,14],25:[1,15]},{4:52,8:4,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,5],22:[1,13],23:[1,14],25:[1,15]},{14:[2,23],15:[2,23],16:[2,23],19:[2,23],20:[2,23],22:[2,23],23:[2,23],25:[2,23]},{5:[2,12],14:[2,12],15:[2,12],16:[2,12],19:[2,12],20:[2,12],22:[2,12],23:[2,12],25:[2,12]},{14:[2,18],15:[2,18],16:[2,18],19:[2,18],20:[2,18],22:[2,18],23:[2,18],25:[2,18]},{18:[2,45],21:56,24:[2,45],29:53,30:60,31:54,32:[1,57],33:[1,58],34:[1,59],35:[1,61],36:[2,45],37:55,38:62,39:63,40:[1,64],42:[1,27],43:26},{40:[1,65]},{18:[2,37],24:[2,37],32:[2,37],33:[2,37],34:[2,37],35:[2,37],36:[2,37],40:[2,37],42:[2,37]},{14:[2,17],15:[2,17],16:[2,17],19:[2,17],20:[2,17],22:[2,17],23:[2,17],25:[2,17]},{5:[2,20],14:[2,20],15:[2,20],16:[2,20],19:[2,20],20:[2,20],22:[2,20],23:[2,20],25:[2,20]},{5:[2,21],14:[2,21],15:[2,21],16:[2,21],19:[2,21],20:[2,21],22:[2,21],23:[2,21],25:[2,21]},{18:[1,66]},{18:[2,42]},{18:[1,67]},{8:17,9:5,11:6,12:7,13:8,14:[1,9],15:[1,10],16:[1,12],19:[1,11],20:[2,4],22:[1,13],23:[1,14],25:[1,15]},{18:[2,24],24:[2,24],36:[2,24]},{18:[2,44],24:[2,44],32:[2,44],33:[2,44],34:[2,44],35:[2,44],36:[2,44],40:[2,44],42:[2,44]},{18:[2,46],24:[2,46],36:[2,46]},{18:[2,26],24:[2,26],32:[2,26],33:[2,26],34:[2,26],35:[2,26],36:[2,26],40:[2,26],42:[2,26]},{18:[2,27],24:[2,27],32:[2,27],33:[2,27],34:[2,27],35:[2,27],36:[2,27],40:[2,27],42:[2,27]},{18:[2,28],24:[2,28],32:[2,28],33:[2,28],34:[2,28],35:[2,28],36:[2,28],40:[2,28],42:[2,28]},{18:[2,29],24:[2,29],32:[2,29],33:[2,29],34:[2,29],35:[2,29],36:[2,29],40:[2,29],42:[2,29]},{18:[2,30],24:[2,30],32:[2,30],33:[2,30],34:[2,30],35:[2,30],36:[2,30],40:[2,30],42:[2,30]},{17:68,21:24,30:25,40:[1,28],42:[1,27],43:26},{18:[2,32],24:[2,32],36:[2,32],39:69,40:[1,70]},{18:[2,47],24:[2,47],36:[2,47],40:[2,47]},{18:[2,40],24:[2,40],32:[2,40],33:[2,40],34:[2,40],35:[2,40],36:[2,40],40:[2,40],41:[1,71],42:[2,40],44:[2,40]},{18:[2,39],24:[2,39],32:[2,39],33:[2,39],34:[2,39],35:[2,39],36:[2,39],40:[2,39],42:[2,39],44:[2,39]},{5:[2,22],14:[2,22],15:[2,22],16:[2,22],19:[2,22],20:[2,22],22:[2,22],23:[2,22],25:[2,22]},{5:[2,19],14:[2,19],15:[2,19],16:[2,19],19:[2,19],20:[2,19],22:[2,19],23:[2,19],25:[2,19]},{36:[1,72]},{18:[2,48],24:[2,48],36:[2,48],40:[2,48]},{41:[1,71]},{21:56,30:60,31:73,32:[1,57],33:[1,58],34:[1,59],35:[1,61],40:[1,28],42:[1,27],43:26},{18:[2,31],24:[2,31],32:[2,31],33:[2,31],34:[2,31],35:[2,31],36:[2,31],40:[2,31],42:[2,31]},{18:[2,33],24:[2,33],36:[2,33],40:[2,33]}],defaultActions:{3:[2,2],16:[2,1],50:[2,42]},parseError:function(t,n){throw new Error(t)},parse:function(t){function v(e){r.length=r.length-2*e,i.length=i.length-e,s.length=s.length-e}function m(){var e;return e=n.lexer.lex()||1,typeof e!="number"&&(e=n.symbols_[e]||e),e}var n=this,r=[0],i=[null],s=[],o=this.table,u="",a=0,f=0,l=0,c=2,h=1;this.lexer.setInput(t),this.lexer.yy=this.yy,this.yy.lexer=this.lexer,this.yy.parser=this,typeof this.lexer.yylloc=="undefined"&&(this.lexer.yylloc={});var p=this.lexer.yylloc;s.push(p);var d=this.lexer.options&&this.lexer.options.ranges;typeof this.yy.parseError=="function"&&(this.parseError=this.yy.parseError);var g,y,b,w,E,S,x={},T,N,C,k;for(;;){b=r[r.length-1];if(this.defaultActions[b])w=this.defaultActions[b];else{if(g===null||typeof g=="undefined")g=m();w=o[b]&&o[b][g]}if(typeof w=="undefined"||!w.length||!w[0]){var L="";if(!l){k=[];for(T in o[b])this.terminals_[T]&&T>2&&k.push("'"+this.terminals_[T]+"'");this.lexer.showPosition?L="Parse error on line "+(a+1)+":\n"+this.lexer.showPosition()+"\nExpecting "+k.join(", ")+", got '"+(this.terminals_[g]||g)+"'":L="Parse error on line "+(a+1)+": Unexpected "+(g==1?"end of input":"'"+(this.terminals_[g]||g)+"'"),this.parseError(L,{text:this.lexer.match,token:this.terminals_[g]||g,line:this.lexer.yylineno,loc:p,expected:k})}}if(w[0]instanceof Array&&w.length>1)throw new Error("Parse Error: multiple actions possible at state: "+b+", token: "+g);switch(w[0]){case 1:r.push(g),i.push(this.lexer.yytext),s.push(this.lexer.yylloc),r.push(w[1]),g=null,y?(g=y,y=null):(f=this.lexer.yyleng,u=this.lexer.yytext,a=this.lexer.yylineno,p=this.lexer.yylloc,l>0&&l--);break;case 2:N=this.productions_[w[1]][1],x.$=i[i.length-N],x._$={first_line:s[s.length-(N||1)].first_line,last_line:s[s.length-1].last_line,first_column:s[s.length-(N||1)].first_column,last_column:s[s.length-1].last_column},d&&(x._$.range=[s[s.length-(N||1)].range[0],s[s.length-1].range[1]]),S=this.performAction.call(x,u,f,a,this.yy,w[1],i,s);if(typeof S!="undefined")return S;N&&(r=r.slice(0,-1*N*2),i=i.slice(0,-1*N),s=s.slice(0,-1*N)),r.push(this.productions_[w[1]][0]),i.push(x.$),s.push(x._$),C=o[r[r.length-2]][r[r.length-1]],r.push(C);break;case 3:return!0}}return!0}},n=function(){var e={EOF:1,parseError:function(t,n){if(!this.yy.parser)throw new Error(t);this.yy.parser.parseError(t,n)},setInput:function(e){return this._input=e,this._more=this._less=this.done=!1,this.yylineno=this.yyleng=0,this.yytext=this.matched=this.match="",this.conditionStack=["INITIAL"],this.yylloc={first_line:1,first_column:0,last_line:1,last_column:0},this.options.ranges&&(this.yylloc.range=[0,0]),this.offset=0,this},input:function(){var e=this._input[0];this.yytext+=e,this.yyleng++,this.offset++,this.match+=e,this.matched+=e;var t=e.match(/(?:\r\n?|\n).*/g);return t?(this.yylineno++,this.yylloc.last_line++):this.yylloc.last_column++,this.options.ranges&&this.yylloc.range[1]++,this._input=this._input.slice(1),e},unput:function(e){var t=e.length,n=e.split(/(?:\r\n?|\n)/g);this._input=e+this._input,this.yytext=this.yytext.substr(0,this.yytext.length-t-1),this.offset-=t;var r=this.match.split(/(?:\r\n?|\n)/g);this.match=this.match.substr(0,this.match.length-1),this.matched=this.matched.substr(0,this.matched.length-1),n.length-1&&(this.yylineno-=n.length-1);var i=this.yylloc.range;return this.yylloc={first_line:this.yylloc.first_line,last_line:this.yylineno+1,first_column:this.yylloc.first_column,last_column:n?(n.length===r.length?this.yylloc.first_column:0)+r[r.length-n.length].length-n[0].length:this.yylloc.first_column-t},this.options.ranges&&(this.yylloc.range=[i[0],i[0]+this.yyleng-t]),this},more:function(){return this._more=!0,this},less:function(e){this.unput(this.match.slice(e))},pastInput:function(){var e=this.matched.substr(0,this.matched.length-this.match.length);return(e.length>20?"...":"")+e.substr(-20).replace(/\n/g,"")},upcomingInput:function(){var e=this.match;return e.length<20&&(e+=this._input.substr(0,20-e.length)),(e.substr(0,20)+(e.length>20?"...":"")).replace(/\n/g,"")},showPosition:function(){var e=this.pastInput(),t=(new Array(e.length+1)).join("-");return e+this.upcomingInput()+"\n"+t+"^"},next:function(){if(this.done)return this.EOF;this._input||(this.done=!0);var e,t,n,r,i,s;this._more||(this.yytext="",this.match="");var o=this._currentRules();for(var u=0;u<o.length;u++){n=this._input.match(this.rules[o[u]]);if(n&&(!t||n[0].length>t[0].length)){t=n,r=u;if(!this.options.flex)break}}if(t){s=t[0].match(/(?:\r\n?|\n).*/g),s&&(this.yylineno+=s.length),this.yylloc={first_line:this.yylloc.last_line,last_line:this.yylineno+1,first_column:this.yylloc.last_column,last_column:s?s[s.length-1].length-s[s.length-1].match(/\r?\n?/)[0].length:this.yylloc.last_column+t[0].length},this.yytext+=t[0],this.match+=t[0],this.matches=t,this.yyleng=this.yytext.length,this.options.ranges&&(this.yylloc.range=[this.offset,this.offset+=this.yyleng]),this._more=!1,this._input=this._input.slice(t[0].length),this.matched+=t[0],e=this.performAction.call(this,this.yy,this,o[r],this.conditionStack[this.conditionStack.length-1]),this.done&&this._input&&(this.done=!1);if(e)return e;return}return this._input===""?this.EOF:this.parseError("Lexical error on line "+(this.yylineno+1)+". Unrecognized text.\n"+this.showPosition(),{text:"",token:null,line:this.yylineno})},lex:function(){var t=this.next();return typeof t!="undefined"?t:this.lex()},begin:function(t){this.conditionStack.push(t)},popState:function(){return this.conditionStack.pop()},_currentRules:function(){return this.conditions[this.conditionStack[this.conditionStack.length-1]].rules},topState:function(){return this.conditionStack[this.conditionStack.length-2]},pushState:function(t){this.begin(t)}};return e.options={},e.performAction=function(t,n,r,i){function s(e,t){return n.yytext=n.yytext.substr(e,n.yyleng-t)}var o=i;switch(r){case 0:n.yytext.slice(-2)==="\\\\"?(s(0,1),this.begin("mu")):n.yytext.slice(-1)==="\\"?(s(0,1),this.begin("emu")):this.begin("mu");if(n.yytext)return 14;break;case 1:return 14;case 2:return this.popState(),14;case 3:return s(0,4),this.popState(),15;case 4:return 35;case 5:return 36;case 6:return 25;case 7:return 16;case 8:return 20;case 9:return 19;case 10:return 19;case 11:return 23;case 12:return 22;case 13:this.popState(),this.begin("com");break;case 14:return s(3,5),this.popState(),15;case 15:return 22;case 16:return 41;case 17:return 40;case 18:return 40;case 19:return 44;case 20:break;case 21:return this.popState(),24;case 22:return this.popState(),18;case 23:return n.yytext=s(1,2).replace(/\\"/g,'"'),32;case 24:return n.yytext=s(1,2).replace(/\\'/g,"'"),32;case 25:return 42;case 26:return 34;case 27:return 34;case 28:return 33;case 29:return 40;case 30:return n.yytext=s(1,2),40;case 31:return"INVALID";case 32:return 5}},e.rules=[/^(?:[^\x00]*?(?=(\{\{)))/,/^(?:[^\x00]+)/,/^(?:[^\x00]{2,}?(?=(\{\{|\\\{\{|\\\\\{\{|$)))/,/^(?:[\s\S]*?--\}\})/,/^(?:\()/,/^(?:\))/,/^(?:\{\{(~)?>)/,/^(?:\{\{(~)?#)/,/^(?:\{\{(~)?\/)/,/^(?:\{\{(~)?\^)/,/^(?:\{\{(~)?\s*else\b)/,/^(?:\{\{(~)?\{)/,/^(?:\{\{(~)?&)/,/^(?:\{\{!--)/,/^(?:\{\{![\s\S]*?\}\})/,/^(?:\{\{(~)?)/,/^(?:=)/,/^(?:\.\.)/,/^(?:\.(?=([=~}\s\/.)])))/,/^(?:[\/.])/,/^(?:\s+)/,/^(?:\}(~)?\}\})/,/^(?:(~)?\}\})/,/^(?:"(\\["]|[^"])*")/,/^(?:'(\\[']|[^'])*')/,/^(?:@)/,/^(?:true(?=([~}\s)])))/,/^(?:false(?=([~}\s)])))/,/^(?:-?[0-9]+(?=([~}\s)])))/,/^(?:([^\s!"#%-,\.\/;->@\[-\^`\{-~]+(?=([=~}\s\/.)]))))/,/^(?:\[[^\]]*\])/,/^(?:.)/,/^(?:$)/],e.conditions={mu:{rules:[4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32],inclusive:!1},emu:{rules:[2],inclusive:!1},com:{rules:[3],inclusive:!1},INITIAL:{rules:[0,1,32],inclusive:!0}},e}();return e.lexer=n,r.prototype=e,e.Parser=r,new r}();return e=t,e}(),a=function(e,t){"use strict";function s(e){return e.constructor===i.ProgramNode?e:(r.yy=i,r.parse(e))}var n={},r=e,i=t;return n.parser=r,n.parse=s,n}(u,o),f=function(e){"use strict";function r(){}function i(e,t,r){if(e==null||typeof e!="string"&&e.constructor!==r.AST.ProgramNode)throw new n("You must pass a string or Handlebars AST to Handlebars.precompile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var i=r.parse(e),s=(new r.Compiler).compile(i,t);return(new r.JavaScriptCompiler).compile(s,t)}function s(e,t,r){function s(){var n=r.parse(e),i=(new r.Compiler).compile(n,t),s=(new r.JavaScriptCompiler).compile(i,t,undefined,!0);return r.template(s)}if(e==null||typeof e!="string"&&e.constructor!==r.AST.ProgramNode)throw new n("You must pass a string or Handlebars AST to Handlebars.compile. You passed "+e);t=t||{},"data"in t||(t.data=!0);var i;return function(e,t){return i||(i=s()),i.call(this,e,t)}}var t={},n=e;return t.Compiler=r,r.prototype={compiler:r,disassemble:function(){var e=this.opcodes,t,n=[],r,i;for(var s=0,o=e.length;s<o;s++){t=e[s];if(t.opcode==="DECLARE")n.push("DECLARE "+t.name+"="+t.value);else{r=[];for(var u=0;u<t.args.length;u++)i=t.args[u],typeof i=="string"&&(i='"'+i.replace("\n","\\n")+'"'),r.push(i);n.push(t.opcode+" "+r.join(" "))}}return n.join("\n")},equals:function(e){var t=this.opcodes.length;if(e.opcodes.length!==t)return!1;for(var n=0;n<t;n++){var r=this.opcodes[n],i=e.opcodes[n];if(r.opcode!==i.opcode||r.args.length!==i.args.length)return!1;for(var s=0;s<r.args.length;s++)if(r.args[s]!==i.args[s])return!1}t=this.children.length;if(e.children.length!==t)return!1;for(n=0;n<t;n++)if(!this.children[n].equals(e.children[n]))return!1;return!0},guid:0,compile:function(e,t){this.opcodes=[],this.children=[],this.depths={list:[]},this.options=t;var n=this.options.knownHelpers;this.options.knownHelpers={helperMissing:!0,blockHelperMissing:!0,each:!0,"if":!0,unless:!0,"with":!0,log:!0};if(n)for(var r in n)this.options.knownHelpers[r]=n[r];return this.accept(e)},accept:function(e){var t=e.strip||{},n;return t.left&&this.opcode("strip"),n=this[e.type](e),t.right&&this.opcode("strip"),n},program:function(e){var t=e.statements;for(var n=0,r=t.length;n<r;n++)this.accept(t[n]);return this.isSimple=r===1,this.depths.list=this.depths.list.sort(function(e,t){return e-t}),this},compileProgram:function(e){var t=(new this.compiler).compile(e,this.options),n=this.guid++,r;this.usePartial=this.usePartial||t.usePartial,this.children[n]=t;for(var i=0,s=t.depths.list.length;i<s;i++){r=t.depths.list[i];if(r<2)continue;this.addDepth(r-1)}return n},block:function(e){var t=e.mustache,n=e.program,r=e.inverse;n&&(n=this.compileProgram(n)),r&&(r=this.compileProgram(r));var i=t.sexpr,s=this.classifySexpr(i);s==="helper"?this.helperSexpr(i,n,r):s==="simple"?(this.simpleSexpr(i),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("blockValue")):(this.ambiguousSexpr(i,n,r),this.opcode("pushProgram",n),this.opcode("pushProgram",r),this.opcode("emptyHash"),this.opcode("ambiguousBlockValue")),this.opcode("append")},hash:function(e){var t=e.pairs,n,r;this.opcode("pushHash");for(var i=0,s=t.length;i<s;i++)n=t[i],r=n[1],this.options.stringParams?(r.depth&&this.addDepth(r.depth),this.opcode("getContext",r.depth||0),this.opcode("pushStringParam",r.stringModeValue,r.type),r.type==="sexpr"&&this.sexpr(r)):this.accept(r),this.opcode("assignToHash",n[0]);this.opcode("popHash")},partial:function(e){var t=e.partialName;this.usePartial=!0,e.context?this.ID(e.context):this.opcode("push","depth0"),this.opcode("invokePartial",t.name),this.opcode("append")},content:function(e){this.opcode("appendContent",e.string)},mustache:function(e){this.sexpr(e.sexpr),e.escaped&&!this.options.noEscape?this.opcode("appendEscaped"):this.opcode("append")},ambiguousSexpr:function(e,t,n){var r=e.id,i=r.parts[0],s=t!=null||n!=null;this.opcode("getContext",r.depth),this.opcode("pushProgram",t),this.opcode("pushProgram",n),this.opcode("invokeAmbiguous",i,s)},simpleSexpr:function(e){var t=e.id;t.type==="DATA"?this.DATA(t):t.parts.length?this.ID(t):(this.addDepth(t.depth),this.opcode("getContext",t.depth),this.opcode("pushContext")),this.opcode("resolvePossibleLambda")},helperSexpr:function(e,t,r){var i=this.setupFullMustacheParams(e,t,r),s=e.id.parts[0];if(this.options.knownHelpers[s])this.opcode("invokeKnownHelper",i.length,s);else{if(this.options.knownHelpersOnly)throw new n("You specified knownHelpersOnly, but used the unknown helper "+s,e);this.opcode("invokeHelper",i.length,s,e.isRoot)}},sexpr:function(e){var t=this.classifySexpr(e);t==="simple"?this.simpleSexpr(e):t==="helper"?this.helperSexpr(e):this.ambiguousSexpr(e)},ID:function(e){this.addDepth(e.depth),this.opcode("getContext",e.depth);var t=e.parts[0];t?this.opcode("lookupOnContext",e.parts[0]):this.opcode("pushContext");for(var n=1,r=e.parts.length;n<r;n++)this.opcode("lookup",e.parts[n])},DATA:function(e){this.options.data=!0;if(e.id.isScoped||e.id.depth)throw new n("Scoped data references are not supported: "+e.original,e);this.opcode("lookupData");var t=e.id.parts;for(var r=0,i=t.length;r<i;r++)this.opcode("lookup",t[r])},STRING:function(e){this.opcode("pushString",e.string)},INTEGER:function(e){this.opcode("pushLiteral",e.integer)},BOOLEAN:function(e){this.opcode("pushLiteral",e.bool)},comment:function(){},opcode:function(e){this.opcodes.push({opcode:e,args:[].slice.call(arguments,1)})},declare:function(e,t){this.opcodes.push({opcode:"DECLARE",name:e,value:t})},addDepth:function(e){if(e===0)return;this.depths[e]||(this.depths[e]=!0,this.depths.list.push(e))},classifySexpr:function(e){var t=e.isHelper,n=e.eligibleHelper,r=this.options;if(n&&!t){var i=e.id.parts[0];r.knownHelpers[i]?t=!0:r.knownHelpersOnly&&(n=!1)}return t?"helper":n?"ambiguous":"simple"},pushParams:function(e){var t=e.length,n;while(t--)n=e[t],this.options.stringParams?(n.depth&&this.addDepth(n.depth),this.opcode("getContext",n.depth||0),this.opcode("pushStringParam",n.stringModeValue,n.type),n.type==="sexpr"&&this.sexpr(n)):this[n.type](n)},setupFullMustacheParams:function(e,t,n){var r=e.params;return this.pushParams(r),this.opcode("pushProgram",t),this.opcode("pushProgram",n),e.hash?this.hash(e.hash):this.opcode("emptyHash"),r}},t.precompile=i,t.compile=s,t}(n),l=function(e,t){"use strict";function u(e){this.value=e}function a(){}var n,r=e.COMPILER_REVISION,i=e.REVISION_CHANGES,s=e.log,o=t;a.prototype={nameLookup:function(e,t){var n,r;return e.indexOf("depth")===0&&(n=!0),/^[0-9]+$/.test(t)?r=e+"["+t+"]":a.isValidJavaScriptVariableName(t)?r=e+"."+t:r=e+"['"+t+"']",n?"("+e+" && "+r+")":r},compilerInfo:function(){var e=r,t=i[e];return"this.compilerInfo = ["+e+",'"+t+"'];\n"},appendToBuffer:function(e){return this.environment.isSimple?"return "+e+";":{appendToBuffer:!0,content:e,toString:function(){return"buffer += "+e+";"}}},initializeBuffer:function(){return this.quotedString("")},namespace:"Handlebars",compile:function(e,t,n,r){this.environment=e,this.options=t||{},s("debug",this.environment.disassemble()+"\n\n"),this.name=this.environment.name,this.isChild=!!n,this.context=n||{programs:[],environments:[],aliases:{}},this.preamble(),this.stackSlot=0,this.stackVars=[],this.registers={list:[]},this.hashes=[],this.compileStack=[],this.inlineStack=[],this.compileChildren(e,t);var i=e.opcodes,u;this.i=0;for(var a=i.length;this.i<a;this.i++)u=i[this.i],u.opcode==="DECLARE"?this[u.name]=u.value:this[u.opcode].apply(this,u.args),u.opcode!==this.stripNext&&(this.stripNext=!1);this.pushSource("");if(this.stackSlot||this.inlineStack.length||this.compileStack.length)throw new o("Compile completed with content left on stack");return this.createFunctionContext(r)},preamble:function(){var e=[];if(!this.isChild){var t=this.namespace,n="helpers = this.merge(helpers, "+t+".helpers);";this.environment.usePartial&&(n=n+" partials = this.merge(partials, "+t+".partials);"),this.options.data&&(n+=" data = data || {};"),e.push(n)}else e.push("");this.environment.isSimple?e.push(""):e.push(", buffer = "+this.initializeBuffer()),this.lastContext=0,this.source=e},createFunctionContext:function(e){var t=this.stackVars.concat(this.registers.list);t.length>0&&(this.source[1]=this.source[1]+", "+t.join(", "));if(!this.isChild)for(var n in this.context.aliases)this.context.aliases.hasOwnProperty(n)&&(this.source[1]=this.source[1]+", "+n+"="+this.context.aliases[n]);this.source[1]&&(this.source[1]="var "+this.source[1].substring(2)+";"),this.isChild||(this.source[1]+="\n"+this.context.programs.join("\n")+"\n"),this.environment.isSimple||this.pushSource("return buffer;");var r=this.isChild?["depth0","data"]:["Handlebars","depth0","helpers","partials","data"];for(var i=0,o=this.environment.depths.list.length;i<o;i++)r.push("depth"+this.environment.depths.list[i]);var u=this.mergeSource();this.isChild||(u=this.compilerInfo()+u);if(e)return r.push(u),Function.apply(this,r);var a="function "+(this.name||"")+"("+r.join(",")+") {\n  "+u+"}";return s("debug",a+"\n\n"),a},mergeSource:function(){var e="",t;for(var n=0,r=this.source.length;n<r;n++){var i=this.source[n];i.appendToBuffer?t?t=t+"\n    + "+i.content:t=i.content:(t&&(e+="buffer += "+t+";\n  ",t=undefined),e+=i+"\n  ")}return e},blockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e),this.replaceStack(function(t){return e.splice(1,0,t),"blockHelperMissing.call("+e.join(", ")+")"})},ambiguousBlockValue:function(){this.context.aliases.blockHelperMissing="helpers.blockHelperMissing";var e=["depth0"];this.setupParams(0,e);var t=this.topStack();e.splice(1,0,t),this.pushSource("if (!"+this.lastHelper+") { "+t+" = blockHelperMissing.call("+e.join(", ")+"); }")},appendContent:function(e){this.pendingContent&&(e=this.pendingContent+e),this.stripNext&&(e=e.replace(/^\s+/,"")),this.pendingContent=e},strip:function(){this.pendingContent&&(this.pendingContent=this.pendingContent.replace(/\s+$/,"")),this.stripNext="strip"},append:function(){this.flushInline();var e=this.popStack();this.pushSource("if("+e+" || "+e+" === 0) { "+this.appendToBuffer(e)+" }"),this.environment.isSimple&&this.pushSource("else { "+this.appendToBuffer("''")+" }")},appendEscaped:function(){this.context.aliases.escapeExpression="this.escapeExpression",this.pushSource(this.appendToBuffer("escapeExpression("+this.popStack()+")"))},getContext:function(e){this.lastContext!==e&&(this.lastContext=e)},lookupOnContext:function(e){this.push(this.nameLookup("depth"+this.lastContext,e,"context"))},pushContext:function(){this.pushStackLiteral("depth"+this.lastContext)},resolvePossibleLambda:function(){this.context.aliases.functionType='"function"',this.replaceStack(function(e){return"typeof "+e+" === functionType ? "+e+".apply(depth0) : "+e})},lookup:function(e){this.replaceStack(function(t){return t+" == null || "+t+" === false ? "+t+" : "+this.nameLookup(t,e,"context")})},lookupData:function(){this.pushStackLiteral("data")},pushStringParam:function(e,t){this.pushStackLiteral("depth"+this.lastContext),this.pushString(t),t!=="sexpr"&&(typeof e=="string"?this.pushString(e):this.pushStackLiteral(e))},emptyHash:function(){this.pushStackLiteral("{}"),this.options.stringParams&&(this.push("{}"),this.push("{}"))},pushHash:function(){this.hash&&this.hashes.push(this.hash),this.hash={values:[],types:[],contexts:[]}},popHash:function(){var e=this.hash;this.hash=this.hashes.pop(),this.options.stringParams&&(this.push("{"+e.contexts.join(",")+"}"),this.push("{"+e.types.join(",")+"}")),this.push("{\n    "+e.values.join(",\n    ")+"\n  }")},pushString:function(e){this.pushStackLiteral(this.quotedString(e))},push:function(e){return this.inlineStack.push(e),e},pushLiteral:function(e){this.pushStackLiteral(e)},pushProgram:function(e){e!=null?this.pushStackLiteral(this.programExpression(e)):this.pushStackLiteral(null)},invokeHelper:function(e,t,n){this.context.aliases.helperMissing="helpers.helperMissing",this.useRegister("helper");var r=this.lastHelper=this.setupHelper(e,t,!0),i=this.nameLookup("depth"+this.lastContext,t,"context"),s="helper = "+r.name+" || "+i;r.paramsInit&&(s+=","+r.paramsInit),this.push("("+s+",helper "+"? helper.call("+r.callParams+") "+": helperMissing.call("+r.helperMissingParams+"))"),n||this.flushInline()},invokeKnownHelper:function(e,t){var n=this.setupHelper(e,t);this.push(n.name+".call("+n.callParams+")")},invokeAmbiguous:function(e,t){this.context.aliases.functionType='"function"',this.useRegister("helper"),this.emptyHash();var n=this.setupHelper(0,e,t),r=this.lastHelper=this.nameLookup("helpers",e,"helper"),i=this.nameLookup("depth"+this.lastContext,e,"context"),s=this.nextStack();n.paramsInit&&this.pushSource(n.paramsInit),this.pushSource("if (helper = "+r+") { "+s+" = helper.call("+n.callParams+"); }"),this.pushSource("else { helper = "+i+"; "+s+" = typeof helper === functionType ? helper.call("+n.callParams+") : helper; }")},invokePartial:function(e){var t=[this.nameLookup("partials",e,"partial"),"'"+e+"'",this.popStack(),"helpers","partials"];this.options.data&&t.push("data"),this.context.aliases.self="this",this.push("self.invokePartial("+t.join(", ")+")")},assignToHash:function(e){var t=this.popStack(),n,r;this.options.stringParams&&(r=this.popStack(),n=this.popStack());var i=this.hash;n&&i.contexts.push("'"+e+"': "+n),r&&i.types.push("'"+e+"': "+r),i.values.push("'"+e+"': ("+t+")")},compiler:a,compileChildren:function(e,t){var n=e.children,r,i;for(var s=0,o=n.length;s<o;s++){r=n[s],i=new this.compiler;var u=this.matchExistingProgram(r);u==null?(this.context.programs.push(""),u=this.context.programs.length,r.index=u,r.name="program"+u,this.context.programs[u]=i.compile(r,t,this.context),this.context.environments[u]=r):(r.index=u,r.name="program"+u)}},matchExistingProgram:function(e){for(var t=0,n=this.context.environments.length;t<n;t++){var r=this.context.environments[t];if(r&&r.equals(e))return t}},programExpression:function(e){this.context.aliases.self="this";if(e==null)return"self.noop";var t=this.environment.children[e],n=t.depths.list,r,i=[t.index,t.name,"data"];for(var s=0,o=n.length;s<o;s++)r=n[s],r===1?i.push("depth0"):i.push("depth"+(r-1));return(n.length===0?"self.program(":"self.programWithDepth(")+i.join(", ")+")"},register:function(e,t){this.useRegister(e),this.pushSource(e+" = "+t+";")},useRegister:function(e){this.registers[e]||(this.registers[e]=!0,this.registers.list.push(e))},pushStackLiteral:function(e){return this.push(new u(e))},pushSource:function(e){this.pendingContent&&(this.source.push(this.appendToBuffer(this.quotedString(this.pendingContent))),this.pendingContent=undefined),e&&this.source.push(e)},pushStack:function(e){this.flushInline();var t=this.incrStack();return e&&this.pushSource(t+" = "+e+";"),this.compileStack.push(t),t},replaceStack:function(e){var t="",n=this.isInline(),r,i,s;if(n){var o=this.popStack(!0);if(o instanceof u)r=o.value,s=!0;else{i=!this.stackSlot;var a=i?this.incrStack():this.topStackName();t="("+this.push(a)+" = "+o+"),",r=this.topStack()}}else r=this.topStack();var f=e.call(this,r);return n?(s||this.popStack(),i&&this.stackSlot--,this.push("("+t+f+")")):(/^stack/.test(r)||(r=this.nextStack()),this.pushSource(r+" = ("+t+f+");")),r},nextStack:function(){return this.pushStack()},incrStack:function(){return this.stackSlot++,this.stackSlot>this.stackVars.length&&this.stackVars.push("stack"+this.stackSlot),this.topStackName()},topStackName:function(){return"stack"+this.stackSlot},flushInline:function(){var e=this.inlineStack;if(e.length){this.inlineStack=[];for(var t=0,n=e.length;t<n;t++){var r=e[t];r instanceof u?this.compileStack.push(r):this.pushStack(r)}}},isInline:function(){return this.inlineStack.length},popStack:function(e){var t=this.isInline(),n=(t?this.inlineStack:this.compileStack).pop();if(!e&&n instanceof u)return n.value;if(!t){if(!this.stackSlot)throw new o("Invalid stack pop");this.stackSlot--}return n},topStack:function(e){var t=this.isInline()?this.inlineStack:this.compileStack,n=t[t.length-1];return!e&&n instanceof u?n.value:n},quotedString:function(e){return'"'+e.replace(/\\/g,"\\\\").replace(/"/g,'\\"').replace(/\n/g,"\\n").replace(/\r/g,"\\r").replace(/\u2028/g,"\\u2028").replace(/\u2029/g,"\\u2029")+'"'},setupHelper:function(e,t,n){var r=[],i=this.setupParams(e,r,n),s=this.nameLookup("helpers",t,"helper");return{params:r,paramsInit:i,name:s,callParams:["depth0"].concat(r).join(", "),helperMissingParams:n&&["depth0",this.quotedString(t)].concat(r).join(", ")}},setupOptions:function(e,t){var n=[],r=[],i=[],s,o,u;n.push("hash:"+this.popStack()),this.options.stringParams&&(n.push("hashTypes:"+this.popStack()),n.push("hashContexts:"+this.popStack())),o=this.popStack(),u=this.popStack();if(u||o)u||(this.context.aliases.self="this",u="self.noop"),o||(this.context.aliases.self="this",o="self.noop"),n.push("inverse:"+o),n.push("fn:"+u);for(var a=0;a<e;a++)s=this.popStack(),t.push(s),this.options.stringParams&&(i.push(this.popStack()),r.push(this.popStack()));return this.options.stringParams&&(n.push("contexts:["+r.join(",")+"]"),n.push("types:["+i.join(",")+"]")),this.options.data&&n.push("data:data"),n},setupParams:function(e,t,n){var r="{"+this.setupOptions(e,t).join(",")+"}";return n?(this.useRegister("options"),t.push("options"),"options="+r):(t.push(r),"")}};var f="break else new var case finally return void catch for switch while continue function this with default if throw delete in try do instanceof typeof abstract enum int short boolean export interface static byte extends long super char final native synchronized class float package throws const goto private transient debugger implements protected volatile double import public let yield".split(" "),l=a.RESERVED_WORDS={};for(var c=0,h=f.length;c<h;c++)l[f[c]]=!0;return a.isValidJavaScriptVariableName=function(e){return!a.RESERVED_WORDS[e]&&/^[a-zA-Z_$][0-9a-zA-Z_$]*$/.test(e)?!0:!1},n=a,n}(r,n),c=function(e,t,n,r,i){"use strict";var s,o=e,u=t,a=n.parser,f=n.parse,l=r.Compiler,c=r.compile,h=r.precompile,p=i,d=o.create,v=function(){var e=d();return e.compile=function(t,n){return c(t,n,e)},e.precompile=function(t,n){return h(t,n,e)},e.AST=u,e.Compiler=l,e.JavaScriptCompiler=p,e.Parser=a,e.parse=f,e};return o=v(),o.create=v,s=o,s}(s,o,a,f,l);return c}();define("handlebars",function(){}),define("kbwidget",["jquery","handlebars"],function(e){function l(e,t){function n(){}n.prototype=t.prototype;var r=new n;r.constructor=e,e.prototype=r}e(document).on("libsLoaded.kbase",function(){e("[data-kbwidget]").each(function(t,n){var r=e(n),i=r.attr("data-kbwidget"),s=r.text();r.empty(),s!=undefined?s=JSON.parse(s):s={},r[i](s)})});var t,n=function(e){if(e!=undefined&&e.length)return e.charAt(0).toUpperCase()+e.slice(1)},r=function(e){return"willChangeValueFor"+n(e)},i=function(e){return"didChangeValueFor"+n(e)},s=function(t){var n=e(t).prop("tagName").toLowerCase();return n.match(/^(input|select|textarea)$/)?e(t).attr("type")=="checkbox"?{setter:"checked",getter:"checked"}:{setter:"val",getter:"val"}:{setter:"html",getter:"html"}},o=function(t,n,r,i,s){return e.proxy(function(n,r){n.preventDefault(),n.stopPropagation();var o=r.newValue;i.transformedValue!=undefined&&(o=i.transformedValue(o)),s.setter=="checked"?e(t).attr(s.setter,o):e(t)[s.setter](o)},e(t))},u=function(t,n,r,i,s){return e.proxy(function(o,u){if(o.type=="keypress"&&o.which!=13)return;o.preventDefault(),o.stopPropagation();var a;s.getter=="checked"?a=this.is(":checked")?!0:!1:a=this[s.getter]();if(a!=this.data("kbase_bindingValue")){if(i.validator!=undefined){var f=i.validator(a);if(!f.success){e(t).data("validationError.kbaseBinding",f.msg),this.popover({placement:"right",title:"Validation error",content:e.proxy(function(){return this.data("validationError.kbaseBinding")},e(t)),trigger:"manual",html:!0}),this.popover("show");return}e(t).popover("hide"),f.newVal&&(a=f.newVal)}i.reverseTransformedValue!=undefined&&(a=i.reverseTransformedValue(a));var l=n.__attributes[r].setter;n[l](a),this.data("kbase_bindingValue",this[s.getter]())}},e(t))},a=function(t,n,r){return e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.data("kbase_bindingValue",this[r.getter]())},e(t))};e.fn.asD3=function(){return this.data("d3rep")==undefined&&this.data("d3rep",d3.select(this.get(0))),this.data("d3rep")},e.fn.kb_bind=function(t,n,r,f){if(this.length>1){var l=arguments;return e.each(this,function(t,n){e.fn.kb_bind.apply(e(n),l)}),this}f==undefined&&(f=s(this)),r==undefined&&(r={});var c=i(n);t.on(c,o(this,t,n,r,f)),e(this).on("blur.kbaseBinding",u(this,t,n,r,f)),e(this).on("focus.kbaseBinding",a(this,r,f));var h=e(this).prop("tagName").toLowerCase();h.match(/^(input)$/)&&(e(this).on("keypress.kbaseBinding",u(this,t,n,r,f)),e(this).attr("type")=="checkbox"&&e(this).on("change.kbaseBinding",u(this,t,n,r,f)));var p=t.__attributes[n].getter,d=t[p]();return r.transformedValue!=undefined&&(d=r.transformedValue(d)),f.setter=="checked"?e(this).attr(f.setter,d):e(this)[f.setter](d),this},e.fn.kb_unbind=function(t,n,r,a,f){if(this.length>1){var l=arguments;return e.each(this,function(t,n){e.fn.kb_unbind.apply(e(n),l)}),this}f==undefined&&(f=s(this)),a==undefined&&(a={});var c=i(n);t.off(c,o(this,t,n,a,f)),e(this).off("blur.kbaseBinding",u(this,t,n,a,f)),e(this).off("focus.kbaseBinding",u(this,a,f));var h=e(this).prop("tagName").toLowerCase();return h.match(/^(input)$/)&&(e(this).off("keypress.kbaseBinding",makeBindingEnterCallback(this,t,n,a,f)),e(this).attr("type")=="checkbox"&&e(this).off("change.kbaseBinding",u(this,t,n,a,f))),this};var f={};t==undefined&&(t=window.KBase),window.KBase===undefined&&(t=window.KBase={_functions:{getter:function(e){return function(){return this.valueForKey(e)}},setter:function(e){return function(t){return this.setValueForKey(e,t)}},getter_setter:function(e){return function(t){return arguments.length==1?this.setValueForKey(e,t):this.valueForKey(e)}}}}),e.jqElem=function(t){var n="<"+t+">";return n.match(/^(area|base|br|col|command|embed|hr|img|input|keygen|link|meta|param|source|track)/)||(n+="</"+t+">"),e(n)},e.KBWidget=function(n){n=n||{};var r=n.name,i=n.parent;i==undefined&&(i="kbaseWidget");var s=n.asPlugin;s===undefined&&(s=!0);var o=function(t){return this.$elem=t,this.options=e.extend(!0,{},n.options,this.constructor.prototype.options),this};if(r){var u=r;u=u.replace(/^kbase/,""),u=u.charAt(0).toLowerCase()+u.slice(1),t[u]=function(t,n){var r=new o;return n==undefined&&(n=e.jqElem("div")),r.$elem=n,t==undefined&&(t={}),t.headless=!0,r.init(t),r._init=!0,r.trigger("initialized"),r},f[r]=o,n==undefined&&(n=i,i="kbaseWidget",n==undefined&&(n={}))}if(i){var a=f[i];if(a===undefined)throw new Error("Parent widget is not registered. Cannot find "+i+" for "+r);l(o,a)}var c=e.extend(!0,{},n);o.prototype.__attributes={},c._accessors!=undefined&&(e.each(c._accessors,e.proxy(function(e,n){var r={name:n,setter:n,getter:n,type:"rw"};if(typeof n=="object"){r.setter=n.name,r.getter=n.name;for(var i in n)r[i]=n[i]}o.prototype.__attributes[r.name]=r,r.setter==r.getter&&r.type.match(/rw/)?o.prototype[r.getter]=t._functions.getter_setter(r.name):(r.type.match(/w/)&&r.setter!=undefined&&(o.prototype[r.setter]=t._functions.setter(r.name)),r.type.match(/r/)&&r.getter!=undefined&&(o.prototype[r.getter]=t._functions.getter(r.name)))},this)),c._accessors=undefined);var h=e.extend(!0,{},o.prototype.__attributes,f[i].prototype.__attributes);o.prototype.__attributes=h;for(var p in c)e.isFunction(c[p])?o.prototype[p]=function(e,t){var n=function(){throw"No parent method defined! Play by the rules!"},r=function(){throw"No parent method defined! Play by the rules!"};if(i)var n=function(){return f[i].prototype[e].apply(this,arguments)},r=function(e){return f[i].prototype[e].apply(this,Array.prototype.slice.call(arguments,1))};return function(){var e=this._super,i=this._superMethod;this._super=n,this._superMethod=r;var s=t.apply(this,arguments);return this._super=e,this._superMethod=i,s}}(p,c[p]):o.prototype[p]=c[p];i&&(o.prototype.options=e.extend(!0,{},f[i].prototype.options,o.prototype.options));if(s){var d=function(t,n){if(this.length>1){var i=arguments;return e.each(this,function(t,n){e.fn[r].apply(e(n),i)}),this}this.data(r)==undefined&&this.data(r,new o(this));if(o.prototype[t])return o.prototype[t].apply(this.data(r),Array.prototype.slice.call(arguments,1));if(typeof t=="object"||!t){var n=arguments;return $w=this.data(r),$w._init===undefined&&($w=o.prototype.init.apply($w,arguments)),$w._init=!0,$w.trigger("initialized"),$w}return e.error("Method "+t+" does not exist on "+r),this};d.name=r,e.fn[r]=d,e[r]=e.fn[r]}return this.on=function(e,t){return this.$elem.bind(e,t),this},this.emit=function(e,t){return this.$elem.trigger(e,t),this},this.off=function(e){return this.$elem.unbind(e),this},r!==undefined?(o.prototype[r]=function(){return e.fn[r].apply(this.$elem,arguments)},e.fn[r]):this},e.KBWidget.registry=function(){var e={};for(var t in f)t!=="kbaseWidget"&&(e[t]=f[t]);return e},e.KBWidget.resetRegistry=function(){for(var e in f)e!=="kbaseWidget"&&delete f[e];return this},e.KBWidget({name:"kbaseWidget",dbg:function(e){window.console&&console.log(e)},callAfterInit:function(e){var t=this,n=function(){var n=arguments.callee;t._init?e():setTimeout(n,10)};return n(),n},init:function(t){this._attributes={};var n=e.extend(!0,{},this.options);this.options=e.extend(!0,{},n,t);for(arg in t)t[arg]==undefined&&this.options[arg]!=undefined&&delete this.options[arg];for(attribute in this.__attributes)if(this.options[attribute]!=undefined){var r=this.__attributes[attribute].setter;this[r](this.options[attribute])}return this.options.template&&this.callAfterInit(e.proxy(function(){this.appendUI(this.$elem)},this)),this},appendUI:function(t){return this.options.template&&e.ajax(this.options.template).done(e.proxy(function(e){this.templateSuccess.apply(this,arguments)},this)).fail(e.proxy(function(e){this.templateFailure.apply(this,arguments)},this)),t},templateSuccess:function(t){var n=Handlebars.compile(t),r=n(),i=n(this.templateContent()),s=e.jqElem("span").append(i);this._rewireIds(s,this),this.$elem.append(s)},templateFailure:function(e){this.dbg("Template load failure"),this.dbg(e)},templateContent:function(){return this.options.templateContent||{}},alert:function(e){return e==undefined&&(e=this.data("msg")),this.data("msg",e),this},valueForKey:function(e){return this._attributes[e]},setValueForKey:function(e,t){var n=undefined,s=this.valueForKey(e);if(t!=s){var o=r(e);n={oldValue:s,newValue:t},this.trigger(o,n),this._attributes[e]=n.newValue;if(n.newValue!=s){var u=i(e);this.trigger(u,n)}}return this.valueForKey(e)},setValuesForKeys:function(t){var n=e.extend({},t);for(attribute in this.__attributes)if(n[attribute]!=undefined){var r=this.__attributes[attribute].setter;this[r](n[attribute]),delete n[attribute]}this.options=e.extend(this.options,n)},data:function(e,t){return this.options._storage==undefined&&(this.options._storage={}),arguments.length==2&&(this.options._storage[e]=t),e!=undefined?this.options._storage[e]:this.options._storage},_rewireIds:function(t,n){return n==undefined&&(n=t),t.attr("id")&&(n.data(t.attr("id"),t),t.removeAttr("id")),e.each(t.find("[id]"),function(t){n.data(e(this).attr("id"),e(this)),e(this).attr("data-id",e(this).attr("id")),e(this).removeAttr("id")}),t},sortCaseInsensitively:function(e,t){return e.toLowerCase()<t.toLowerCase()?-1:e.toLowerCase()>t.toLowerCase()?1:0},sortByKey:function(e,t){return t?function(t,n){return t[e].toLowerCase()<n[e].toLowerCase()?-1:t[e].toLowerCase()>n[e].toLowerCase()?1:0}:function(t,n){return t[e]<n[e]?-1:t[e]>n[e]?1:0}},trigger:function(){this.$elem.trigger.apply(this.$elem,arguments)},on:function(){this.$elem.on.apply(this.$elem,arguments)},off:function(){this.$elem.off.apply(this.$elem,arguments)},makeObserverCallback:function(t,n,r){return e.proxy(function(e,n){e.preventDefault(),e.stopPropagation(),r.call(this,e,t,n)},this)},observe:function(e,t,n){e.on(t,e,this.makeObserverCallback(e,t,n))},unobserve:function(e,t,n){e.off(t,e,this.makeObserverCallback(e,t,n))},kb_bind:function(e,t,n){var r=i(t);this.observe(e,r,n)},kb_unbind:function(e,t,n){var r=i(t);this.unobserve(e,r,n)},uuid:function(){var e="";for(var t=0;t<32;t++)e+=Math.floor(Math.random()*16).toString(16).toUpperCase();return"uuid-"+e}})});if("undefined"==typeof jQuery)throw new Error("Bootstrap's JavaScript requires jQuery");+function(e){var t=e.fn.jquery.split(" ")[0].split(".");if(t[0]<2&&t[1]<9||1==t[0]&&9==t[1]&&t[2]<1)throw new Error("Bootstrap's JavaScript requires jQuery version 1.9.1 or higher")}(jQuery),+function(e){"use strict";function t(){var e=document.createElement("bootstrap"),t={WebkitTransition:"webkitTransitionEnd",MozTransition:"transitionend",OTransition:"oTransitionEnd otransitionend",transition:"transitionend"};for(var n in t)if(void 0!==e.style[n])return{end:t[n]};return!1}e.fn.emulateTransitionEnd=function(t){var n=!1,r=this;e(this).one("bsTransitionEnd",function(){n=!0});var i=function(){n||e(r).trigger(e.support.transition.end)};return setTimeout(i,t),this},e(function(){e.support.transition=t(),e.support.transition&&(e.event.special.bsTransitionEnd={bindType:e.support.transition.end,delegateType:e.support.transition.end,handle:function(t){return e(t.target).is(this)?t.handleObj.handler.apply(this,arguments):void 0}})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var n=e(this),i=n.data("bs.alert");i||n.data("bs.alert",i=new r(this)),"string"==typeof t&&i[t].call(n)})}var n='[data-dismiss="alert"]',r=function(t){e(t).on("click",n,this.close)};r.VERSION="3.3.0",r.TRANSITION_DURATION=150,r.prototype.close=function(t){function n(){o.detach().trigger("closed.bs.alert").remove()}var i=e(this),s=i.attr("data-target");s||(s=i.attr("href"),s=s&&s.replace(/.*(?=#[^\s]*$)/,""));var o=e(s);t&&t.preventDefault(),o.length||(o=i.closest(".alert")),o.trigger(t=e.Event("close.bs.alert")),t.isDefaultPrevented()||(o.removeClass("in"),e.support.transition&&o.hasClass("fade")?o.one("bsTransitionEnd",n).emulateTransitionEnd(r.TRANSITION_DURATION):n())};var i=e.fn.alert;e.fn.alert=t,e.fn.alert.Constructor=r,e.fn.alert.noConflict=function(){return e.fn.alert=i,this},e(document).on("click.bs.alert.data-api",n,r.prototype.close)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.button"),s="object"==typeof t&&t;i||r.data("bs.button",i=new n(this,s)),"toggle"==t?i.toggle():t&&i.setState(t)})}var n=function(t,r){this.$element=e(t),this.options=e.extend({},n.DEFAULTS,r),this.isLoading=!1};n.VERSION="3.3.0",n.DEFAULTS={loadingText:"loading..."},n.prototype.setState=function(t){var n="disabled",r=this.$element,i=r.is("input")?"val":"html",s=r.data();t+="Text",null==s.resetText&&r.data("resetText",r[i]()),setTimeout(e.proxy(function(){r[i](null==s[t]?this.options[t]:s[t]),"loadingText"==t?(this.isLoading=!0,r.addClass(n).attr(n,n)):this.isLoading&&(this.isLoading=!1,r.removeClass(n).removeAttr(n))},this),0)},n.prototype.toggle=function(){var e=!0,t=this.$element.closest('[data-toggle="buttons"]');if(t.length){var n=this.$element.find("input");"radio"==n.prop("type")&&(n.prop("checked")&&this.$element.hasClass("active")?e=!1:t.find(".active").removeClass("active")),e&&n.prop("checked",!this.$element.hasClass("active")).trigger("change")}else this.$element.attr("aria-pressed",!this.$element.hasClass("active"));e&&this.$element.toggleClass("active")};var r=e.fn.button;e.fn.button=t,e.fn.button.Constructor=n,e.fn.button.noConflict=function(){return e.fn.button=r,this},e(document).on("click.bs.button.data-api",'[data-toggle^="button"]',function(n){var r=e(n.target);r.hasClass("btn")||(r=r.closest(".btn")),t.call(r,"toggle"),n.preventDefault()}).on("focus.bs.button.data-api blur.bs.button.data-api",'[data-toggle^="button"]',function(t){e(t.target).closest(".btn").toggleClass("focus","focus"==t.type)})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.carousel"),s=e.extend({},n.DEFAULTS,r.data(),"object"==typeof t&&t),o="string"==typeof t?t:s.slide;i||r.data("bs.carousel",i=new n(this,s)),"number"==typeof t?i.to(t):o?i[o]():s.interval&&i.pause().cycle()})}var n=function(t,n){this.$element=e(t),this.$indicators=this.$element.find(".carousel-indicators"),this.options=n,this.paused=this.sliding=this.interval=this.$active=this.$items=null,this.options.keyboard&&this.$element.on("keydown.bs.carousel",e.proxy(this.keydown,this)),"hover"==this.options.pause&&!("ontouchstart"in document.documentElement)&&this.$element.on("mouseenter.bs.carousel",e.proxy(this.pause,this)).on("mouseleave.bs.carousel",e.proxy(this.cycle,this))};n.VERSION="3.3.0",n.TRANSITION_DURATION=600,n.DEFAULTS={interval:5e3,pause:"hover",wrap:!0,keyboard:!0},n.prototype.keydown=function(e){switch(e.which){case 37:this.prev();break;case 39:this.next();break;default:return}e.preventDefault()},n.prototype.cycle=function(t){return t||(this.paused=!1),this.interval&&clearInterval(this.interval),this.options.interval&&!this.paused&&(this.interval=setInterval(e.proxy(this.next,this),this.options.interval)),this},n.prototype.getItemIndex=function(e){return this.$items=e.parent().children(".item"),this.$items.index(e||this.$active)},n.prototype.getItemForDirection=function(e,t){var n="prev"==e?-1:1,r=this.getItemIndex(t),i=(r+n)%this.$items.length;return this.$items.eq(i)},n.prototype.to=function(e){var t=this,n=this.getItemIndex(this.$active=this.$element.find(".item.active"));return e>this.$items.length-1||0>e?void 0:this.sliding?this.$element.one("slid.bs.carousel",function(){t.to(e)}):n==e?this.pause().cycle():this.slide(e>n?"next":"prev",this.$items.eq(e))},n.prototype.pause=function(t){return t||(this.paused=!0),this.$element.find(".next, .prev").length&&e.support.transition&&(this.$element.trigger(e.support.transition.end),this.cycle(!0)),this.interval=clearInterval(this.interval),this},n.prototype.next=function(){return this.sliding?void 0:this.slide("next")},n.prototype.prev=function(){return this.sliding?void 0:this.slide("prev")},n.prototype.slide=function(t,r){var i=this.$element.find(".item.active"),s=r||this.getItemForDirection(t,i),o=this.interval,u="next"==t?"left":"right",f="next"==t?"first":"last",l=this;if(!s.length){if(!this.options.wrap)return;s=this.$element.find(".item")[f]()}if(s.hasClass("active"))return this.sliding=!1;var h=s[0],p=e.Event("slide.bs.carousel",{relatedTarget:h,direction:u});if(this.$element.trigger(p),!p.isDefaultPrevented()){if(this.sliding=!0,o&&this.pause(),this.$indicators.length){this.$indicators.find(".active").removeClass("active");var d=e(this.$indicators.children()[this.getItemIndex(s)]);d&&d.addClass("active")}var v=e.Event("slid.bs.carousel",{relatedTarget:h,direction:u});return e.support.transition&&this.$element.hasClass("slide")?(s.addClass(t),s[0].offsetWidth,i.addClass(u),s.addClass(u),i.one("bsTransitionEnd",function(){s.removeClass([t,u].join(" ")).addClass("active"),i.removeClass(["active",u].join(" ")),l.sliding=!1,setTimeout(function(){l.$element.trigger(v)},0)}).emulateTransitionEnd(n.TRANSITION_DURATION)):(i.removeClass("active"),s.addClass("active"),this.sliding=!1,this.$element.trigger(v)),o&&this.cycle(),this}};var r=e.fn.carousel;e.fn.carousel=t,e.fn.carousel.Constructor=n,e.fn.carousel.noConflict=function(){return e.fn.carousel=r,this};var i=function(n){var r,i=e(this),s=e(i.attr("data-target")||(r=i.attr("href"))&&r.replace(/.*(?=#[^\s]+$)/,""));if(s.hasClass("carousel")){var o=e.extend({},s.data(),i.data()),u=i.attr("data-slide-to");u&&(o.interval=!1),t.call(s,o),u&&s.data("bs.carousel").to(u),n.preventDefault()}};e(document).on("click.bs.carousel.data-api","[data-slide]",i).on("click.bs.carousel.data-api","[data-slide-to]",i),e(window).on("load",function(){e('[data-ride="carousel"]').each(function(){var n=e(this);t.call(n,n.data())})})}(jQuery),+function(e){"use strict";function t(t){var n,r=t.attr("data-target")||(n=t.attr("href"))&&n.replace(/.*(?=#[^\s]+$)/,"");return e(r)}function n(t){return this.each(function(){var n=e(this),i=n.data("bs.collapse"),s=e.extend({},r.DEFAULTS,n.data(),"object"==typeof t&&t);!i&&s.toggle&&"show"==t&&(s.toggle=!1),i||n.data("bs.collapse",i=new r(this,s)),"string"==typeof t&&i[t]()})}var r=function(t,n){this.$element=e(t),this.options=e.extend({},r.DEFAULTS,n),this.$trigger=e(this.options.trigger).filter('[href="#'+t.id+'"], [data-target="#'+t.id+'"]'),this.transitioning=null,this.options.parent?this.$parent=this.getParent():this.addAriaAndCollapsedClass(this.$element,this.$trigger),this.options.toggle&&this.toggle()};r.VERSION="3.3.0",r.TRANSITION_DURATION=350,r.DEFAULTS={toggle:!0,trigger:'[data-toggle="collapse"]'},r.prototype.dimension=function(){var e=this.$element.hasClass("width");return e?"width":"height"},r.prototype.show=function(){if(!this.transitioning&&!this.$element.hasClass("in")){var t,i=this.$parent&&this.$parent.find("> .panel").children(".in, .collapsing");if(!(i&&i.length&&(t=i.data("bs.collapse"),t&&t.transitioning))){var s=e.Event("show.bs.collapse");if(this.$element.trigger(s),!s.isDefaultPrevented()){i&&i.length&&(n.call(i,"hide"),t||i.data("bs.collapse",null));var o=this.dimension();this.$element.removeClass("collapse").addClass("collapsing")[o](0).attr("aria-expanded",!0),this.$trigger.removeClass("collapsed").attr("aria-expanded",!0),this.transitioning=1;var u=function(){this.$element.removeClass("collapsing").addClass("collapse in")[o](""),this.transitioning=0,this.$element.trigger("shown.bs.collapse")};if(!e.support.transition)return u.call(this);var f=e.camelCase(["scroll",o].join("-"));this.$element.one("bsTransitionEnd",e.proxy(u,this)).emulateTransitionEnd(r.TRANSITION_DURATION)[o](this.$element[0][f])}}}},r.prototype.hide=function(){if(!this.transitioning&&this.$element.hasClass("in")){var t=e.Event("hide.bs.collapse");if(this.$element.trigger(t),!t.isDefaultPrevented()){var n=this.dimension();this.$element[n](this.$element[n]())[0].offsetHeight,this.$element.addClass("collapsing").removeClass("collapse in").attr("aria-expanded",!1),this.$trigger.addClass("collapsed").attr("aria-expanded",!1),this.transitioning=1;var i=function(){this.transitioning=0,this.$element.removeClass("collapsing").addClass("collapse").trigger("hidden.bs.collapse")};return e.support.transition?void this.$element[n](0).one("bsTransitionEnd",e.proxy(i,this)).emulateTransitionEnd(r.TRANSITION_DURATION):i.call(this)}}},r.prototype.toggle=function(){this[this.$element.hasClass("in")?"hide":"show"]()},r.prototype.getParent=function(){return e(this.options.parent).find('[data-toggle="collapse"][data-parent="'+this.options.parent+'"]').each(e.proxy(function(n,r){var i=e(r);this.addAriaAndCollapsedClass(t(i),i)},this)).end()},r.prototype.addAriaAndCollapsedClass=function(e,t){var n=e.hasClass("in");e.attr("aria-expanded",n),t.toggleClass("collapsed",!n).attr("aria-expanded",n)};var i=e.fn.collapse;e.fn.collapse=n,e.fn.collapse.Constructor=r,e.fn.collapse.noConflict=function(){return e.fn.collapse=i,this},e(document).on("click.bs.collapse.data-api",'[data-toggle="collapse"]',function(r){var i=e(this);i.attr("data-target")||r.preventDefault();var s=t(i),o=s.data("bs.collapse"),u=o?"toggle":e.extend({},i.data(),{trigger:this});n.call(s,u)})}(jQuery),+function(e){"use strict";function t(t){t&&3===t.which||(e(i).remove(),e(s).each(function(){var r=e(this),i=n(r),s={relatedTarget:this};i.hasClass("open")&&(i.trigger(t=e.Event("hide.bs.dropdown",s)),t.isDefaultPrevented()||(r.attr("aria-expanded","false"),i.removeClass("open").trigger("hidden.bs.dropdown",s)))}))}function n(t){var n=t.attr("data-target");n||(n=t.attr("href"),n=n&&/#[A-Za-z]/.test(n)&&n.replace(/.*(?=#[^\s]*$)/,""));var r=n&&e(n);return r&&r.length?r:t.parent()}function r(t){return this.each(function(){var n=e(this),r=n.data("bs.dropdown");r||n.data("bs.dropdown",r=new o(this)),"string"==typeof t&&r[t].call(n)})}var i=".dropdown-backdrop",s='[data-toggle="dropdown"]',o=function(t){e(t).on("click.bs.dropdown",this.toggle)};o.VERSION="3.3.0",o.prototype.toggle=function(r){var i=e(this);if(!i.is(".disabled, :disabled")){var s=n(i),o=s.hasClass("open");if(t(),!o){"ontouchstart"in document.documentElement&&!s.closest(".navbar-nav").length&&e('<div class="dropdown-backdrop"/>').insertAfter(e(this)).on("click",t);var u={relatedTarget:this};if(s.trigger(r=e.Event("show.bs.dropdown",u)),r.isDefaultPrevented())return;i.trigger("focus").attr("aria-expanded","true"),s.toggleClass("open").trigger("shown.bs.dropdown",u)}return!1}},o.prototype.keydown=function(t){if(/(38|40|27|32)/.test(t.which)){var r=e(this);if(t.preventDefault(),t.stopPropagation(),!r.is(".disabled, :disabled")){var i=n(r),o=i.hasClass("open");if(!o&&27!=t.which||o&&27==t.which)return 27==t.which&&i.find(s).trigger("focus"),r.trigger("click");var u=" li:not(.divider):visible a",l=i.find('[role="menu"]'+u+', [role="listbox"]'+u);if(l.length){var h=l.index(t.target);38==t.which&&h>0&&h--,40==t.which&&h<l.length-1&&h++,~h||(h=0),l.eq(h).trigger("focus")}}}};var u=e.fn.dropdown;e.fn.dropdown=r,e.fn.dropdown.Constructor=o,e.fn.dropdown.noConflict=function(){return e.fn.dropdown=u,this},e(document).on("click.bs.dropdown.data-api",t).on("click.bs.dropdown.data-api",".dropdown form",function(e){e.stopPropagation()}).on("click.bs.dropdown.data-api",s,o.prototype.toggle).on("keydown.bs.dropdown.data-api",s,o.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="menu"]',o.prototype.keydown).on("keydown.bs.dropdown.data-api",'[role="listbox"]',o.prototype.keydown)}(jQuery),+function(e){"use strict";function t(t,r){return this.each(function(){var i=e(this),s=i.data("bs.modal"),o=e.extend({},n.DEFAULTS,i.data(),"object"==typeof t&&t);s||i.data("bs.modal",s=new n(this,o)),"string"==typeof t?s[t](r):o.show&&s.show(r)})}var n=function(t,n){this.options=n,this.$body=e(document.body),this.$element=e(t),this.$backdrop=this.isShown=null,this.scrollbarWidth=0,this.options.remote&&this.$element.find(".modal-content").load(this.options.remote,e.proxy(function(){this.$element.trigger("loaded.bs.modal")},this))};n.VERSION="3.3.0",n.TRANSITION_DURATION=300,n.BACKDROP_TRANSITION_DURATION=150,n.DEFAULTS={backdrop:!0,keyboard:!0,show:!0},n.prototype.toggle=function(e){return this.isShown?this.hide():this.show(e)},n.prototype.show=function(t){var r=this,i=e.Event("show.bs.modal",{relatedTarget:t});this.$element.trigger(i),this.isShown||i.isDefaultPrevented()||(this.isShown=!0,this.checkScrollbar(),this.$body.addClass("modal-open"),this.setScrollbar(),this.escape(),this.$element.on("click.dismiss.bs.modal",'[data-dismiss="modal"]',e.proxy(this.hide,this)),this.backdrop(function(){var i=e.support.transition&&r.$element.hasClass("fade");r.$element.parent().length||r.$element.appendTo(r.$body),r.$element.show().scrollTop(0),i&&r.$element[0].offsetWidth,r.$element.addClass("in").attr("aria-hidden",!1),r.enforceFocus();var s=e.Event("shown.bs.modal",{relatedTarget:t});i?r.$element.find(".modal-dialog").one("bsTransitionEnd",function(){r.$element.trigger("focus").trigger(s)}).emulateTransitionEnd(n.TRANSITION_DURATION):r.$element.trigger("focus").trigger(s)}))},n.prototype.hide=function(t){t&&t.preventDefault(),t=e.Event("hide.bs.modal"),this.$element.trigger(t),this.isShown&&!t.isDefaultPrevented()&&(this.isShown=!1,this.escape(),e(document).off("focusin.bs.modal"),this.$element.removeClass("in").attr("aria-hidden",!0).off("click.dismiss.bs.modal"),e.support.transition&&this.$element.hasClass("fade")?this.$element.one("bsTransitionEnd",e.proxy(this.hideModal,this)).emulateTransitionEnd(n.TRANSITION_DURATION):this.hideModal())},n.prototype.enforceFocus=function(){e(document).off("focusin.bs.modal").on("focusin.bs.modal",e.proxy(function(e){this.$element[0]===e.target||this.$element.has(e.target).length||this.$element.trigger("focus")},this))},n.prototype.escape=function(){this.isShown&&this.options.keyboard?this.$element.on("keydown.dismiss.bs.modal",e.proxy(function(e){27==e.which&&this.hide()},this)):this.isShown||this.$element.off("keydown.dismiss.bs.modal")},n.prototype.hideModal=function(){var e=this;this.$element.hide(),this.backdrop(function(){e.$body.removeClass("modal-open"),e.resetScrollbar(),e.$element.trigger("hidden.bs.modal")})},n.prototype.removeBackdrop=function(){this.$backdrop&&this.$backdrop.remove(),this.$backdrop=null},n.prototype.backdrop=function(t){var r=this,i=this.$element.hasClass("fade")?"fade":"";if(this.isShown&&this.options.backdrop){var s=e.support.transition&&i;if(this.$backdrop=e('<div class="modal-backdrop '+i+'" />').prependTo(this.$element).on("click.dismiss.bs.modal",e.proxy(function(e){e.target===e.currentTarget&&("static"==this.options.backdrop?this.$element[0].focus.call(this.$element[0]):this.hide.call(this))},this)),s&&this.$backdrop[0].offsetWidth,this.$backdrop.addClass("in"),!t)return;s?this.$backdrop.one("bsTransitionEnd",t).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):t()}else if(!this.isShown&&this.$backdrop){this.$backdrop.removeClass("in");var o=function(){r.removeBackdrop(),t&&t()};e.support.transition&&this.$element.hasClass("fade")?this.$backdrop.one("bsTransitionEnd",o).emulateTransitionEnd(n.BACKDROP_TRANSITION_DURATION):o()}else t&&t()},n.prototype.checkScrollbar=function(){this.scrollbarWidth=this.measureScrollbar()},n.prototype.setScrollbar=function(){var e=parseInt(this.$body.css("padding-right")||0,10);this.scrollbarWidth&&this.$body.css("padding-right",e+this.scrollbarWidth)},n.prototype.resetScrollbar=function(){this.$body.css("padding-right","")},n.prototype.measureScrollbar=function(){if(document.body.clientWidth>=window.innerWidth)return 0;var e=document.createElement("div");e.className="modal-scrollbar-measure",this.$body.append(e);var t=e.offsetWidth-e.clientWidth;return this.$body[0].removeChild(e),t};var r=e.fn.modal;e.fn.modal=t,e.fn.modal.Constructor=n,e.fn.modal.noConflict=function(){return e.fn.modal=r,this},e(document).on("click.bs.modal.data-api",'[data-toggle="modal"]',function(n){var r=e(this),i=r.attr("href"),s=e(r.attr("data-target")||i&&i.replace(/.*(?=#[^\s]+$)/,"")),o=s.data("bs.modal")?"toggle":e.extend({remote:!/#/.test(i)&&i},s.data(),r.data());r.is("a")&&n.preventDefault(),s.one("show.bs.modal",function(e){e.isDefaultPrevented()||s.one("hidden.bs.modal",function(){r.is(":visible")&&r.trigger("focus")})}),t.call(s,o,this)})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.tooltip"),s="object"==typeof t&&t,o=s&&s.selector;(i||"destroy"!=t)&&(o?(i||r.data("bs.tooltip",i={}),i[o]||(i[o]=new n(this,s))):i||r.data("bs.tooltip",i=new n(this,s)),"string"==typeof t&&i[t]())})}var n=function(e,t){this.type=this.options=this.enabled=this.timeout=this.hoverState=this.$element=null,this.init("tooltip",e,t)};n.VERSION="3.3.0",n.TRANSITION_DURATION=150,n.DEFAULTS={animation:!0,placement:"top",selector:!1,template:'<div class="tooltip" role="tooltip"><div class="tooltip-arrow"></div><div class="tooltip-inner"></div></div>',trigger:"hover focus",title:"",delay:0,html:!1,container:!1,viewport:{selector:"body",padding:0}},n.prototype.init=function(t,n,r){this.enabled=!0,this.type=t,this.$element=e(n),this.options=this.getOptions(r),this.$viewport=this.options.viewport&&e(this.options.viewport.selector||this.options.viewport);for(var i=this.options.trigger.split(" "),s=i.length;s--;){var o=i[s];if("click"==o)this.$element.on("click."+this.type,this.options.selector,e.proxy(this.toggle,this));else if("manual"!=o){var u="hover"==o?"mouseenter":"focusin",f="hover"==o?"mouseleave":"focusout";this.$element.on(u+"."+this.type,this.options.selector,e.proxy(this.enter,this)),this.$element.on(f+"."+this.type,this.options.selector,e.proxy(this.leave,this))}}this.options.selector?this._options=e.extend({},this.options,{trigger:"manual",selector:""}):this.fixTitle()},n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.getOptions=function(t){return t=e.extend({},this.getDefaults(),this.$element.data(),t),t.delay&&"number"==typeof t.delay&&(t.delay={show:t.delay,hide:t.delay}),t},n.prototype.getDelegateOptions=function(){var t={},n=this.getDefaults();return this._options&&e.each(this._options,function(e,r){n[e]!=r&&(t[e]=r)}),t},n.prototype.enter=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n&&n.$tip&&n.$tip.is(":visible")?void (n.hoverState="in"):(n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="in",n.options.delay&&n.options.delay.show?void (n.timeout=setTimeout(function(){"in"==n.hoverState&&n.show()},n.options.delay.show)):n.show())},n.prototype.leave=function(t){var n=t instanceof this.constructor?t:e(t.currentTarget).data("bs."+this.type);return n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n)),clearTimeout(n.timeout),n.hoverState="out",n.options.delay&&n.options.delay.hide?void (n.timeout=setTimeout(function(){"out"==n.hoverState&&n.hide()},n.options.delay.hide)):n.hide()},n.prototype.show=function(){var t=e.Event("show.bs."+this.type);if(this.hasContent()&&this.enabled){this.$element.trigger(t);var r=e.contains(this.$element[0].ownerDocument.documentElement,this.$element[0]);if(t.isDefaultPrevented()||!r)return;var i=this,s=this.tip(),o=this.getUID(this.type);this.setContent(),s.attr("id",o),this.$element.attr("aria-describedby",o),this.options.animation&&s.addClass("fade");var u="function"==typeof this.options.placement?this.options.placement.call(this,s[0],this.$element[0]):this.options.placement,f=/\s?auto?\s?/i,l=f.test(u);l&&(u=u.replace(f,"")||"top"),s.detach().css({top:0,left:0,display:"block"}).addClass(u).data("bs."+this.type,this),this.options.container?s.appendTo(this.options.container):s.insertAfter(this.$element);var h=this.getPosition(),p=s[0].offsetWidth,d=s[0].offsetHeight;if(l){var v=u,m=this.options.container?e(this.options.container):this.$element.parent(),g=this.getPosition(m);u="bottom"==u&&h.bottom+d>g.bottom?"top":"top"==u&&h.top-d<g.top?"bottom":"right"==u&&h.right+p>g.width?"left":"left"==u&&h.left-p<g.left?"right":u,s.removeClass(v).addClass(u)}var y=this.getCalculatedOffset(u,h,p,d);this.applyPlacement(y,u);var b=function(){var e=i.hoverState;i.$element.trigger("shown.bs."+i.type),i.hoverState=null,"out"==e&&i.leave(i)};e.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",b).emulateTransitionEnd(n.TRANSITION_DURATION):b()}},n.prototype.applyPlacement=function(t,n){var r=this.tip(),i=r[0].offsetWidth,s=r[0].offsetHeight,o=parseInt(r.css("margin-top"),10),u=parseInt(r.css("margin-left"),10);isNaN(o)&&(o=0),isNaN(u)&&(u=0),t.top=t.top+o,t.left=t.left+u,e.offset.setOffset(r[0],e.extend({using:function(e){r.css({top:Math.round(e.top),left:Math.round(e.left)})}},t),0),r.addClass("in");var f=r[0].offsetWidth,l=r[0].offsetHeight;"top"==n&&l!=s&&(t.top=t.top+s-l);var c=this.getViewportAdjustedDelta(n,t,f,l);c.left?t.left+=c.left:t.top+=c.top;var h=/top|bottom/.test(n),p=h?2*c.left-i+f:2*c.top-s+l,d=h?"offsetWidth":"offsetHeight";r.offset(t),this.replaceArrow(p,r[0][d],h)},n.prototype.replaceArrow=function(e,t,n){this.arrow().css(n?"left":"top",50*(1-e/t)+"%").css(n?"top":"left","")},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle();e.find(".tooltip-inner")[this.options.html?"html":"text"](t),e.removeClass("fade in top bottom left right")},n.prototype.hide=function(t){function r(){"in"!=i.hoverState&&s.detach(),i.$element.removeAttr("aria-describedby").trigger("hidden.bs."+i.type),t&&t()}var i=this,s=this.tip(),o=e.Event("hide.bs."+this.type);return this.$element.trigger(o),o.isDefaultPrevented()?void 0:(s.removeClass("in"),e.support.transition&&this.$tip.hasClass("fade")?s.one("bsTransitionEnd",r).emulateTransitionEnd(n.TRANSITION_DURATION):r(),this.hoverState=null,this)},n.prototype.fixTitle=function(){var e=this.$element;(e.attr("title")||"string"!=typeof e.attr("data-original-title"))&&e.attr("data-original-title",e.attr("title")||"").attr("title","")},n.prototype.hasContent=function(){return this.getTitle()},n.prototype.getPosition=function(t){t=t||this.$element;var n=t[0],r="BODY"==n.tagName,i=n.getBoundingClientRect();null==i.width&&(i=e.extend({},i,{width:i.right-i.left,height:i.bottom-i.top}));var s=r?{top:0,left:0}:t.offset(),o={scroll:r?document.documentElement.scrollTop||document.body.scrollTop:t.scrollTop()},u=r?{width:e(window).width(),height:e(window).height()}:null;return e.extend({},i,o,u,s)},n.prototype.getCalculatedOffset=function(e,t,n,r){return"bottom"==e?{top:t.top+t.height,left:t.left+t.width/2-n/2}:"top"==e?{top:t.top-r,left:t.left+t.width/2-n/2}:"left"==e?{top:t.top+t.height/2-r/2,left:t.left-n}:{top:t.top+t.height/2-r/2,left:t.left+t.width}},n.prototype.getViewportAdjustedDelta=function(e,t,n,r){var i={top:0,left:0};if(!this.$viewport)return i;var s=this.options.viewport&&this.options.viewport.padding||0,o=this.getPosition(this.$viewport);if(/right|left/.test(e)){var u=t.top-s-o.scroll,a=t.top+s-o.scroll+r;u<o.top?i.top=o.top-u:a>o.top+o.height&&(i.top=o.top+o.height-a)}else{var f=t.left-s,l=t.left+s+n;f<o.left?i.left=o.left-f:l>o.width&&(i.left=o.left+o.width-l)}return i},n.prototype.getTitle=function(){var e,t=this.$element,n=this.options;return e=t.attr("data-original-title")||("function"==typeof n.title?n.title.call(t[0]):n.title)},n.prototype.getUID=function(e){do e+=~~(1e6*Math.random());while(document.getElementById(e));return e},n.prototype.tip=function(){return this.$tip=this.$tip||e(this.options.template)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".tooltip-arrow")},n.prototype.enable=function(){this.enabled=!0},n.prototype.disable=function(){this.enabled=!1},n.prototype.toggleEnabled=function(){this.enabled=!this.enabled},n.prototype.toggle=function(t){var n=this;t&&(n=e(t.currentTarget).data("bs."+this.type),n||(n=new this.constructor(t.currentTarget,this.getDelegateOptions()),e(t.currentTarget).data("bs."+this.type,n))),n.tip().hasClass("in")?n.leave(n):n.enter(n)},n.prototype.destroy=function(){var e=this;clearTimeout(this.timeout),this.hide(function(){e.$element.off("."+e.type).removeData("bs."+e.type)})};var r=e.fn.tooltip;e.fn.tooltip=t,e.fn.tooltip.Constructor=n,e.fn.tooltip.noConflict=function(){return e.fn.tooltip=r,this}}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.popover"),s="object"==typeof t&&t,o=s&&s.selector;(i||"destroy"!=t)&&(o?(i||r.data("bs.popover",i={}),i[o]||(i[o]=new n(this,s))):i||r.data("bs.popover",i=new n(this,s)),"string"==typeof t&&i[t]())})}var n=function(e,t){this.init("popover",e,t)};if(!e.fn.tooltip)throw new Error("Popover requires tooltip.js");n.VERSION="3.3.0",n.DEFAULTS=e.extend({},e.fn.tooltip.Constructor.DEFAULTS,{placement:"right",trigger:"click",content:"",template:'<div class="popover" role="tooltip"><div class="arrow"></div><h3 class="popover-title"></h3><div class="popover-content"></div></div>'}),n.prototype=e.extend({},e.fn.tooltip.Constructor.prototype),n.prototype.constructor=n,n.prototype.getDefaults=function(){return n.DEFAULTS},n.prototype.setContent=function(){var e=this.tip(),t=this.getTitle(),n=this.getContent();e.find(".popover-title")[this.options.html?"html":"text"](t),e.find(".popover-content").children().detach().end()[this.options.html?"string"==typeof n?"html":"append":"text"](n),e.removeClass("fade top bottom left right in"),e.find(".popover-title").html()||e.find(".popover-title").hide()},n.prototype.hasContent=function(){return this.getTitle()||this.getContent()},n.prototype.getContent=function(){var e=this.$element,t=this.options;return e.attr("data-content")||("function"==typeof t.content?t.content.call(e[0]):t.content)},n.prototype.arrow=function(){return this.$arrow=this.$arrow||this.tip().find(".arrow")},n.prototype.tip=function(){return this.$tip||(this.$tip=e(this.options.template)),this.$tip};var r=e.fn.popover;e.fn.popover=t,e.fn.popover.Constructor=n,e.fn.popover.noConflict=function(){return e.fn.popover=r,this}}(jQuery),+function(e){"use strict";function t(n,r){var i=e.proxy(this.process,this);this.$body=e("body"),this.$scrollElement=e(e(n).is("body")?window:n),this.options=e.extend({},t.DEFAULTS,r),this.selector=(this.options.target||"")+" .nav li > a",this.offsets=[],this.targets=[],this.activeTarget=null,this.scrollHeight=0,this.$scrollElement.on("scroll.bs.scrollspy",i),this.refresh(),this.process()}function n(n){return this.each(function(){var r=e(this),i=r.data("bs.scrollspy"),s="object"==typeof n&&n;i||r.data("bs.scrollspy",i=new t(this,s)),"string"==typeof n&&i[n]()})}t.VERSION="3.3.0",t.DEFAULTS={offset:10},t.prototype.getScrollHeight=function(){return this.$scrollElement[0].scrollHeight||Math.max(this.$body[0].scrollHeight,document.documentElement.scrollHeight)},t.prototype.refresh=function(){var t="offset",n=0;e.isWindow(this.$scrollElement[0])||(t="position",n=this.$scrollElement.scrollTop()),this.offsets=[],this.targets=[],this.scrollHeight=this.getScrollHeight();var r=this;this.$body.find(this.selector).map(function(){var r=e(this),i=r.data("target")||r.attr("href"),s=/^#./.test(i)&&e(i);return s&&s.length&&s.is(":visible")&&[[s[t]().top+n,i]]||null}).sort(function(e,t){return e[0]-t[0]}).each(function(){r.offsets.push(this[0]),r.targets.push(this[1])})},t.prototype.process=function(){var e,t=this.$scrollElement.scrollTop()+this.options.offset,n=this.getScrollHeight(),r=this.options.offset+n-this.$scrollElement.height(),i=this.offsets,s=this.targets,o=this.activeTarget;if(this.scrollHeight!=n&&this.refresh(),t>=r)return o!=(e=s[s.length-1])&&this.activate(e);if(o&&t<i[0])return this.activeTarget=null,this.clear();for(e=i.length;e--;)o!=s[e]&&t>=i[e]&&(!i[e+1]||t<=i[e+1])&&this.activate(s[e])},t.prototype.activate=function(t){this.activeTarget=t,this.clear();var n=this.selector+'[data-target="'+t+'"],'+this.selector+'[href="'+t+'"]',r=e(n).parents("li").addClass("active");r.parent(".dropdown-menu").length&&(r=r.closest("li.dropdown").addClass("active")),r.trigger("activate.bs.scrollspy")},t.prototype.clear=function(){e(this.selector).parentsUntil(this.options.target,".active").removeClass("active")};var r=e.fn.scrollspy;e.fn.scrollspy=n,e.fn.scrollspy.Constructor=t,e.fn.scrollspy.noConflict=function(){return e.fn.scrollspy=r,this},e(window).on("load.bs.scrollspy.data-api",function(){e('[data-spy="scroll"]').each(function(){var t=e(this);n.call(t,t.data())})})}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.tab");i||r.data("bs.tab",i=new n(this)),"string"==typeof t&&i[t]()})}var n=function(t){this.element=e(t)};n.VERSION="3.3.0",n.TRANSITION_DURATION=150,n.prototype.show=function(){var t=this.element,n=t.closest("ul:not(.dropdown-menu)"),r=t.data("target");if(r||(r=t.attr("href"),r=r&&r.replace(/.*(?=#[^\s]*$)/,"")),!t.parent("li").hasClass("active")){var i=n.find(".active:last a"),s=e.Event("hide.bs.tab",{relatedTarget:t[0]}),o=e.Event("show.bs.tab",{relatedTarget:i[0]});if(i.trigger(s),t.trigger(o),!o.isDefaultPrevented()&&!s.isDefaultPrevented()){var u=e(r);this.activate(t.closest("li"),n),this.activate(u,u.parent(),function(){i.trigger({type:"hidden.bs.tab",relatedTarget:t[0]}),t.trigger({type:"shown.bs.tab",relatedTarget:i[0]})})}}},n.prototype.activate=function(t,r,i){function s(){o.removeClass("active").find("> .dropdown-menu > .active").removeClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!1),t.addClass("active").find('[data-toggle="tab"]').attr("aria-expanded",!0),u?(t[0].offsetWidth,t.addClass("in")):t.removeClass("fade"),t.parent(".dropdown-menu")&&t.closest("li.dropdown").addClass("active").end().find('[data-toggle="tab"]').attr("aria-expanded",!0),i&&i()}var o=r.find("> .active"),u=i&&e.support.transition&&(o.length&&o.hasClass("fade")||!!r.find("> .fade").length);o.length&&u?o.one("bsTransitionEnd",s).emulateTransitionEnd(n.TRANSITION_DURATION):s(),o.removeClass("in")};var r=e.fn.tab;e.fn.tab=t,e.fn.tab.Constructor=n,e.fn.tab.noConflict=function(){return e.fn.tab=r,this};var i=function(n){n.preventDefault(),t.call(e(this),"show")};e(document).on("click.bs.tab.data-api",'[data-toggle="tab"]',i).on("click.bs.tab.data-api",'[data-toggle="pill"]',i)}(jQuery),+function(e){"use strict";function t(t){return this.each(function(){var r=e(this),i=r.data("bs.affix"),s="object"==typeof t&&t;i||r.data("bs.affix",i=new n(this,s)),"string"==typeof t&&i[t]()})}var n=function(t,r){this.options=e.extend({},n.DEFAULTS,r),this.$target=e(this.options.target).on("scroll.bs.affix.data-api",e.proxy(this.checkPosition,this)).on("click.bs.affix.data-api",e.proxy(this.checkPositionWithEventLoop,this)),this.$element=e(t),this.affixed=this.unpin=this.pinnedOffset=null,this.checkPosition()};n.VERSION="3.3.0",n.RESET="affix affix-top affix-bottom",n.DEFAULTS={offset:0,target:window},n.prototype.getState=function(e,t,n,r){var i=this.$target.scrollTop(),s=this.$element.offset(),o=this.$target.height();if(null!=n&&"top"==this.affixed)return n>i?"top":!1;if("bottom"==this.affixed)return null!=n?i+this.unpin<=s.top?!1:"bottom":e-r>=i+o?!1:"bottom";var u=null==this.affixed,a=u?i:s.top,f=u?o:t;return null!=n&&n>=a?"top":null!=r&&a+f>=e-r?"bottom":!1},n.prototype.getPinnedOffset=function(){if(this.pinnedOffset)return this.pinnedOffset;this.$element.removeClass(n.RESET).addClass("affix");var e=this.$target.scrollTop(),t=this.$element.offset();return this.pinnedOffset=t.top-e},n.prototype.checkPositionWithEventLoop=function(){setTimeout(e.proxy(this.checkPosition,this),1)},n.prototype.checkPosition=function(){if(this.$element.is(":visible")){var t=this.$element.height(),r=this.options.offset,i=r.top,s=r.bottom,o=e("body").height();"object"!=typeof r&&(s=i=r),"function"==typeof i&&(i=r.top(this.$element)),"function"==typeof s&&(s=r.bottom(this.$element));var u=this.getState(o,t,i,s);if(this.affixed!=u){null!=this.unpin&&this.$element.css("top","");var f="affix"+(u?"-"+u:""),l=e.Event(f+".bs.affix");if(this.$element.trigger(l),l.isDefaultPrevented())return;this.affixed=u,this.unpin="bottom"==u?this.getPinnedOffset():null,this.$element.removeClass(n.RESET).addClass(f).trigger(f.replace("affix","affixed")+".bs.affix")}"bottom"==u&&this.$element.offset({top:o-t-s})}};var r=e.fn.affix;e.fn.affix=t,e.fn.affix.Constructor=n,e.fn.affix.noConflict=function(){return e.fn.affix=r,this},e(window).on("load",function(){e('[data-spy="affix"]').each(function(){var n=e(this),r=n.data();r.offset=r.offset||{},null!=r.offsetBottom&&(r.offset.bottom=r.offsetBottom),null!=r.offsetTop&&(r.offset.top=r.offsetTop),t.call(n,r)})})}(jQuery),define("bootstrap",["jquery"],function(){}),define("kbaseButtonControls",["jquery","bootstrap","kbwidget","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseButtonControls",version:"1.0.0",options:{controls:[],onMouseover:!0,position:"top",type:"floating",posOffset:"0px"},init:function(t){return this._super(t),this._controls={},this.appendUI(e(this.$elem)),this},bounds:function(e){var t=e.offset();return new Rectangle(new Point(t.left,t.top),new Size(e.width(),e.height()))},visibleBounds:function(e){var t=this.bounds(e),n=0;while(e=e.parent()){var r=this.bounds(e);t=t.intersectRect(r);if(n++>1e3)break;if(e.prop("tagName").toLowerCase()=="body")break}return t},appendUI:function(t){this.options.type=="floating"&&(t.css("position","relative"),t.append(e.jqElem("style").text(".tooltip { position : fixed }")));var n=e("<div></div>").addClass("btn-group btn-group-xs").attr("id","control-buttons");this.options.type=="floating"&&n.css("right","0px").css(this.options.position,this.options.posOffset).css("position","absolute").css("margin-right","3px").attr("z-index",1e4),t.prepend(n),this._rewireIds(t,this);if(this.options.onMouseover&&this.options.type=="floating"){var r=!1,i=!1,s=this;t.mouseover(function(t){t.preventDefault(),t.stopPropagation(),window._active_kbaseButtonControls!=undefined&&window._active_kbaseButtonControls.hide(),e(this).children().first().show(),window._active_kbaseButtonControls=n,i=!0}).mouseout(function(e){e.preventDefault(),e.stopPropagation();var r=s.bounds(n),o=s.visibleBounds(n),u=s.bounds(t),a=u.intersectRect(r);o.containsPoint(new Point(e.pageX,e.pageY))||(window._active_kbaseButtonControls.hide(),window._active_kbaseButtonControls=undefined),i=!1}).children().first().hide()}return this.setControls(this.options.controls),this},controls:function(e){return e?this._controls[e]:this._controls},setControls:function(t){this.data("control-buttons").empty();for(control in this._controls)this._controls[control]=undefined;var n=this;e.each(t,e.proxy(function(t,r){if(r.condition&&r.condition.call(this,r,n.options.context,this.$elem)==0)return;var i="btn btn-default";r.type&&(i=i+" btn-"+r.type),tooltip=r.tooltip,typeof r.tooltip=="string"&&(tooltip={title:r.tooltip}),tooltip!=undefined&&tooltip.container==undefined&&(tooltip.container=this.data("control-buttons")),tooltip!=undefined&&tooltip.placement==undefined&&(tooltip.placement="top"),tooltip!=undefined&&(tooltip.delay=1);var s=e("<button></button>").attr("href","#").css("padding-top","1px").css("padding-bottom","1px").attr("class",i).append(e("<i></i>").addClass(r.icon)).tooltip(tooltip).on("click",function(t){t.preventDefault(),t.stopPropagation(),r["icon-alt"]&&(e(this).children().first().toggleClass(r.icon),e(this).children().first().toggleClass(r["icon-alt"])),r.callback.call(this,t,n.options.context)});r.id&&(this._controls[r.id]=s),this.options.id&&s.data("id",this.options.id),this.data("control-buttons").append(s)},this))}})}),define("kbaseBox",["jquery","kbwidget","kbaseButtonControls"],function(e){e.KBWidget({name:"kbaseBox",version:"1.0.0",options:{canCollapse:!0,canCollapseOnDoubleClick:!1,controls:[],bannerColor:"lightgray",boxColor:"lightgray",displayTitle:!0},init:function(t){return this._super(t),this.options.canCollapse&&this.options.controls.push({icon:"fa fa-caret-up","icon-alt":"fa fa-caret-down",tooltip:{title:"collapse / expand",placement:"bottom"},callback:e.proxy(function(e){this.data("content").slideToggle()},this)}),this.appendUI(e(this.$elem)),this},setBannerColor:function(e){this.data("banner").css("background-color",e)},startThinking:function(){this.data("thinking").css("display","inline")},stopThinking:function(){this.data("thinking").css("display","none")},appendUI:function(t){var n=this.options.canCollapse,r=e("<div></div>").append(e("<div></div>").css("text-align","left").css("font-size","70%").css("color","gray").append(this.options.precontent)).append(e("<div></div>").css("border","1px solid "+this.options.boxColor).css("padding","2px").append(e("<div></div>").attr("id","banner").css("width","100%").css("height","24px").css("margin-bottom","0px").css("box-shadow","none").css("background-color",this.options.bannerColor).css("border-radius","0px").append(e("<h5></h5>").attr("id","banner-text").addClass("text-left").css("text-align","left").css("text-shadow","none").css("color","black").css("font-size","14px").addClass("bar").css("padding","2px").css("margin","0px").css("position","relative").css("width","100%").bind("dblclick",function(t){t.preventDefault(),t.stopPropagation(),canCollapseOnDoubleClick&&e(this).parent().parent().children().last().collapse("toggle")}).append(e("<span></span>").attr("id","title")).append(e("<span></span>").attr("id","thinking").css("display","none").append("&nbsp;&nbsp;").append(e.jqElem("i").addClass("fa fa-spinner fa fa-spin"))))).append(e("<div></div>").attr("id","content"))).append(e("<div></div>").css("text-align","right").css("font-size","70%").css("color","gray").append(this.options.postcontent));return this._rewireIds(r,this),this.options.controls&&this.data("banner-text").kbaseButtonControls({onMouseover:!1,controls:this.options.controls}),this.options.displayTitle||this.data("banner").css("display","none"),this.setTitle(this.options.title),this.setContent(this.options.content),t.append(r),this},setTitle:function(e){this.data("title").empty(),this.data("title").append(e)},setContent:function(e){this.data("content").empty(),this.data("content").append(e)},content:function(){return this.data("content")},controls:function(e){return this.data("banner-text").kbaseButtonControls("controls",e)}})}),define("kbaseIrisProcessList",["jquery","kbwidget","kbaseBox"],function(e){e.KBWidget({name:"kbaseIrisProcessList",version:"1.0.0",_accessors:["processList"],options:{processList:{}},init:function(t){return this._super(t),e(document).on("updateIrisProcess.kbaseIris",e.proxy(function(e,t){this.updateProcess(e,t)},this)),e(document).on("removeIrisProcess.kbaseIris",e.proxy(function(e,t){this.removeProcess(e,t)},this)),e(document).on("clearIrisProcesses.kbaseIris",e.proxy(function(e){this.clearProcesses(e)},this)),this.appendUI(this.$elem),this},clearProcesses:function(t){var n=Object.keys(this.processList());e.each(n,e.proxy(function(e,n){this.removeProcess(t,n)},this))},updateProcess:function(t,n){var r=n.pid;if(r==undefined)throw"Cannot update process w/o pid";this.pendingLi().remove();var i=this.processList()[r]!=undefined?this.processList()[r]:e.jqElem("li");return i.empty(),n.msg?i.text(n.msg):n.content&&i.append(n.content),this.processList()[r]==undefined&&(this.$elem.find("ul").append(i),this.processList()[r]=i),i},removeProcess:function(e,t){if(t==undefined)throw"Cannot update process w/o pid";var n=this.processList()[t];if(n==undefined)return;return n.remove(),this.$elem.find("ul").children().length==0&&this.$elem.find("ul").append(this.pendingLi()),this.processList()[t]=undefined,t},appendUI:function(t){var n=t.kbaseBox({title:"Running processes",content:e("<ul></ul>").addClass("unstyled").append(this.pendingLi())});return this},pendingLi:function(){return this.data("pendingLi")==undefined&&this.data("pendingLi",e("<li></li>").css("font-style","italic").text("No processes running")),this.data("pendingLi")}})}),define("kbaseIrisTutorial",["jquery","kbwidget","kbaseIrisConfig"],function(e){e.KBWidget({name:"kbaseIrisTutorial",version:"1.0.0",options:{config_url:window.kbaseIrisConfig.tutorial.config_url,default_tutorial:window.kbaseIrisConfig.tutorial.default_tutorial},format_tutorial_url:function(e,t,n){var r=e;return r=r.replace(/\$repo/,t),r=r.replace(/\$filespec/,n),r},list:function(){var e=[];for(key in this.repos)for(var t=0;t<this.repos[key].length;t++){var n=this.repos[key][t],r=this.format_tutorial_url(this.doc_format_string,key,n.file);e.push({title:n.title,url:r})}return e},init:function(t){return this._super(t),this.pages=[],this._currentPage=-1,e.getJSON(this.options.config_url,e.proxy(function(e){this.repos=e.repos,this.doc_format_string=e.doc_format_string,this.options.default_tutorial==undefined&&(this.options.default_tutorial=e.default),this.options.default_tutorial&&this.retrieveTutorial(this.options.default_tutorial)},this)),this},retrieveTutorial:function(t){this.pages=[];var n=undefined;e.ajax({async:!0,dataType:"text",url:t,crossDomain:!0,beforeSend:function(e){n&&e.setRequestHeader("Authorization",n)},success:e.proxy(function(t,n,r){var i=e.jqElem("div").append(t);e.each(i.children(),e.proxy(function(t,n){e(n).find(".example").remove(),this.pages.push(e(n))},this)),this.renderAsHTML()},this),error:e.proxy(function(e,t,n){throw this.dbg(e),e},this),type:"GET"})},renderAsHTML:function(){this.$elem.empty(),e.each(this.pages,e.proxy(function(e,t){this.$elem.append(t)},this))},lastPage:function(){return this.pages.length-1},currentPage:function(){return page=this._currentPage,this._currentPage<0&&(page=0),this.pages[page]},goToPrevPage:function(){var e=this._currentPage-1;return e<0&&(e=0),this._currentPage=e,e},goToNextPage:function(){var e=this._currentPage+1;return e>=this.pages.length&&(e=this.pages.length-1),this._currentPage=e,e},contentForPage:function(t,n){if(this.pages.length==0)return undefined;var r=this.pages[this._currentPage];return r.find("a").attr("target","_blank"),n!=undefined&&r.find("a[data-input-link]").on("click",function(t){n.appendAndFocusInput(e(this).text())}),r},contentForCurrentPage:function(e){return this.contentForPage(this._currentPage,e)},list_text:function(e){return this.command_text("tutorial list","tutorial list","to see available tutorials.",e)},next_text:function(e){return this.command_text("next","next","to move to the next step in the tutorial.",e)},back_text:function(e){return this.command_text("back","back","to move to the previous step in the tutorial.",e)},command_text:function(t,n,r,i){if(i==undefined)throw"Cannot create command_text w/o handler";return e.jqElem("span").append("<br>").append("Type ").append(e.jqElem("i").append(e.jqElem("a").append(t).on("click",e.proxy(function(e){i.run(n)},i)))).append(" "+r)}})}),define("kbaseAuthenticatedWidget",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbaseAuthenticatedWidget",version:"1.0.0",_accessors:[{name:"auth",setter:"setAuth"},"sessionId","authToken","user_id","loggedInCallback","logInCanceledCallback","loggedOutCallback","loggedInQueryCallback"],options:{auth:undefined},init:function(t){return this._super(t),e(document).on("loggedIn.kbase",e.proxy(function(e,t){this.setAuth(t),this.loggedInCallback&&this.loggedInCallback(e,t)},this)),e(document).on("loggedOut.kbase",e.proxy(function(e){this.setAuth(undefined),this.loggedOutCallback&&this.loggedOutCallback(e)},this)),e(document).on("logInCanceled.kbase",e.proxy(function(e){this.setAuth(undefined),this.logInCanceledCallback&&this.logInCanceledCallback(e)},this)),e(document).trigger("loggedInQuery",e.proxy(function(t){this.setAuth(t),t.kbase_sessionid&&this.callAfterInit(e.proxy(function(){this.loggedInQueryCallback&&this.loggedInQueryCallback(t)},this))},this)),this},setAuth:function(e){this.setValueForKey("auth",e),e==undefined&&(e={}),this.sessionId(e.kbase_sessionid),this.authToken(e.token),this.user_id(e.user_id)},loggedInQueryCallback:function(e){this.loggedInCallback&&this.loggedInCallback(undefined,e)}})}),define("kbaseDataBrowser",["jquery","kbaseAuthenticatedWidget","kbaseButtonControls","kbaseBox"],function(e){e.KBWidget({name:"kbaseDataBrowser",parent:"kbaseAuthenticatedWidget",version:"1.0.0",options:{title:"Data Browser",canCollapse:!0,height:"200px",types:{file:{icon:"fa fa-file-o"},folder:{icon:"fa fa-folder-o","icon-alt":"fa fa-folder-open-o",expandable:!0}},content:[]},init:function(e){return this.targets={},this.openTargets={},this._super(e),this.appendUI(this.$elem),this},sortByName:function(e,t){return e.name.toLowerCase()<t.name.toLowerCase()?-1:e.name.toLowerCase()>t.name.toLowerCase()?1:0},appendContent:function(t,n){return e.each(t,e.proxy(function(t,r){var i=r.icon,s=r["fa fa-open"];i==undefined&&r.type!=undefined&&(i=this.options.types[r.type].icon,s=this.options.types[r.type]["fa fa-open"]),r.expandable==undefined&&r.type!=undefined&&(r.expandable=this.options.types[r.type].expandable);var o=e("<i></i>").addClass(r.open?s:i).css("color","gray"),u=e("<li></li>").attr("id",r.id).css("cursor","pointer").append(e("<a></a>").css("padding","3px 5px 3px 5px").append(o).append(" ").append(r.label));r.data&&u.data("data",r.data),r.id&&(u.data("id",r.id),this.targets[r.id]=u),n.append(u);if(r.expandable){var a=e("<ul></ul>").addClass("databrowser-nav list-group").css("margin-bottom","0px");r.open||a.hide(),r.children!=undefined&&this.appendContent(r.children,a),n.append(a);var f=r.childrenCallback;r.children==undefined&&f==undefined&&r.type!=undefined&&(f=this.options.types[r.type].childrenCallback),u.bind("click",e.proxy(function(t){t.preventDefault(),t.stopPropagation(),o.toggleClass(s),o.toggleClass(i),a.is(":hidden")&&f!=undefined?f.call(this,r.id,e.proxy(function(e){a.empty(),this.appendContent(e,a),a.show("collapse"),this.openTargets[r.id]=!0},this)):a.is(":hidden")?(a.show("collapse"),this.openTargets[r.id]=!0):(a.hide("collapse"),this.openTargets[r.id]=!1)},this)),r.open&&r.children==undefined&&f!=undefined&&(o.toggleClass(s),o.toggleClass(i),a.hide(),u.trigger("click"))}var l=this.options.types[r.type].leafCallback;!r.expandable&&l!=undefined&&u.bind("click",e.proxy(function(e){e.preventDefault(),e.stopPropagation(),l.call(this,r,u)},this));var c=r.controls;c==undefined&&r.type!=undefined&&(c=this.options.types[r.type].controls),c&&u.kbaseButtonControls({controls:c,id:r.id,context:this})},this)),this._rewireIds(n,this),n},prepareRootContent:function(){return e("<ul></ul>").addClass("databrowser-nav list-group").css("margin-bottom","0px").css("height",this.options.height).css("overflow","auto").attr("id","ul-nav")},appendUI:function(e){var t=this.prepareRootContent();return this._rewireIds(t,this),this.appendContent(this.options.content,this.data("ul-nav")),e.kbaseBox({title:this.options.title,canCollapse:this.options.canCollapse,content:t,postcontent:this.options.postcontent}),e}})}),define("kbasePrompt",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbasePrompt",version:"1.0.0",options:{controls:["cancelButton","okayButton"],modalClass:"fade",keyboard:!0},init:function(e){return this._super(e),this},openPrompt:function(){this.dialogModal().modal({keyboard:this.options.keyboard})},closePrompt:function(){this.dialogModal().modal("hide")},cancelButton:function(){return{name:"Cancel",callback:function(e,t){t.closePrompt()}}},okayButton:function(){return{name:"Okay",type:"primary",callback:function(e,t){t.closePrompt()}}},dialogModal:function(){if(this.data("dialogModal")!=undefined)return this.data("dialogModal");var t=e("<div></div>").attr("class","modal "+this.options.modalClass).attr("tabindex","-1").append(e.jqElem("div").addClass("modal-dialog").append(e.jqElem("div").addClass("modal-content").append(e("<div></div>").attr("class","modal-header").append(e("<button></button>").attr("type","button").attr("class","close").attr("data-dismiss","modal").attr("aria-hidden","true").append("x\n")).append(e("<h3></h3>").addClass("modal-title").attr("id","title"))).append(e("<div></div>").attr("class","modal-body").attr("id","body")).append(e("<div></div>").attr("class","modal-footer").append(e("<div></div>").addClass("row").addClass("form-horizontal").append(e("<div></div>").addClass("col-sm-5").addClass("text-left").attr("id","footer")).append(e("<div></div>").addClass("col-sm-7").attr("id","controls").css("white-space","nowrap"))))));t.unbind("keypress"),t.keypress(function(n){n.keyCode==13&&(n.stopPropagation(),n.preventDefault(),e("a:last",t).trigger("click"))}),this._rewireIds(t,t),this.options.title&&t.data("title").append(this.options.title),this.options.body&&t.data("body").append(this.options.body),this.options.footer&&t.data("footer").append(this.options.footer);var n=this;e.each(this.options.controls,function(r,i){typeof i=="string"&&(i=n[i]());var s="btn btn-default";i.type&&(s=s+" btn-"+i.type);var o=e("<a></a>").attr("href","#").attr("class",s).append(i.name).bind("click",function(e){e.preventDefault(),e.stopPropagation(),i.callback.call(this,e,n)});i.id&&o.attr("id",i.id),t.data("controls").append(o)}),this._rewireIds(t,t),this.data("dialogModal",t);var r=undefined,i=!1;return t.on("shown.bs.modal",e.proxy(function(){e.each(t.find("input[type=text],input[type=password],textarea"),function(t,n){r==undefined&&(r=e(n));if(e(n).is("input")&&e(n).val()==undefined){e(n).focus(),i=!0;return}if(e(n).is("textarea")&&e(n).text().length==0){e(n).focus(),i=!0;return}}),!i&&r!=undefined&&r.focus()},this)),t}})}),define("kbaseDeletePrompt",["jquery","kbasePrompt"],function(e){e.KBWidget({name:"kbaseDeletePrompt",parent:"kbasePrompt",version:"1.0.0",options:{controls:["cancelButton","okayButton"]},init:function(t){return this._super(t),e("<div></div>").kbasePrompt({title:"Confirm deletion",body:"Really delete <strong>"+this.options.name+"</strong>?",controls:["cancelButton",{name:"Delete",type:"primary",callback:this.options.callback}]})}})}),define("kbaseIrisFileBrowser",["jquery","kbaseDataBrowser","kbaseButtonControls","kbaseDeletePrompt","kbasePrompt"],function(e){e.KBWidget({name:"kbaseIrisFileBrowser",parent:"kbaseDataBrowser",version:"1.0.0",_accessors:["selectedFiles","invocationURL","client","addFileCallback","editFileCallback","singleFileSize","chunkSize","stalledUploads"],options:{stalledUploads:{},uploadDir:".uploads",concurrentUploads:4,singleFileSize:15e6,chunkSize:5e6,title:"File Browser",pendingUploadJobs:[],root:"/",types:{file:{leafCallback:function(e,t){this.viewFile(e.id)},controls:[{icon:"fa fa-minus",callback:function(t,n){n.deleteFile(e(this).data("id"),"file")},id:"removeButton",tooltip:"delete this file"},{icon:"fa fa-download",callback:function(t,n){n.downloadFile(e(this).data("id"))},id:"dlButton",tooltip:"download this file"},{icon:"fa fa-pencil",callback:function(t,n){n.editFileCallback()!=undefined&&n.editFileCallback()(e(this).data("id"),n)},id:"editButton",tooltip:"edit this file",condition:function(e,t){var n=this.$elem.data("data").size;return n>t.singleFileSize()?!1:t.editFileCallback()==undefined?!1:!0}},{icon:"fa fa-arrow-right",callback:function(t,n){n.addFileCallback()!=undefined&&n.addFileCallback()(e(this).data("id"),n)},id:"addButton",tooltip:"add this file to terminal input"}]},folder:{childrenCallback:function(t,n){this.listDirectory(t,e.proxy(function(e){n(e),this.selectFiles()},this))},controls:[{icon:"fa fa-minus",tooltip:"delete this folder",callback:function(t,n){n.deleteFile(e(this).data("id"),"folder")},id:"removeDirectoryButton"},{icon:"fa fa-file",tooltip:"add a subdirectory",callback:function(t,n){n.addNewFile(e(this).data("id"))},id:"addFileButton"},{icon:"fa fa-plus",tooltip:"add a subdirectory",callback:function(t,n){n.addDirectory(e(this).data("id"))},id:"addDirectoryButton"},{icon:"fa fa-arrow-up",tooltip:"upload a file",callback:function(t,n){n.data("active_directory",e(this).data("id")),n.uploadFile()},id:"uploadFileButton"}]}}},toggleSelection:function(e){this.selectedFiles()[e]=!this.selectedFiles()[e],this.selectedFiles()[e]?this.targets[e].css("border","1px solid green"):this.targets[e].css("border","")},selectFiles:function(){e.each(this.selectedFiles(),e.proxy(function(e,t){t&&this.targets[e].css("border","1px solid green")},this))},uploadFile:function(){this.data("fileInput").trigger("click")},init:function(t){return this._super(t),this.selectedFiles({}),this.listDirectory(this.options.root,e.proxy(function(e){this.appendContent(e,this.data("ul-nav"))},this)),this},checkStalledUploads:function(){this.client().list_files(this.sessionId(),"/",this.options.uploadDir).done(e.proxy(function(t){var n=t[0];e.each(n,e.proxy(function(t,n){this.client().get_file(this.sessionId(),"chunkMap","/"+this.options.uploadDir+"/"+n.name).done(e.proxy(function(e){var t;try{var t=JSON.parse(e)}catch(n){this.dbg("Could not load chunk map"),this.dbg(n)}while(t.chunks.length>0){var r=t.chunks.shift();t.chunksByName[r.name]=r,t.doneChunks.push(r)}this.checkAndMergeChunks(t)},this))},this))},this))},loggedInCallback:function(t,n){n.success&&(this.refreshDirectory("/"),this.client().make_directory(this.sessionId(),"/",this.options.uploadDir).always(e.proxy(function(e){this.checkStalledUploads()},this)))},loggedOutCallback:function(e){this.data("ul-nav").empty()},prepareRootContent:function(){var t=this._super();t.css("height",parseInt(this.options.height)-25+"px");var n=e("<div></div>").css("margin-top","2px");return n.kbaseButtonControls({onMouseover:!1,context:this,controls:[{icon:"fa fa-file",tooltip:"add file",callback:function(e,t){t.addNewFile("/")},id:"addFileButton"},{icon:"fa fa-plus",tooltip:"add directory",callback:function(e,t){t.addDirectory("/")}},{icon:"fa fa-arrow-up",tooltip:"upload a file",callback:function(t,n){n.data("active_directory",e(this).data("id")),n.uploadFile()}}]}),e("<div></div>").css("height",this.options.height).append(t).append(n).append(e("<input></input>").attr("type","file").attr("id","fileInput").css("display","none").attr("multiple","multiple").bind("change",e.proxy(this.handleFileSelect,this)))},refreshDirectory:function(t){if(this.sessionId()==undefined){this.data("ul-nav").empty();return}var n;if(t=="/")n=this.data("ul-nav");else{var r=this.targets[t];if(r==undefined)return;n=r.next()}var i=new RegExp("^"+t),s=[];for(var o in this.targets)o.match(i)&&!this.targets[o].next().is(":hidden")&&this.targets[o].next().is("ul")&&s.push(o);n.is(":hidden")||this.listDirectory(t,e.proxy(function(e){n.empty(),this.appendContent(e,n),this.selectFiles()},this),s),e.each(s,e.proxy(function(t,n){var r=this.targets[n].next();this.listDirectory(n,e.proxy(function(e){r.empty(),this.appendContent(e,r),this.selectFiles(),r.show()},this))},this))},listDirectory:function(t,n){this.client().list_files(this.sessionId(),"/",t,jQuery.proxy(function(t){var r=t[0],i=t[1],s=[],o=this;jQuery.each(r,e.proxy(function(e,t){t.full_path=t.full_path.replace(/\/+/g,"/"),s.push({type:"folder",id:t.full_path,label:t.name,open:o.openTargets[t.full_path]})},this)),jQuery.each(i,e.proxy(function(e,t){t.full_path=t.full_path.replace(/\/+/g,"/"),s.push({type:"file",id:t.full_path,label:t.name,data:t})},this)),s=s.sort(this.sortByKey("label","insensitively")),n(s)},this),e.proxy(function(e){this.dbg(e)},this))},handleFileSelect:function(t){t.preventDefault();var n=t.target.files||t.originalEvent.dataTransfer.files||t.dataTransfer.files;e.each(n,e.proxy(function(e,t){this.doFileUpload(t)},this)),this.data("fileInput").val("")},fileUploadComplete:function(e,t){this.trigger("removeIrisProcess",e),t!=undefined&&this.refreshDirectory(t),this.currentUploadJob=undefined,this.dbg("upload job done for "+e),this.dbg("check for pending jobs");if(this.options.pendingUploadJobs.length){var n=this.options.pendingUploadJobs.shift();this.dbg("found one"),this.dbg(n),this.trigger("removeIrisProcess",n.pid),n.name&&this.data("override_filename",n.name),this.doFileUpload(n.file)}},doFileUpload:function(t){var n="/";this.data("active_directory")&&(n=this.data("active_directory"));var r=t.name;this.data("override_filename")&&(r=this.data("override_filename"),this.data("override_filename",undefined));var i=n+"/"+r;i=i.replace(/\/\/+/g,"/");var s=this.uuid();this.dbg("uploads file "+i),this.dbg("JOB IS "+this.currentUploadJob);if(this.currentUploadJob!=undefined){this.trigger("updateIrisProcess",{pid:s,msg:"Waiting to upload "+i}),this.options.pendingUploadJobs.push({file:t,pid:s,name:r});return}this.currentUploadJob=s,this.dbg("will upload "+s+","+this.currentUploadJob),this.trigger("updateIrisProcess",{pid:s,msg:"Uploading "+i+" ... 0%"});if(t.size<=this.singleFileSize()){var o=new FileReader;o.onprogress=e.proxy(function(e){this.trigger("updateIrisProcess",{pid:s,msg:"Uploading "+i+" ... "+(100*e.loaded/e.total).toFixed(2)+"%"}),this.dbg("progress "+e.loaded/e.total),this.dbg(e)},this),o.onload=jQuery.proxy(function(e){this.client().put_file(this.sessionId(),r,e.target.result,n,jQuery.proxy(function(e){this.fileUploadComplete(s,n)},this),jQuery.proxy(function(e){this.fileUploadComplete(s)},this))},this),o.readAsBinaryString(t)}else{var u=i;u=u.replace(/\//g,"::");var a=t.size,f=this.chunkSize(),l=1,c=0,h={chunks:[],doneChunks:[],chunksByName:{},size:0,fileName:r,upload_dir:n,fullFilePath:i,chunkUploadPath:u,fullUploadPath:this.options.uploadDir+"/"+u,pid:s};this.stalledUploads()[h.fullFilePath]!=undefined&&(this.data("resumed_chunkMap",this.stalledUploads()[h.fullFilePath]),this.stalledUploads()[h.fullFilePath]=undefined);if(this.data("resumed_chunkMap")!=undefined){h=this.data("resumed_chunkMap"),this.trigger("removeIrisProcess",s);var p=(100*h.doneChunks.length/(h.doneChunks.length+h.chunks.length)).toFixed(2);p>=100&&(p=99),this.trigger("updateIrisProcess",{pid:h.pid,msg:"Uploading "+h.fullFilePath+" ... "+p+"%"}),this.data("resumed_chunkMap",undefined)}else while(a>0){f>a&&(f=a),a-=f;var d="00000000",v=(d+l).slice(-8);h.chunks.push({chunk:l,name:"chunk."+v,start:c,end:c+f,size:f,complete:!1}),h.size+=f,c+=f,l++}var m=e.proxy(function(n){e.each(h.chunks,function(e,t){h.chunksByName[t.name]=t});var r=this.makeChunkUploader(t,h);for(var i=0;i<this.options.concurrentUploads;i++)r()},this);this.client().make_directory(this.sessionId(),"/"+this.options.uploadDir,h.chunkUploadPath).always(e.proxy(function(){this.client().put_file(this.sessionId(),"chunkMap",JSON.stringify(h,undefined,2),"/"+h.fullUploadPath).done(m).fail(e.proxy(function(e){this.dbg(e)},this))},this))}},makeChunkUploader:function(e,t){t.jobs=0;var n=this;return function(){var r=arguments.callee;if(t.chunks.length>0){var i=t.chunks.shift(),s=e.slice||e.webkitSlice||e.mozSlice,o=s.call(e,i.start,i.end),u=new FileReader;u.onloadend=function(e){e.target.readyState==FileReader.DONE&&n.client().put_file(n.sessionId(),i.name,e.target.result,"/"+t.fullUploadPath,function(e){t.doneChunks.push(i);var s=(100*t.doneChunks.length/(t.jobs-1+t.doneChunks.length+t.chunks.length)).toFixed(2);s>=100&&(s=99),n.trigger("updateIrisProcess",{pid:t.pid,msg:"Uploading "+t.fullFilePath+" ... "+s+"%"}),t.jobs--,r()},function(e){t.jobs--,t.chunks.push(i),r()})},t.jobs++,u.readAsBinaryString(o)}else t.jobs==0&&n.checkAndMergeChunks(t,r)}},checkAndMergeChunks:function(t,n){this.client().list_files(this.sessionId(),"/"+this.options.uploadDir,t.chunkUploadPath,e.proxy(function(r){var i=r[0],s=r[1],o=[],u=this,a=!0,f=0,l={};jQuery.each(s,e.proxy(function(e,t){l[t.name]=t.size},this));var c=l.upload||0,h=[];t.doneChunks=t.doneChunks.sort(this.sortByKey("name")),e.each(t.doneChunks,e.proxy(function(e,n){var r=n.size;r==l[n.name]?(n.complete=!0,f++,h.push(n)):l[n.name]==undefined&&c>0?(c-=r,n.complete=!0,f++):(n.complete=!1,t.chunks.push(n),a=!1)},this)),t.doneChunks=h;if(c!=0){a=!1;var p=Object.keys(l).sort()[0],d=l[p];if(c-d!=0){var g=e("<div></div>").text("Uploading "+t.fullFilePath+" failed. Please start over");g.kbaseButtonControls({onMouseover:!0,context:this,controls:[{icon:"fa fa-ban",tooltip:"Cancel",callback:function(e,n){n.client().remove_directory(n.sessionId(),"/","/"+t.fullUploadPath,function(){n.fileUploadComplete(t.pid)})}}]}),this.trigger("updateIrisProcess",{pid:t.pid,content:g});return}var h=[];for(var v=0;v<t.doneChunks.length;v++){var m=t.doneChunks[v];m.name!=p&&h.push(m)}t.doneChunks=h,a=!0}if(a){var y=this.makeChunkMerger(t);y()}else if(n)n();else{var b=(100*t.doneChunks.length/(t.doneChunks.length+t.chunks.length)).toFixed(2);b>=100&&(b=99);var g=e("<div></div>").text("Uploading "+t.fullFilePath+" ...stalled at "+b+"%");g.kbaseButtonControls({onMouseover:!0,context:this,controls:[{icon:"fa fa-refresh",tooltip:"Resume",callback:function(e,n){n.data("resumed_chunkMap",t),n.data("fileInput").trigger("click")}},{icon:"fa fa-ban",tooltip:"Cancel",callback:function(e,n){n.client().remove_directory(n.sessionId(),"/","/"+t.fullUploadPath,function(){n.fileUploadComplete(t.pid)})}}]}),this.trigger("updateIrisProcess",{pid:t.pid,content:g}),this.stalledUploads()[t.fullFilePath]=t}},this))},makeChunkMerger:function(t){var n=this,r=t.fullUploadPath+"/upload",i=t.doneChunks.length?1/t.doneChunks.length:0,s=1;return function(){if(t.doneChunks.length==0){n.client().rename_file(n.sessionId(),"/",r,t.fullFilePath,function(){n.client().remove_directory(n.sessionId(),"/",t.fullUploadPath,function(){n.fileUploadComplete(t.pid,t.upload_dir)})},function(e){this.dbg("rename file failure"),this.dbg(e)});return}var o=t.doneChunks.shift(),u=arguments.callee;n.client().run_pipeline(n.sessionId(),"cat "+t.fullUploadPath+"/"+o.name+" >> "+r,[],0,"/",e.proxy(function(r){if(r){var a=r[0],f=r[1],l=(99+s++*i).toFixed(2);n.trigger("updateIrisProcess",{pid:t.pid,msg:"Uploading "+t.fullFilePath+" ... "+l+"%"}),f.length||n.client().remove_files(n.sessionId(),"/"+t.fullUploadPath,o.name,e.proxy(function(e){u()},n))}},this),function(e){this.dbg("OMFG ERR"),this.dbg(e)})}},downloadFile:function(e){window.location.href=this.downloadUrlForFile(e)},viewFile:function(e){window.open(this.viewUrlForFile(e))},downloadUrlForFile:function(e){return this.urlForFile(e,"download")},viewUrlForFile:function(e){return this.urlForFile(e,"view")},urlForFile:function(e,t){var n="/"+t+"/"+e+"?session_id="+encodeURIComponent(this.sessionId())+"&token="+encodeURIComponent(this.authToken());return n=n.replace(new RegExp("/+","g"),"/"),n=this.options.invocationURL+n,n},deleteFile:function(t,n){var r=n=="file"?"remove_files":"remove_directory";t=t.replace(/\/+$/,"");var i=t.match(/(.+)\/[^/]+$/),s="/";i!=undefined&&i.length>1&&(s=i[1]);var o=this,u=t.replace(this.options.root,""),a=e("<div></div>").kbaseDeletePrompt({name:u,callback:function(e,n){n.closePrompt(),o.client()[r](o.sessionId(),"/",t,function(e){o.refreshDirectory(s)})}});a.openPrompt()},addDirectory:function(t){var n=this,r=t.replace(this.options.root,"/"),i=e("<div></div>").kbasePrompt({title:"Create directory",body:e("<p></p>").append("Create directory ").append(e("<span></span>").css("font-weight","bold").text(r)).append(" ").append(e("<input></input>").attr("type","text").attr("name","dir_name").attr("size","20")),controls:["cancelButton",{name:"Create directory",type:"primary",callback:function(e,r){r.closePrompt(),n.client().make_directory(n.sessionId(),t,i.dialogModal().find("input").val(),function(e){n.refreshDirectory(t)},function(){})}}]});i.openPrompt()},addNewFile:function(t){var n=this,r=t.replace(this.options.root,"/"),i=e.jqElem("div").kbasePrompt({title:"Create a new file",body:e.jqElem("p").append("Create a new file ").append(e.jqElem("span").css("font-weight","bold").text(r)).append(" ").append(e.jqElem("input").attr("type","text").attr("name","file_name").attr("size","20")),controls:["cancelButton",{name:"Add and edit file",callback:e.proxy(function(e,n){n.closePrompt(),this.addNewFileCallback(i.dialogModal().find("input").val(),t,!0)},this)},{name:"Add file",type:"primary",callback:e.proxy(function(e,n){n.closePrompt(),this.addNewFileCallback(i.dialogModal().find("input").val(),t,!1)},this)}]});i.openPrompt()},addNewFileCallback:function(t,n,r){var i=n+"/"+t;i=i.replace(/\/\//,"/"),this.client().run_pipeline(this.sessionId(),"echo '' > "+t,[],0,n,e.proxy(function(e){this.refreshDirectory(n),r&&this.editFileCallback()(i,this)},this),function(){})}})}),define("kbaseAccordion",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbaseAccordion",version:"1.0.0",options:{fontSize:"100%"},init:function(t){return this._super(t),this.options.client&&(this.client=this.options.client),this.appendUI(e(this.$elem)),this},appendUI:function(t,n){n==undefined&&(n=this.options.elements);var r=this.options.fontSize,i=e("<div></div>").addClass("accordion").css("font-size",r).attr("id","accordion");e.each(n,e.proxy(function(t,n){n.fontMultiplier==undefined&&(n.fontMultiplier=this.options.fontMultiplier),i.append(e("<div></div>").addClass("panel panel-default").css("margin-bottom","2px").append(e("<div></div>").addClass("panel-heading").css("padding","0px").append(e("<i></i>").css("margin-right","5px").css("margin-left","3px").addClass("fa").addClass(n.open?"fa-chevron-down":"fa-chevron-right").addClass("pull-left").css("height",22*n.fontMultiplier+"px").css("line-height",22*n.fontMultiplier+"px").css("color","gray")).append(e("<a></a>").css("padding","0px").attr("href","#").attr("title",n.title).css("height",22*n.fontMultiplier+"px").css("line-height",22*n.fontMultiplier+"px").css("font-size",100*n.fontMultiplier+"%").append(n.title)).bind("click",function(t){t.preventDefault();var n=e(this).closest(".panel").find(".in"),r=e(this).next();if(n!=undefined){n.collapse("hide");var i=n.parent().first().find("i");i.removeClass("fa fa-chevron-down"),i.addClass("fa fa-chevron-right")}if(r.get(0)!=n.get(0)){r.collapse("show");var i=e(this).parent().find("i");i.removeClass("fa fa-chevron-right"),i.addClass("fa fa-chevron-down")}})).append(e("<div></div>").addClass("panel-body collapse").addClass(n.open?"in":"").css("padding-top","9px").css("padding-bottom","9px").append(n.body)))},this)),this._rewireIds(i,this),t.append(i)}})}),define("kbaseIrisCommands",["jquery","kbaseAccordion","kbaseButtonControls","kbaseBox","kbaseIrisConfig"],function(e){e.KBWidget({name:"kbaseIrisCommands",parent:"kbaseAccordion",version:"1.0.0",options:{link:function(t){alert("clicked on "+e(t.target).text())},englishCommands:!1,fontSize:"90%",overflow:!0,sectionHeight:"300px",order:window.kbaseIrisConfig.commands.order,include:window.kbaseIrisConfig.commands.include,exclude:window.kbaseIrisConfig.commands.exclude},init:function(t){return this._super(t),t.client&&(this.client=t.client),this.commandCategories={},this.knownIrisCommands={},e(document).on("addedIrisCommand.kbaseIris",e.proxy(function(e,t){this.addIrisCommand(e,t.command)},this)),this},completeCommand:function(e){var t=[],n=new RegExp("^"+e+".*");for(group in this.commandCategories)for(var r=0;r<this.commandCategories[group].length;r++)this.commandCategories[group][r].match(n)&&t.push([this.commandCategories[group][r],group]);return t},commonPrefix:function(e,t){var n="";for(var r=0;r<e.length&&r<t.length;r++){var i=e.charAt(r),s=t.charAt(r);if(i!=s)break;n+=i}return n},commonCommandPrefix:function(e){var t="";if(e.length>1){t=this.commonPrefix(e[0][0],e[1][0]);for(var n=2;n<e.length;n++)t=this.commonPrefix(t,e[n][0])}else t=e[0];return t},commandsMatchingRegex:function(e){var t=[];for(var n in this.commandCategories)for(var r=0;r<this.commandCategories[n].length;r++)this.commandCategories[n][r].match(e)&&t.push([this.commandCategories[n][r],n]);return t.sort()},appendUI:function(t){if(this.client==undefined)return;this.client.valid_commands(e.proxy(function(n){var r=["sort","grep","cut","cat","head","tail","date","echo","wc","diff","join","uniq","tr"].sort(),i=[];e.each(r,function(e,t){i.push({cmd:t,helpFlag:"--help"})}),n.push({name:"shell",title:"Shell commands",items:i},{name:"iris",title:"IRIS commands",items:[]});if(this.options.include.length){var s={};e.each(this.options.include,function(e,t){s[t]=1}),n=e.grep(n,function(e,t){return s[e.name]})}if(this.options.exclude.length){var o={};e.each(this.options.exclude,function(e,t){o[t]=1}),n=e.grep(n,function(e,t){return!o[e.name]})}var u=[];this.options.order.length&&e.each(this.options.order,function(t,r){e.each(n,function(e,t){if(t.name==r)return u.push.apply(u,n.splice(e,1)),!1})}),n=n.sort(this.sortByKey("title")),u.length&&n.unshift.apply(n,u);var a=[];e.each(n,e.proxy(function(t,n){var r=e.jqElem("ul").addClass("unstyled").css("max-height",this.options.overflow?this.options.sectionHeight:"5000px").css("overflow",this.options.overflow?"auto":"visible");e.each(n.items,e.proxy(function(e,t){var i=t.cmd;if(this.options.englishCommands){var s=MetaToolInfo(t.cmd);if(s!=undefined){var o=s(t.cmd);i=o.label}}this.commandCategories[n.title]==undefined&&(this.commandCategories[n.title]=[]),this.commandCategories[n.title].push(t.cmd),r.append(this.createLI(t.cmd,i))},this)),a.push({title:n.title,category:n.name,body:r})},this)),this.commandCategories.Widgets=[],this.commandCategories.Widgets.push("Network"),this.loadedCallback(t,a)},this))},createLI:function(t,n,r,i){n==undefined&&(n=t),r==undefined&&(r=this.options.link);var s=e("<li></li>").append(e("<a></a>").attr("href","#").attr("title",t).data("type","invocation").text(n).bind("click",r)),o=[{icon:"fa fa-question",callback:function(e,n){n.options.terminal!=undefined&&(n.options.terminal.run(t+" --help"),n.options.terminal.scroll())},id:"helpButton",tooltip:n+" help"}];if(i!=undefined&&i.length)for(var u=0;u<i.length;u++)o.push(i[u]);return s.kbaseButtonControls({context:this,controls:o}),s},loadedCallback:function(t,n){var r=this;e("input,textarea").on("focus.kbaseIrisCommands",e.proxy(function(t){e(":focus").get(0)!=undefined&&e(":focus").get(0)!=this.data("searchField").get(0)&&this.data("focused",e(":focus"))},this)),this.data("focused",e(":focus"));var i=e.jqElem("form").css("margin-bottom","2px").append(e("<div></div>").css("max-height",this.options.overflow?this.options.sectionHeight:"5000px").css("overflow",this.options.overflow?"auto":"visible").append(e("<div></div>").addClass("input-group").addClass("pull-right").addClass("input-group-sm").attr("id","searchFieldBox").append(e("<input></input>").attr("type","text").attr("name","search").addClass("form-control").attr("id","searchField").attr("size","50").keyup(e.proxy(function(t){t.preventDefault(),t.stopPropagation();if(t.metaKey||t.altKey||t.ctrlKey)return;if(t.keyCode==27){this.data("searchField").val(""),this.data("searchField").trigger("keyup");return}var n=this.data("searchField").val();if(n.length<3){n.length==0&&this.data("test").animate({left:"-100%"},150);return}this.data("command-container").scrollTop("0px"),this.data("test").animate({left:"0px"},150);var i=new RegExp(n,"i"),s=this.commandsMatchingRegex(i),o=e.jqElem("ul").css("font-size",this.options.fontSize).css("padding-left","15px").addClass("unstyled").css("max-height",this.options.overflow?this.options.sectionHeight:"5000px").css("overflow",this.options.overflow?"auto":"visible");e.each(s,e.proxy(function(t,n){o.append(this.createLI(n[0],n[0],function(e){r.options.link.call(this,e)},[{icon:"fa fa-long-arrow-right",callback:function(t,r){r.data("searchField").val(""),r.data("searchField").trigger("keyup");var i=e(".panel-heading").find('a[title="'+n[1]+'"]'),s=i.parent().parent(),o=s.offset().top-r.data("command-container").offset().top;r.data("command-container").scrollTop(o),s.find(".in").length==0&&(i.trigger("click"),setTimeout(function(){r.data("command-container").scrollTop(o)},200))},id:"linkButton",tooltip:"Find in command list"}]))},this)),s.length||o.append(e("<li></li>").css("font-style","italic").text("No matching commands found")),this.data("searchResults").empty(),this.data("searchResults").append(o),this.data("searchResults").prepend(e.jqElem("div").css("position","relative").css("top","2px").css("left","90%").append(e.jqElem("button").addClass("btn btn-default btn-xs").append(e.jqElem("i").addClass("fa fa-times")).on("click",e.proxy(function(e){this.data("searchField").val(""),this.data("searchField").trigger("keyup")},this)).tooltip({title:"Cancel search"})))},this))).append(e.jqElem("span").addClass("input-group-btn").css("height","30px").append(e.jqElem("button").addClass("btn btn-default").attr("id","search-button").append(e.jqElem("i").attr("id","search-button-icon").addClass("fa fa-search")).on("click",e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.data("searchField").trigger("keyup")},this)).tooltip({title:"Search"}))))),s=e.jqElem("div").kbaseBox({title:"Command list",content:e.jqElem("div").append(e.jqElem("div").attr("id","command-container").css("max-height",this.options.overflow?this.options.sectionHeight:"5000px").css("overflow",this.options.overflow?"auto":"visible").append(e.jqElem("div").attr("id","test").css("position","relative").css("left","-100%").css("width","200%").append(e.jqElem("div").text("This is my left div right here").css("width","50%").css("float","left").attr("id","searchResults")).append(e.jqElem("div").css("width","50%").css("float","right").append(e.jqElem("div").attr("id","all-commands").css("white-space","nowrap"))))).append(i)});t.append(s.$elem),this._rewireIds(s.$elem,this),this._superMethod("appendUI",this.data("all-commands"),n),this.data("commands",n),this.data("accordion").css("margin-bottom","0px"),this.trigger("requestIrisCommands",{requester:this})},addIrisCommand:function(t){if(this.knownIrisCommands[t.cmd]!=undefined)return;this.knownIrisCommands[t.cmd]=1;var n=this.data("irisCommandsUL");n==undefined&&e.each(this.data("commands"),e.proxy(function(e,t){t.category=="iris"&&(n=this.data("irisCommandsUL",t.body))},this)),n.append(this.createLI(t.cmd,t.label))}})}),define("kbaseIrisGrammar",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbaseIrisGrammar",version:"1.0.0",options:{defaultGrammarURL:document.URL.replace("iris.html","grammar.json")},init:function(t){return this._super(t),this.options.defaultGrammarURL.match(/^file:\/\//)&&(this.options.defaultGrammarURL="grammar.json"),this.options.$loginbox!=undefined&&(this.$loginbox=this.options.$loginbox),this.appendUI(e(this.$elem)),this.retrieveGrammar(this.options.defaultGrammarURL),this},appendUI:function(e){},detokenize:function(t){var n="";if(t.length&&!e.isArray(t[0])&&t[0].match(/^\s*#/))return t[0];t.forceString==undefined&&(t.forceString={});for(var r=0;r<t.length;r++){var i=t[r];e.isArray(i)?n+=this.detokenize(i)+";":i.match(/[\s;|]/)&&i!="|"||t.forceString[r]?i.match(/"/)&&!i.match(/\\"/)?n+=" '"+i+"'":n+=' "'+i+'"':i.length?n+=" "+i:n+=" ''"}return n.match(/;$/)&&(n=n.substring(0,n.length-1)),n.match(/^ /)&&(n=n.substring(1,n.length)),n},tokenize:function(e){var t=[];t.forceString={};var n="",r=undefined,i=!1,s=[],o=!1,u="";if(e==undefined||!e.length)return t;if(e.match(/^\s*#/))return t.push(e),t;for(var a=0;a<e.length;a++){var f=e.charAt(a);if(r==undefined&&f.match(/[?;\n]/)){n.length&&(t.push(n),n=""),t.length&&(s.push(t),t=[],t.forceString={}),u=f;continue}if(!f.match(/\S/)&&r==undefined){n.length&&(t.push(n),n=""),u=f;continue}var l=f.match(/[\|><]/)?!0:!1,c=!1;if(n.match(/kb$/)&&f=="|"||n.match(/kb\|$/))c=!0;if(f==">"&&n!=undefined&&n.match(/((^|\s)2|>)$/)&&!r&&!c){n+=f,o=l;continue}(l||o)&&!r&&!c?(n.length&&t.push(n),n=f):n+=f,o=l;if(r!=undefined&&f==r&&!i){n=n.substring(1,n.length-1),t.push(n),t.forceString[t.length-1]=!0,n="",r=undefined,u=f;continue}r==undefined&&u.match(/\s/)&&(f=='"'||f=="'")&&(r=f),f=="\\"?i=!0:i=!1,u=f}return n.length&&t.push(n),s.length&&t.length&&s.push(t),s.length?s:t},evaluate:function(t,n){var r=this.tokenize(t),i=this.grammar;if(i==undefined){this.retrieveGrammar(this.options.defaultGrammarURL,e.proxy(function(){this.evaluate(t,n)},this));return}var s=undefined,o=undefined,u={},a={parsed:"",string:t,grammar:i._root};e.isArray(r[0])&&(r=r[0],r.forceString={}),r[0]=="explain"&&(r.shift(),a.explain=1);for(var f=0;f<r.length;f++){var l=r[f],c=!1;for(child in a.grammar.children){var h=a.grammar.children[child];if(h.regex&&l.match(h.regex))a.grammar=a.grammar.children[child],c=!0;else if(child.match(/^\$/))a.grammar=a.grammar.children[child],c=!0;else if(l==child)a.grammar=a.grammar.children[child],c=!0;else if(!h.caseSensitive){var p=new RegExp("^"+child+"$","i");l.match(p)&&(a.grammar=a.grammar.children[child],c=!0)}if(c){child.match(/^\$/)&&(u[child]=l),a.parsed.length?a.parsed+=" "+l:a.parsed=l,a.grammar=h,a.execute=h.execute;break}}if(!c&&!a.grammar.childrenOptional){a.tail=r.splice(f,r.length-f).join(" ");break}}if(a.grammar.children!=undefined&&Object.keys(a.grammar.children).length&&!a.grammar.childrenOptional){a.error="Parse error at "+l,a.fail=1,delete a.execute,a.token=l,a.tail=r.splice(f,r.length-f).join(" ");var d=[];if(a.grammar.children!=undefined)for(prop in a.grammar.children)d.push(this.nextForGrammar(prop,a.grammar.children));return a.next=d.sort(),n&&n(a),a}a.rawExecute=a.execute;for(var v in u)a.execute=a.execute.replace(v,u[v]);if(a.tail){var m;(m=a.tail.match(/^into\s+(\S+)/))?a.execute+=" > "+m[1]:(a.fail=1,a.error="Extra characters - "+a.tail)}return n&&n(a),a},nextForGrammar:function(e,t){e==undefined&&(e="");var n=t[e].children,r,i=1e3;while(n!=undefined&&i-->0)if(Object.keys(n).length==1){var s=Object.keys(n)[0];e=e.length?e+" "+s:s,n=n[s].children}return e},allQuestions:function(e){var t=["Display the dna sequence of contig $contig_id from $max to $min","Display the dna sequence of gene $gene_id","What type of family is $family","What is the function of family $family","What fids are in family $family","Display sequences in family $family as fasta","Display sequences in family $family","What is the function of feature $feature_id","What fids in k12 have attached publications","What publications have been connected to gene thrB","Show the DNA sequence of fid thrB","Display the protein sequence of fid thrB","Which protein families contain gene $gene_id","Is fid thrB in an atomic regulon","Which fids appear to have correlated expression with gene thrB","What is the location of feature thrB","What protein sequence corresponds to fid $fid","Which contigs are in genome $genome","What is the size of genome $genome","What is the KBase id of SEED genome $genome","What is the KBase id of SEED feature $feature","What is the source of genome $genome","Which are the closest genomes to $genome","What is the name of genome $genome","Which genomes have models","Which models exist for genome $genome","Which reactions exist in genome $genome","Which reactions are in model $model","What reactions connect to role $role","What roles relate to reaction $reaction","What complexes implement reaction $reaction","What reactions does complex $complex implement","Describe the biomass reaction for model kb|fm.0","What compounds are connected to model $model","What media are known","What compounds are considered part of media $media","show reactions that connect to compound $compound","How many otus exist","What otus exist","What otu contains $otu","What genomes are in OTU $otu","What annotations are known for protein sequence $sequence","What roles are used in models","What roles are used in subsystem $subsystem","What subsystems include role $role","What features in $feature implement role $role","What families implement role $role","What roles occur in subsystem $subsystem","What roles are in subsystem $subsystem","What genomes are in subsystem $subsystem","What subsystems are in genome $genome","what is the taxonomy of genome $genome","What is the taxonomic group id of $group_id","What genomes are in taxonomic group $group"];if(e==undefined)return t;var n=[],r=new RegExp(e);for(var i=0;i<t.length;i++){var s=t[i];s.match(r)&&n.push(s)}return n},XXXallQuestionsBOGUS:function(t,n){n==undefined&&(n="");if(t==undefined){if(this.grammar==undefined){this.retrieveGrammar(this.options.defaultGrammarURL,e.proxy(function(){this.allQuestions()},this));return}t=this.grammar._root.children}for(var r in t)var i=n.length?n+" "+r:r},retrieveGrammar:function(t,n){var r=undefined;e.ajax({async:!0,dataType:"text",url:t,crossDomain:!0,beforeSend:function(e){r&&e.setRequestHeader("Authorization",r)},success:e.proxy(function(e,t,r){var i=JSON.parse(e);this.grammar=i,n&&n()},this),error:e.proxy(function(e,t,r){try{var i=JSON.parse(e.responseText);this.grammar=i,n&&n()}catch(s){}},this),type:"GET"})}})}),define("kbaseIrisWidget",["jquery","kbaseAuthenticatedWidget"],function(e){e.KBWidget({name:"kbaseIrisWidget",parent:"kbaseAuthenticatedWidget",version:"1.0.0",_accessors:["promise","subWidgets",{name:"isSelected",setter:"setIsSelected"},{name:"pid",setter:"setPid"},{name:"isHidden",setter:"setIsHidden"},{name:"input",setter:"setInput"},{name:"output",setter:"setOutput"},{name:"error",setter:"setError"},{name:"value",setter:"setValue"},{name:"cwd",setter:"setCwd"},{name:"subCommand",setter:"setSubCommand"}],options:{subWidgets:[]},init:function(t){return this._super(t),this.$elem.on("removeWidget.kbaseIris",e.proxy(function(e,t){this.removeWidget(t.$widget)},this)),this.$elem.on("toggleWidgetSelection.kbaseIris",e.proxy(function(e,t){e.stopPropagation(),e.preventDefault(),this.$elem.parent().trigger("toggleWidgetSelection",this)},this)),this.appendUI(e(this.$elem)),this},render:function(){},toggleSelection:function(){this.trigger("toggleWidgetSelection",this)},setIsSelected:function(e){this.setValueForKey("isSelected",e),this.isSelected()?this.$elem.css("border","1px solid green"):this.$elem.css("border","")},setSubCommand:function(e){this.setValueForKey("subCommand",e)},setPid:function(e){this.setValueForKey("pid",e)},setIsHidden:function(e){this.setValueForKey("isHidden",e),e?this.$elem.css("display","none"):this.$elem.css("display","")},setValue:function(e){this.setValueForKey("value",e)},setInput:function(e){this.setValueForKey("input",e)},setOutput:function(e){this.setValueForKey("output",e)},setError:function(e){this.setValueForKey("error",e),typeof e=="string"&&e.match(/error/i)&&this.$elem.css("display","")},setCwd:function(e){this.setValueForKey("cwd",e)},escapeText:function(t){return typeof t=="string"?(t=t.replace(/&/g,"&amp;"),t=t.replace(/</g,"&lt;"),t=t.replace(/>/g,"&gt;"),t=e.jqElem("span").append(e.jqElem("span").css("white-space","pre").append(t))):t=e.jqElem("span").append(t),t},viewOutput:function(){var t=window.open();t.document.open();var n=e.jqElem("div").append(e.jqElem("div").css("white-space","pre").css("font-family","monospace").append(this.output().clone()));e.each(n.find("a"),function(t,n){e(n).replaceWith(e(n).html())}),t.document.write(n.html()),t.document.close()},acceptInput:function(e,t){this.kb_bind(e,"value",function(e,t,n){this.setInput(n.newValue),this.render()}),e.value()!=undefined&&!t&&this.setInput(e.value())},startThinking:function(){},stopThinking:function(){},freeze:function(){return{error:"this widget could not be frozen!"}},thaw:function(){this.setError("This widget could not be unfrozen!")},freeze:function(){var t={type:this.name,input:typeof this.input()=="object"?e.jqElem("div").append(this.input().clone()).html():this.input(),output:typeof this.output()=="object"?e.jqElem("div").append(this.output().clone()).html():this.output(),error:typeof this.error()=="object"?e.jqElem("div").append(this.error().clone()).html():this.error(),value:this.value(),pid:this.pid(),isHidden:this.isHidden(),cwd:this.cwd(),subCommand:this.subCommand(),subWidgets:[],inputObj:typeof this.input()=="object",outputObj:typeof this.output()=="object",errorObj:typeof this.error()=="object"};return e.each(this.subWidgets(),function(e,n){t.subWidgets.push(n.freeze())}),t},thaw:function(t){var n=e.jqElem("div")[t.type]();return n.setSubCommand(t.subCommand),n.setCwd(t.cwd),n.setIsHidden(t.isHidden),n.setPid(t.pid),n.setValue(t.value),n.setInput(t.inputObj?e.jqElem("div").append(t.input):t.input),n.setOutput(t.outputObj?e.jqElem("div").append(t.output):t.output),n.setError(t.errorObj?e.jqElem("div").append(t.error):t.error),e.each(t.subWidgets,e.proxy(function(e,t){n.appendWidget(this.thaw(t))},this)),n},appendWidget:function(t){this.output()==undefined&&this.setOutput(e.jqElem("div"));var n=!1;e.each(this.subWidgets(),e.proxy(function(e,r){if(r===t){n=!0;return}},this)),!n&&this.data("subWidgets")&&(this.data("subWidgets").append(t.$elem),this.subWidgets().push(t))},removeWidget:function(e){for(var t=0;t<this.subWidgets().length;t++)if(this.subWidgets()[t]===e){this.subWidgets().splice(t,1),e.$elem.remove();break}}})}),define("kbaseIrisTerminalWidget",["jquery","kbaseIrisWidget","kbaseButtonControls","kbaseDeletePrompt"],function(e){e.KBWidget({name:"kbaseIrisTerminalWidget",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:["collapsed",{name:"isComment",setter:"setIsComment"}],options:{subCommand:!1},init:function(t){return this._super(t),e(document).on("updateIrisProcess.kbaseIris",e.proxy(function(e,t){t.pid==this.pid()&&this.startThinking()},this)),e(document).on("removeIrisProcess.kbaseIris",e.proxy(function(e,t){t==this.pid()&&this.stopThinking()},this)),e(document).on("clearIrisProcesses.kbaseIris",e.proxy(function(e){this.stopThinking()},this)),this},setIsComment:function(e){this.setValueForKey("isComment",e),e?(this.data("cwdDisplay").css("display","none"),this.data("inputContainer").css("font-weight","normal"),this.data("input").css("font-weight","normal"),this.data("inputContainer").css("font-style","italic"),this.data("line").css("display","none")):(this.data("cwdDisplay").css("display",""),this.data("inputContainer").css("font-weight","bold"),this.data("input").css("font-weight",""),this.data("inputContainer").css("font-style",""),this.data("line").css("display",""))},appendUI:function(t){var n=e.jqElem("div").css("white-space","pre").css("position","relative").css("style","font-weight : bold").append(e.jqElem("span").attr("id","cwdDisplay").append("&gt;").append(e.jqElem("span").attr("id","cwd").addClass("command").kb_bind(this,"cwd",{transformedValue:e.proxy(function(e){return this.escapeText(e)},this)})).append("&nbsp;")).append(e.jqElem("span").attr("id","input").attr("contenteditable","true").addClass("command").kb_bind(this,"input",{transformedValue:e.proxy(function(e){return this.escapeText(e)},this),reverseTransformedValue:e.proxy(function(t){var n=e.jqElem("span").html(t);return this.trigger("runWidget",{$widget:this,command:n.text()}),n.text()},this)}).bind("keypress",function(e){if(event.metaKey||event.altKey||event.ctrlKey)return;event.which==13&&this.blur()})).mouseover(function(t){e(this).children().first().show()}).mouseout(function(t){e(this).children().first().hide()});return t.append(e.jqElem("div").attr("id","thoughtBox").addClass("pull-left").append(e.jqElem("i").addClass("fa fa-spinner fa fa-spin")).css("display","none")).append(n.attr("id","inputContainer").on("click",e.proxy(function(e){this.data("output").show(),this.data("subWidgets").show(),this.data("error").show(),this.data("line").show()},this))).append(e.jqElem("div").attr("id","outputWrapper").css("position","relative").append(e.jqElem("div").attr("id","output").kb_bind(this,"output",{transformedValue:e.proxy(function(e){return this.escapeText(e)},this)})).append(e.jqElem("div").attr("id","subWidgets"))).append(e.jqElem("div").attr("id","error").css("font-style","italic").kb_bind(this,"error",{transformedValue:e.proxy(function(e){return this.escapeText(e)},this)})).append(e.jqElem("hr").attr("id","line")),this._rewireIds(t,this),n.kbaseButtonControls({context:this,controls:[{icon:"fa fa-link",tooltip:"select widget",callback:function(e,t){t.toggleSelection()}},{icon:"fa fa-eye",tooltip:"view output",callback:function(e,t){t.viewOutput()}},{icon:"fa fa-times",tooltip:"remove command",callback:e.proxy(function(e){this.removeWidgetPrompt()},this)},{icon:"fa fa-caret-up","icon-alt":"fa fa-caret-down",tooltip:{title:"collapse / expand",placement:"bottom"},callback:e.proxy(function(e){this.collapsed(!this.collapsed()),this.data("output").toggle(),this.data("subWidgets").toggle(),this.data("error").toggle(),this.data("line").toggle()},this)}]}),this.data("outputWrapper").kbaseButtonControls({position:"bottom",posOffset:"-20px",context:this,controls:[{icon:"fa fa-link",tooltip:"select widget",callback:function(e,t){t.toggleSelection()}},{icon:"fa fa-angle-double-up",tooltip:"jump to command input",callback:function(e,t){t.trigger("scrollTo",t.$elem.prop("offsetTop")-85)}},{icon:"fa fa-times",tooltip:"remove command",callback:function(e,t){t.removeWidgetPrompt()}}]}),t},removeWidgetPrompt:function(){var t=e.jqElem("div").kbaseDeletePrompt({name:"this widget",callback:e.proxy(function(e,t){t.closePrompt(),this.trigger("removeWidget",{$widget:this})},this)});t.openPrompt()},startThinking:function(){this.data("thoughtBox").show()},stopThinking:function(){this.data("thoughtBox").hide()},setInput:function(e){this._super(e),(typeof e!="string"||!e.length)&&this.data("inputContainer").css("display","none")},setError:function(e){this._super(e),typeof e=="string"&&e.match(/error/i)&&this.data("inputContainer").css("color","red")},setSubCommand:function(e,t){if(this.data("inputContainer")==undefined)return;e?(this.data("inputContainer").css("color","gray"),t||(this.data("output").hide(),this.data("error").hide(),this.data("line").hide())):this.data("inputContainer").css("color","black"),this._super(e)},freeze:function(){var e=this._super();return e.collapsed=this.collapsed(),e.isComment=this.isComment(),e},thaw:function(e){var t=this._super(e);return e.collapsed&&(t.data("output").hide(),t.data("subWidgets").hide(),t.data("error").hide(),t.data("line").hide()),t.setIsComment(e.isComment),t}})}),define("kbaseIrisTextWidget",["jquery","kbaseIrisWidget"],function(e){e.KBWidget({name:"kbaseIrisTextWidget",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:[{name:"text",setter:"setText"}],options:{},setText:function(t,n){n==undefined&&(n="text"),n=="text"?t=e.jqElem("span").css("white-space","pre").append(typeof t=="string"?t:t.text()).html():n=="html"&&typeof t=="string"&&(t=e.jqElem("span").html(t)),this.setValueForKey("text",t)},appendUI:function(t){var n=e.jqElem("div").attr("id","text").kb_bind(this,"text",{transformedValue:e.proxy(function(e){return this.escapeText(e)},this)});return t.append(n),this._rewireIds(t,this),t}})}),define("kbaseIrisContainerWidget",["jquery","kbaseIrisWidget","kbaseButtonControls"],function(e){e.KBWidget({name:"kbaseIrisContainerWidget",parent:"kbaseIrisWidget",version:"1.0.0",options:{inputType:"string"},_accessors:[],setInput:function(t){this.options.inputType=="string"?(this.setValueForKey("input",t),this.options.widget.setInput(t)):this.options.inputType.match(/file|json/)&&this.$terminal.client().get_file(this.$terminal.sessionId(),t,this.$terminal.cwd,e.proxy(function(e){this.options.inputType=="json"&&(e=JSON.parse(e)),this.setValueForKey("input",e),this.options.widget.setInput(e)},this),e.proxy(function(e){this.setError("No such input file")},this))},setOutput:function(e){this.setValueForKey("output",e),this.options.widget.setOutput(e)},setError:function(e){this.setValueForKey("error",e),this.options.widget.setError(e)},setValue:function(e){this.setValueForKey("value",e),this.options.widget.setValue(e)},init:function(e){return this._super(e),this.observe(this.options.widget,"didChangeValueForInput",function(e,t,n){this.setValueForKey("input",n.newValue)}),this.observe(this.options.widget,"didChangeValueForOutput",function(e,t,n){this.setValueForKey("output",n.newValue)}),this.observe(this.options.widget,"didChangeValueForError",function(e,t,n){this.setValueForKey("error",n.newValue)}),this.observe(this.options.widget,"didChangeValueForValue",function(e,t,n){this.setValueForKey("value",n.newValue)}),this},render:function(){this.options.widget.render&&this.options.widget.render()},appendUI:function(e){return e.kbaseButtonControls({context:this,controls:[{icon:"fa fa-times",callback:function(t){e.remove()}}]}),e.append(this.options.widget.$elem),this._rewireIds(e,this),e}})}),define("kbaseSearchControls",["jquery","bootstrap","kbwidget"],function(e){e.KBWidget({name:"kbaseSearchControls",version:"1.0.0",options:{controls:[],onMouseover:!0,position:"top",type:"floating"},init:function(t){return this._super(t),this.appendUI(e(this.$elem)),this},appendUI:function(t){var n=this,r=this.options.onMouseover;this.options.type=="floating"&&t.css("position","relative");var i=e.jqElem("div").addClass("input-group input-group-sm").append(e.jqElem("input").attr("type","text").addClass("form-control").attr("id","searchBox").on("keyup",function(e){e.keyCode==27&&n.value(undefined);var t=n.value();t.length?(n.data("searchIcon").removeClass("fa-search"),n.data("searchIcon").addClass("fa-times"),n.options.onMouseover=!1):(n.data("searchIcon").addClass("fa-search"),n.data("searchIcon").removeClass("fa-times"),r&&(n.options.onMouseover=!0)),n.options.searchCallback.call(this,e,t,n.options.context)})).append(e.jqElem("span").addClass("input-group-btn").append(e.jqElem("button").addClass("btn btn-default").attr("id","searchButton").append(e.jqElem("i").attr("id","searchIcon").addClass("fa fa-search")).on("click",function(e){n.data("searchIcon").hasClass("fa-times")&&(n.value(undefined),n.data("searchBox").focus(),r&&(n.options.onMouseover=!0)),n.options.searchCallback.call(this,e,n.value(),n.options.context)})));return this.options.type=="floating"&&i.css("right","0px").css("top","0px").css("position","absolute").css("margin-right","3px").attr("z-index",1e4),this._rewireIds(i,this),t.append(i),t.data("searchControls",i),t.on("mouseover.kbaseSearchControls",function(e){n.options.onMouseover&&i.show()}).on("mouseout.kbaseSearchControls",function(e){n.options.onMouseover&&i.hide(),n.data("searchBox").blur()}),this.options.onMouseover&&i.hide(),this},value:function(e){return arguments.length&&this.data("searchBox").val(e),this.data("searchBox").val()}})}),define("kbaseTable",["jquery","kbwidget","kbaseDeletePrompt","kbaseButtonControls","kbaseSearchControls"],function(e){e.KBWidget({name:"kbaseTable",version:"1.0.0",_accessors:["numRows","sortButtons","visRowString"],options:{sortable:!1,striped:!0,hover:!0,bordered:!0,headerOptions:{},resizable:!1,header_callback:function(e){return e.label!=undefined?e.label:e.value.replace(/(?:^|\s+)([a-z])/g,function(e){return e.toUpperCase()})},row_callback:function(e,t,n,r){},sortButtons:{},navControls:!1},default_row_callback:function(e){return e==undefined?e:e.label!=undefined?e.label:(value=typeof e!="object"?e:e.value,e.type=="th"&&(value=value.replace(/(?:^|\s+)([a-z])/g,function(e){return e.toUpperCase()}),value+=" : "),typeof e=="object"&&e.setup!=undefined&&e.setup(value,e),value)},init:function(t){return this._super(t),this.appendUI(e(this.$elem),this.options.structure),this},appendUI:function(t,n){t.empty();var r=e("<table></table>").attr("id","table").css("margin","0px").addClass("table");this.options.tblOptions&&this.addOptions(r,this.options.tblOptions),this.options.striped&&r.addClass("table-striped"),this.options.hover&&r.addClass("table-hover"),this.options.bordered&&r.addClass("table-bordered"),this.options.caption&&r.append(e("<caption></caption>").append(this.options.caption));if(n.header){var i=e("<thead></thead>").attr("id","thead");i.append(this.navControls(n.header.length));var s=e("<tr></tr>").attr("id","headerRow");e.each(n.header,e.proxy(function(t,r){typeof r=="string"&&(r={value:r},n.header[t]=r);var i=r.callback||this.options.header_callback,o=i(r,this),u=r.value,a=e.jqElem("th").append(o);this.options.resizable&&a.resizable({handles:"e"}),this.addOptions(a,e.extend(!0,{},this.options.headerOptions,r));if(r.sortable||r.sortable==undefined&&this.options.sortable){var f=r.value+"-sortButton",l=e("<i></i>").addClass("fa fa-sort"),c=e("<button></button>").addClass("btn btn-default btn-xs").attr("id",f).css("display","none").css("float","right").append(l).data("shouldHide",!0);c.bind("click",e.proxy(function(e){var t=this.data("lastSort");t!=undefined&&t.get(0)!=c.get(0)&&(t.children(":first").removeClass("fa fa-sort-up"),t.children(":first").removeClass("fa fa-sort-down"),t.children(":first").addClass("fa fa-sort"),t.data("shouldHide",!0),t.css("display","none")),this.data("lastSortHeader",u),l.hasClass("fa fa-sort")?(l.removeClass("fa fa-sort"),l.addClass("fa fa-sort-up"),c.data("shouldHide",!1),this.sortAndLayoutOn(u,1),this.data("lastSortDir",1),this.data("lastSort",c)):l.hasClass("fa fa-sort-up")?(l.removeClass("fa fa-sort-up"),l.addClass("fa fa-sort-down"),c.data("shouldHide",!1),this.sortAndLayoutOn(u,-1),this.data("lastSortDir",-1),this.data("lastSort",c)):l.hasClass("fa fa-sort-down")&&(l.removeClass("fa fa-sort-down"),l.addClass("fa fa-sort"),c.data("shouldHide",!0),this.sortAndLayoutOn(undefined),this.data("lastSortHeader",undefined),this.data("lastSortDir",undefined),this.data("lastSort",undefined))},this)),this.sortButtons()[r.value]=c,a.append(c),a.bind("mouseover",e.proxy(function(e){c.css("display","inline")},this)),a.bind("mouseout",e.proxy(function(e){c.data("shouldHide")&&c.css("display","none")},this))}s.append(a)},this)),i.append(s),r.append(i)}if(n.rows){var o=this.data("tbody",e("<tbody></tbody>"));this.layoutRows(n.rows,n.header),r.append(o)}if(n.footer){var u=e("<tfoot></tfoot>").attr("id","tfoot"),a=e.jqElem("tr");u.append(a);for(var f=0;f<n.footer.length;f++){var l=n.footer[f],c=l,h,p;typeof l=="object"&&(c=l.value,h=l.style,p=l.colspan);var d=e.jqElem("td").append(c);h&&d.attr("style",h),p&&d.attr("colspan",p),a.append(d)}r.append(u)}return this._rewireIds(r,this),t.append(r),t},navControls:function(t){var n=this,r=e.jqElem("tr").css("display",this.options.navControls?undefined:"none").append(e.jqElem("td").attr("colspan",t).css("background-color","lightgray").append(e.jqElem("div").addClass("pull-left").addClass("input-group input-group-sm").append(e.jqElem("span").addClass("input-group-btn").append(e.jqElem("button").addClass("btn btn-default").attr("id","pageLeftButton").append(e.jqElem("i").attr("id","leftIcon").addClass("fa fa-caret-left")).on("click",function(t){var r=n.options.maxVisibleRowIndex||n.numRows(),i=n.options.minVisibleRowIndex||0,s=r-i,o=i-s;o<=0&&(e(this).attr("disabled",!0),o=0);var u=o+s;n.options.minVisibleRowIndex=o,n.options.maxVisibleRowIndex=u,n.displayRows()}))).append(e.jqElem("span").attr("id","visRecords").addClass("input-group-addon").kb_bind(this,"visRowString")).append(e.jqElem("span").addClass("input-group-btn").append(e.jqElem("button").addClass("btn btn-default").attr("id","pageRightButton").append(e.jqElem("i").attr("id","rightIcon").addClass("fa fa-caret-right")).on("click",function(t){var r=n.options.maxVisibleRowIndex||n.numRows(),i=n.options.minVisibleRowIndex||0,s=r-i,o=r+s;o>=n.numRows()&&(o=n.numRows(),e(this).attr("disabled",!0));var u=o-s;n.options.minVisibleRowIndex=u,n.options.maxVisibleRowIndex=o,n.displayRows()})))).append(e.jqElem("div").addClass("pull-left").addClass("input-group input-group-sm").append(e.jqElem("span").addClass("input-group-btn").append(e.jqElem("button").addClass("btn btn-default").attr("id","removeButton").append(e.jqElem("i").attr("id","removeIcon").addClass("fa fa-minus")).on("click",function(e){var t=n.options.maxVisibleRowIndex||0;t--,t<1&&(t=1),n.options.maxVisibleRowIndex=t,n.displayRows()}))).append(e.jqElem("span").addClass("input-group-btn").append(e.jqElem("button").addClass("btn btn-default").attr("id","addButton").append(e.jqElem("i").attr("id","addIcon").addClass("fa fa-plus")).on("click",function(e){var t=n.options.maxVisibleRowIndex||0;t++;if(t>n.numRows()){var r=t-n.numRows();t=n.options.structure.rows.length,n.options.minVisibleRowIndex-=r,n.options.minVisibleRowIndex<0&&(n.options.minVisibleRowIndex=0)}n.options.maxVisibleRowIndex=t,n.displayRows()})))).append(e.jqElem("div").addClass("pull-right").attr("id","searchDiv")));return this._rewireIds(r,this),this.data("searchDiv").kbaseSearchControls({onMouseover:!1,type:"inline",context:this,searchCallback:function(e,t,n){n.refilter(t)}}),r},sort:function(e,t){var n=this.sortButtons()[e];if(t==-1||t==1&&n!=undefined){var r=this.data("lastSortHeader"),i=this.data("lastSortDir");if(e==r&&t==i)return;e==r?t==1&&r==-1?(n.trigger("click"),n.trigger("click")):t==-1&&r==1&&n.trigger("click"):(n.trigger("click"),t==-1&&n.trigger("click")),n.css("display","inline")}},refilter:function(e){this.options.filter=e,this.sortAndLayoutOn(this.data("lastSortHeader"),this.data("lastSortDir"))},sortAndLayoutOn:function(e,t){var n=this.options.structure.rows;e!=undefined&&(n=this.options.structure.rows.slice().sort(function(n,r){var i=n[e],s=r[e];return i!=undefined&&i.sortValue!=undefined?i=i.sortValue:i=typeof i=="string"?i.toLowerCase():i,s!=undefined&&s.sortValue!=undefined?s=s.sortValue:s=typeof s=="string"?s.toLowerCase():s,i<s?0-t:i>s?t:0})),this.layoutRows(n,this.options.structure.header)},layoutRows:function(t,n){this.data("tbody").empty();var r=0;if(e.isArray(t))for(var i=0;i<t.length;i++){var s=this.createRow(t[i],n);s!=undefined&&s.children().length&&(r++,this.data("tbody").append(s))}else if(this.options.structure.keys!=undefined)for(var i=0;i<this.options.structure.keys.length;i++){var o=this.options.structure.keys[i];typeof o!="object"&&(o={value:o}),o.type="th",o.style="white-space : nowrap";var s=this.createRow({key:o,value:{value:t[o.value],key:o.value}},[{value:"key"},{value:"value"}]);s!=undefined&&s.children().length&&(r++,this.data("tbody").append(s))}this.numRows(r),this.displayRows()},displayRows:function(){this.data("tbody").find("tr").css("display","");var e=this.options.maxVisibleRowIndex||this.numRows();e>this.numRows()&&(e=this.numRows());var t=this.options.minVisibleRowIndex||0;this.data("tbody").find("tr:lt("+t+")").css("display","none"),this.data("tbody").find("tr:gt("+(e-1)+")").css("display","none"),this.visRowString("Rows "+(t+1)+" to "+e+" of "+this.numRows()),this.data("pageLeftButton").attr("disabled",t==0),this.data("pageRightButton").attr("disabled",e==this.numRows()),this.data("removeButton").attr("disabled",e-t==1),this.data("addButton").attr("disabled",e==this.numRows())},addOptions:function(t,n){if(typeof n=="string"||n==undefined)return;n.style!=undefined&&t.attr("style",n.style);if(n.class!=undefined){var r=typeof n.class=="string"?[n.class]:n.class;e.each(r,e.proxy(function(e,n){t.addClass(n)},this))}var i=["mouseover","mouseout","click"];e.each(i,e.proxy(function(e,r){n[r]!=undefined&&t.bind(r,n[r])},this)),n.colspan&&t.attr("colspan",n.colspan),n.rowspan&&t.attr("rowspan",n.rowspan)},createRow:function(t,n){var r=e.jqElem("tr").css("background-color","white"),i=this.options.row_callback,s="";e.isArray(t)?e.each(t,e.proxy(function(t,n){var i=typeof n=="object"?n.value:n;if(i==undefined)return;s+=i instanceof jQuery?i.text():i;var o=e.jqElem("td").append(i);typeof n=="object"&&this.addOptions(o,n),r.append(o)},this)):n!=undefined&&n.length&&e.each(n,e.proxy(function(n,o){var u=o.value,a="td";t[u]==null&&(t[u]=undefined),typeof t[u]=="object"&&t[u].value==null&&(t[u].value=""),typeof t[u]=="object"&&t[u].type!=undefined&&(a=t[u].type);var f=e.jqElem(a),l=i(t[u],u,t,this);l==undefined&&(l=this.default_row_callback(t[u],u,t,this)),s+=l instanceof jQuery?l.text():l,t[u]&&!t[u].externalSortValue&&(t[u].sortValue=l instanceof jQuery?l.text():l),f.append(l),typeof t[u]!="string"&&this.addOptions(f,t[u]),l!=undefined&&r.append(f)},this));if(this.options.filter!=undefined){var o=new RegExp(this.options.filter,"i");s.match(o)||(r=undefined)}return r},deletePrompt:function(t){var n=e("<div></div>").kbaseDeletePrompt({name:t,callback:this.deleteRowCallback(t)});n.openPrompt()},deleteRowCallback:function(e){},shouldDeleteRow:function(e){return 1}})}),define("kbaseIrisTerminalDispatchTutorial",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"next",auth:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("next")).append(" to go to the next page of your current tutorial");return e},history:!1,callback:function(e,t,n,r){return this.tutorial._currentPage==this.tutorial.lastPage()?(n.setError("You are already at the last page."),!0):(this.tutorial.goToNextPage(),"show_tutorial")}},{name:"back",auth:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("back")).append(" to go to the previous page of your current tutorial");return e},history:!1,callback:function(e,t,n,r){return this.tutorial._currentPage==0?(n.setError("You are already at the first page."),!0):(this.tutorial.goToPrevPage(),"show_tutorial")}},{name:"tutorial",auth:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("start")).append(" to go to the start of your current tutorial");return e},history:!1,callback:function(e,t,n,r){return this.tutorial._currentPage=0,"show_tutorial"}},{name:"tutorial list",auth:!1,history:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("tutorial list")).append(" to see a list of available tutorials");return e},callback:function(e,t,n,r){var i=this.tutorial.list();if(i.length==0)return n.setError($.jqElem("span").append("Could not load tutorials.<br>\n").append(this.tutorial.list_text(this))),r.reject(),!0;var s=n.data("output");return s.empty(),$.each(i,$.proxy(function(e,t){s.append($("<a></a>").attr("href","#").append(t.title).bind("click",$.proxy(function(e){e.preventDefault(),e.stopPropagation(),n.setError($.jqElem("span").append("Set tutorial to <b>"+t.title+"</b><br>")),this.tutorial.retrieveTutorial(t.url),n.isHidden()||this.scroll(),this.input_box.focus()},this)).append("<br>"))},this)),r.resolve(),n.isHidden()||this.scroll(),!0}},{name:"show_tutorial",auth:!1,history:!1,callback:function(e,t,n,r){var i=this.tutorial.contentForCurrentPage(this);n.setValue(i);if(i==undefined)return n.setError("Could not load tutorial"),r.reject(),!0;i=i.clone(!0);var s={"text-align":"left","font-size":"100%"};return i.find("h1").css(s),i.find("h2").css(s),this.tutorial._currentPage>0&&i.append(this.tutorial.back_text(this)),this.tutorial._currentPage<this.tutorial.pages.length-1&&i.append(this.tutorial.next_text(this)),i.append(this.tutorial.list_text(this)),n.setOutput(i),r.resolve(),n.isHidden()||this.scroll(),!0}})}),define("kbaseIrisTerminalDispatchAuth",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"login",help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("login $username")).append(" to create an unauthenticated session with user <b>$username</b>.");return e},auth:!1,regex:new RegExp(/^log[io]n\s+(.+)$/),callback:function(e,t,n,r){e=e[0].split(/\s+/);if(e.length!=1){n.setError($.jqElem("span").append("Invalid login syntax, should be : ").append(this.create_input_link("login $username"))),r.reject();return}return this.client().start_session(e[0],$.proxy(function(e){var t={kbase_sessionid:e,success:!0,unauthenticated:!0};this.sessionId()&&(this.terminal.empty(),this.trigger("logout",!1),this.trigger("loggedOut")),this.trigger("loggedIn",t),r.resolve()},this),$.proxy(function(e){n.setError($.jqElem("span").append("Error on session_start:<br>"+this.format_error(e))),r.reject()},this)),!0}},{name:"authenticate",auth:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("authenticate $username")).append(" to create an authenticated session with user <b>$username</b>.").append("<br>Type ").append(this.create_input_link("authenticate")).append(" to create an authenticated session and specify the user in the dialog box.");return e},regex:new RegExp(/^authenticate\s*(.*)$/),callback:function(e,t,n,r){e.length==0&&(e=[""]),e=e[0].split(/\s+/);if(e.length>1){n.setError($.jqElem("span").append("Invalid authenticate syntax, should be : ").append(this.create_input_link("authenticate $username"))),r.reject();return}return this.sessionId()&&this.trigger("loggedOut"),this.trigger("promptForLogin",{user_id:e[0]}),!0}},{name:"unauthenticate",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("unauthenticate")).append(" to log out of your current session.");return e},history:!1,callback:function(e,t,n,r){return this.trigger("logout"),r.resolve(),!0}},{name:"logout",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("logout")).append(" to log out of your current session.");return e},history:!1,callback:function(e,t,n,r){return this.trigger("logout",!1),this.trigger("loggedOut",!1),r.resolve(),!0}})}),define("kbaseIrisTerminalDispatchFile",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"cd",auth:!0,regex:new RegExp(/^cd\s*(.*)/),help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("cd $directoryName")).append(" to change into directory <b>$directoryName</b>.").append("<br>Type ").append(this.create_input_link("cd")).append(" to return to your home directory.");return e},callback:function(e,t,n,r){return e=e[0].split(/\s+/),e.length!=1?(n.setError("Invalid cd syntax."),r.reject(),!0):(e[0]==""?dir="/":e[0]=="~"?dir="/":dir=e[0],this.client().change_directory(this.sessionId(),this.cwd,dir,$.proxy(function(e){this.cwd=e,n.setError($.jqElem("span").html("changed directory into <b>"+e+"</b>")),r.resolve()},this),$.proxy(function(e){var t=e.error.message.replace("/\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()},this)),!0)}},{name:"cp",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("cp $file1 $file2")).append(" to copy the contents of <b>$file1</b> to <b>$file2</b>");return e},regex:new RegExp(/^cp\s*(.*)/),callback:function(e,t,n,r){e=e[0].split(/\s+/);if(e.length!=2)return n.setError("Invalid cp syntax."),r.reject(),!0;var i=e[0],s=e[1];return this.client().copy(this.sessionId(),this.cwd,i,s,$.proxy(function(){this.refreshFileBrowser(),n.setError($.jqElem("span").html("Copied <b>"+i+"</b> to <b>"+s+"</b>")),r.resolve()},this),$.proxy(function(e){var t=e.error.message.replace("\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()},this)),!0}},{name:"mv",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("mv $file1 $file2")).append(" to move the contents of <b>$file1</b> to <b>$file2</b>, and delete <b>$file1</b>");return e},regex:new RegExp(/^mv\s*(.*)/),callback:function(e,t,n,r){return e=e[0].split(/\s+/),e.length!=2?(n.setError("Invalid mv syntax."),r.reject(),!0):(from=e[0],to=e[1],this.client().rename_file(this.sessionId(),this.cwd,from,to,$.proxy(function(){this.refreshFileBrowser(),n.setError($.jqElem("span").html("Moved <b>"+from+"</b> to <b>"+to+"</b>")),r.resolve()},this),$.proxy(function(e){var t=e.error.message.replace("\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()},this)),!0)}},{name:"mkdir",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("mkdir $directoryName")).append(" to create a new directory with name <b>directoryname</b>");return e},regex:new RegExp(/^mkdir\s*(.*)/),callback:function(e,t,n,r){return e=e[0].split(/\s+/),e[0].length<1?(n.setError("Invalid mkdir syntax."),r.reject(),!0):($.each(e,$.proxy(function(e,t){this.client().make_directory(this.sessionId(),this.cwd,t,$.proxy(function(){this.refreshFileBrowser(),n.setError($.jqElem("span").html("Made directory <b>"+t+"</b>")),r.resolve()},this),$.proxy(function(e){var t=e.error.message.replace("\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()},this))},this)),!0)}},{name:"rmdir",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("rmdir $directoryName")).append(" to remove the directory with name <b>directoryname</b>");return e},regex:new RegExp(/^rmdir\s*(.*)/),callback:function(e,t,n,r){return e=e[0].split(/\s+/),e[0].length<1?(n.setError("Invalid rmdir syntax."),r.reject(),!0):($.each(e,$.proxy(function(e,t){this.client().remove_directory(this.sessionId(),this.cwd,t,$.proxy(function(){this.refreshFileBrowser(),n.setError($.jqElem("span").html("Removed directory <b>"+t+"</b>")),r.resolve()},this),$.proxy(function(e){var t=e.error.message.replace("\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()},this))},this)),!0)}},{name:"rm",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("rm $fileName")).append(" to remove the file with name <b>$fileName</b>");return e},regex:new RegExp(/^rm\s+(.*)/),callback:function(e,t,n,r){return e=e[0].split(/\s+/),e[0].length<1?(n.setError("Invalid rm syntax."),r.reject(),!0):($.each(e,$.proxy(function(t,i){this.client().remove_files(this.sessionId(),this.cwd,i,$.proxy(function(){this.refreshFileBrowser(),n.setError($.jqElem("span").html("Removed file <b>"+i+"</b>")),e.length>1&&t==e.length-1&&n.setError($.jqElem("span").html("Removed all files.")),r.resolve()},this),$.proxy(function(e){var t=e.error.message.replace("\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()},this))},this)),!0)}},{name:"upload",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("upload")).append(" to upload a file. You will be prompted to select a file, and it will create a file of that name in your current directory.").append("<br>Type ").append(this.create_input_link("upload $fileName")).append(" to upload a file into file <b>filename</b>. You will be prompted to select a file.");return e},regex:new RegExp(/^upload\s*(\S+)?$/),callback:function(e,t,n,r){var i=e[0];if(this.fileBrowsers.length){var s=this.fileBrowsers[0];i&&s.data("override_filename",i),s.data("active_directory",this.cwd),s.uploadFile(),r.resolve()}return!0}},{name:"download",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("download $fileName")).append(" to download the file with name <b>filename</b>.");return e},regex:new RegExp(/^download\s*(\S+)?$/),callback:function(e,t,n,r){var i=e[0];if(this.fileBrowsers.length){var s=this.fileBrowsers[0];s.data("active_directory",this.cwd),s.downloadFile(i),r.resolve()}return!0}},{name:"edit",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("edit $fileName")).append(" to open the file with name <b>filename</b> in the file editor.");return e},regex:new RegExp(/^edit\s*(\S+)?$/),callback:function(e,t,n,r){var i=e[0];if(this.fileBrowsers.length){var s=this.fileBrowsers[0];s.data("active_directory",this.cwd),s.editFileCallback()?s.editFileCallback()(i,s):n.setError("Cannot edit : no editor"),r.resolve()}return!0}},{name:"view",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("view $imageName")).append(" to view the image with name <b>$imageName</b>.");return e},regex:new RegExp(/^view\s+(\S+)$/),callback:function(e,t,n,r){var i=e[0],s=$.jqElem("img").attr("src",this.fileBrowsers[0].downloadUrlForFile(i)).css("max-width","90%"),o=$.jqElem("a").append(s).attr("href",this.fileBrowsers[0].downloadUrlForFile(i)).css("border","0px");return n.setOutput(o),setTimeout($.proxy(function(){this.scroll()},this),500),r.resolve(),!0}},{name:"ls",help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("ls")).append(" to list the contents of the current directory.").append("<br>Type ").append(this.create_input_link("ls $directoryName")).append(" to list the contents of the directory <b>$directoryName</b>.").append("<br>Type ").append(this.create_input_link("ls $regex")).append(" to list only files matching the regular expression <b>$regex</b>.");return e},auth:!0,regex:new RegExp(/^ls\s*(.*)/),callback:function(e,t,n,r){var i,s=this;e.length==0?i=".":i=e[0];var o=undefined;return i.match(/[*+?\s.]/)&&(i=i.replace(/\s+/g,"|"),i=i.replace(/\./g,"."),i=i.replace(/([*+?])/g,".$1"),o=new RegExp("^("+i+")$"),i="."),this.client().list_files(this.sessionId(),this.cwd,i,$.proxy(function(e){var t=e[0],i=e[1],s=[];$.each(t,function(e,t){if(o!=undefined&&!t.name.match(o))return;s.push({size:"(directory)",mod_date:t.mod_date,name:t.name,nameTD:t.name})}),$.each(i,$.proxy(function(e,t){if(o!=undefined&&!t.name.match(o))return;s.push({size:t.size,mod_date:t.mod_date,name:t.name,dlTD:$.jqElem("span").append($.jqElem("button").attr("class","fa fa-download").attr("href","#").on("click",$.proxy(function(e){return e.preventDefault(),e.stopPropagation(),this.download_file(t.full_path),!1},this))),nameTD:$.jqElem("span").append($.jqElem("a").text(t.name).attr("href",this.fileBrowsers[0].viewUrlForFile(t.full_path)).attr("target","_blank")),url:this.options.invocationURL+"/download/"+t.full_path+"?session_id="+this.sessionId()})},this));var u={structure:{header:[],rows:[]},sortable:!0,bordered:!1};$.each(s.sort(this.sortByKey("name","insensitively")),$.proxy(function(e,t){u.structure.rows.push([t.size,t.mod_date,{value:t.nameTD},{value:t.dlTD}])},this));var a=$.jqElem("div").kbaseTable(u);u.structure.rows.length?(n.setOutput(a.$elem),n.setValue(e)):n.setError("no matching files found"),r.resolve(),n.isHidden()||this.scroll()},this),function(e){var t=e.error.message.replace("\n","<br>\n");n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+t)),r.reject()}),!0}})}),define("kbaseIrisTerminalDispatchHelp",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"help",auth:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("help")).append(" receive system help.");return e},callback:function(e,t,n,r){return n.setOutput($.jqElem("span").append("There is an introductory Iris tutorial available at ").append(this.create_ext_link(window.kbaseIrisConfig.tutorial.default_tutorial))),r.resolve(),!0}},{name:"whatsnew",auth:!1,regex:new RegExp(/whatsnew(\s+--recent)?/),help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("whatsnew")).append(" to view the release change log.").append("<br>Type ").append(this.create_input_link("whatsnew --recent")).append(" to view the changes from the most recent release.");return e},history:!1,callback:function(e,t,n,r){return e[0]?(this.dbg("RECENT NOTES"),this.dbg(this),n.setOutput(this.whatsnew().ulForCurrentRelease())):n.setOutput(this.whatsnew().ulForAllReleases()),n.isHidden()||this.scroll(),!0}},{name:"commands",auth:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("commands")).append("  to view available invocation commands");return e},history:!1,callback:function(e,t,n,r){return this.client().valid_commands($.proxy(function(e){var t={structure:{header:[],rows:[]},sortable:!0,hover:!1};jQuery.each(e,function(e,n){t.structure.rows.push([{value:n.title,colspan:2,style:"font-weight : bold; text-align : center"}]);for(var r=0;r<n.items.length;r+=2)t.structure.rows.push([n.items[r].cmd,n.items[r+1]!=undefined?n.items[r+1].cmd:""])});var i=$.jqElem("div").kbaseTable(t);n.setOutput(i.$elem),n.setValue(e),r.resolve(),this.dbg("IS HIDDEN : "+n.isHidden()),n.isHidden()||(this.dbg("SCROLL IT"),this.scroll())},this)),!0}},{name:"questions",regex:new RegExp(/^questions\s*(\S+)?/),history:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("questions")).append("  to view available English language questions");return e},auth:!1,callback:function(e,t,n,r){var i=this.options.grammar.allQuestions(e[0]),s={structure:{header:[],rows:[]},sortable:!0};$.each(i,$.proxy(function(e,t){s.structure.rows.push([{value:$.jqElem("a").attr("href","#").text(t).bind("click",$.proxy(function(e){e.preventDefault(),this.input_box.val(t),this.selectNextInputVariable()},this))}])},this));var o=$.jqElem("div").kbaseTable(s);return n.setOutput(o.$elem),n.setValue(i),r.resolve(),n.isHidden()||this.scroll(),!0}})}),define("kbaseIrisTerminalDispatchEnv",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"setenv",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("setenv $variable = $value")).append(" to change environment variable <b>$variable</b> to <b>$value</b>.");return e},regex:new RegExp(/^setenv\s+(\S+)\s*=\s*(\S+)/),callback:function(e,t,n,r){return this.envKeys[e[0]]?(this.options[e[0]]=e[1]=="undefined"?undefined:e[1],n.setOutput($.jqElem("span").html("<b>"+e[0]+"</b> set to <b>"+e[1]+"</b>")),n.setValue(e[1])):n.setError($.jqElem("span").html("Cannot set environment variable <b>"+e[0]+"</b>: Unknown")),r.resolve(),n.isHidden()||this.scroll(),!0}},{name:"environment",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("environment")).append(" to list your currently set environment variables");return e},callback:function(e,t,n,r){var i=[];$.each(Object.keys(this.envKeys).sort(),$.proxy(function(e,t){i.push({variable:t,value:this.options[t]==undefined?"<i>undefined</i>":this.options[t]})},this));var s={structure:{header:["variable","value"],rows:i},sortable:!0,hover:!1},o=$.jqElem("div").kbaseTable(s);return n.setOutput(o.$elem),n.setValue(i),r.resolve(),n.isHidden()||this.scroll(),!0}},{name:"alias",help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("alias $new_command = $old_command")).append(" to create a new alias for an existing command.");return e},auth:!0,regex:new RegExp(/^alias\s+(\S+)\s*=\s*(\S+)/),callback:function(e,t,n,r){return this.aliases[e[0]]=e[1],n.setOutput($.jqElem("span").html("<b>"+e[0]+"</b> set to <b>"+e[1]+"</b>")),r.resolve(),!0}},{name:"variable assignment",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append("<i><b>$variable</b> = <b>value</b></i>").append(" to set a user defined variable.");return e},regex:new RegExp(/^(\$\S+)\s*=\s*(\S+)/),callback:function(e,t,n,r){return e[1]=="undefined"?(delete this.variables[e[0]],n.setOutput($.jqElem("span").html("Deleted <b>"+e[0]+"</b>"))):(this.variables[e[0]]=e[1],n.setOutput($.jqElem("span").html("<b>"+e[0]+"</b> set to <b>"+e[1]+"</b>"))),r.resolve(),!0}},{name:"variables",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("variables")).append(" to see a list of variables defined in this session.");return e},callback:function(e,t,n,r){var i=[];$.each(Object.keys(this.variables).sort(),$.proxy(function(e,t){i.push({variable:t,value:this.variables[t]})},this));var s={structure:{header:["variable","value"],rows:i},sortable:!0,hover:!1},o=$.jqElem("div").kbaseTable(s);return n.setOutput(o.$elem),n.setValue(i),r.resolve(),n.isHidden()||this.scroll(),!0}})}),define("kbaseIrisTerminalDispatchScript",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"record",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("record")).append(" to begin recording commands to save to a script");return e},callback:function(e,t,n,r){return n.setError("recording actions"),this.recording=!0,n.isHidden()||this.scroll(),r.resolve(),!0}},{name:"save",regex:new RegExp(/^save\s*(.+)/),help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("save $filename")).append(" to save recorded actions to file <b>$filename</b>");return e},auth:!0,callback:function(e,t,n,r){return e=e[0].split(/\s+/),e.length!=1?(n.setError("Invalid save syntax. Please specify a file name."),r.reject(),!0):this.record==undefined?(n.setError("Error : Not recording. Cannot save."),r.reject(),!0):(file=e[0],this.client().put_file(this.sessionId(),file,this.record.join("\n"),this.cwd,$.proxy(function(){n.setOutput("Recording saved as "+file),this.recording=!1,this.record=undefined,r.resolve()},this),$.proxy(function(e){n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+m)),r.reject()},this)),!0)}},{name:"snapshot",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("snapshot $filename")).append(" to save selected widgets to a snapshot file <b>$filename</b>");return e},regex:new RegExp(/^snapshot\s*(.*)/),callback:function(e,t,n,r){e=e[0].split(/\s+/);if(!e[0].length||e.length!=1)return n.setError("Invalid snapshot syntax. Please specify a file name."),r.reject(),!0;file=e[0];if(!this.selectedWidgets.length)return n.setError("No widgets selected for snapshot"),r.reject(),!0;var i=[];$.each(this.selectedWidgets,function(e,t){i.push(t.freeze())});var s=[];return $.each(this.fileBrowsers,function(e,t){$.each(t.selectedFiles(),function(e,t){t&&s.push(e)})}),snapshot={widgets:i,files:s},this.client().put_file(this.sessionId(),file,JSON.stringify(snapshot),this.cwd,$.proxy(function(){n.setOutput("Snapshot saved as "+file);var e=this.selectedWidgets;$.each(e,function(e,t){t.setIsSelected(!1)}),$.each(this.fileBrowsers,function(e,t){var n=t.selectedFiles();$.each(n,function(e,n){n&&t.toggleSelection(e)})}),r.resolve()},this),$.proxy(function(e){n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+m)),r.reject()},this)),!0}},{name:"thaw",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("thaw $filename")).append(" to recreate a snapshotted set of widgets in <b>$filename</b>");return e},regex:new RegExp(/^thaw\s*(.+)/),callback:function(e,t,n,r){return e=e[0].split(/\s+/),e.length!=1?(n.setError("Invalid that syntax. Please specify a file name."),r.reject(),!0):(file=e[0],n.$elem.css("background-color","#DDDDDD"),this.client().get_file(this.sessionId(),file,this.cwd,$.proxy(function(e){var t=JSON.parse(e);$.each(t.widgets,$.proxy(function(e,t){var r=n.thaw(t);n.appendWidget(r)},this)),r.resolve()},this),$.proxy(function(e){n.setError($.jqElem("span").append("Error received:<br>"+e.error.code+"<br>"+m)),r.reject()},this)),!0)}},{name:"search",auth:!0,regex:new RegExp(/^search\s+(\S+)\s+(\S+)(?:\s*(\S+)\s+(\S+)(?:\s*(\S+))?)?/),callback:function(e,t,n,r){var i=this.options.grammar.evaluate(t),s={},o=this.options.searchURL;s.$category=e[0],s.$keyword=e[1],s.$start=e[2]||this.options.searchStart,s.$count=e[3]||this.options.searchCount;var u=e[4]||this.options.searchFilter[s.$category];for(prop in s)o=o.replace(prop,s[prop]);return $.support.cors=!0,$.ajax({type:"GET",url:o,dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},xhrFields:{withCredentials:!0},beforeSend:function(e){e.withCredentials=!0},success:$.proxy(function(e,t,i){var s=$.jqElem("span");s.append("<br>","html"),s.append($("<i></i>").html("Command completed.")),s.append("<br>","html"),s.append($.jqElem("span").append($.jqElem("b").html(e.found)).append(" records found.")),s.append("<br>","html"),s.append(this.search_json_to_table(e.body,u)),n.setOutput(s),n.setValue({results:e.body,filter:u});var t=this.search_json_to_table(e.body,u);n.isHidden()||this.scroll(),r.resolve()},this),error:$.proxy(function(e,t,i){n.setError(i),r.reject()},this)}),!0}},{name:"execute",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("execute $filename")).append(" to execute the series of IRIS commands stored in the script <b>$filename</b>");return e},regex:new RegExp(/^execute\s+(.*)/),callback:function(e,t,n,r,i){return e.length!=1?(n.setError("Invalid execute syntax."),r.reject(),!0):(this.client().get_file(this.sessionId(),e[0],this.cwd,$.proxy(function(e){r.resolve(),n.$elem.next().prop("tagName")=="HR"&&n.$elem.next().remove(),this.run(e,{subCommand:!0,$containerWidget:n,viaInvoke:i.viaInvoke})},this),$.proxy(function(e){n.setError("No such script"),r.reject()},this)),!0)}},{name:"evaluate",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("evaluate $filename")).append(" to execute the javascript contained within script $filename");return e},regex:new RegExp(/^evaluate\s+(.*)/),callback:function(e,t,n,r){var i=e[0];return i.length<1?(n.setError("Invalid evalute syntax."),r.reject(),!0):(this.client().get_file(this.sessionId(),i,this.cwd,$.proxy(function(e){this.evaluateScript(this,n,e,r,n)},this),$.proxy(function(e){this.evaluateScript(this,n,i,r,n)},this)),!0)}})}),define("kbaseIrisTerminalDispatchHistory",["kbaseIrisConfig"],function(){window.kbaseIrisConfig.terminal.run_dispatch.push({name:"history",auth:!0,history:!1,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("history")).append("  to view history of all commands typed.");return e},callback:function(e,t,n,r){var i={structure:{header:[],rows:[]},sortable:!0};jQuery.each(this.commandHistory,$.proxy(function(e,t){i.structure.rows.push([e,{value:$.jqElem("a").attr("href","#").text(t).bind("click",$.proxy(function(e){e.preventDefault(),this.appendInput(t+" ")},this)),style:"padding-left : 10px"}])},this));var s=$.jqElem("div").kbaseTable(i);return n.setOutput(s.$elem),n.setValue(this.commandHistory),r.resolve(),!0}},{name:"repeat",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("! $historyNum")).append(" to repeat the command at history line <b>$historyNum</b>").append("<br>Type ").append(this.create_input_link("!!")).append(" to repeat the last command.");return e},regex:new RegExp(/^!(!|\d+)/),callback:function(e,t,n,r){return e[0]=="!"?(this.dbg("bang bang"),this.dbg(this.commandHistory[this.commandHistory.length]),this.dbg(this.commandHistory[this.commandHistory.length-1]),this.dbg(this.commandHistory[this.commandHistory.length-2]),this.commandHistory[this.commandHistory.length-2]):this.commandHistory[e[0]]}})}),define("kbaseIrisTerminalDispatch",["kbaseIrisConfig","kbaseIrisTerminalDispatchTutorial","kbaseIrisTerminalDispatchAuth","kbaseIrisTerminalDispatchFile","kbaseIrisTerminalDispatchHelp","kbaseIrisTerminalDispatchEnv","kbaseIrisTerminalDispatchScript","kbaseIrisTerminalDispatchHistory"],function(){}),define("kbaseIrisTerminal",["jquery","kbwidget","kbaseButtonControls","kbaseIrisTutorial","kbaseIrisFileBrowser","kbaseAuthenticatedWidget","kbaseIrisCommands","kbaseIrisGrammar","kbaseIrisTerminalWidget","kbaseIrisTextWidget","kbaseIrisContainerWidget","kbaseTable","kbaseIrisConfig","kbaseIrisTerminalDispatch"],function($){$.KBWidget({name:"kbaseIrisTerminal",parent:"kbaseAuthenticatedWidget",version:"1.0.0",_accessors:["terminalHeight","client","subWidgets","whatsnew"],options:{searchStart:1,searchCount:10,searchFilter:{literature:"link,pid"},maxOutput:100,scrollSpeed:750,terminalHeight:"550px",promptIfUnauthenticated:!1,autocreateFileBrowser:!0,environment:["maxOutput","scrollSpeed"],subWidgets:[],defaultFileType:"IrisFile",invocationURL:window.kbaseIrisConfig.terminal.invocationURL,searchURL:window.kbaseIrisConfig.terminal.searchURL},run_dispatch:[{name:"clear",help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("clear")).append(" to clear your terminal history.");return e},auth:!1,history:!1,callback:function(e,t,n,r){while(this.subWidgets().length)this.removeWidget(this.subWidgets()[0]);return this.trigger("clearIrisProcesses"),this.terminal.empty(),r.resolve(),!0}},{name:"end",help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("end")).append(" to jump to the end of your terminal scroll.");return e},auth:!1,history:!1,callback:function(e,t,n,r){return this.terminal.animate({scrollTop:this.terminal.prop("scrollHeight")-this.terminal.height()},0),r.resolve(),!0}},{name:"comment",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("#$comment")).append(" to create a comment for later reference.");return e},regex:new RegExp(/^#\s*((?:.|\n)+)/),callback:function(e,t,n,r){return n.setIsComment(!0),n.setInput(e[0]),n.setOutput(""),n.setError(""),n.subWidgets([]),r.resolve(),!0}},{name:"widget",auth:!0,help:function(){var e=$.jqElem("span").append("Type ").append(this.create_input_link("widget $widgetname")).append(" to add a widget with name <b>$widgetname</b>.");return e},regex:new RegExp(/^widget\s+(.*)/),callback:function(e,t,n,r){var e=e[0].split(/\s+/),i=this;if(!e[0].length)return n.setError("incorrect add widget syntax"),r.reject(),!0;var n=this.addWidget(e[0],e.length>1);return e.length>1&&n.setInput(e[1]),r.resolve(),!0}}],create_input_link:function(e,t){t==undefined&&(t=e);var n=$.jqElem("a").attr("title",e).append(e).on("click",$.proxy(function(e){this.appendAndFocusInput(t)},this));return n},appendAndFocusInput:function(e){var t=e+" ";this.input_box.val().length&&!this.input_box.val().match(/[\|;]\s*$/)&&(t="| "+t),this.appendInput(t),this.input_box.setCursorPosition(0),this.selectNextInputVariable()||this.input_box.focusEnd()},create_run_link:function(e,t){t==undefined&&(t=e);var n=$.jqElem("a").attr("title",e).append(e).on("click",$.proxy(function(e){this.run(t)},this));return n},create_ext_link:function(e,t){t==undefined&&(t=e);var n=$.jqElem("a").attr("title",e).attr("target","_blank").attr("href",t).append(e);return n},warn_not_logged_in:function(e){e.setError($.jqElem("span").append("You are not logged in.<br>Please click the ").append(this.create_run_link("Sign In","((authenticate))")).append(" link in the upper right to get started.")),e.isHidden()||this.scroll()},format_error:function(e){var t=undefined;return typeof e.error=="string"?t=e.error+" : "+e.status:t=e.error.message,t.replace("\n","<br>\n"),t},setenv:function(e,t){},notifyOfIrisCommands:function(e){var t=[];$.each(this.run_dispatch,function(e,n){t.push({cmd:n.name,label:n.name})}),t=t.sort(this.sortByKey("label")),$.each(t,$.proxy(function(t,n){e==undefined?this.trigger("addedIrisCommand",n):e.addIrisCommand(n)},this))},init:function(e){this._super(e),$.each(window.kbaseIrisConfig.terminal.run_dispatch,$.proxy(function(e,t){this.add_to_dispatch(t,"silently")},this)),this.notifyOfIrisCommands(),this.whatsnew(new KBase.irisWhatsNew),$.fn.setCursorPosition=function(e){return this.length==0?this:$(this).setSelection(e,e)},$.fn.setSelection=function(e,t){if(this.length==0)return this;input=this[0];if(input.createTextRange){var n=input.createTextRange();n.collapse(!0),n.moveEnd("character",t),n.moveStart("character",e),n.select()}else input.setSelectionRange&&(input.focus(),input.setSelectionRange(e,t));return this},$.fn.focusEnd=function(){return this.setCursorPosition(this.val().length),this},$.fn.getCursorPosition=function(){return this.length==0?this:(input=this[0],input.selectionEnd)},this.envKeys={},$.each(this.options.environment,$.proxy(function(e,t){this.envKeys[t]=1},this)),this.client()==undefined&&this.client(new InvocationService(this.options.invocationURL,this.auth())),this.tutorial=new KBase.irisTutorial,this.commandHistory=[],this.commandHistoryPosition=0,this.path=".",this.cwd="/",this.variables={},this.aliases={},this.live_widgets=[],this.appendUI(this.$elem),this.fileBrowsers=[],this.options.fileBrowser?this.addFileBrowser(this.options.fileBrowser):this.options.autocreateFileBrowser&&this.addFileBrowser($.jqElem("div").kbaseIrisFileBrowser({client:this.client(),externalControls:!1,invocationURL:this.options.invocationURL})),$(document).on("requestIrisCommands.kbaseIris",$.proxy(function(e,t){this.notifyOfIrisCommands(t.requester)},this)),$(document).on("loggedInQuery.kbase",$.proxy(function(e,t){var n=this.auth();t&&n!=undefined&&n.unauthenticated==1&&t(n)},this)),this.selectedWidgets=[],this.$elem.on("toggleWidgetSelection.kbaseIris",$.proxy(function(e,t){e.stopPropagation(),e.preventDefault(),t.isSelected()?this.deselectWidget(t):this.selectWidget(t)},this)),this.$elem.on("removeWidget.kbaseIris",$.proxy(function(e,t){this.removeWidget(t.$widget)},this)),this.$elem.on("scrollTo.kbaseIris",$.proxy(function(e,t){this.terminal.animate({scrollTop:this.terminal.prop("offsetTop")-85},0)},this)),this.$elem.on("runWidget.kbaseIris",$.proxy(function(e,t){t.$widget.isComment()&&(t.command="#"+t.command),this.run(t.command,{$widget:t.$widget})},this)),this.options.commandsElement==undefined&&(this.options.commandsElement=$.jqElem("div"),this.options.commandsElement.kbaseIrisCommands({client:this.client(),terminal:this})),this.options.grammar==undefined&&(this.options.grammar=$.jqElem("div").kbaseIrisGrammar());var t=0;this.terminal.on("scroll",function(e){var n=$(this).scrollTop();n<t&&$(this).stop(!0),t=n});var n=localStorage.getItem("kbase_iris_version");return n!=this.whatsnew().currentVersion()&&(setTimeout($.proxy(function(){this.run("whatsnew --recent")},this),0),localStorage.setItem("kbase_iris_version",this.whatsnew().currentVersion())),this},loggedInCallback:function(e,t){this.client().setAuth(this.auth()),t.success&&(this.client().start_session(t.user_id,$.proxy(function(e){this.loadCommandHistory(),t.token?this.out_text("Authenticated as "+t.name):this.out_text("Unauthenticated logged in as "+t.kbase_sessionid),this.out_line(),this.scroll(),this.data("input_box").focus()},this),$.proxy(function(e){this.out_text("<i>Error on session_start:<br>"+e.error.message.replace("\n","<br>\n")+"</i>","html")},this)),this.data("input_box").focus())},loggedInQueryCallback:function(e){this.loggedInCallback(undefined,e),!e.success&&this.options.promptIfUnauthenticated&&this.trigger("promptForLogin")},loggedOutCallback:function(e){this.cwd="/",this.commandHistory=[],this.commandHistoryPosition=0,this.terminal.empty(),this.variables={},this.trigger("clearIrisProcesses"),this.input_box.focus()},logInCanceledCallback:function(e){this.loggedOutCallback()},addFileBrowser:function(e){this.fileBrowsers.push(e)},download_file:function(e){this.fileBrowsers[0].downloadFile(e)},view_file:function(e){this.fileBrowsers[0].viewFile(e)},refreshFileBrowser:function(){for(var e=0;e<this.fileBrowsers.length;e++)this.fileBrowsers[e].refreshDirectory(this.cwd)},appendInput:function(e,t){if(this.input_box){var n=t==undefined?" ":"";this.input_box.val().length==0&&(n=""),this.input_box.val(this.input_box.val()+n+e),this.input_box.focusEnd()}},appendUI:function(e){var t=$("<div></div>").append($("<div></div>").attr("id","terminal").css("height",this.options.terminalHeight).css("overflow","auto").css("padding","5px").css("font-family","monospace")).append($("<textarea></textarea>").attr("id","input_box").attr("style","width : 95%;").attr("height","3").attr("spellcheck","false"));this._rewireIds(t,this);var n=this.data("terminal");e.append(t),this.terminal=this.data("terminal"),this.input_box=this.data("input_box"),this.out_text($.jqElem("span").append("Welcome to the interactive KBase terminal!<br>\nPlease click the ").append(this.create_run_link("Sign In","((authenticate))")).append(" button in the upper right to get started.<br>\nType ").append(this.create_run_link("commands")).append(" for a list of commands.<br>\nFor usage information about a specific command, type the command name with -h or --help after it.<br>\nPlease visit ").append(this.create_ext_link(window.kbaseIrisConfig.tutorial.default_tutorial)).append(" or type ").append(this.create_run_link("tutorial")).append(" for an IRIS tutorial.<br>\nTo find out what's new, type ").append(this.create_run_link("whatsnew")).append(" ("+this.whatsnew().currentReleaseString()+")").append("<br><br>").append($.jqElem("span").css("color","red").append('IRIS is a legacy system and is no longer officially supported. Some of the commands in the IRIS tutorials may not work correctly. We recommend that you use the next-generation KBase user interface, the <a href = "https://narrative.kbase.us/">Narrative interface</a>.')),"html"),this.out_line(),this.input_box.on("keypress",$.proxy(function(e){this.keypress(e)},this)),this.input_box.on("keydown",$.proxy(function(e){this.keydown(e)},this)),this.input_box.on("onchange",$.proxy(function(e){this.dbg("change")},this)),setTimeout($.proxy(function(){this.input_box.focus()},this),0),$(window).bind("resize",$.proxy(function(e){this.resize_contents(this.terminal)},this)),this.resize_contents(this.terminal)},saveCommandHistory:function(){this.client().put_file(this.sessionId(),"history",JSON.stringify(this.commandHistory),"/",function(){},function(){})},addCommandHistory:function(e){this.commandHistory==undefined&&(this.commandHistory=[]),this.commandHistory.push(e),this.saveCommandHistory(),this.commandHistoryPosition=this.commandHistory.length,this.recording&&(this.record==undefined&&(this.record=[]),this.record.push(e))},loadCommandHistory:function(){this.client().get_file(this.sessionId(),"history","/",$.proxy(function(e){this.commandHistory=JSON.parse(e),this.commandHistory==undefined&&(this.commandHistory=[]),this.commandHistoryPosition=this.commandHistory.length},this),$.proxy(function(e){this.dbg("error on history load : "),this.dbg(e)},this))},resize_contents:function(e){this.data("terminal").css("height",$(window).height()-135-56)},keypress:function(e){if(e.which==13){this.unsubmittedCommand=undefined;if(e.metaKey||e.altKey||e.ctrlKey)return;e.preventDefault();var t=this.input_box.val();if(t=="gui"){this.gui=!0,this.input_box.val("");return}if(t=="nogui"){this.gui=!1,this.input_box.val("");return}this.run(t),this.scroll(),this.input_box.val("")}},keydown:function(e){if(e.metaKey||e.altKey||e.ctrlKey)return;if(e.which==38)e.preventDefault(),this.unsubmittedCommand==undefined&&(this.unsubmittedCommand=this.input_box.val()),this.commandHistoryPosition>0&&this.commandHistoryPosition--,this.input_box.val(this.commandHistory[this.commandHistoryPosition]);else if(e.which==40)e.preventDefault(),this.unsubmittedCommand==undefined&&(this.unsubmittedCommand=this.input_box.val()),this.commandHistoryPosition<this.commandHistory.length&&this.commandHistoryPosition++,this.commandHistoryPosition==this.commandHistory.length&&this.unsubmittedCommand!=undefined?this.input_box.val(this.unsubmittedCommand):this.input_box.val(this.commandHistory[this.commandHistoryPosition]);else if(e.which==39&&this.options.commandsElement){var t=this.input_box.val().length,n=this.input_box.getCursorPosition();if(n!=undefined&&n<t){var r;if(r=this.selectNextInputVariable(e))return}e.preventDefault();var i=this.input_box.val().match(/([^\s]+)\s*$/);if(i.length){i=i[1];var r=this.options.grammar.evaluate(this.input_box.val());if(r!=undefined&&r.next&&r.next.length){var s=new RegExp("^"+i),o=[];for(var u=0;u<r.next.length;u++){var a=r.next[u];a.match(s)&&o.push(a)}if(o.length||r.parsed.length==0){r.next=o;if(r["next"].length==1){var f=new RegExp("s*"+i+"s*$");this.input_box.val(this.input_box.val().replace(f,""))}}if(r["next"].length==1){var l=" ";this.input_box.val().match(/\s+$/)&&(l=""),this.appendInput(l+r.next[0]+" ",0),this.selectNextInputVariable();return}if(r.next.length){var c=!0,h=new RegExp(i+"\\s*$");for(prop in r.next)prop.match(h)||(c=!1);this.displayCompletions(r.next,i);return}}var p=this.options.commandsElement.kbaseIrisCommands("completeCommand",i);if(p.length==1){var d=p[0][0].replace(new RegExp("^"+i),"");this.appendInput(d+" ",0)}else p.length&&this.displayCompletions(p,i)}}},selectNextInputVariable:function(e){var t,n=this.input_box.getCursorPosition(),r=new RegExp(".{"+n+",}?(\\$\\S+)");if(t=this.input_box.val().match(r)){e!=undefined&&e.preventDefault();var i=this.input_box.val().indexOf(t[1]),s=this.input_box.val().indexOf(t[1])+t[1].length;if(n<i||n==0)return this.input_box.setSelection(i,s),this.input_box.setSelection(i,s),!0;n==i&&this.input_box.setCursorPosition(n+1)}else this.input_box.setCursorPosition(n+1);return!1},search_json_to_table:function(e,t){var n=$.jqElem("div"),r=new RegExp(".");return t&&(r=new RegExp(t.replace(/,/g,"|"))),$.each(e,$.proxy(function(e,t){var i=$.jqElem("table").css("border","1px solid black").css("margin-bottom","2px"),s=Object.keys(t).sort();for(var e=0;e<s.length;e++){var o=s[e];o.match(r)&&i.append($("<tr></tr>").css("text-align","left").append($("<th></th>").append(o)).append($("<td></td>").append(t[o])))}n.append(i)},this)),n},displayCompletions:function(e,t){var n=this.options.commandsElement.kbaseIrisCommands("commonCommandPrefix",e);n!=undefined&&n.length?this.input_box.val(this.input_box.val().replace(new RegExp(t+"s*$"),n)):n=t;var r=$.jqElem("table").attr("border",1).css("margin-top","10px").append($.jqElem("tr").append($.jqElem("th").text("Suggested commands")));jQuery.each(e,$.proxy(function(e,t){var i=$.isArray(t)?t[0]:t;r.append($.jqElem("tr").append($.jqElem("td").append($.jqElem("a").attr("href","#").text(i).on("click",$.proxy(function(e){e.preventDefault(),this.input_box.val(this.input_box.val().replace(new RegExp(n+"s*$"),"")),this.appendInput(i+" ")},this)))))},this));var i=$.jqElem("div").kbaseIrisTerminalWidget();this.appendWidget(i),i.setOutput(r),i.setValue({completions:e,prefix:n}),this.scroll()},out_text:function(e,t){var n=$.jqElem("div").kbaseIrisTextWidget();this.appendWidget(n),n.setText(e,t)},out_line:function(e){e==undefined&&(e=this.terminal);var t=$("<hr>");e.append(t),this.scroll(0)},scroll:function(e){this.terminal.stop(!0),e==undefined&&(e=parseInt(this.options.scrollSpeed)),this.terminal.animate({scrollTop:this.terminal.prop("scrollHeight")-this.terminal.height()},e)},replaceVariables:function(e){e=e.replace(/^ +/,""),e=e.replace(/ +$/,"");var t=e+e,n;if(n=e.match(/^\s*(\$\S+)/))t=n[1];(n=e.match(/^(\$\S+)\s*=\s*(\S+)/))&&delete this.variables[n[1]];for(variable in this.variables){if(variable.match(t))continue;var r=variable.replace(/\$/,"\\$"),i=new RegExp(r,"g");e=e.replace(i,this.variables[variable])}return e},jobqueue:function(e,t,n,r){var i=this.uuid(),s,o=[],u;e.startThinking(),$(document).on("removeIrisProcess.kbaseIris"+i,$.proxy(function(o,a){if(a==s){n!=undefined&&n(u);var f=this.nextJobInQueue(t);if(f!=undefined&&(r==undefined||r>0)){var l=this.invoke(e,f);s=l.$widget.pid(),u=l.$widget,r!=undefined&&r--}else e.stopThinking(),$(document).off("removeIrisProcess.kbaseIris"+i)}},this));var a=this.nextJobInQueue(t);if(a){var f=this.invoke(e,a);s=f.$widget.pid(),u=f.$widget}},nextJobInQueue:function(e){return $.isArray(e)?e.length?e.shift():undefined:e()},addWidget:function(e,t){var n=this.options.widgets[e]();this.appendWidget(n),n.render();if(this.live_widgets.length){var r=this.live_widgets.length-1;while(r>=0){var i=this.live_widgets[r];if(!i.isHidden()){n.acceptInput(i,t);break}r--}}return this.live_widgets.push(n),this.subWidgets().push(n),n},appendWidget:function(e){var t=!1;$.each(this.subWidgets(),$.proxy(function(n,r){if(r===e){t=!0;return}},this)),t||(this.terminal.append(e.$elem),this.subWidgets().push(e),e.$terminal=this)},removeWidget:function(e){for(var t=0;t<this.subWidgets().length;t++)if(this.subWidgets()[t]===e){this.deselectWidget(e),this.subWidgets().splice(t,1),e.$elem.remove();break}},selectWidget:function(e){this.selectedWidgets.push(e),e.setIsSelected(!0);var t=[];return $.each(this.subWidgets(),function(e,n){n.isSelected()&&t.push(n)}),this.selectedWidgets=t,e},deselectWidget:function(e){for(var t=0;t<this.selectedWidgets.length;t++)if(this.selectedWidgets[t]===e){this.selectedWidgets.splice(t,1),e.setIsSelected(!1);break}},evaluateScript:function($terminal,$widget,script,$deferred){var res;try{return script.match(/^(['"]).*\1$/)&&(script=eval(script)),$widget.output()==undefined&&$widget.setOutput($.jqElem("div")),script=script.replace(/\$terminal.invoke\(/g,"$terminal.invoke($widget,"),res=eval(script),$widget.output()==undefined&&$widget.setOutput(res),$deferred.resolve(),!0}catch(e){return $widget.setError(e),$deferred.reject(),!1}},invoke:function(e,t){return this.run(t,{subCommand:!1,$containerWidget:e,viaInvoke:!0})},add_to_dispatch:function(e,t){this.run_dispatch.push(e),t||this.trigger("addedIrisCommand",{cmd:e.name,label:e.name})},run:function(e,t){t==undefined&&(t={});var n=e;$.isArray(e)&&(n=e[1],e=e[0]);var r=t.$widget||$.jqElem("div").kbaseIrisTerminalWidget(),i=t.$containerWidget,s=$.Deferred(),o=s.promise();o.$widget=r;var u=this.options.grammar.tokenize(e);if(u.length==0)return s.resolve(),o;if($.isArray(u[0])){if(!t.subCommand){!t.viaInvoke&&!t.historyLess&&this.addCommandHistory(e);var a=$.jqElem("div").kbaseIrisTerminalWidget();i?(i.appendWidget(a),a.setSubCommand(!0,!0)):this.appendWidget(a),a.setCwd(this.cwd),a.setInput(n),a.setOutput($.jqElem("div")),t.subCommand=!0,i=a}e=this.options.grammar.detokenize(u.shift()),s.done($.proxy(function(e){this.run(this.options.grammar.detokenize(u),{subCommand:!0,$containerWidget:i,viaInvoke:t.viaInvoke})},this))}else e=this.options.grammar.detokenize(u);var f=this.replaceVariables(e),l=!1;if(m=f.match(/^\(\(([^]+)\)\)$/))l=!0,f=m[1],f=f.replace(/^\s+/,""),f=f.replace(/\s+$/,"");var c=[];r.setCwd(this.cwd),r.setInput(f),r.setSubCommand(t.subCommand),r.setIsHidden(l),i?i.appendWidget(r):this.appendWidget(r),this.dbg("Run ("+f+")["+l+"]");var h=!1;do{h=!1;var p=!1;$.each(this.run_dispatch,$.proxy(function(e,n){if(p)return;var i=[],u=!1,a=n.help_regex;a==undefined&&(a=n.help_regex=new RegExp("^\\s*"+n.name+"\\s+(-h|--help)\\s*$"));if(i=f.match(a)){var l=n.help||$.jqElem("span").html("help is not available for <i>"+n.name+"</i>");typeof l=="function"&&(l=l.apply(this)),r.setOutput(l),p=!0}else if(n.regex){if(i=f.match(n.regex))i.shift(),u=!0}else n.name==f&&(u=!0);u&&(n.auth==1&&!this.sessionId()?(this.warn_not_logged_in(r),p=!0):(!t.subCommand&&this.commandHistory!=undefined&&!t.viaInvoke&&!r.isHidden()&&(n.history==undefined||n.history==1)&&this.addCommandHistory(f),p=n.callback.call(this,i,f,r,s,o,t)))},this));if(typeof p=="boolean"&&p==1)return o;if(typeof p!="string"){if(!this.sessionId())return this.warn_not_logged_in(r),s.resolve(),o;!t.subCommand&&this.commandHistory!=undefined&&!t.viaInvoke&&!r.isHidden()&&this.addCommandHistory(f);var d=this.options.grammar.evaluate(f);if(d!=undefined)if(!d.fail&&d.execute){f=d.execute;if(d.explain)return r.setOutput(d.execute),s.resolve(),!0}else if(d.parsed.length&&d.fail)return r.setError(d.error),s.reject(),!0;var v=this.uuid();r.setPid(v);var g=$.jqElem("div").text(f);g.kbaseButtonControls({onMouseover:!0,context:this,controls:[{icon:"fa fa-ban",callback:function(e,t){r.promise().xhr.abort(),r.$elem.remove()}}]}),r.isHidden()||this.trigger("updateIrisProcess",{pid:v,content:g});var y=this.client().run_pipeline(this.sessionId(),f,[],this.options.maxOutput,this.cwd,$.proxy(function(e){if(e){var t=e[0],n=e[1];this.refreshFileBrowser();if(t.length>0&&t[0].indexOf("	")>=0){var i={structure:{header:[],rows:[]},sortable:!1,hover:!1,resizable:!0};$.each(t,function(e,t){var n=[];i.structure.rows.push(n),$.each(t.split(/\t/),function(e,t){n.push(t)})});var o=$.jqElem("div").kbaseTable(i);r.setOutput(o.$elem),r.setValue(t)}else r.setOutput(t.join("")),r.setValue(t);n.length?(r.setError(n.join("")),t.length?s.resolve():s.reject()):(r.setError("Command Completed"),s.resolve())}else r.setError("Error running command."),s.reject();r.isHidden()||this.scroll(),this.trigger("removeIrisProcess",v)},this),$.proxy(function(e){this.trigger("removeIrisProcess",v)},this));return r.promise(y),this.live_widgets.push(r),!0}f=p,h=!0}while(h)}})}),define("kbaseTabs",["jquery","kbwidget","kbaseDeletePrompt"],function(e){e.KBWidget({name:"kbaseTabs",version:"1.0.0",_accessors:["tabsHeight"],options:{tabPosition:"top",canDelete:!1,borderColor:"lightgray"},init:function(t){return this._super(t),this.data("tabs",{}),this.data("nav",{}),this.appendUI(e(this.$elem)),this},appendUI:function(t,n){n==undefined&&(n=this.options.tabs);var r=e.jqElem("div").addClass("tabbable"),i=e.jqElem("div").addClass("tab-content").attr("id","tabs-content").css("height",this.tabsHeight()),s=e.jqElem("ul").addClass("nav nav-tabs").attr("id","tabs-nav");r.append(s).append(i),this._rewireIds(r,this),t.append(r),n&&e.each(n,e.proxy(function(e,t){this.addTab(t)},this))},addTab:function(n){n.canDelete==undefined&&(n.canDelete=this.options.canDelete);var r=e("<div></div>").addClass("tab-pane fade").append(n.content);this.options.border&&(r.css("border","solid "+this.options.borderColor),r.css("border-width","0px 1px 0px 1px"),r.css("padding","3px"));var i=this,s=e("<li></li>").css("white-space","nowrap").append(e("<a></a>").attr("href","#").text(n.tab).attr("data-tab",n.tab).bind("click",function(t){t.preventDefault(),t.stopPropagation();var n=i.data("tabs-nav").find(".active:last a")[0];e.fn.tab.Constructor.prototype.activate.call(e(this),e(this).parent("li"),i.data("tabs-nav")),e.fn.tab.Constructor.prototype.activate.call(e(this),r,r.parent(),function(){e(this).trigger({type:"shown",relatedTarget:n})})}).append(e("<button></button>").addClass("btn btn-default btn-xs").append(e("<i></i>").addClass(this.closeIcon())).css("padding","0px").css("width","22px").css("height","22px").css("margin-left","10px").attr("title",this.deleteTabToolTip(n.tab)).tooltip().bind("click",e.proxy(function(e){e.preventDefault(),e.stopPropagation(),n.deleteCallback!=undefined?n.deleteCallback(n.tab):this.deletePrompt(n.tab)},this))));n.canDelete||s.find("button").remove(),this.data("tabs")[n.tab]=r,this.data("nav")[n.tab]=s,this.data("tabs-content").append(r),this.data("tabs-nav").append(s);var o=0;for(t in this.data("tabs"))o++;(n.show||o==1)&&this.showTab(n.tab)},closeIcon:function(){return"fa fa-times"},deleteTabToolTip:function(e){return"Remove "+e},hasTab:function(e){return this.data("tabs")[e]},showTab:function(e){this.shouldShowTab(e)&&this.data("nav")[e].find("a").trigger("click")},removeTab:function(e){var t=this.data("tabs")[e],n=this.data("nav")[e];n.hasClass("active")&&(n.next("li").length?n.next().find("a").trigger("click"):n.prev("li").find("a").trigger("click")),t.remove(),n.remove(),this.data("tabs")[e]=undefined,this.data("nav")[e]=undefined},shouldShowTab:function(e){return 1},deletePrompt:function(t){var n=e("<div></div>").kbaseDeletePrompt({name:t,callback:this.deleteTabCallback(t)});n.openPrompt()},deleteTabCallback:function(t){return e.proxy(function(e,n){n!=undefined&&n.closePrompt(),this.shouldDeleteTab(t)&&this.removeTab(t)},this)},shouldDeleteTab:function(e){return 1},activeTab:function(){var t=this.data("tabs-nav").find(".active:last a")[0];return e(t).attr("data-tab")}})}),define("kbaseIrisWorkspace",["jquery","kbaseTabs"],function(e){e.KBWidget({name:"kbaseIrisWorkspace",parent:"kbaseTabs",version:"1.0.0",options:{},XXXappendUI:function(t,n){t.append(e.jqElem("div").css("padding","2px").append(e("<h5></h5>").addClass("text-left").html("&nbsp;").css("padding","2px").css("margin","0px").css("position","relative").append(e.jqElem("div").css("right","0px").css("top","0px").css("position","absolute").append(e.jqElem("button").addClass("btn btn-default btn-mini").append(e("<i></i>").addClass("fa fa-plus")).css("padding-top","1px").css("padding-bottom","1px").attr("title","Add a terminal").tooltip().bind("click",e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.addTab({tab:"IRIS Terminal",content:$term.$elem,canDelete:!1,show:!0})},this)))))),this._super(t,n)}})}),define("kbaseFormBuilder",["jquery","kbwidget","kbasePrompt"],function(e){e.KBWidget({name:"kbaseFormBuilder",version:"1.0.0",options:{elements:[],values:{},dispatch:{text:"buildTextField",textarea:"buildTextArea",password:"buildSecureTextField",checkbox:"buildCheckbox",select:"buildSelectbox",multiselect:"buildSelectbox",radio:"buildRadioButton",hidden:"buildHiddenField",string:"buildTextField",secure:"buildSecureTextField","enum":"buildSelectbox","boolean":"buildCheckbox"},canSubmit:!1,resetButton:"Reset",submitButton:"Submit"},init:function(e){return this._super(e),this.$elem.empty(),this.$elem.append(this._buildForm(this.options.elements)),this},getFormValuesAsObject:function(){var t=this.data("formValues"),n=this.getFormValuesAsArray(),r={};return e.each(n,function(e,n){r[n[0]]=n.slice(1),n.length==1&&(r[n[0]]=!0);var i=t[n[0]].type,s=t[n[0]].multi;n.length==2&&!s&&i!="multiselect"&&(r[n[0]]=r[n[0]][0])}),r},getFormValuesAsArray:function(){var t=[],n=this.data("formValues"),r=this.data("form").get(0);for(key in n){var i=n[key],s=i.name,o=i.type,u=[];if(r[s]=="[object NodeList]")for(var a=0;a<r[s].length;a++)u.push(r[s][a]);else u=[r[s]];if(o=="checkbox"||o=="boolean")r[s].checked&&t.push([key]);else if(o=="multiselect"){var f=[key],l=f;i.asArray&&(l=[],f.push(l));var c=0;for(var a=0;a<r[s].length;a++)r[s][a].selected&&(c=1,l.push(r[s][a].value));c&&t.push(f)}else if(o=="radio"){var f=[key],c=0;for(var a=0;a<r[s].length;a++)r[s][a].checked&&(c=1,f.push(r[s][a].value));c&&t.push(f)}else if(o=="file"){var h=r[s].files||r[s].dataTransfer.files;e.each(h,e.proxy(function(n,r){t.jobs++;var i=[key];t.push(i);var s=new FileReader;s.onload=e.proxy(function(e){t.jobs--,i.push(e.target.result)},this),s.readAsBinaryString(r)},this))}else{var p=[];for(var a=0;a<u.length;a++)if(i.json){var d="";typeof u[a].value=="string"&&u[a].value.length&&(d=JSON.parse(u[a].value)),i.asArray&&(d=[d]),p.push(d)}else p.push(this.carve(u[a].value,i.split,i.asArray));if(p.length>0){if(p.length==1){p=p[0];if(p.length==0)continue}t.push([key,p])}}}if(this.options.returnArrayStructure!=undefined){var v=[],m={};for(var a=0;a<t.length;a++)m[t[a][0]]=t[a][1];for(var a=0;a<this.options.returnArrayStructure.length;a++)v.push(m[this.options.returnArrayStructure[a]]);t=v}return t},carve:function(t,n,r){n=n==undefined?[]:typeof n=="string"?[n]:n.slice(0);var i=n.shift();if(i==undefined)return r&&typeof t=="string"&&(t=[t]),t;var s=new RegExp(" *"+i+" *");return typeof t=="string"?this.carve(t.split(s),n,r):(n.push(i),jQuery.each(t,e.proxy(function(e,i){t[e]=this.carve(i,n,r)},this)),t)},escapeValue:function(e){return e=e.replace(/"/g,'\\"'),'"'+e+'"'},getFormValuesAsString:function(){var e=this.getFormValuesAsArray();if(this.options.returnArrayStructure!=undefined)return JSON.stringify(e);var t=[];for(var n=0;n<e.length;n++){var r=e[n];if(r.length==1)t.push(r[0]);else for(var i=1;i<r.length;i++)this.data("formValues")[r[0]].valOnly?t.push(r[i]):typeof r[i]=="string"?t.push(r[0]+" "+this.escapeValue(r[i])):t.push(r[0]+" "+this.escapeValue(JSON.stringify(r[i])))}return t.join(" ")},_buildForm:function(t){var n=e.jqElem("form").addClass("form-horizontal");this.options.action&&n.attr("action",this.options.action),this.options.method&&n.attr("method",this.options.method),this.options.canSubmit||n.on("submit",function(e){return!1}),this.options.submitCallback&&n.on("submit",e.proxy(function(e){return this.options.submitCallback(e,n,this)},this)),this.data("form",n);var r=this.data("formValues",{}),i=undefined;e.each(t,e.proxy(function(t,s){typeof s=="string"&&(s={key:s}),s.name==undefined&&(s.name=s.key);if(r[s.key]!=undefined){var o="FORM ERROR. KEY "+s.key+" IS DOUBLE DEFINED";return n=o,!1}r[s.key]=s;if(s.fieldset){if(i==undefined||i.attr("name")!=s.fieldset)i=e.jqElem("fieldset").attr("name",s.fieldset).append(e.jqElem("legend").append(s.fieldset)),n.append(i)}else i=n;var u=s.label!=undefined?s.label:s.name.charAt(0).toUpperCase()+s.name.slice(1);this.options.rawLabels&&(u=s.name);var a=e.jqElem("label").addClass("control-label col-sm-4").append(e.jqElem("span").attr("title",u).append(u+" : ")).bind("click",function(t){e(this).next().children().first().focus()});this.options.values[s.key]!=undefined&&(s.value=s.checked=s.selected=this.options.values[s.key]);var f;s.type==undefined&&(s.type="text"),this.options.dispatch[s.type]?(s.json&&s.value?s.value_as_string=JSON.stringify(s.value,undefined,2):s.value_as_string=s.value,f=this[this.options.dispatch[s.type]](s)):f=this.buildTextField(s),s.kb_bind&&f.kb_bind(s.kb_bind[0],s.kb_bind[1]),s.validate&&(typeof s.validate!="function"&&(s.validate=this.buildValidationRegexFunction(s.key,s.validate.regex,s.validate.msg)),f.on("change",e.proxy(function(e){e.stopPropagation(),e.preventDefault(),s.validate(s.key,this)},this)));var l=e.jqElem("div").addClass("col-sm-8"),c;s.description&&(c=e.jqElem("span").addClass("help-block").append(s.description));var h=e.jqElem("span").addClass("help-block");if(s.multi){var p=this;l.append(e.jqElem("span").addClass("input-group").append(f).append(e.jqElem("div").addClass("input-group-btn").append(e("<button></button>").addClass("btn btn-default").attr("title","Add more").append(e("<i></i>").addClass("fa fa-plus")).bind("click",function(t){t.stopPropagation(),t.preventDefault();var n=l.children().first().clone(),r=h.clone();n.find("i").toggleClass("fa fa-plus fa fa-minus"),n.find("button").unbind("click"),n.find("button").bind("click",function(e){e.stopPropagation(),e.preventDefault(),n.remove(),r.remove(),l.find(":input:not(button)").trigger("change")}),n.find(":input:not(button)").val(undefined),n.find(":input:not(button)").off("change"),n.find(":input:not(button)").on("change",e.proxy(function(e){e.stopPropagation(),e.preventDefault(),s.validate(s.key,p)},p)),l.append(n,r)})))).append(h).append(c)}else l.append(f).append(h).append(c);s.disabled&&f.prop("disabled",!0);var d=e.jqElem("div").addClass("form-group").attr("id",s.key+"-group").append(a).append(l);s.type=="hidden"&&d.css("display","none"),n.append(d)},this));if(this.options.canSubmit||this.options.canReset){var s=e.jqElem("div").addClass("pull-right");this.options.canReset&&s.append(e.jqElem("input").addClass("btn btn-default btn-warning").attr("type","button").val(this.options.resetButton).on("click",function(t){var r=e.jqElem("div").kbasePrompt({title:"Begin again",body:"Really start over?",controls:["cancelButton",{name:"Reset",type:"primary",callback:function(e,t){e.stopPropagation(),e.preventDefault(),n.get(0).reset(),t.closePrompt()}}]});r.openPrompt()})),this.options.canReset&&this.options.canSubmit&&s.append(" "),this.options.canSubmit&&s.append(e.jqElem("input").addClass("btn btn-primary").attr("type","submit").val(this.options.submitButton)),n.append(s)}return this._rewireIds(n,this),n},validateForm:function(){var t=!0,n=this;return e.each(this.options.elements,function(e,r){if(r.validate){var i=r.validate(r.key,n);t=t&&i}}),t},formGroup:function(e){return this.data(e+"-group")},errmsg:function(t,n){var r=t.next("span");r.length==0&&(r=t.parent().next());var i=e(r);i.text(n)},buildValidationRegexFunction:function(t,n,r){var i=this;return typeof n=="string"&&(n=new RegExp(n)),function(t,i){var s=!0,o=i.formGroup(t);return o.removeClass("has-error"),e.each(i.fieldsForKey(t),function(t,u){var a=e(u);i.errmsg(a,""),a.val().match(n)||(s=!1,o.addClass("has-error"),i.errmsg(a,r))}),s}},fieldsForKey:function(e){var t=this.formGroup(e);return t.find(":input:not(button)")},buildHiddenField:function(t){return e.jqElem("input").attr("type","hidden").attr("value",t.value_as_string).attr("name",t.name)},buildTextField:function(t){return e.jqElem("input").attr("type","text").attr("value",t.value_as_string).attr("placeholder",t.placeholder).attr("name",t.name).addClass("form-control")},buildFileField:function(t){return e.jqElem("input").attr("type","file").attr("value",t.value_as_string).attr("name",t.name).addClass("form-control")},buildTextArea:function(t){var n=e.jqElem("textarea").attr("name",t.name).addClass("form-control").append(t.value_as_string);return t.rows&&n.attr("rows",t.rows),n},buildSecureTextField:function(t){return e.jqElem("input").attr("type","password").attr("value",t.value_as_string).attr("name",t.name).addClass("form-control")},buildCheckbox:function(t){var n=e.jqElem("input").attr("type","checkbox").addClass("form-control").attr("name",t.name).attr("value",t.value_as_string);return(t.checked==1||t.value==1)&&n.prop("checked",!0),n},buildRadioButton:function(t){var n=e.jqElem("div");return e.each(t.values,e.proxy(function(r,i){var s=i,o=i;typeof i!="string"&&(s=i.value,o=i.name);var u=e.jqElem("div").addClass("radio"),a=e.jqElem("input").attr("type","radio").attr("name",t.name).attr("value",s);t.checked==s&&a.prop("checked",!0);var f=e.jqElem("label").addClass("control-label").append(a).append(o);u.append(f),n.append(u)},this)),n},buildSelectbox:function(t){var n=e.jqElem("select").attr("name",t.name).addClass("form-control");return t.type=="multiselect"&&(n.prop("multiple",!0),t.size&&n.attr("size",t.size)),t.names==undefined&&(t.names=[]),e.each(t.values,function(r,i){var s=i,o=i;typeof i!="string"&&(s=i.value,o=i.name);var u=e.jqElem("option").attr("value",s).append(o);typeof t.selected=="string"&&t.selected==s?u.prop("selected",!0):typeof t.selected=="object"&&e.each(t.selected,function(e,t){t==s&&u.prop("selected",!0)}),n.append(u)}),n}})}),define("kbaseIrisEchoWidget",["jquery","kbaseIrisWidget","kbaseFormBuilder","kbaseBox","kbaseDeletePrompt"],function(e){e.KBWidget({name:"kbaseIrisEchoWidget",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:["terminal"],options:{},setInput:function(e){this.setValueForKey("input",e),this.setValueForKey("output",e),this.setValueForKey("value",e)},appendUI:function(t){var n=e.jqElem("div").kbaseFormBuilder({elements:[{name:"echo",label:"Echo this value",type:"text",key:"echo",description:"This widget echoes and broadcasts the value typed in.",kb_bind:[this,"input"]}]}),r=e.jqElem("div").kbaseBox({title:"Echo Chamber",content:e.jqElem("div").addClass("row").append(e.jqElem("div").addClass("col-sm-12").append(n.$elem)),controls:[{icon:"fa fa-times",callback:e.proxy(function(n,r){var i=e.jqElem("div").kbaseDeletePrompt({name:"Echo Chamber",callback:function(e,n){n.closePrompt(),t.remove()}});i.openPrompt()},this)}]});return t.append(r.$elem.attr("id","box")),this._rewireIds(t,this),t}})}),define("kbaseIrisGUIWidget",["jquery","kbaseIrisWidget","kbaseFormBuilder","kbaseBox","kbaseDeletePrompt"],function(e){e.KBWidget({name:"kbaseIrisGUIWidget",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:["terminal"],options:{},appendUI:function(t){var n=MetaToolInfo(this.options.command),r=n(this.options.command),i=e.jqElem("div").kbaseFormBuilder({elements:r.fields}),s=e.jqElem("div").kbaseBox({title:r.label,content:e.jqElem("div").addClass("row").append(e.jqElem("div").addClass("col-sm-9").append(i.$elem)).append(e.jqElem("div").addClass("col-sm-2").css("height","100px").css("font-size","4px").css("overflow","hidden").attr("id","output").on("click",e.proxy(function(e){e.stopPropagation(),e.preventDefault(),this.viewOutput()},this)).kb_bind(this,"output")),controls:[{icon:"fa fa-copy",callback:e.proxy(function(e){var t=this.data("box").kbaseBox()},this),id:"runButton"},{icon:"fa fa-save",callback:e.proxy(function(e){var t=this.data("box").kbaseBox()},this),id:"runButton"},{icon:"fa fa-play",callback:e.proxy(function(e){s.startThinking();var t=this.options.command+" "+i.getFormValuesAsString();this.terminal().run(t,this)},this),id:"runButton"},{icon:"fa fa-question",callback:e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.setOutput(undefined),this.terminal().run(this.options.command+" -h",this)},this),id:"helpButton"},{icon:"fa fa-times",callback:e.proxy(function(n,r){var i=e.jqElem("div").kbaseDeletePrompt({name:this.options.command,callback:function(e,n){n.closePrompt(),t.remove()}});i.openPrompt()},this)}]});return t.append(s.$elem.attr("id","box")),this._rewireIds(t,this),t},setOutput:function(e){this.data("box").kbaseBox("stopThinking"),this._super(e)}})}),define("kbaseIrisFileEditor",["jquery","kbaseAuthenticatedWidget","kbasePrompt"],function(e){e.KBWidget({name:"kbaseIrisFileEditor",parent:"kbaseAuthenticatedWidget",version:"1.0.0",_accessors:["client",{name:"file",setter:"setFile"},"rows","cols","content","loadedContent","saveFileCallback","cancelSaveFileCallback"],options:{rows:50,cols:85},init:function(e){return this._super(e),this.appendUI(this.$elem),this},setFile:function(e){this.setValueForKey("file",e),this.appendUI(this.$elem)},save:function(){var e=this.file().split("/"),t=e.pop(),n=e.join("/");if(this.content()==this.loadedContent())return;this.client().put_file(this.sessionId(),t,this.content(),n,jQuery.proxy(function(e){this.dbg("saved file")},this),jQuery.proxy(function(e){throw"Could not save file "+e.error.message},this))},appendUI:function(t){t.empty(),t.append("Loading file "+this.file()+"...<br>please wait...").append(e.jqElem("br")).append(e.jqElem("div").attr("align","center").append(e.jqElem("i").addClass("fa fa-spinner").addClass("fa fa-spin fa fa-4x"))),this.client().get_file(this.sessionId(),this.file(),"/",e.proxy(function(n){var r=e.jqElem("textarea").attr("rows",this.rows()).attr("cols",this.cols()).css("width","720px").kb_bind(this,"content");this.content(n),this.loadedContent(this.content()),t.empty(),t.append(r)},this),e.proxy(function(n){var r=e.jqElem("textarea").attr("rows",this.rows()).attr("cols",this.cols()).css("width","720px").kb_bind(this,"content");t.empty(),t.append(r)},this))},savePrompt:function(){if(this.content()==this.loadedContent()){this.saveFileCallback&&this.saveFileCallback()(this.file());return}var t=e.jqElem("div").kbasePrompt({title:"Save changes",body:"Save changes to <strong>"+this.file()+"</strong> before closing?",controls:[{name:"Close without save",callback:e.proxy(function(e,t){t.closePrompt(),this.cancelSaveFileCallback&&this.cancelSaveFileCallback()(this.file())},this)},{name:"Close and save",type:"primary",callback:e.proxy(function(e,t){t.closePrompt(),this.save(),this.saveFileCallback&&this.saveFileCallback()(this.file())},this)}]});t.openPrompt()}})}),define("kbaseIrisWhatsNew",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbaseIrisWhatsNew",version:"1.0.0",_accessors:["history"],options:{history:[{version:"0.0.8",date:"08/06/2014",notes:["The <b>view</b> command now scales an image to fit within the terminal window. Click on the image to download it full size.","Clicking the right arrow button on the file browser now no longer prepends a leading slash to the file name.","Clicking the right arrow button on the file browser now properly respects subdirectories","File Editor can now properly edit files in subdirectories.","Files can now be created via the <b>edit</b> <i>newfilename</i> command.","Added visualization widgets. Type <b>widget</b> <i>widgetname</i> <i>jsondata</i> to display. Available visualization widgets are: <b>barchart</b>, <b>forcednetwork</b>, <b>heatmap</b>, <b>linechart</b>, <b>piechart</b>, <b>scatterplot</b>, <b>tree</b>.","Added <b>!!</b> command to repeat last command typed.","links from tutorials will now automatically appear in a new window.","Tutorial next/back/list commands are now clickable.","Disabled spell checking in commands input.","Internal IRIS commands are explicitly listed in the commands list.","Magic workspace tokens are no longer supported.","Terminal will now resize with the window","Clicking on file names in the file browser will now open them in a new tab","Clicking on file names after an ls will now open in a new tab; added explicit download button","Fixed a bug that could cause a blank directory listing upon initial log in","Now remembers the last typed unrun command when browsing up and down through command history"]},{version:"0.0.7",date:"02/06/2014",notes:["Resolved an issue preventing tutorial loads"]},{version:"0.0.6",date:"12/13/2013",notes:["Minor bug fixes.","Resolved the issue regarding downloads occasionally not working.","Resolved the layout issue that would occasionally make the chevrons on the command list slide off the screen.","Fixed redirecting STDERR, as well as appending to files."]},{version:"0.0.5",date:"11/18/2013",notes:["Scriptability - save your commands to a file (one command per line), then run it later with <b>execute</b> <i>nameofscript</i>","Scriptability - Write a javascript program and run it later with <b>evaluate</b> <i>text of program</i> or <b>evaluate</b> <i>name of program file</i>. The terminal object is accessible via $terminal, the current widget via $widget. Run further iris commands via $terminal.invoke('....');","Multiple commands can be run at once - delimited commands with semicolons. <b>echo a </b><u>;</u><b> echo b</b>","<b>ls</b> command can now accept standard shell wildcard syntax <b>ls</b> <i>*.txt</i>, or <b>ls</b> <i>sequences.*</i>, etc.","Added <b>variables</b> command to list user defined session variables","Added <b>download</b> <i>filename</i> command to download a file from the command line","Added <b>edit</b> <i>filename</i> command to launch the file editor from the command line","Added <b>environment</b> and <b>setenv</b> <i>key=value</i> syntax to customize IRIS behavior","Added <b>end</b> command to jump to end of terminal input","Added <b>record</b> command. Save all your actions from that point on as an executable script. Save it with <b>save</b> <i>nameofscript</i>. It can then be executed with <b>execute</b> <i>nameofscript</i>","Added new file button (<i class = 'icon-file'></i>) to file browser to add and optionally immediately edit a file","<strike>Added automatic communication with the workspace. Pass around 'files' with <b>@W#<i>workpaceid:type:objectid-instance</i></b> such as: <b>all_entities_Genome &gt; @W#genome_obj_in_workspace</b>, will create an object with id 'genome_obj_in_workspace in your current workspace. The workspace id, type, and instance number are optional (and must be : delimited, the instance is appended with a hyphen). If this is an ID through standard script redirects (&lt; or &gt;), you don't need to specify IO. If it's a switch (<b>some_script -i <i>name_of_file</i></b>) then append the io flag - @W#objid#i to read from the workspace or @W#objid#o to write to it.</strike>","Much nicer selection of variables with the right arrow key","Alphabetically sorted the groups of commands","Scrolling up while the UI is automatically scrolling down will now halt the scroll","Greatly improved performance of view command","Moved the interface to bootstrap v3.0"]},{version:"0.0.4",date:"09/23/2013",notes:["Minor bug fixes","Files can now be downloaded","Variables can now be re-assigned","Variables are cleared from session upon logout","Error messages no longer auto clean up"]},{version:"0.0.3",date:"08/23/2013",notes:["User defined variables - <br><b>$genome = kb|g.1994</b><br><b>all_entities_Genome | grep $genome</b>","Help for commands - click on the <b>?</b> next to the command name in the list to the left for usage info.","IRIS now supports uploading huge files (up to at least multiple gigabytes), and uploads are resumable if there's a failure.<br> Likewise, IRIS now supports real file downloads to get your processed information back out of the system.<br> If you have a stalled upload job, just mouseover it in the process list to resume it or cancel the upload.<br><br> Finally, you can also upload via the command line - <b>upload</b> <i>filename</i>","Enhanced file browser. Mouseover the items to interact with them.<ul><li><i class = 'icon-plus'></i> Add a directory.</li><li><i class = 'icon-arrow-up'></i> Upload a file.</li><li><i class = 'icon-minus'></i> Delete a file or directory.</li><li><i class = 'icon-download-alt'></i> Download this file.</li><li><i class = 'icon-pencil'></i> Edit this file.</li><li><i class = 'icon-arrow-right'></i> Add this file to your terminal input.</li></ul>","IRIS has a simple file editor - in the file browser, mouse over a file name and click the pencil to tweak (small) files.","Images are viewable. Type <b>view</b> <i>filename</i>","Lots of behind the scenes infrastructure improvements.","IRIS supports natural language questions. Type <b>questions</b> to bring up a list of natural language prompts.<br> You can also type them on the command line and hit arrow-right to attempt an auto completion. Further, you can arrow-right to select the next variable in the sequence.","Improved command search functionality. Just start typing into the search box under the list of commands to filter down to what you want to see.","Add comments to your output by typing <b>#</b><i>your comment here</i>","Terminate processes by mousing over the process list and clicking the cancel button."]}]},init:function(e){return this._super(e),this.appendUI(this.$elem),this},appendUI:function(e){if(this.options.headless)return;return e.append(this.ulForAllReleases()),e},ulForAllReleases:function(){var t=e.jqElem("ul");return e.each(this.history(),e.proxy(function(e,n){t.append(this.ulForRelease(n).children())},this)),t},currentRelease:function(){return this.history()[0]},currentVersion:function(){return this.currentRelease().version},currentReleaseString:function(){return this.releaseString(this.currentRelease())},releaseString:function(e){return e.version+" - "+e.date},ulForCurrentRelease:function(){return this.ulForRelease(this.currentRelease())},ulForRelease:function(t){var n=e.jqElem("ul");return n.append(e.jqElem("li").append(this.releaseString(t))).append(this.ulForNotes(t.notes)),n},ulForCurrentNotes:function(){return this.ulForNotes(this.currentNotes())},ulForNotes:function(t){var n=e.jqElem("ul");return e.each(t,function(t,r){n.append(e.jqElem("li").html(r))}),n}})}),d3=function(){function e(e){return null!=e&&!isNaN(e)}function t(e){return e.length}function n(e){for(var t=1;e*t%1;)t*=10;return t}function r(e,t){try{for(var n in t)Object.defineProperty(e.prototype,n,{value:t[n],enumerable:!1})}catch(r){e.prototype=t}}function i(){}function s(){}function o(e,t,n){return function(){var r=n.apply(t,arguments);return r===t?e:r}}function u(e,t){if(t in e)return t;t=t.charAt(0).toUpperCase()+t.substring(1);for(var n=0,r=Do.length;r>n;++n){var i=Do[n]+t;if(i in e)return i}}function a(e){for(var t=e.length,n=new Array(t);t--;)n[t]=e[t];return n}function f(e){return Array.prototype.slice.call(e)}function l(){}function c(){}function h(e){function t(){for(var t,r=n,i=-1,s=r.length;++i<s;)(t=r[i].on)&&t.apply(this,arguments);return e}var n=[],r=new i;return t.on=function(t,i){var s,o=r.get(t);return arguments.length<2?o&&o.on:(o&&(o.on=null,n=n.slice(0,s=n.indexOf(o)).concat(n.slice(s+1)),r.remove(t)),i&&n.push(r.set(t,{on:i})),e)},t}function p(){wo.event.preventDefault()}function d(){for(var e,t=wo.event;e=t.sourceEvent;)t=e;return t}function v(e){for(var t=new c,n=0,r=arguments.length;++n<r;)t[arguments[n]]=h(t);return t.of=function(n,r){return function(i){try{var s=i.sourceEvent=wo.event;i.target=e,wo.event=i,t[i.type].apply(n,r)}finally{wo.event=s}}},t}function m(e){return jo(e,Uo),e}function g(e){return"function"==typeof e?e:function(){return Fo(e,this)}}function y(e){return"function"==typeof e?e:function(){return Io(e,this)}}function b(e,t){function n(){this.removeAttribute(e)}function r(){this.removeAttributeNS(e.space,e.local)}function i(){this.setAttribute(e,t)}function s(){this.setAttributeNS(e.space,e.local,t)}function o(){var n=t.apply(this,arguments);null==n?this.removeAttribute(e):this.setAttribute(e,n)}function u(){var n=t.apply(this,arguments);null==n?this.removeAttributeNS(e.space,e.local):this.setAttributeNS(e.space,e.local,n)}return e=wo.ns.qualify(e),null==t?e.local?r:n:"function"==typeof t?e.local?u:o:e.local?s:i}function w(e){return e.trim().replace(/\s+/g," ")}function E(e){return new RegExp("(?:^|\\s+)"+wo.requote(e)+"(?:\\s+|$)","g")}function S(e,t){function n(){for(var n=-1;++n<i;)e[n](this,t)}function r(){for(var n=-1,r=t.apply(this,arguments);++n<i;)e[n](this,r)}e=e.trim().split(/\s+/).map(x);var i=e.length;return"function"==typeof t?r:n}function x(e){var t=E(e);return function(n,r){if(i=n.classList)return r?i.add(e):i.remove(e);var i=n.getAttribute("class")||"";r?(t.lastIndex=0,t.test(i)||n.setAttribute("class",w(i+" "+e))):n.setAttribute("class",w(i.replace(t," ")))}}function T(e,t,n){function r(){this.style.removeProperty(e)}function i(){this.style.setProperty(e,t,n)}function s(){var r=t.apply(this,arguments);null==r?this.style.removeProperty(e):this.style.setProperty(e,r,n)}return null==t?r:"function"==typeof t?s:i}function N(e,t){function n(){delete this[e]}function r(){this[e]=t}function i(){var n=t.apply(this,arguments);null==n?delete this[e]:this[e]=n}return null==t?n:"function"==typeof t?i:r}function C(e){return"function"==typeof e?e:(e=wo.ns.qualify(e)).local?function(){return Eo.createElementNS(e.space,e.local)}:function(){return Eo.createElementNS(this.namespaceURI,e)}}function k(e){return{__data__:e}}function L(e){return function(){return Ro(this,e)}}function A(e){return arguments.length||(e=wo.ascending),function(t,n){return t&&n?e(t.__data__,n.__data__):!t-!n}}function O(e,t){for(var n=0,r=e.length;r>n;n++)for(var i,s=e[n],o=0,u=s.length;u>o;o++)(i=s[o])&&t(i,o,n);return e}function M(e){return jo(e,Wo),e}function _(e){var t,n;return function(r,i,s){var o,u=e[s].update,a=u.length;for(s!=n&&(n=s,t=0),i>=t&&(t=i+1);!(o=u[t])&&++t<a;);return o}}function D(e,t,n){function r(){var t=this[o];t&&(this.removeEventListener(e,t,t.$),delete this[o])}function i(){var i=a(t,Po(arguments));r.call(this),this.addEventListener(e,this[o]=i,i.$=n),i._=t}function s(){var t,n=new RegExp("^__on([^.]+)"+wo.requote(e)+"$");for(var r in this)if(t=r.match(n)){var i=this[r];this.removeEventListener(t[1],i,i.$),delete this[r]}}var o="__on"+e,u=e.indexOf("."),a=P;u>0&&(e=e.substring(0,u));var f=Vo.get(e);return f&&(e=f,a=H),u?t?i:r:t?l:s}function P(e,t){return function(n){var r=wo.event;wo.event=n,t[0]=this.__data__;try{e.apply(this,t)}finally{wo.event=r}}}function H(e,t){var n=P(e,t);return function(e){var t=this,r=e.relatedTarget;r&&(r===t||8&r.compareDocumentPosition(t))||n.call(t,e)}}function B(){var e=".dragsuppress-"+ ++Jo,t="touchmove"+e,n="selectstart"+e,r="dragstart"+e,i="click"+e,s=wo.select(xo).on(t,p).on(n,p).on(r,p),o=So.style,u=o[$o];return o[$o]="none",function(t){function n(){s.on(i,null)}s.on(e,null),o[$o]=u,t&&(s.on(i,function(){p(),n()},!0),setTimeout(n,0))}}function j(e,t){var n=e.ownerSVGElement||e;if(n.createSVGPoint){var r=n.createSVGPoint();if(0>Ko&&(xo.scrollX||xo.scrollY)){n=wo.select("body").append("svg").style({position:"absolute",top:0,left:0,margin:0,padding:0,border:"none"},"important");var i=n[0][0].getScreenCTM();Ko=!i.f&&!i.e,n.remove()}return Ko?(r.x=t.pageX,r.y=t.pageY):(r.x=t.clientX,r.y=t.clientY),r=r.matrixTransform(e.getScreenCTM().inverse()),[r.x,r.y]}var s=e.getBoundingClientRect();return[t.clientX-s.left-e.clientLeft,t.clientY-s.top-e.clientTop]}function F(){}function I(e,t,n){return new q(e,t,n)}function q(e,t,n){this.h=e,this.s=t,this.l=n}function R(e,t,n){function r(e){return e>360?e-=360:0>e&&(e+=360),60>e?s+(o-s)*e/60:180>e?o:240>e?s+(o-s)*(240-e)/60:s}function i(e){return Math.round(255*r(e))}var s,o;return e=isNaN(e)?0:(e%=360)<0?e+360:e,t=isNaN(t)?0:0>t?0:t>1?1:t,n=0>n?0:n>1?1:n,o=.5>=n?n*(1+t):n+t-n*t,s=2*n-o,ot(i(e+120),i(e),i(e-120))}function U(e){return e>0?1:0>e?-1:0}function z(e){return e>1?0:-1>e?eu:Math.acos(e)}function W(e){return e>1?eu/2:-1>e?-eu/2:Math.asin(e)}function X(e){return(Math.exp(e)-Math.exp(-e))/2}function V(e){return(Math.exp(e)+Math.exp(-e))/2}function $(e){return(e=Math.sin(e/2))*e}function J(e,t,n){return new K(e,t,n)}function K(e,t,n){this.h=e,this.c=t,this.l=n}function Q(e,t,n){return isNaN(e)&&(e=0),isNaN(t)&&(t=0),G(n,Math.cos(e*=ru)*t,Math.sin(e)*t)}function G(e,t,n){return new Y(e,t,n)}function Y(e,t,n){this.l=e,this.a=t,this.b=n}function Z(e,t,n){var r=(e+16)/116,i=r+t/500,s=r-n/200;return i=tt(i)*uu,r=tt(r)*au,s=tt(s)*fu,ot(rt(3.2404542*i-1.5371385*r-.4985314*s),rt(-0.969266*i+1.8760108*r+.041556*s),rt(.0556434*i-.2040259*r+1.0572252*s))}function et(e,t,n){return e>0?J(Math.atan2(n,t)*iu,Math.sqrt(t*t+n*n),e):J(0/0,0/0,e)}function tt(e){return e>.206893034?e*e*e:(e-4/29)/7.787037}function nt(e){return e>.008856?Math.pow(e,1/3):7.787037*e+4/29}function rt(e){return Math.round(255*(.00304>=e?12.92*e:1.055*Math.pow(e,1/2.4)-.055))}function it(e){return ot(e>>16,255&e>>8,255&e)}function st(e){return it(e)+""}function ot(e,t,n){return new ut(e,t,n)}function ut(e,t,n){this.r=e,this.g=t,this.b=n}function at(e){return 16>e?"0"+Math.max(0,e).toString(16):Math.min(255,e).toString(16)}function ft(e,t,n){var r,i,s,o=0,u=0,a=0;if(r=/([a-z]+)\((.*)\)/i.exec(e))switch(i=r[2].split(","),r[1]){case"hsl":return n(parseFloat(i[0]),parseFloat(i[1])/100,parseFloat(i[2])/100);case"rgb":return t(pt(i[0]),pt(i[1]),pt(i[2]))}return(s=hu.get(e))?t(s.r,s.g,s.b):(null!=e&&"#"===e.charAt(0)&&(4===e.length?(o=e.charAt(1),o+=o,u=e.charAt(2),u+=u,a=e.charAt(3),a+=a):7===e.length&&(o=e.substring(1,3),u=e.substring(3,5),a=e.substring(5,7)),o=parseInt(o,16),u=parseInt(u,16),a=parseInt(a,16)),t(o,u,a))}function lt(e,t,n){var r,i,s=Math.min(e/=255,t/=255,n/=255),o=Math.max(e,t,n),u=o-s,a=(o+s)/2;return u?(i=.5>a?u/(o+s):u/(2-o-s),r=e==o?(t-n)/u+(n>t?6:0):t==o?(n-e)/u+2:(e-t)/u+4,r*=60):(r=0/0,i=a>0&&1>a?0:r),I(r,i,a)}function ct(e,t,n){e=ht(e),t=ht(t),n=ht(n);var r=nt((.4124564*e+.3575761*t+.1804375*n)/uu),i=nt((.2126729*e+.7151522*t+.072175*n)/au),s=nt((.0193339*e+.119192*t+.9503041*n)/fu);return G(116*i-16,500*(r-i),200*(i-s))}function ht(e){return(e/=255)<=.04045?e/12.92:Math.pow((e+.055)/1.055,2.4)}function pt(e){var t=parseFloat(e);return"%"===e.charAt(e.length-1)?Math.round(2.55*t):t}function dt(e){return"function"==typeof e?e:function(){return e}}function vt(e){return e}function mt(e){return function(t,n,r){return 2===arguments.length&&"function"==typeof n&&(r=n,n=null),gt(t,n,e,r)}}function gt(e,t,n,r){function i(){var e,t=a.status;if(!t&&a.responseText||t>=200&&300>t||304===t){try{e=n.call(s,a)}catch(r){return o.error.call(s,r),void 0}o.load.call(s,e)}else o.error.call(s,a)}var s={},o=wo.dispatch("progress","load","error"),u={},a=new XMLHttpRequest,f=null;return!xo.XDomainRequest||"withCredentials"in a||!/^(http(s)?:)?\/\//.test(e)||(a=new XDomainRequest),"onload"in a?a.onload=a.onerror=i:a.onreadystatechange=function(){a.readyState>3&&i()},a.onprogress=function(e){var t=wo.event;wo.event=e;try{o.progress.call(s,a)}finally{wo.event=t}},s.header=function(e,t){return e=(e+"").toLowerCase(),arguments.length<2?u[e]:(null==t?delete u[e]:u[e]=t+"",s)},s.mimeType=function(e){return arguments.length?(t=null==e?null:e+"",s):t},s.responseType=function(e){return arguments.length?(f=e,s):f},s.response=function(e){return n=e,s},["get","post"].forEach(function(e){s[e]=function(){return s.send.apply(s,[e].concat(Po(arguments)))}}),s.send=function(n,r,i){if(2===arguments.length&&"function"==typeof r&&(i=r,r=null),a.open(n,e,!0),null==t||"accept"in u||(u.accept=t+",*/*"),a.setRequestHeader)for(var o in u)a.setRequestHeader(o,u[o]);return null!=t&&a.overrideMimeType&&a.overrideMimeType(t),null!=f&&(a.responseType=f),null!=i&&s.on("error",i).on("load",function(e){i(null,e)}),a.send(null==r?null:r),s},s.abort=function(){return a.abort(),s},wo.rebind(s,o,"on"),null==r?s:s.get(yt(r))}function yt(e){return 1===e.length?function(t,n){e(null==t?n:null)}:e}function bt(){var e=Et(),t=St()-e;t>24?(isFinite(t)&&(clearTimeout(mu),mu=setTimeout(bt,t)),vu=0):(vu=1,yu(bt))}function wt(e,t,n){var r=arguments.length;2>r&&(t=0),3>r&&(n=Date.now()),gu.callback=e,gu.time=n+t}function Et(){var e=Date.now();for(gu=pu;gu;)e>=gu.time&&(gu.flush=gu.callback(e-gu.time)),gu=gu.next;return e}function St(){for(var e,t=pu,n=1/0;t;)t.flush?t=e?e.next=t.next:pu=t.next:(t.time<n&&(n=t.time),t=(e=t).next);return du=e,n}function xt(e,t){var n=Math.pow(10,3*Math.abs(8-t));return{scale:t>8?function(e){return e/n}:function(e){return e*n},symbol:e}}function Tt(e,t){return t-(e?Math.ceil(Math.log(e)/Math.LN10):1)}function Nt(e){return e+""}function Ct(){}function kt(e,t,n){var r=n.s=e+t,i=r-e,s=r-i;n.t=e-s+(t-i)}function Lt(e,t){e&&Ou.hasOwnProperty(e.type)&&Ou[e.type](e,t)}function At(e,t,n){var r,i=-1,s=e.length-n;for(t.lineStart();++i<s;)r=e[i],t.point(r[0],r[1]);t.lineEnd()}function Ot(e,t){var n=-1,r=e.length;for(t.polygonStart();++n<r;)At(e[n],t,1);t.polygonEnd()}function Mt(){function e(e,t){e*=ru,t=t*ru/2+eu/4;var n=e-r,o=Math.cos(t),u=Math.sin(t),a=s*u,f=i*o+a*Math.cos(n),l=a*Math.sin(n);_u.add(Math.atan2(l,f)),r=e,i=o,s=u}var t,n,r,i,s;Du.point=function(o,u){Du.point=e,r=(t=o)*ru,i=Math.cos(u=(n=u)*ru/2+eu/4),s=Math.sin(u)},Du.lineEnd=function(){e(t,n)}}function _t(e){var t=e[0],n=e[1],r=Math.cos(n);return[r*Math.cos(t),r*Math.sin(t),Math.sin(n)]}function Dt(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]}function Pt(e,t){return[e[1]*t[2]-e[2]*t[1],e[2]*t[0]-e[0]*t[2],e[0]*t[1]-e[1]*t[0]]}function Ht(e,t){e[0]+=t[0],e[1]+=t[1],e[2]+=t[2]}function Bt(e,t){return[e[0]*t,e[1]*t,e[2]*t]}function jt(e){var t=Math.sqrt(e[0]*e[0]+e[1]*e[1]+e[2]*e[2]);e[0]/=t,e[1]/=t,e[2]/=t}function Ft(e){return[Math.atan2(e[1],e[0]),W(e[2])]}function It(e,t){return Math.abs(e[0]-t[0])<tu&&Math.abs(e[1]-t[1])<tu}function qt(e,t){e*=ru;var n=Math.cos(t*=ru);Rt(n*Math.cos(e),n*Math.sin(e),Math.sin(t))}function Rt(e,t,n){++Pu,Bu+=(e-Bu)/Pu,ju+=(t-ju)/Pu,Fu+=(n-Fu)/Pu}function Ut(){function e(e,i){e*=ru;var s=Math.cos(i*=ru),o=s*Math.cos(e),u=s*Math.sin(e),a=Math.sin(i),f=Math.atan2(Math.sqrt((f=n*a-r*u)*f+(f=r*o-t*a)*f+(f=t*u-n*o)*f),t*o+n*u+r*a);Hu+=f,Iu+=f*(t+(t=o)),qu+=f*(n+(n=u)),Ru+=f*(r+(r=a)),Rt(t,n,r)}var t,n,r;Xu.point=function(i,s){i*=ru;var o=Math.cos(s*=ru);t=o*Math.cos(i),n=o*Math.sin(i),r=Math.sin(s),Xu.point=e,Rt(t,n,r)}}function zt(){Xu.point=qt}function Wt(){function e(e,t){e*=ru;var n=Math.cos(t*=ru),o=n*Math.cos(e),u=n*Math.sin(e),a=Math.sin(t),f=i*a-s*u,l=s*o-r*a,c=r*u-i*o,h=Math.sqrt(f*f+l*l+c*c),p=r*o+i*u+s*a,d=h&&-z(p)/h,v=Math.atan2(h,p);Uu+=d*f,zu+=d*l,Wu+=d*c,Hu+=v,Iu+=v*(r+(r=o)),qu+=v*(i+(i=u)),Ru+=v*(s+(s=a)),Rt(r,i,s)}var t,n,r,i,s;Xu.point=function(o,u){t=o,n=u,Xu.point=e,o*=ru;var a=Math.cos(u*=ru);r=a*Math.cos(o),i=a*Math.sin(o),s=Math.sin(u),Rt(r,i,s)},Xu.lineEnd=function(){e(t,n),Xu.lineEnd=zt,Xu.point=qt}}function Xt(){return!0}function Vt(e,t,n,r,i){var s=[],o=[];if(e.forEach(function(e){if(!((t=e.length-1)<=0)){var t,n=e[0],r=e[t];if(It(n,r)){i.lineStart();for(var u=0;t>u;++u)i.point((n=e[u])[0],n[1]);return i.lineEnd(),void 0}var a={point:n,points:e,other:null,visited:!1,entry:!0,subject:!0},f={point:n,points:[n],other:a,visited:!1,entry:!1,subject:!1};a.other=f,s.push(a),o.push(f),a={point:r,points:[r],other:null,visited:!1,entry:!1,subject:!0},f={point:r,points:[r],other:a,visited:!1,entry:!0,subject:!1},a.other=f,s.push(a),o.push(f)}}),o.sort(t),$t(s),$t(o),s.length){if(n)for(var u=1,a=!n(o[0].point),f=o.length;f>u;++u)o[u].entry=a=!a;for(var l,c,h,p=s[0];;){for(l=p;l.visited;)if((l=l.next)===p)return;c=l.points,i.lineStart();do{if(l.visited=l.other.visited=!0,l.entry){if(l.subject)for(var u=0;u<c.length;u++)i.point((h=c[u])[0],h[1]);else r(l.point,l.next.point,1,i);l=l.next}else{if(l.subject){c=l.prev.points;for(var u=c.length;--u>=0;)i.point((h=c[u])[0],h[1])}else r(l.point,l.prev.point,-1,i);l=l.prev}l=l.other,c=l.points}while(!l.visited);i.lineEnd()}}}function $t(e){if(t=e.length){for(var t,n,r=0,i=e[0];++r<t;)i.next=n=e[r],n.prev=i,i=n;i.next=n=e[0],n.prev=i}}function Jt(e,t,n,r){return function(i){function s(t,n){e(t,n)&&i.point(t,n)}function o(e,t){v.point(e,t)}function u(){m.point=o,v.lineStart()}function a(){m.point=s,v.lineEnd()}function f(e,t){y.point(e,t),d.push([e,t])}function l(){y.lineStart(),d=[]}function c(){f(d[0][0],d[0][1]),y.lineEnd();var e,t=y.clean(),n=g.buffer(),r=n.length;if(d.pop(),p.push(d),d=null,r){if(1&t){e=n[0];var s,r=e.length-1,o=-1;for(i.lineStart();++o<r;)i.point((s=e[o])[0],s[1]);return i.lineEnd(),void 0}r>1&&2&t&&n.push(n.pop().concat(n.shift())),h.push(n.filter(Kt))}}var h,p,d,v=t(i),m={point:s,lineStart:u,lineEnd:a,polygonStart:function(){m.point=f,m.lineStart=l,m.lineEnd=c,h=[],p=[],i.polygonStart()},polygonEnd:function(){m.point=s,m.lineStart=u,m.lineEnd=a,h=wo.merge(h),h.length?Vt(h,Gt,null,n,i):r(p)&&(i.lineStart(),n(null,null,1,i),i.lineEnd()),i.polygonEnd(),h=p=null},sphere:function(){i.polygonStart(),i.lineStart(),n(null,null,1,i),i.lineEnd(),i.polygonEnd()}},g=Qt(),y=t(g);return m}}function Kt(e){return e.length>1}function Qt(){var e,t=[];return{lineStart:function(){t.push(e=[])},point:function(t,n){e.push([t,n])},lineEnd:l,buffer:function(){var n=t;return t=[],e=null,n},rejoin:function(){t.length>1&&t.push(t.pop().concat(t.shift()))}}}function Gt(e,t){return((e=e.point)[0]<0?e[1]-eu/2-tu:eu/2-e[1])-((t=t.point)[0]<0?t[1]-eu/2-tu:eu/2-t[1])}function Yt(e,t){var n=e[0],r=e[1],i=[Math.sin(n),-Math.cos(n),0],s=0,o=!1,u=!1,a=0;_u.reset();for(var f=0,l=t.length;l>f;++f){var c=t[f],h=c.length;if(h){for(var p=c[0],d=p[0],v=p[1]/2+eu/4,m=Math.sin(v),g=Math.cos(v),y=1;;){y===h&&(y=0),e=c[y];var b=e[0],w=e[1]/2+eu/4,E=Math.sin(w),S=Math.cos(w),x=b-d,T=Math.abs(x)>eu,N=m*E;if(_u.add(Math.atan2(N*Math.sin(x),g*S+N*Math.cos(x))),Math.abs(w)<tu&&(u=!0),s+=T?x+(x>=0?2:-2)*eu:x,T^d>=n^b>=n){var C=Pt(_t(p),_t(e));jt(C);var k=Pt(i,C);jt(k);var L=(T^x>=0?-1:1)*W(k[2]);r>L&&(a+=T^x>=0?1:-1)}if(!(y++))break;d=b,m=E,g=S,p=e}Math.abs(s)>tu&&(o=!0)}}return(!u&&!o&&0>_u||-tu>s)^1&a}function Zt(e){var t,n=0/0,r=0/0,i=0/0;return{lineStart:function(){e.lineStart(),t=1},point:function(s,o){var u=s>0?eu:-eu,a=Math.abs(s-n);Math.abs(a-eu)<tu?(e.point(n,r=(r+o)/2>0?eu/2:-eu/2),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(u,r),e.point(s,r),t=0):i!==u&&a>=eu&&(Math.abs(n-i)<tu&&(n-=i*tu),Math.abs(s-u)<tu&&(s-=u*tu),r=en(n,r,s,o),e.point(i,r),e.lineEnd(),e.lineStart(),e.point(u,r),t=0),e.point(n=s,r=o),i=u},lineEnd:function(){e.lineEnd(),n=r=0/0},clean:function(){return 2-t}}}function en(e,t,n,r){var i,s,o=Math.sin(e-n);return Math.abs(o)>tu?Math.atan((Math.sin(t)*(s=Math.cos(r))*Math.sin(n)-Math.sin(r)*(i=Math.cos(t))*Math.sin(e))/(i*s*o)):(t+r)/2}function tn(e,t,n,r){var i;if(null==e)i=n*eu/2,r.point(-eu,i),r.point(0,i),r.point(eu,i),r.point(eu,0),r.point(eu,-i),r.point(0,-i),r.point(-eu,-i),r.point(-eu,0),r.point(-eu,i);else if(Math.abs(e[0]-t[0])>tu){var s=(e[0]<t[0]?1:-1)*eu;i=n*s/2,r.point(-s,i),r.point(0,i),r.point(s,i)}else r.point(t[0],t[1])}function nn(e){return Yt($u,e)}function rn(e){function t(e,t){return Math.cos(e)*Math.cos(t)>o}function n(e){var n,s,o,a,l;return{lineStart:function(){a=o=!1,l=1},point:function(c,h){var p,d=[c,h],v=t(c,h),m=u?v?0:i(c,h):v?i(c+(0>c?eu:-eu),h):0;if(!n&&(a=o=v)&&e.lineStart(),v!==o&&(p=r(n,d),(It(n,p)||It(d,p))&&(d[0]+=tu,d[1]+=tu,v=t(d[0],d[1]))),v!==o)l=0,v?(e.lineStart(),p=r(d,n),e.point(p[0],p[1])):(p=r(n,d),e.point(p[0],p[1]),e.lineEnd()),n=p;else if(f&&n&&u^v){var g;m&s||!(g=r(d,n,!0))||(l=0,u?(e.lineStart(),e.point(g[0][0],g[0][1]),e.point(g[1][0],g[1][1]),e.lineEnd()):(e.point(g[1][0],g[1][1]),e.lineEnd(),e.lineStart(),e.point(g[0][0],g[0][1])))}!v||n&&It(n,d)||e.point(d[0],d[1]),n=d,o=v,s=m},lineEnd:function(){o&&e.lineEnd(),n=null},clean:function(){return l|(a&&o)<<1}}}function r(e,t,n){var r=_t(e),i=_t(t),s=[1,0,0],u=Pt(r,i),a=Dt(u,u),f=u[0],l=a-f*f;if(!l)return!n&&e;var c=o*a/l,h=-o*f/l,p=Pt(s,u),d=Bt(s,c),v=Bt(u,h);Ht(d,v);var m=p,g=Dt(d,m),y=Dt(m,m),b=g*g-y*(Dt(d,d)-1);if(!(0>b)){var w=Math.sqrt(b),E=Bt(m,(-g-w)/y);if(Ht(E,d),E=Ft(E),!n)return E;var S,x=e[0],T=t[0],N=e[1],C=t[1];x>T&&(S=x,x=T,T=S);var k=T-x,L=Math.abs(k-eu)<tu,A=L||tu>k;if(!L&&N>C&&(S=N,N=C,C=S),A?L?N+C>0^E[1]<(Math.abs(E[0]-x)<tu?N:C):N<=E[1]&&E[1]<=C:k>eu^(x<=E[0]&&E[0]<=T)){var O=Bt(m,(-g+w)/y);return Ht(O,d),[E,Ft(O)]}}}function i(t,n){var r=u?e:eu-e,i=0;return-r>t?i|=1:t>r&&(i|=2),-r>n?i|=4:n>r&&(i|=8),i}function s(e){return Yt(a,e)}var o=Math.cos(e),u=o>0,a=[e,0],f=Math.abs(o)>tu,l=An(e,6*ru);return Jt(t,n,l,s)}function sn(e,t,n,r){function i(r,i){return Math.abs(r[0]-e)<tu?i>0?0:3:Math.abs(r[0]-n)<tu?i>0?2:1:Math.abs(r[1]-t)<tu?i>0?1:0:i>0?3:2}function s(e,t){return o(e.point,t.point)}function o(e,t){var n=i(e,1),r=i(t,1);return n!==r?n-r:0===n?t[1]-e[1]:1===n?e[0]-t[0]:2===n?e[1]-t[1]:t[0]-e[0]}function u(i,s){var o=s[0]-i[0],u=s[1]-i[1],a=[0,1];return Math.abs(o)<tu&&Math.abs(u)<tu?e<=i[0]&&i[0]<=n&&t<=i[1]&&i[1]<=r:on(e-i[0],o,a)&&on(i[0]-n,-o,a)&&on(t-i[1],u,a)&&on(i[1]-r,-u,a)?(a[1]<1&&(s[0]=i[0]+a[1]*o,s[1]=i[1]+a[1]*u),a[0]>0&&(i[0]+=a[0]*o,i[1]+=a[0]*u),!0):!1}return function(a){function f(s){var o=i(s,-1),u=l([0===o||3===o?e:n,o>1?r:t]);return u}function l(e){for(var t=0,n=b.length,r=e[1],i=0;n>i;++i)for(var s,o=1,u=b[i],a=u.length,f=u[0];a>o;++o)s=u[o],f[1]<=r?s[1]>r&&c(f,s,e)>0&&++t:s[1]<=r&&c(f,s,e)<0&&--t,f=s;return 0!==t}function c(e,t,n){return(t[0]-e[0])*(n[1]-e[1])-(n[0]-e[0])*(t[1]-e[1])}function h(s,u,a,f){var l=0,c=0;if(null==s||(l=i(s,a))!==(c=i(u,a))||o(s,u)<0^a>0){do f.point(0===l||3===l?e:n,l>1?r:t);while((l=(l+a+4)%4)!==c)}else f.point(u[0],u[1])}function p(i,s){return i>=e&&n>=i&&s>=t&&r>=s}function d(e,t){p(e,t)&&a.point(e,t)}function v(){O.point=g,b&&b.push(w=[]),k=!0,C=!1,T=N=0/0}function m(){y&&(g(E,S),x&&C&&A.rejoin(),y.push(A.buffer())),O.point=d,C&&a.lineEnd()}function g(e,t){e=Math.max(-Ju,Math.min(Ju,e)),t=Math.max(-Ju,Math.min(Ju,t));var n=p(e,t);if(b&&w.push([e,t]),k)E=e,S=t,x=n,k=!1,n&&(a.lineStart(),a.point(e,t));else if(n&&C)a.point(e,t);else{var r=[T,N],i=[e,t];u(r,i)?(C||(a.lineStart(),a.point(r[0],r[1])),a.point(i[0],i[1]),n||a.lineEnd()):n&&(a.lineStart(),a.point(e,t))}T=e,N=t,C=n}var y,b,w,E,S,x,T,N,C,k,L=a,A=Qt(),O={point:d,lineStart:v,lineEnd:m,polygonStart:function(){a=A,y=[],b=[]},polygonEnd:function(){a=L,(y=wo.merge(y)).length?(a.polygonStart(),Vt(y,s,f,h,a),a.polygonEnd()):l([e,t])&&(a.polygonStart(),a.lineStart(),h(null,null,1,a),a.lineEnd(),a.polygonEnd()),y=b=w=null}};return O}}function on(e,t,n){if(Math.abs(t)<tu)return 0>=e;var r=e/t;if(t>0){if(r>n[1])return!1;r>n[0]&&(n[0]=r)}else{if(r<n[0])return!1;r<n[1]&&(n[1]=r)}return!0}function un(e,t){function n(n,r){return n=e(n,r),t(n[0],n[1])}return e.invert&&t.invert&&(n.invert=function(n,r){return n=t.invert(n,r),n&&e.invert(n[0],n[1])}),n}function an(e){var t=0,n=eu/3,r=Sn(e),i=r(t,n);return i.parallels=function(e){return arguments.length?r(t=e[0]*eu/180,n=e[1]*eu/180):[180*(t/eu),180*(n/eu)]},i}function fn(e,t){function n(e,t){var n=Math.sqrt(s-2*i*Math.sin(t))/i;return[n*Math.sin(e*=i),o-n*Math.cos(e)]}var r=Math.sin(e),i=(r+Math.sin(t))/2,s=1+r*(2*i-r),o=Math.sqrt(s)/i;return n.invert=function(e,t){var n=o-t;return[Math.atan2(e,n)/i,W((s-(e*e+n*n)*i*i)/(2*i))]},n}function ln(){function e(e,t){Qu+=i*e-r*t,r=e,i=t}var t,n,r,i;ta.point=function(s,o){ta.point=e,t=r=s,n=i=o},ta.lineEnd=function(){e(t,n)}}function cn(e,t){Gu>e&&(Gu=e),e>Zu&&(Zu=e),Yu>t&&(Yu=t),t>ea&&(ea=t)}function hn(){function e(e,t){o.push("M",e,",",t,s)}function t(e,t){o.push("M",e,",",t),u.point=n}function n(e,t){o.push("L",e,",",t)}function r(){u.point=e}function i(){o.push("Z")}var s=pn(4.5),o=[],u={point:e,lineStart:function(){u.point=t},lineEnd:r,polygonStart:function(){u.lineEnd=i},polygonEnd:function(){u.lineEnd=r,u.point=e},pointRadius:function(e){return s=pn(e),u},result:function(){if(o.length){var e=o.join("");return o=[],e}}};return u}function pn(e){return"m0,"+e+"a"+e+","+e+" 0 1,1 0,"+ -2*e+"a"+e+","+e+" 0 1,1 0,"+2*e+"z"}function dn(e,t){Bu+=e,ju+=t,++Fu}function vn(){function e(e,r){var i=e-t,s=r-n,o=Math.sqrt(i*i+s*s);Iu+=o*(t+e)/2,qu+=o*(n+r)/2,Ru+=o,dn(t=e,n=r)}var t,n;ra.point=function(r,i){ra.point=e,dn(t=r,n=i)}}function mn(){ra.point=dn}function gn(){function e(e,t){var n=e-r,s=t-i,o=Math.sqrt(n*n+s*s);Iu+=o*(r+e)/2,qu+=o*(i+t)/2,Ru+=o,o=i*e-r*t,Uu+=o*(r+e),zu+=o*(i+t),Wu+=3*o,dn(r=e,i=t)}var t,n,r,i;ra.point=function(s,o){ra.point=e,dn(t=r=s,n=i=o)},ra.lineEnd=function(){e(t,n)}}function yn(e){function t(t,n){e.moveTo(t,n),e.arc(t,n,o,0,2*eu)}function n(t,n){e.moveTo(t,n),u.point=r}function r(t,n){e.lineTo(t,n)}function i(){u.point=t}function s(){e.closePath()}var o=4.5,u={point:t,lineStart:function(){u.point=n},lineEnd:i,polygonStart:function(){u.lineEnd=s},polygonEnd:function(){u.lineEnd=i,u.point=t},pointRadius:function(e){return o=e,u},result:l};return u}function bn(e){function t(t){function r(n,r){n=e(n,r),t.point(n[0],n[1])}function i(){b=0/0,T.point=o,t.lineStart()}function o(r,i){var o=_t([r,i]),u=e(r,i);n(b,w,y,E,S,x,b=u[0],w=u[1],y=r,E=o[0],S=o[1],x=o[2],s,t),t.point(b,w)}function u(){T.point=r,t.lineEnd()}function a(){i(),T.point=f,T.lineEnd=l}function f(e,t){o(c=e,h=t),p=b,d=w,v=E,m=S,g=x,T.point=o}function l(){n(b,w,y,E,S,x,p,d,c,v,m,g,s,t),T.lineEnd=u,u()}var c,h,p,d,v,m,g,y,b,w,E,S,x,T={point:r,lineStart:i,lineEnd:u,polygonStart:function(){t.polygonStart(),T.lineStart=a},polygonEnd:function(){t.polygonEnd(),T.lineStart=i}};return T}function n(t,s,o,u,a,f,l,c,h,p,d,v,m,g){var y=l-t,b=c-s,w=y*y+b*b;if(w>4*r&&m--){var E=u+p,S=a+d,x=f+v,T=Math.sqrt(E*E+S*S+x*x),N=Math.asin(x/=T),C=Math.abs(Math.abs(x)-1)<tu?(o+h)/2:Math.atan2(S,E),k=e(C,N),L=k[0],A=k[1],O=L-t,M=A-s,_=b*O-y*M;(_*_/w>r||Math.abs((y*O+b*M)/w-.5)>.3||i>u*p+a*d+f*v)&&(n(t,s,o,u,a,f,L,A,C,E/=T,S/=T,x,m,g),g.point(L,A),n(L,A,C,E,S,x,l,c,h,p,d,v,m,g))}}var r=.5,i=Math.cos(30*ru),s=16;return t.precision=function(e){return arguments.length?(s=(r=e*e)>0&&16,t):Math.sqrt(r)},t}function wn(e){var t=bn(function(t,n){return e([t*iu,n*iu])});return function(e){return e=t(e),{point:function(t,n){e.point(t*ru,n*ru)},sphere:function(){e.sphere()},lineStart:function(){e.lineStart()},lineEnd:function(){e.lineEnd()},polygonStart:function(){e.polygonStart()},polygonEnd:function(){e.polygonEnd()}}}}function En(e){return Sn(function(){return e})()}function Sn(e){function t(e){return e=u(e[0]*ru,e[1]*ru),[e[0]*h+a,f-e[1]*h]}function n(e){return e=u.invert((e[0]-a)/h,(f-e[1])/h),e&&[e[0]*iu,e[1]*iu]}function r(){u=un(o=Nn(g,y,b),s);var e=s(v,m);return a=p-e[0]*h,f=d+e[1]*h,i()}function i(){return l&&(l.valid=!1,l=null),t}var s,o,u,a,f,l,c=bn(function(e,t){return e=s(e,t),[e[0]*h+a,f-e[1]*h]}),h=150,p=480,d=250,v=0,m=0,g=0,y=0,b=0,w=Vu,E=vt,S=null,x=null;return t.stream=function(e){return l&&(l.valid=!1),l=xn(o,w(c(E(e)))),l.valid=!0,l},t.clipAngle=function(e){return arguments.length?(w=null==e?(S=e,Vu):rn((S=+e)*ru),i()):S},t.clipExtent=function(e){return arguments.length?(x=e,E=null==e?vt:sn(e[0][0],e[0][1],e[1][0],e[1][1]),i()):x},t.scale=function(e){return arguments.length?(h=+e,r()):h},t.translate=function(e){return arguments.length?(p=+e[0],d=+e[1],r()):[p,d]},t.center=function(e){return arguments.length?(v=e[0]%360*ru,m=e[1]%360*ru,r()):[v*iu,m*iu]},t.rotate=function(e){return arguments.length?(g=e[0]%360*ru,y=e[1]%360*ru,b=e.length>2?e[2]%360*ru:0,r()):[g*iu,y*iu,b*iu]},wo.rebind(t,c,"precision"),function(){return s=e.apply(this,arguments),t.invert=s.invert&&n,r()}}function xn(e,t){return{point:function(n,r){r=e(n*ru,r*ru),n=r[0],t.point(n>eu?n-2*eu:-eu>n?n+2*eu:n,r[1])},sphere:function(){t.sphere()},lineStart:function(){t.lineStart()},lineEnd:function(){t.lineEnd()},polygonStart:function(){t.polygonStart()},polygonEnd:function(){t.polygonEnd()}}}function Tn(e,t){return[e,t]}function Nn(e,t,n){return e?t||n?un(kn(e),Ln(t,n)):kn(e):t||n?Ln(t,n):Tn}function Cn(e){return function(t,n){return t+=e,[t>eu?t-2*eu:-eu>t?t+2*eu:t,n]}}function kn(e){var t=Cn(e);return t.invert=Cn(-e),t}function Ln(e,t){function n(e,t){var n=Math.cos(t),u=Math.cos(e)*n,a=Math.sin(e)*n,f=Math.sin(t),l=f*r+u*i;return[Math.atan2(a*s-l*o,u*r-f*i),W(l*s+a*o)]}var r=Math.cos(e),i=Math.sin(e),s=Math.cos(t),o=Math.sin(t);return n.invert=function(e,t){var n=Math.cos(t),u=Math.cos(e)*n,a=Math.sin(e)*n,f=Math.sin(t),l=f*s-a*o;return[Math.atan2(a*s+f*o,u*r+l*i),W(l*r-u*i)]},n}function An(e,t){var n=Math.cos(e),r=Math.sin(e);return function(i,s,o,u){null!=i?(i=On(n,i),s=On(n,s),(o>0?s>i:i>s)&&(i+=2*o*eu)):(i=e+2*o*eu,s=e);for(var a,f=o*t,l=i;o>0?l>s:s>l;l-=f)u.point((a=Ft([n,-r*Math.cos(l),-r*Math.sin(l)]))[0],a[1])}}function On(e,t){var n=_t(t);n[0]-=e,jt(n);var r=z(-n[1]);return((-n[2]<0?-r:r)+2*Math.PI-tu)%(2*Math.PI)}function Mn(e,t,n){var r=wo.range(e,t-tu,n).concat(t);return function(e){return r.map(function(t){return[e,t]})}}function _n(e,t,n){var r=wo.range(e,t-tu,n).concat(t);return function(e){return r.map(function(t){return[t,e]})}}function Dn(e){return e.source}function Pn(e){return e.target}function Hn(e,t,n,r){var i=Math.cos(t),s=Math.sin(t),o=Math.cos(r),u=Math.sin(r),a=i*Math.cos(e),f=i*Math.sin(e),l=o*Math.cos(n),c=o*Math.sin(n),h=2*Math.asin(Math.sqrt($(r-t)+i*o*$(n-e))),p=1/Math.sin(h),d=h?function(e){var t=Math.sin(e*=h)*p,n=Math.sin(h-e)*p,r=n*a+t*l,i=n*f+t*c,o=n*s+t*u;return[Math.atan2(i,r)*iu,Math.atan2(o,Math.sqrt(r*r+i*i))*iu]}:function(){return[e*iu,t*iu]};return d.distance=h,d}function Bn(){function e(e,i){var s=Math.sin(i*=ru),o=Math.cos(i),u=Math.abs((e*=ru)-t),a=Math.cos(u);ia+=Math.atan2(Math.sqrt((u=o*Math.sin(u))*u+(u=r*s-n*o*a)*u),n*s+r*o*a),t=e,n=s,r=o}var t,n,r;sa.point=function(i,s){t=i*ru,n=Math.sin(s*=ru),r=Math.cos(s),sa.point=e},sa.lineEnd=function(){sa.point=sa.lineEnd=l}}function jn(e,t){function n(t,n){var r=Math.cos(t),i=Math.cos(n),s=e(r*i);return[s*i*Math.sin(t),s*Math.sin(n)]}return n.invert=function(e,n){var r=Math.sqrt(e*e+n*n),i=t(r),s=Math.sin(i),o=Math.cos(i);return[Math.atan2(e*s,r*o),Math.asin(r&&n*s/r)]},n}function Fn(e,t){function n(e,t){var n=Math.abs(Math.abs(t)-eu/2)<tu?0:o/Math.pow(i(t),s);return[n*Math.sin(s*e),o-n*Math.cos(s*e)]}var r=Math.cos(e),i=function(e){return Math.tan(eu/4+e/2)},s=e===t?Math.sin(e):Math.log(r/Math.cos(t))/Math.log(i(t)/i(e)),o=r*Math.pow(i(e),s)/s;return s?(n.invert=function(e,t){var n=o-t,r=U(s)*Math.sqrt(e*e+n*n);return[Math.atan2(e,n)/s,2*Math.atan(Math.pow(o/r,1/s))-eu/2]},n):qn}function In(e,t){function n(e,t){var n=s-t;return[n*Math.sin(i*e),s-n*Math.cos(i*e)]}var r=Math.cos(e),i=e===t?Math.sin(e):(r-Math.cos(t))/(t-e),s=r/i+e;return Math.abs(i)<tu?Tn:(n.invert=function(e,t){var n=s-t;return[Math.atan2(e,n)/i,s-U(i)*Math.sqrt(e*e+n*n)]},n)}function qn(e,t){return[e,Math.log(Math.tan(eu/4+t/2))]}function Rn(e){var t,n=En(e),r=n.scale,i=n.translate,s=n.clipExtent;return n.scale=function(){var e=r.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.translate=function(){var e=i.apply(n,arguments);return e===n?t?n.clipExtent(null):n:e},n.clipExtent=function(e){var o=s.apply(n,arguments);if(o===n){if(t=null==e){var u=eu*r(),a=i();s([[a[0]-u,a[1]-u],[a[0]+u,a[1]+u]])}}else t&&(o=null);return o},n.clipExtent(null)}function Un(e,t){var n=Math.cos(t)*Math.sin(e);return[Math.log((1+n)/(1-n))/2,Math.atan2(Math.tan(t),Math.cos(e))]}function zn(e){function t(t){function o(){f.push("M",s(e(l),u))}for(var a,f=[],l=[],c=-1,h=t.length,p=dt(n),d=dt(r);++c<h;)i.call(this,a=t[c],c)?l.push([+p.call(this,a,c),+d.call(this,a,c)]):l.length&&(o(),l=[]);return l.length&&o(),f.length?f.join(""):null}var n=Wn,r=Xn,i=Xt,s=Vn,o=s.key,u=.7;return t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.defined=function(e){return arguments.length?(i=e,t):i},t.interpolate=function(e){return arguments.length?(o="function"==typeof e?s=e:(s=ca.get(e)||Vn).key,t):o},t.tension=function(e){return arguments.length?(u=e,t):u},t}function Wn(e){return e[0]}function Xn(e){return e[1]}function Vn(e){return e.join("L")}function $n(e){return Vn(e)+"Z"}function Jn(e){for(var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];++t<n;)i.push("H",(r[0]+(r=e[t])[0])/2,"V",r[1]);return n>1&&i.push("H",r[0]),i.join("")}function Kn(e){for(var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];++t<n;)i.push("V",(r=e[t])[1],"H",r[0]);return i.join("")}function Qn(e){for(var t=0,n=e.length,r=e[0],i=[r[0],",",r[1]];++t<n;)i.push("H",(r=e[t])[0],"V",r[1]);return i.join("")}function Gn(e,t){return e.length<4?Vn(e):e[1]+er(e.slice(1,e.length-1),tr(e,t))}function Yn(e,t){return e.length<3?Vn(e):e[0]+er((e.push(e[0]),e),tr([e[e.length-2]].concat(e,[e[1]]),t))}function Zn(e,t){return e.length<3?Vn(e):e[0]+er(e,tr(e,t))}function er(e,t){if(t.length<1||e.length!=t.length&&e.length!=t.length+2)return Vn(e);var n=e.length!=t.length,r="",i=e[0],s=e[1],o=t[0],u=o,a=1;if(n&&(r+="Q"+(s[0]-2*o[0]/3)+","+(s[1]-2*o[1]/3)+","+s[0]+","+s[1],i=e[1],a=2),t.length>1){u=t[1],s=e[a],a++,r+="C"+(i[0]+o[0])+","+(i[1]+o[1])+","+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1];for(var f=2;f<t.length;f++,a++)s=e[a],u=t[f],r+="S"+(s[0]-u[0])+","+(s[1]-u[1])+","+s[0]+","+s[1]}if(n){var l=e[a];r+="Q"+(s[0]+2*u[0]/3)+","+(s[1]+2*u[1]/3)+","+l[0]+","+l[1]}return r}function tr(e,t){for(var n,r=[],i=(1-t)/2,s=e[0],o=e[1],u=1,a=e.length;++u<a;)n=s,s=o,o=e[u],r.push([i*(o[0]-n[0]),i*(o[1]-n[1])]);return r}function nr(e){if(e.length<3)return Vn(e);var t=1,n=e.length,r=e[0],i=r[0],s=r[1],o=[i,i,i,(r=e[1])[0]],u=[s,s,s,r[1]],a=[i,",",s,"L",or(da,o),",",or(da,u)];for(e.push(e[n-1]);++t<=n;)r=e[t],o.shift(),o.push(r[0]),u.shift(),u.push(r[1]),ur(a,o,u);return e.pop(),a.push("L",r),a.join("")}function rr(e){if(e.length<4)return Vn(e);for(var t,n=[],r=-1,i=e.length,s=[0],o=[0];++r<3;)t=e[r],s.push(t[0]),o.push(t[1]);for(n.push(or(da,s)+","+or(da,o)),--r;++r<i;)t=e[r],s.shift(),s.push(t[0]),o.shift(),o.push(t[1]),ur(n,s,o);return n.join("")}function ir(e){for(var t,n,r=-1,i=e.length,s=i+4,o=[],u=[];++r<4;)n=e[r%i],o.push(n[0]),u.push(n[1]);for(t=[or(da,o),",",or(da,u)],--r;++r<s;)n=e[r%i],o.shift(),o.push(n[0]),u.shift(),u.push(n[1]),ur(t,o,u);return t.join("")}function sr(e,t){var n=e.length-1;if(n)for(var r,i,s=e[0][0],o=e[0][1],u=e[n][0]-s,a=e[n][1]-o,f=-1;++f<=n;)r=e[f],i=f/n,r[0]=t*r[0]+(1-t)*(s+i*u),r[1]=t*r[1]+(1-t)*(o+i*a);return nr(e)}function or(e,t){return e[0]*t[0]+e[1]*t[1]+e[2]*t[2]+e[3]*t[3]}function ur(e,t,n){e.push("C",or(ha,t),",",or(ha,n),",",or(pa,t),",",or(pa,n),",",or(da,t),",",or(da,n))}function ar(e,t){return(t[1]-e[1])/(t[0]-e[0])}function fr(e){for(var t=0,n=e.length-1,r=[],i=e[0],s=e[1],o=r[0]=ar(i,s);++t<n;)r[t]=(o+(o=ar(i=s,s=e[t+1])))/2;return r[t]=o,r}function lr(e){for(var t,n,r,i,s=[],o=fr(e),u=-1,a=e.length-1;++u<a;)t=ar(e[u],e[u+1]),Math.abs(t)<1e-6?o[u]=o[u+1]=0:(n=o[u]/t,r=o[u+1]/t,i=n*n+r*r,i>9&&(i=3*t/Math.sqrt(i),o[u]=i*n,o[u+1]=i*r));for(u=-1;++u<=a;)i=(e[Math.min(a,u+1)][0]-e[Math.max(0,u-1)][0])/(6*(1+o[u]*o[u])),s.push([i||0,o[u]*i||0]);return s}function cr(e){return e.length<3?Vn(e):e[0]+er(e,lr(e))}function hr(e,t,n,r){var i,s,o,u,a,f,l;return i=r[e],s=i[0],o=i[1],i=r[t],u=i[0],a=i[1],i=r[n],f=i[0],l=i[1],(l-o)*(u-s)-(a-o)*(f-s)>0}function pr(e,t,n){return(n[0]-t[0])*(e[1]-t[1])<(n[1]-t[1])*(e[0]-t[0])}function dr(e,t,n,r){var i=e[0],s=n[0],o=t[0]-i,u=r[0]-s,a=e[1],f=n[1],l=t[1]-a,c=r[1]-f,h=(u*(a-f)-c*(i-s))/(c*o-u*l);return[i+h*o,a+h*l]}function vr(e){var t=e[0],n=e[e.length-1];return!(t[0]-n[0]||t[1]-n[1])}function mr(e,t){var n={list:e.map(function(e,t){return{index:t,x:e[0],y:e[1]}}).sort(function(e,t){return e.y<t.y?-1:e.y>t.y?1:e.x<t.x?-1:e.x>t.x?1:0}),bottomSite:null},r={list:[],leftEnd:null,rightEnd:null,init:function(){r.leftEnd=r.createHalfEdge(null,"l"),r.rightEnd=r.createHalfEdge(null,"l"),r.leftEnd.r=r.rightEnd,r.rightEnd.l=r.leftEnd,r.list.unshift(r.leftEnd,r.rightEnd)},createHalfEdge:function(e,t){return{edge:e,side:t,vertex:null,l:null,r:null}},insert:function(e,t){t.l=e,t.r=e.r,e.r.l=t,e.r=t},leftBound:function(e){var t=r.leftEnd;do t=t.r;while(t!=r.rightEnd&&i.rightOf(t,e));return t=t.l},del:function(e){e.l.r=e.r,e.r.l=e.l,e.edge=null},right:function(e){return e.r},left:function(e){return e.l},leftRegion:function(e){return null==e.edge?n.bottomSite:e.edge.region[e.side]},rightRegion:function(e){return null==e.edge?n.bottomSite:e.edge.region[ma[e.side]]}},i={bisect:function(e,t){var n={region:{l:e,r:t},ep:{l:null,r:null}},r=t.x-e.x,i=t.y-e.y,s=r>0?r:-r,o=i>0?i:-i;return n.c=e.x*r+e.y*i+.5*(r*r+i*i),s>o?(n.a=1,n.b=i/r,n.c/=r):(n.b=1,n.a=r/i,n.c/=i),n},intersect:function(e,t){var n=e.edge,r=t.edge;if(!n||!r||n.region.r==r.region.r)return null;var i=n.a*r.b-n.b*r.a;if(Math.abs(i)<1e-10)return null;var s,o,u=(n.c*r.b-r.c*n.b)/i,a=(r.c*n.a-n.c*r.a)/i,f=n.region.r,l=r.region.r;f.y<l.y||f.y==l.y&&f.x<l.x?(s=e,o=n):(s=t,o=r);var c=u>=o.region.r.x;return c&&"l"===s.side||!c&&"r"===s.side?null:{x:u,y:a}},rightOf:function(e,t){var n=e.edge,r=n.region.r,i=t.x>r.x;if(i&&"l"===e.side)return 1;if(!i&&"r"===e.side)return 0;if(1===n.a){var s=t.y-r.y,o=t.x-r.x,u=0,a=0;if(!i&&n.b<0||i&&n.b>=0?a=u=s>=n.b*o:(a=t.x+t.y*n.b>n.c,n.b<0&&(a=!a),a||(u=1)),!u){var f=r.x-n.region.l.x;a=n.b*(o*o-s*s)<f*s*(1+2*o/f+n.b*n.b),n.b<0&&(a=!a)}}else{var l=n.c-n.a*t.x,c=t.y-l,h=t.x-r.x,p=l-r.y;a=c*c>h*h+p*p}return"l"===e.side?a:!a},endPoint:function(e,n,r){e.ep[n]=r,e.ep[ma[n]]&&t(e)},distance:function(e,t){var n=e.x-t.x,r=e.y-t.y;return Math.sqrt(n*n+r*r)}},s={list:[],insert:function(e,t,n){e.vertex=t,e.ystar=t.y+n;for(var r=0,i=s.list,o=i.length;o>r;r++){var u=i[r];if(!(e.ystar>u.ystar||e.ystar==u.ystar&&t.x>u.vertex.x))break}i.splice(r,0,e)},del:function(e){for(var t=0,n=s.list,r=n.length;r>t&&n[t]!=e;++t);n.splice(t,1)},empty:function(){return 0===s.list.length},nextEvent:function(e){for(var t=0,n=s.list,r=n.length;r>t;++t)if(n[t]==e)return n[t+1];return null},min:function(){var e=s.list[0];return{x:e.vertex.x,y:e.ystar}},extractMin:function(){return s.list.shift()}};r.init(),n.bottomSite=n.list.shift();for(var o,u,a,f,l,c,h,p,d,v,m,g,y,b=n.list.shift();;)if(s.empty()||(o=s.min()),b&&(s.empty()||b.y<o.y||b.y==o.y&&b.x<o.x))u=r.leftBound(b),a=r.right(u),h=r.rightRegion(u),g=i.bisect(h,b),c=r.createHalfEdge(g,"l"),r.insert(u,c),v=i.intersect(u,c),v&&(s.del(u),s.insert(u,v,i.distance(v,b))),u=c,c=r.createHalfEdge(g,"r"),r.insert(u,c),v=i.intersect(c,a),v&&s.insert(c,v,i.distance(v,b)),b=n.list.shift();else{if(s.empty())break;u=s.extractMin(),f=r.left(u),a=r.right(u),l=r.right(a),h=r.leftRegion(u),p=r.rightRegion(a),m=u.vertex,i.endPoint(u.edge,u.side,m),i.endPoint(a.edge,a.side,m),r.del(u),s.del(a),r.del(a),y="l",h.y>p.y&&(d=h,h=p,p=d,y="r"),g=i.bisect(h,p),c=r.createHalfEdge(g,y),r.insert(f,c),i.endPoint(g,ma[y],m),v=i.intersect(f,c),v&&(s.del(f),s.insert(f,v,i.distance(v,h))),v=i.intersect(c,l),v&&s.insert(c,v,i.distance(v,h))}for(u=r.right(r.leftEnd);u!=r.rightEnd;u=r.right(u))t(u.edge)}function gr(e){return e.x}function yr(e){return e.y}function br(){return{leaf:!0,nodes:[],point:null,x:null,y:null}}function wr(e,t,n,r,i,s){if(!e(t,n,r,i,s)){var o=.5*(n+i),u=.5*(r+s),a=t.nodes;a[0]&&wr(e,a[0],n,r,o,u),a[1]&&wr(e,a[1],o,r,i,u),a[2]&&wr(e,a[2],n,u,o,s),a[3]&&wr(e,a[3],o,u,i,s)}}function Er(e,t){e=wo.rgb(e),t=wo.rgb(t);var n=e.r,r=e.g,i=e.b,s=t.r-n,o=t.g-r,u=t.b-i;return function(e){return"#"+at(Math.round(n+s*e))+at(Math.round(r+o*e))+at(Math.round(i+u*e))}}function Sr(e,t){var n,r={},i={};for(n in e)n in t?r[n]=Nr(e[n],t[n]):i[n]=e[n];for(n in t)n in e||(i[n]=t[n]);return function(e){for(n in r)i[n]=r[n](e);return i}}function xr(e,t){return t-=e=+e,function(n){return e+t*n}}function Tr(e,t){var n,r,i,s,o,u=0,a=0,f=[],l=[];for(e+="",t+="",ga.lastIndex=0,r=0;n=ga.exec(t);++r)n.index&&f.push(t.substring(u,a=n.index)),l.push({i:f.length,x:n[0]}),f.push(null),u=ga.lastIndex;for(u<t.length&&f.push(t.substring(u)),r=0,s=l.length;(n=ga.exec(e))&&s>r;++r)if(o=l[r],o.x==n[0]){if(o.i)if(null==f[o.i+1])for(f[o.i-1]+=o.x,f.splice(o.i,1),i=r+1;s>i;++i)l[i].i--;else for(f[o.i-1]+=o.x+f[o.i+1],f.splice(o.i,2),i=r+1;s>i;++i)l[i].i-=2;else if(null==f[o.i+1])f[o.i]=o.x;else for(f[o.i]=o.x+f[o.i+1],f.splice(o.i+1,1),i=r+1;s>i;++i)l[i].i--;l.splice(r,1),s--,r--}else o.x=xr(parseFloat(n[0]),parseFloat(o.x));for(;s>r;)o=l.pop(),null==f[o.i+1]?f[o.i]=o.x:(f[o.i]=o.x+f[o.i+1],f.splice(o.i+1,1)),s--;return 1===f.length?null==f[0]?(o=l[0].x,function(e){return o(e)+""}):function(){return t}:function(e){for(r=0;s>r;++r)f[(o=l[r]).i]=o.x(e);return f.join("")}}function Nr(e,t){for(var n,r=wo.interpolators.length;--r>=0&&!(n=wo.interpolators[r](e,t)););return n}function Cr(e,t){var n,r=[],i=[],s=e.length,o=t.length,u=Math.min(e.length,t.length);for(n=0;u>n;++n)r.push(Nr(e[n],t[n]));for(;s>n;++n)i[n]=e[n];for(;o>n;++n)i[n]=t[n];return function(e){for(n=0;u>n;++n)i[n]=r[n](e);return i}}function kr(e){return function(t){return 0>=t?0:t>=1?1:e(t)}}function Lr(e){return function(t){return 1-e(1-t)}}function Ar(e){return function(t){return.5*(.5>t?e(2*t):2-e(2-2*t))}}function Or(e){return e*e}function Mr(e){return e*e*e}function _r(e){if(0>=e)return 0;if(e>=1)return 1;var t=e*e,n=t*e;return 4*(.5>e?n:3*(e-t)+n-.75)}function Dr(e){return function(t){return Math.pow(t,e)}}function Pr(e){return 1-Math.cos(e*eu/2)}function Hr(e){return Math.pow(2,10*(e-1))}function Br(e){return 1-Math.sqrt(1-e*e)}function jr(e,t){var n;return arguments.length<2&&(t=.45),arguments.length?n=t/(2*eu)*Math.asin(1/e):(e=1,n=t/4),function(r){return 1+e*Math.pow(2,10*-r)*Math.sin(2*(r-n)*eu/t)}}function Fr(e){return e||(e=1.70158),function(t){return t*t*((e+1)*t-e)}}function Ir(e){return 1/2.75>e?7.5625*e*e:2/2.75>e?7.5625*(e-=1.5/2.75)*e+.75:2.5/2.75>e?7.5625*(e-=2.25/2.75)*e+.9375:7.5625*(e-=2.625/2.75)*e+.984375}function qr(e,t){e=wo.hcl(e),t=wo.hcl(t);var n=e.h,r=e.c,i=e.l,s=t.h-n,o=t.c-r,u=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.c:r),isNaN(s)?(s=0,n=isNaN(n)?t.h:n):s>180?s-=360:-180>s&&(s+=360),function(e){return Q(n+s*e,r+o*e,i+u*e)+""}}function Rr(e,t){e=wo.hsl(e),t=wo.hsl(t);var n=e.h,r=e.s,i=e.l,s=t.h-n,o=t.s-r,u=t.l-i;return isNaN(o)&&(o=0,r=isNaN(r)?t.s:r),isNaN(s)?(s=0,n=isNaN(n)?t.h:n):s>180?s-=360:-180>s&&(s+=360),function(e){return R(n+s*e,r+o*e,i+u*e)+""}}function Ur(e,t){e=wo.lab(e),t=wo.lab(t);var n=e.l,r=e.a,i=e.b,s=t.l-n,o=t.a-r,u=t.b-i;return function(e){return Z(n+s*e,r+o*e,i+u*e)+""}}function zr(e,t){return t-=e,function(n){return Math.round(e+t*n)}}function Wr(e){var t=[e.a,e.b],n=[e.c,e.d],r=Vr(t),i=Xr(t,n),s=Vr($r(n,t,-i))||0;t[0]*n[1]<n[0]*t[1]&&(t[0]*=-1,t[1]*=-1,r*=-1,i*=-1),this.rotate=(r?Math.atan2(t[1],t[0]):Math.atan2(-n[0],n[1]))*iu,this.translate=[e.e,e.f],this.scale=[r,s],this.skew=s?Math.atan2(i,s)*iu:0}function Xr(e,t){return e[0]*t[0]+e[1]*t[1]}function Vr(e){var t=Math.sqrt(Xr(e,e));return t&&(e[0]/=t,e[1]/=t),t}function $r(e,t,n){return e[0]+=n*t[0],e[1]+=n*t[1],e}function Jr(e,t){var n,r=[],i=[],s=wo.transform(e),o=wo.transform(t),u=s.translate,a=o.translate,f=s.rotate,l=o.rotate,c=s.skew,h=o.skew,p=s.scale,d=o.scale;return u[0]!=a[0]||u[1]!=a[1]?(r.push("translate(",null,",",null,")"),i.push({i:1,x:xr(u[0],a[0])},{i:3,x:xr(u[1],a[1])})):a[0]||a[1]?r.push("translate("+a+")"):r.push(""),f!=l?(f-l>180?l+=360:l-f>180&&(f+=360),i.push({i:r.push(r.pop()+"rotate(",null,")")-2,x:xr(f,l)})):l&&r.push(r.pop()+"rotate("+l+")"),c!=h?i.push({i:r.push(r.pop()+"skewX(",null,")")-2,x:xr(c,h)}):h&&r.push(r.pop()+"skewX("+h+")"),p[0]!=d[0]||p[1]!=d[1]?(n=r.push(r.pop()+"scale(",null,",",null,")"),i.push({i:n-4,x:xr(p[0],d[0])},{i:n-2,x:xr(p[1],d[1])})):(1!=d[0]||1!=d[1])&&r.push(r.pop()+"scale("+d+")"),n=i.length,function(e){for(var t,s=-1;++s<n;)r[(t=i[s]).i]=t.x(e);return r.join("")}}function Kr(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return(n-e)*t}}function Qr(e,t){return t=t-(e=+e)?1/(t-e):0,function(n){return Math.max(0,Math.min(1,(n-e)*t))}}function Gr(e){for(var t=e.source,n=e.target,r=Zr(t,n),i=[t];t!==r;)t=t.parent,i.push(t);for(var s=i.length;n!==r;)i.splice(s,0,n),n=n.parent;return i}function Yr(e){for(var t=[],n=e.parent;null!=n;)t.push(e),e=n,n=n.parent;return t.push(e),t}function Zr(e,t){if(e===t)return e;for(var n=Yr(e),r=Yr(t),i=n.pop(),s=r.pop(),o=null;i===s;)o=i,i=n.pop(),s=r.pop();return o}function ei(e){e.fixed|=2}function ti(e){e.fixed&=-7}function ni(e){e.fixed|=4,e.px=e.x,e.py=e.y}function ri(e){e.fixed&=-5}function ii(e,t,n){var r=0,i=0;if(e.charge=0,!e.leaf)for(var s,o=e.nodes,u=o.length,a=-1;++a<u;)s=o[a],null!=s&&(ii(s,t,n),e.charge+=s.charge,r+=s.charge*s.cx,i+=s.charge*s.cy);if(e.point){e.leaf||(e.point.x+=Math.random()-.5,e.point.y+=Math.random()-.5);var f=t*n[e.point.index];e.charge+=e.pointCharge=f,r+=f*e.point.x,i+=f*e.point.y}e.cx=r/e.charge,e.cy=i/e.charge}function si(e,t){return wo.rebind(e,t,"sort","children","value"),e.nodes=e,e.links=fi,e}function oi(e){return e.children}function ui(e){return e.value}function ai(e,t){return t.value-e.value}function fi(e){return wo.merge(e.map(function(e){return(e.children||[]).map(function(t){return{source:e,target:t}})}))}function li(e){return e.x}function ci(e){return e.y}function hi(e,t,n){e.y0=t,e.y=n}function pi(e){return wo.range(e.length)}function di(e){for(var t=-1,n=e[0].length,r=[];++t<n;)r[t]=0;return r}function vi(e){for(var t,n=1,r=0,i=e[0][1],s=e.length;s>n;++n)(t=e[n][1])>i&&(r=n,i=t);return r}function mi(e){return e.reduce(gi,0)}function gi(e,t){return e+t[1]}function yi(e,t){return bi(e,Math.ceil(Math.log(t.length)/Math.LN2+1))}function bi(e,t){for(var n=-1,r=+e[0],i=(e[1]-r)/t,s=[];++n<=t;)s[n]=i*n+r;return s}function wi(e){return[wo.min(e),wo.max(e)]}function Ei(e,t){return e.parent==t.parent?1:2}function Si(e){var t=e.children;return t&&t.length?t[0]:e._tree.thread}function xi(e){var t,n=e.children;return n&&(t=n.length)?n[t-1]:e._tree.thread}function Ti(e,t){var n=e.children;if(n&&(i=n.length))for(var r,i,s=-1;++s<i;)t(r=Ti(n[s],t),e)>0&&(e=r);return e}function Ni(e,t){return e.x-t.x}function Ci(e,t){return t.x-e.x}function ki(e,t){return e.depth-t.depth}function Li(e,t){function n(e,r){var i=e.children;if(i&&(o=i.length))for(var s,o,u=null,a=-1;++a<o;)s=i[a],n(s,u),u=s;t(e,r)}n(e,null)}function Ai(e){for(var t,n=0,r=0,i=e.children,s=i.length;--s>=0;)t=i[s]._tree,t.prelim+=n,t.mod+=n,n+=t.shift+(r+=t.change)}function Oi(e,t,n){e=e._tree,t=t._tree;var r=n/(t.number-e.number);e.change+=r,t.change-=r,t.shift+=n,t.prelim+=n,t.mod+=n}function Mi(e,t,n){return e._tree.ancestor.parent==t.parent?e._tree.ancestor:n}function _i(e,t){return e.value-t.value}function Di(e,t){var n=e._pack_next;e._pack_next=t,t._pack_prev=e,t._pack_next=n,n._pack_prev=t}function Pi(e,t){e._pack_next=t,t._pack_prev=e}function Hi(e,t){var n=t.x-e.x,r=t.y-e.y,i=e.r+t.r;return.999*i*i>n*n+r*r}function Bi(e){function t(e){l=Math.min(e.x-e.r,l),c=Math.max(e.x+e.r,c),h=Math.min(e.y-e.r,h),p=Math.max(e.y+e.r,p)}if((n=e.children)&&(f=n.length)){var n,r,i,s,o,u,a,f,l=1/0,c=-1/0,h=1/0,p=-1/0;if(n.forEach(ji),r=n[0],r.x=-r.r,r.y=0,t(r),f>1&&(i=n[1],i.x=i.r,i.y=0,t(i),f>2))for(s=n[2],qi(r,i,s),t(s),Di(r,s),r._pack_prev=s,Di(s,i),i=r._pack_next,o=3;f>o;o++){qi(r,i,s=n[o]);var d=0,v=1,m=1;for(u=i._pack_next;u!==i;u=u._pack_next,v++)if(Hi(u,s)){d=1;break}if(1==d)for(a=r._pack_prev;a!==u._pack_prev&&!Hi(a,s);a=a._pack_prev,m++);d?(m>v||v==m&&i.r<r.r?Pi(r,i=u):Pi(r=a,i),o--):(Di(r,s),i=s,t(s))}var g=(l+c)/2,y=(h+p)/2,b=0;for(o=0;f>o;o++)s=n[o],s.x-=g,s.y-=y,b=Math.max(b,s.r+Math.sqrt(s.x*s.x+s.y*s.y));e.r=b,n.forEach(Fi)}}function ji(e){e._pack_next=e._pack_prev=e}function Fi(e){delete e._pack_next,delete e._pack_prev}function Ii(e,t,n,r){var i=e.children;if(e.x=t+=r*e.x,e.y=n+=r*e.y,e.r*=r,i)for(var s=-1,o=i.length;++s<o;)Ii(i[s],t,n,r)}function qi(e,t,n){var r=e.r+n.r,i=t.x-e.x,s=t.y-e.y;if(r&&(i||s)){var o=t.r+n.r,u=i*i+s*s;o*=o,r*=r;var a=.5+(r-o)/(2*u),f=Math.sqrt(Math.max(0,2*o*(r+u)-(r-=u)*r-o*o))/(2*u);n.x=e.x+a*i+f*s,n.y=e.y+a*s-f*i}else n.x=e.x+r,n.y=e.y}function Ri(e){return 1+wo.max(e,function(e){return e.y})}function Ui(e){return e.reduce(function(e,t){return e+t.x},0)/e.length}function zi(e){var t=e.children;return t&&t.length?zi(t[0]):e}function Wi(e){var t,n=e.children;return n&&(t=n.length)?Wi(n[t-1]):e}function Xi(e){return{x:e.x,y:e.y,dx:e.dx,dy:e.dy}}function Vi(e,t){var n=e.x+t[3],r=e.y+t[0],i=e.dx-t[1]-t[3],s=e.dy-t[0]-t[2];return 0>i&&(n+=i/2,i=0),0>s&&(r+=s/2,s=0),{x:n,y:r,dx:i,dy:s}}function $i(e){var t=e[0],n=e[e.length-1];return n>t?[t,n]:[n,t]}function Ji(e){return e.rangeExtent?e.rangeExtent():$i(e.range())}function Ki(e,t,n,r){var i=n(e[0],e[1]),s=r(t[0],t[1]);return function(e){return s(i(e))}}function Qi(e,t){var n,r=0,i=e.length-1,s=e[r],o=e[i];return s>o&&(n=r,r=i,i=n,n=s,s=o,o=n),e[r]=t.floor(s),e[i]=t.ceil(o),e}function Gi(e){return e?{floor:function(t){return Math.floor(t/e)*e},ceil:function(t){return Math.ceil(t/e)*e}}:ka}function Yi(e,t,n,r){var i=[],s=[],o=0,u=Math.min(e.length,t.length)-1;for(e[u]<e[0]&&(e=e.slice().reverse(),t=t.slice().reverse());++o<=u;)i.push(n(e[o-1],e[o])),s.push(r(t[o-1],t[o]));return function(t){var n=wo.bisect(e,t,1,u)-1;return s[n](i[n](t))}}function Zi(e,t,n,r){function i(){var i=Math.min(e.length,t.length)>2?Yi:Ki,a=r?Qr:Kr;return o=i(e,t,a,n),u=i(t,e,a,Nr),s}function s(e){return o(e)}var o,u;return s.invert=function(e){return u(e)},s.domain=function(t){return arguments.length?(e=t.map(Number),i()):e},s.range=function(e){return arguments.length?(t=e,i()):t},s.rangeRound=function(e){return s.range(e).interpolate(zr)},s.clamp=function(e){return arguments.length?(r=e,i()):r},s.interpolate=function(e){return arguments.length?(n=e,i()):n},s.ticks=function(t){return is(e,t)},s.tickFormat=function(t,n){return ss(e,t,n)},s.nice=function(t){return ts(e,t),i()},s.copy=function(){return Zi(e,t,n,r)},i()}function es(e,t){return wo.rebind(e,t,"range","rangeRound","interpolate","clamp")}function ts(e,t){return Qi(e,Gi(t?rs(e,t)[2]:ns(e)))}function ns(e){var t=$i(e),n=t[1]-t[0];return Math.pow(10,Math.round(Math.log(n)/Math.LN10)-1)}function rs(e,t){var n=$i(e),r=n[1]-n[0],i=Math.pow(10,Math.floor(Math.log(r/t)/Math.LN10)),s=t/r*i;return.15>=s?i*=10:.35>=s?i*=5:.75>=s&&(i*=2),n[0]=Math.ceil(n[0]/i)*i,n[1]=Math.floor(n[1]/i)*i+.5*i,n[2]=i,n}function is(e,t){return wo.range.apply(wo,rs(e,t))}function ss(e,t,n){var r=-Math.floor(Math.log(rs(e,t)[2])/Math.LN10+.01);return wo.format(n?n.replace(Tu,function(e,t,n,i,s,o,u,a,f,l){return[t,n,i,s,o,u,a,f||"."+(r-2*("%"===l)),l].join("")}):",."+r+"f")}function os(e,t,n,r){function i(e){return(n?Math.log(0>e?0:e):-Math.log(e>0?0:-e))/Math.log(t)}function s(e){return n?Math.pow(t,e):-Math.pow(t,-e)}function o(t){return e(i(t))}return o.invert=function(t){return s(e.invert(t))},o.domain=function(t){return arguments.length?(n=t[0]>=0,e.domain((r=t.map(Number)).map(i)),o):r},o.base=function(n){return arguments.length?(t=+n,e.domain(r.map(i)),o):t},o.nice=function(){var t=Qi(r.map(i),n?Math:Aa);return e.domain(t),r=t.map(s),o},o.ticks=function(){var e=$i(r),o=[],u=e[0],a=e[1],f=Math.floor(i(u)),l=Math.ceil(i(a)),c=t%1?2:t;if(isFinite(l-f)){if(n){for(;l>f;f++)for(var h=1;c>h;h++)o.push(s(f)*h);o.push(s(f))}else for(o.push(s(f));f++<l;)for(var h=c-1;h>0;h--)o.push(s(f)*h);for(f=0;o[f]<u;f++);for(l=o.length;o[l-1]>a;l--);o=o.slice(f,l)}return o},o.tickFormat=function(e,t){if(!arguments.length)return La;arguments.length<2?t=La:"function"!=typeof t&&(t=wo.format(t));var r,u=Math.max(.1,e/o.ticks().length),a=n?(r=1e-12,Math.ceil):(r=-1e-12,Math.floor);return function(e){return e/s(a(i(e)+r))<=u?t(e):""}},o.copy=function(){return os(e.copy(),t,n,r)},es(o,e)}function us(e,t,n){function r(t){return e(i(t))}var i=as(t),s=as(1/t);return r.invert=function(t){return s(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain((n=t.map(Number)).map(i)),r):n},r.ticks=function(e){return is(n,e)},r.tickFormat=function(e,t){return ss(n,e,t)},r.nice=function(e){return r.domain(ts(n,e))},r.exponent=function(o){return arguments.length?(i=as(t=o),s=as(1/t),e.domain(n.map(i)),r):t},r.copy=function(){return us(e.copy(),t,n)},es(r,e)}function as(e){return function(t){return 0>t?-Math.pow(-t,e):Math.pow(t,e)}}function fs(e,t){function n(t){return o[((s.get(t)||s.set(t,e.push(t)))-1)%o.length]}function r(t,n){return wo.range(e.length).map(function(e){return t+n*e})}var s,o,u;return n.domain=function(r){if(!arguments.length)return e;e=[],s=new i;for(var o,u=-1,a=r.length;++u<a;)s.has(o=r[u])||s.set(o,e.push(o));return n[t.t].apply(n,t.a)},n.range=function(e){return arguments.length?(o=e,u=0,t={t:"range",a:arguments},n):o},n.rangePoints=function(i,s){arguments.length<2&&(s=0);var a=i[0],f=i[1],l=(f-a)/(Math.max(1,e.length-1)+s);return o=r(e.length<2?(a+f)/2:a+l*s/2,l),u=0,t={t:"rangePoints",a:arguments},n},n.rangeBands=function(i,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=i[1]<i[0],l=i[f-0],c=i[1-f],h=(c-l)/(e.length-s+2*a);return o=r(l+h*a,h),f&&o.reverse(),u=h*(1-s),t={t:"rangeBands",a:arguments},n},n.rangeRoundBands=function(i,s,a){arguments.length<2&&(s=0),arguments.length<3&&(a=s);var f=i[1]<i[0],l=i[f-0],c=i[1-f],h=Math.floor((c-l)/(e.length-s+2*a)),p=c-l-(e.length-s)*h;return o=r(l+Math.round(p/2),h),f&&o.reverse(),u=Math.round(h*(1-s)),t={t:"rangeRoundBands",a:arguments},n},n.rangeBand=function(){return u},n.rangeExtent=function(){return $i(t.a[0])},n.copy=function(){return fs(e,t)},n.domain(e)}function ls(e,t){function n(){var n=0,s=t.length;for(i=[];++n<s;)i[n-1]=wo.quantile(e,n/s);return r}function r(e){return isNaN(e=+e)?void 0:t[wo.bisect(i,e)]}var i;return r.domain=function(t){return arguments.length?(e=t.filter(function(e){return!isNaN(e)}).sort(wo.ascending),n()):e},r.range=function(e){return arguments.length?(t=e,n()):t},r.quantiles=function(){return i},r.invertExtent=function(n){return n=t.indexOf(n),0>n?[0/0,0/0]:[n>0?i[n-1]:e[0],n<i.length?i[n]:e[e.length-1]]},r.copy=function(){return ls(e,t)},n()}function cs(e,t,n){function r(t){return n[Math.max(0,Math.min(o,Math.floor(s*(t-e))))]}function i(){return s=n.length/(t-e),o=n.length-1,r}var s,o;return r.domain=function(n){return arguments.length?(e=+n[0],t=+n[n.length-1],i()):[e,t]},r.range=function(e){return arguments.length?(n=e,i()):n},r.invertExtent=function(t){return t=n.indexOf(t),t=0>t?0/0:t/s+e,[t,t+1/s]},r.copy=function(){return cs(e,t,n)},i()}function hs(e,t){function n(n){return n>=n?t[wo.bisect(e,n)]:void 0}return n.domain=function(t){return arguments.length?(e=t,n):e},n.range=function(e){return arguments.length?(t=e,n):t},n.invertExtent=function(n){return n=t.indexOf(n),[e[n-1],e[n]]},n.copy=function(){return hs(e,t)},n}function ps(e){function t(e){return+e}return t.invert=t,t.domain=t.range=function(n){return arguments.length?(e=n.map(t),t):e},t.ticks=function(t){return is(e,t)},t.tickFormat=function(t,n){return ss(e,t,n)},t.copy=function(){return ps(e)},t}function ds(e){return e.innerRadius}function vs(e){return e.outerRadius}function ms(e){return e.startAngle}function gs(e){return e.endAngle}function ys(e){for(var t,n,r,i=-1,s=e.length;++i<s;)t=e[i],n=t[0],r=t[1]+Pa,t[0]=n*Math.cos(r),t[1]=n*Math.sin(r);return e}function bs(e){function t(t){function a(){v.push("M",u(e(g),c),l,f(e(m.reverse()),c),"Z")}for(var h,p,d,v=[],m=[],g=[],y=-1,b=t.length,w=dt(n),E=dt(i),S=n===r?function(){return p}:dt(r),x=i===s?function(){return d}:dt(s);++y<b;)o.call(this,h=t[y],y)?(m.push([p=+w.call(this,h,y),d=+E.call(this,h,y)]),g.push([+S.call(this,h,y),+x.call(this,h,y)])):m.length&&(a(),m=[],g=[]);return m.length&&a(),v.length?v.join(""):null}var n=Wn,r=Wn,i=0,s=Xn,o=Xt,u=Vn,a=u.key,f=u,l="L",c=.7;return t.x=function(e){return arguments.length?(n=r=e,t):r},t.x0=function(e){return arguments.length?(n=e,t):n},t.x1=function(e){return arguments.length?(r=e,t):r},t.y=function(e){return arguments.length?(i=s=e,t):s},t.y0=function(e){return arguments.length?(i=e,t):i},t.y1=function(e){return arguments.length?(s=e,t):s},t.defined=function(e){return arguments.length?(o=e,t):o},t.interpolate=function(e){return arguments.length?(a="function"==typeof e?u=e:(u=ca.get(e)||Vn).key,f=u.reverse||u,l=u.closed?"M":"L",t):a},t.tension=function(e){return arguments.length?(c=e,t):c},t}function ws(e){return e.radius}function Es(e){return[e.x,e.y]}function Ss(e){return function(){var t=e.apply(this,arguments),n=t[0],r=t[1]+Pa;return[n*Math.cos(r),n*Math.sin(r)]}}function xs(){return 64}function Ts(){return"circle"}function Ns(e){var t=Math.sqrt(e/eu);return"M0,"+t+"A"+t+","+t+" 0 1,1 0,"+ -t+"A"+t+","+t+" 0 1,1 0,"+t+"Z"}function Cs(e,t){return jo(e,Ra),e.id=t,e}function ks(e,t,n,r){var i=e.id;return O(e,"function"==typeof n?function(e,s,o){e.__transition__[i].tween.set(t,r(n.call(e,e.__data__,s,o)))}:(n=r(n),function(e){e.__transition__[i].tween.set(t,n)}))}function Ls(e){return null==e&&(e=""),function(){this.textContent=e}}function As(e,t,n,r){var s=e.__transition__||(e.__transition__={active:0,count:0}),o=s[n];if(!o){var u=r.time;o=s[n]={tween:new i,time:u,ease:r.ease,delay:r.delay,duration:r.duration},++s.count,wo.timer(function(r){function i(r){return s.active>n?f():(s.active=n,o.event&&o.event.start.call(e,l,t),o.tween.forEach(function(n,r){(r=r.call(e,l,t))&&d.push(r)}),a(r)?1:(wt(a,0,u),void 0))}function a(r){if(s.active!==n)return f();for(var i=(r-h)/p,u=c(i),a=d.length;a>0;)d[--a].call(e,u);return i>=1?(f(),o.event&&o.event.end.call(e,l,t),1):void 0}function f(){return--s.count?delete s[n]:delete e.__transition__,1}var l=e.__data__,c=o.ease,h=o.delay,p=o.duration,d=[];return r>=h?i(r):(wt(i,h,u),void 0)},0,u)}}function Os(e,t){e.attr("transform",function(e){return"translate("+t(e)+",0)"})}function Ms(e,t){e.attr("transform",function(e){return"translate(0,"+t(e)+")"})}function _s(e,t,n){if(r=[],n&&t.length>1){for(var r,i,s,o=$i(e.domain()),u=-1,a=t.length,f=(t[1]-t[0])/++n;++u<a;)for(i=n;--i>0;)(s=+t[u]-i*f)>=o[0]&&r.push(s);for(--u,i=0;++i<n&&(s=+t[u]+i*f)<o[1];)r.push(s)}return r}function Ds(){this._=new Date(arguments.length>1?Date.UTC.apply(this,arguments):arguments[0])}function Ps(e,t,n){function r(t){var n=e(t),r=s(n,1);return r-t>t-n?n:r}function i(n){return t(n=e(new $a(n-1)),1),n}function s(e,n){return t(e=new $a(+e),n),e}function o(e,r,s){var o=i(e),u=[];if(s>1)for(;r>o;)n(o)%s||u.push(new Date(+o)),t(o,1);else for(;r>o;)u.push(new Date(+o)),t(o,1);return u}function u(e,t,n){try{$a=Ds;var r=new Ds;return r._=e,o(r,t,n)}finally{$a=Date}}e.floor=e,e.round=r,e.ceil=i,e.offset=s,e.range=o;var a=e.utc=Hs(e);return a.floor=a,a.round=Hs(r),a.ceil=Hs(i),a.offset=Hs(s),a.range=u,e}function Hs(e){return function(t,n){try{$a=Ds;var r=new Ds;return r._=t,e(r,n)._}finally{$a=Date}}}function Bs(e,t,n,r){for(var i,s,o=0,u=t.length,a=n.length;u>o;){if(r>=a)return-1;if(i=t.charCodeAt(o++),37===i){if(s=vf[t.charAt(o++)],!s||(r=s(e,n,r))<0)return-1}else if(i!=n.charCodeAt(r++))return-1}return r}function js(e){return new RegExp("^(?:"+e.map(wo.requote).join("|")+")","i")}function Fs(e){for(var t=new i,n=-1,r=e.length;++n<r;)t.set(e[n].toLowerCase(),n);return t}function Is(e,t,n){var r=0>e?"-":"",i=(r?-e:e)+"",s=i.length;return r+(n>s?(new Array(n-s+1)).join(t)+i:i)}function qs(e,t,n){of.lastIndex=0;var r=of.exec(t.substring(n));return r?(e.w=uf.get(r[0].toLowerCase()),n+r[0].length):-1}function Rs(e,t,n){rf.lastIndex=0;var r=rf.exec(t.substring(n));return r?(e.w=sf.get(r[0].toLowerCase()),n+r[0].length):-1}function Us(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+1));return r?(e.w=+r[0],n+r[0].length):-1}function zs(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n));return r?(e.U=+r[0],n+r[0].length):-1}function Ws(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n));return r?(e.W=+r[0],n+r[0].length):-1}function Xs(e,t,n){lf.lastIndex=0;var r=lf.exec(t.substring(n));return r?(e.m=cf.get(r[0].toLowerCase()),n+r[0].length):-1}function Vs(e,t,n){af.lastIndex=0;var r=af.exec(t.substring(n));return r?(e.m=ff.get(r[0].toLowerCase()),n+r[0].length):-1}function $s(e,t,n){return Bs(e,df.c.toString(),t,n)}function Js(e,t,n){return Bs(e,df.x.toString(),t,n)}function Ks(e,t,n){return Bs(e,df.X.toString(),t,n)}function Qs(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+4));return r?(e.y=+r[0],n+r[0].length):-1}function Gs(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+2));return r?(e.y=Ys(+r[0]),n+r[0].length):-1}function Ys(e){return e+(e>68?1900:2e3)}function Zs(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+2));return r?(e.m=r[0]-1,n+r[0].length):-1}function eo(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+2));return r?(e.d=+r[0],n+r[0].length):-1}function to(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+3));return r?(e.j=+r[0],n+r[0].length):-1}function no(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+2));return r?(e.H=+r[0],n+r[0].length):-1}function ro(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+2));return r?(e.M=+r[0],n+r[0].length):-1}function io(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+2));return r?(e.S=+r[0],n+r[0].length):-1}function so(e,t,n){mf.lastIndex=0;var r=mf.exec(t.substring(n,n+3));return r?(e.L=+r[0],n+r[0].length):-1}function oo(e,t,n){var r=gf.get(t.substring(n,n+=2).toLowerCase());return null==r?-1:(e.p=r,n)}function uo(e){var t=e.getTimezoneOffset(),n=t>0?"-":"+",r=~~(Math.abs(t)/60),i=Math.abs(t)%60;return n+Is(r,"0",2)+Is(i,"0",2)}function ao(e,t,n){hf.lastIndex=0;var r=hf.exec(t.substring(n,n+1));return r?n+r[0].length:-1}function fo(e){return e.toISOString()}function lo(e,t,n){function r(t){return e(t)}return r.invert=function(t){return co(e.invert(t))},r.domain=function(t){return arguments.length?(e.domain(t),r):e.domain().map(co)},r.nice=function(e){return r.domain(Qi(r.domain(),e))},r.ticks=function(n,i){var s=$i(r.domain());if("function"!=typeof n){var o=s[1]-s[0],u=o/n,a=wo.bisect(bf,u);if(a==bf.length)return t.year(s,n);if(!a)return e.ticks(n).map(co);u/bf[a-1]<bf[a]/u&&--a,n=t[a],i=n[1],n=n[0].range}return n(s[0],new Date(+s[1]+1),i)},r.tickFormat=function(){return n},r.copy=function(){return lo(e.copy(),t,n)},es(r,e)}function co(e){return new Date(e)}function ho(e){return function(t){for(var n=e.length-1,r=e[n];!r[1](t);)r=e[--n];return r[0](t)}}function po(e){var t=new Date(e,0,1);return t.setFullYear(e),t}function vo(e){var t=e.getFullYear(),n=po(t),r=po(t+1);return t+(e-n)/(r-n)}function mo(e){var t=new Date(Date.UTC(e,0,1));return t.setUTCFullYear(e),t}function go(e){var t=e.getUTCFullYear(),n=mo(t),r=mo(t+1);return t+(e-n)/(r-n)}function yo(e){return JSON.parse(e.responseText)}function bo(e){var t=Eo.createRange();return t.selectNode(Eo.body),t.createContextualFragment(e.responseText)}var wo={version:"3.2.8"};Date.now||(Date.now=function(){return+(new Date)});var Eo=document,So=Eo.documentElement,xo=window;try{Eo.createElement("div").style.setProperty("opacity",0,"")}catch(To){var No=xo.Element.prototype,Co=No.setAttribute,ko=No.setAttributeNS,Lo=xo.CSSStyleDeclaration.prototype,Ao=Lo.setProperty;No.setAttribute=function(e,t){Co.call(this,e,t+"")},No.setAttributeNS=function(e,t,n){ko.call(this,e,t,n+"")},Lo.setProperty=function(e,t,n){Ao.call(this,e,t+"",n)}}wo.ascending=function(e,t){return t>e?-1:e>t?1:e>=t?0:0/0},wo.descending=function(e,t){return e>t?-1:t>e?1:t>=e?0:0/0},wo.min=function(e,t){var n,r,i=-1,s=e.length;if(1===arguments.length){for(;++i<s&&!(null!=(n=e[i])&&n>=n);)n=void 0;for(;++i<s;)null!=(r=e[i])&&n>r&&(n=r)}else{for(;++i<s&&!(null!=(n=t.call(e,e[i],i))&&n>=n);)n=void 0;for(;++i<s;)null!=(r=t.call(e,e[i],i))&&n>r&&(n=r)}return n},wo.max=function(e,t){var n,r,i=-1,s=e.length;if(1===arguments.length){for(;++i<s&&!(null!=(n=e[i])&&n>=n);)n=void 0;for(;++i<s;)null!=(r=e[i])&&r>n&&(n=r)}else{for(;++i<s&&!(null!=(n=t.call(e,e[i],i))&&n>=n);)n=void 0;for(;++i<s;)null!=(r=t.call(e,e[i],i))&&r>n&&(n=r)}return n},wo.extent=function(e,t){var n,r,i,s=-1,o=e.length;if(1===arguments.length){for(;++s<o&&!(null!=(n=i=e[s])&&n>=n);)n=i=void 0;for(;++s<o;)null!=(r=e[s])&&(n>r&&(n=r),r>i&&(i=r))}else{for(;++s<o&&!(null!=(n=i=t.call(e,e[s],s))&&n>=n);)n=void 0;for(;++s<o;)null!=(r=t.call(e,e[s],s))&&(n>r&&(n=r),r>i&&(i=r))}return[n,i]},wo.sum=function(e,t){var n,r=0,i=e.length,s=-1;if(1===arguments.length)for(;++s<i;)isNaN(n=+e[s])||(r+=n);else for(;++s<i;)isNaN(n=+t.call(e,e[s],s))||(r+=n);return r},wo.mean=function(t,n){var r,i=t.length,s=0,o=-1,u=0;if(1===arguments.length)for(;++o<i;)e(r=t[o])&&(s+=(r-s)/++u);else for(;++o<i;)e(r=n.call(t,t[o],o))&&(s+=(r-s)/++u);return u?s:void 0},wo.quantile=function(e,t){var n=(e.length-1)*t+1,r=Math.floor(n),i=+e[r-1],s=n-r;return s?i+s*(e[r]-i):i},wo.median=function(t,n){return arguments.length>1&&(t=t.map(n)),t=t.filter(e),t.length?wo.quantile(t.sort(wo.ascending),.5):void 0},wo.bisector=function(e){return{left:function(t,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);i>r;){var s=r+i>>>1;e.call(t,t[s],s)<n?r=s+1:i=s}return r},right:function(t,n,r,i){for(arguments.length<3&&(r=0),arguments.length<4&&(i=t.length);i>r;){var s=r+i>>>1;n<e.call(t,t[s],s)?i=s:r=s+1}return r}}};var Oo=wo.bisector(function(e){return e});wo.bisectLeft=Oo.left,wo.bisect=wo.bisectRight=Oo.right,wo.shuffle=function(e){for(var t,n,r=e.length;r;)n=0|Math.random()*r--,t=e[r],e[r]=e[n],e[n]=t;return e},wo.permute=function(e,t){for(var n=t.length,r=new Array(n);n--;)r[n]=e[t[n]];return r},wo.zip=function(){if(!(i=arguments.length))return[];for(var e=-1,n=wo.min(arguments,t),r=new Array(n);++e<n;)for(var i,s=-1,o=r[e]=new Array(i);++s<i;)o[s]=arguments[s][e];return r},wo.transpose=function(e){return wo.zip.apply(wo,e)},wo.keys=function(e){var t=[];for(var n in e)t.push(n);return t},wo.values=function(e){var t=[];for(var n in e)t.push(e[n]);return t},wo.entries=function(e){var t=[];for(var n in e)t.push({key:n,value:e[n]});return t},wo.merge=function(e){return Array.prototype.concat.apply([],e)},wo.range=function(e,t,r){if(arguments.length<3&&(r=1,arguments.length<2&&(t=e,e=0)),1/0===(t-e)/r)throw new Error("infinite range");var i,s=[],o=n(Math.abs(r)),u=-1;if(e*=o,t*=o,r*=o,0>r)for(;(i=e+r*++u)>t;)s.push(i/o);else for(;(i=e+r*++u)<t;)s.push(i/o);return s},wo.map=function(e){var t=new i;if(e instanceof i)e.forEach(function(e,n){t.set(e,n)});else for(var n in e)t.set(n,e[n]);return t},r(i,{has:function(e){return Mo+e in this},get:function(e){return this[Mo+e]},set:function(e,t){return this[Mo+e]=t},remove:function(e){return e=Mo+e,e in this&&delete this[e]},keys:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},values:function(){var e=[];return this.forEach(function(t,n){e.push(n)}),e},entries:function(){var e=[];return this.forEach(function(t,n){e.push({key:t,value:n})}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===_o&&e.call(this,t.substring(1),this[t])}});var Mo="\0",_o=Mo.charCodeAt(0);wo.nest=function(){function e(t,u,a){if(a>=o.length)return r?r.call(s,u):n?u.sort(n):u;for(var f,l,c,h,p=-1,d=u.length,v=o[a++],m=new i;++p<d;)(h=m.get(f=v(l=u[p])))?h.push(l):m.set(f,[l]);return t?(l=t(),c=function(n,r){l.set(n,e(t,r,a))}):(l={},c=function(n,r){l[n]=e(t,r,a)}),m.forEach(c),l}function t(e,n){if(n>=o.length)return e;var r=[],i=u[n++];return e.forEach(function(e,i){r.push({key:e,values:t(i,n)})}),i?r.sort(function(e,t){return i(e.key,t.key)}):r}var n,r,s={},o=[],u=[];return s.map=function(t,n){return e(n,t,0)},s.entries=function(n){return t(e(wo.map,n,0),0)},s.key=function(e){return o.push(e),s},s.sortKeys=function(e){return u[o.length-1]=e,s},s.sortValues=function(e){return n=e,s},s.rollup=function(e){return r=e,s},s},wo.set=function(e){var t=new s;if(e)for(var n=0,r=e.length;r>n;++n)t.add(e[n]);return t},r(s,{has:function(e){return Mo+e in this},add:function(e){return this[Mo+e]=!0,e},remove:function(e){return e=Mo+e,e in this&&delete this[e]},values:function(){var e=[];return this.forEach(function(t){e.push(t)}),e},forEach:function(e){for(var t in this)t.charCodeAt(0)===_o&&e.call(this,t.substring(1))}}),wo.behavior={},wo.rebind=function(e,t){for(var n,r=1,i=arguments.length;++r<i;)e[n=arguments[r]]=o(e,t,t[n]);return e};var Do=["webkit","ms","moz","Moz","o","O"],Po=f;try{Po(So.childNodes)[0].nodeType}catch(Ho){Po=a}wo.dispatch=function(){for(var e=new c,t=-1,n=arguments.length;++t<n;)e[arguments[t]]=h(e);return e},c.prototype.on=function(e,t){var n=e.indexOf("."),r="";if(n>=0&&(r=e.substring(n+1),e=e.substring(0,n)),e)return arguments.length<2?this[e].on(r):this[e].on(r,t);if(2===arguments.length){if(null==t)for(e in this)this.hasOwnProperty(e)&&this[e].on(r,null);return this}},wo.event=null,wo.requote=function(e){return e.replace(Bo,"\\$&")};var Bo=/[\\\^\$\*\+\?\|\[\]\(\)\.\{\}]/g,jo={}.__proto__?function(e,t){e.__proto__=t}:function(e,t){for(var n in t)e[n]=t[n]},Fo=function(e,t){return t.querySelector(e)},Io=function(e,t){return t.querySelectorAll(e)},qo=So[u(So,"matchesSelector")],Ro=function(e,t){return qo.call(e,t)};"function"==typeof Sizzle&&(Fo=function(e,t){return Sizzle(e,t)[0]||null},Io=function(e,t){return Sizzle.uniqueSort(Sizzle(e,t))},Ro=Sizzle.matchesSelector),wo.selection=function(){return Xo};var Uo=wo.selection.prototype=[];Uo.select=function(e){var t,n,r,i,s=[];e=g(e);for(var o=-1,u=this.length;++o<u;){s.push(t=[]),t.parentNode=(r=this[o]).parentNode;for(var a=-1,f=r.length;++a<f;)(i=r[a])?(t.push(n=e.call(i,i.__data__,a,o)),n&&"__data__"in i&&(n.__data__=i.__data__)):t.push(null)}return m(s)},Uo.selectAll=function(e){var t,n,r=[];e=y(e);for(var i=-1,s=this.length;++i<s;)for(var o=this[i],u=-1,a=o.length;++u<a;)(n=o[u])&&(r.push(t=Po(e.call(n,n.__data__,u,i))),t.parentNode=n);return m(r)};var zo={svg:"http://www.w3.org/2000/svg",xhtml:"http://www.w3.org/1999/xhtml",xlink:"http://www.w3.org/1999/xlink",xml:"http://www.w3.org/XML/1998/namespace",xmlns:"http://www.w3.org/2000/xmlns/"};wo.ns={prefix:zo,qualify:function(e){var t=e.indexOf(":"),n=e;return t>=0&&(n=e.substring(0,t),e=e.substring(t+1)),zo.hasOwnProperty(n)?{space:zo[n],local:e}:e}},Uo.attr=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node();return e=wo.ns.qualify(e),e.local?n.getAttributeNS(e.space,e.local):n.getAttribute(e)}for(t in e)this.each(b(t,e[t]));return this}return this.each(b(e,t))},Uo.classed=function(e,t){if(arguments.length<2){if("string"==typeof e){var n=this.node(),r=(e=e.trim().split(/^|\s+/g)).length,i=-1;if(t=n.classList){for(;++i<r;)if(!t.contains(e[i]))return!1}else for(t=n.getAttribute("class");++i<r;)if(!E(e[i]).test(t))return!1;return!0}for(t in e)this.each(S(t,e[t]));return this}return this.each(S(e,t))},Uo.style=function(e,t,n){var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t="");for(n in e)this.each(T(n,e[n],t));return this}if(2>r)return xo.getComputedStyle(this.node(),null).getPropertyValue(e);n=""}return this.each(T(e,t,n))},Uo.property=function(e,t){if(arguments.length<2){if("string"==typeof e)return this.node()[e];for(t in e)this.each(N(t,e[t]));return this}return this.each(N(e,t))},Uo.text=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.textContent=null==t?"":t}:null==e?function(){this.textContent=""}:function(){this.textContent=e}):this.node().textContent},Uo.html=function(e){return arguments.length?this.each("function"==typeof e?function(){var t=e.apply(this,arguments);this.innerHTML=null==t?"":t}:null==e?function(){this.innerHTML=""}:function(){this.innerHTML=e}):this.node().innerHTML},Uo.append=function(e){return e=C(e),this.select(function(){return this.appendChild(e.apply(this,arguments))})},Uo.insert=function(e,t){return e=C(e),t=g(t),this.select(function(){return this.insertBefore(e.apply(this,arguments),t.apply(this,arguments))})},Uo.remove=function(){return this.each(function(){var e=this.parentNode;e&&e.removeChild(this)})},Uo.data=function(e,t){function n(e,n){var r,s,o,u=e.length,c=n.length,h=Math.min(u,c),p=new Array(c),d=new Array(c),v=new Array(u);if(t){var m,g=new i,y=new i,b=[];for(r=-1;++r<u;)m=t.call(s=e[r],s.__data__,r),g.has(m)?v[r]=s:g.set(m,s),b.push(m);for(r=-1;++r<c;)m=t.call(n,o=n[r],r),(s=g.get(m))?(p[r]=s,s.__data__=o):y.has(m)||(d[r]=k(o)),y.set(m,o),g.remove(m);for(r=-1;++r<u;)g.has(b[r])&&(v[r]=e[r])}else{for(r=-1;++r<h;)s=e[r],o=n[r],s?(s.__data__=o,p[r]=s):d[r]=k(o);for(;c>r;++r)d[r]=k(n[r]);for(;u>r;++r)v[r]=e[r]}d.update=p,d.parentNode=p.parentNode=v.parentNode=e.parentNode,a.push(d),f.push(p),l.push(v)}var r,s,o=-1,u=this.length;if(!arguments.length){for(e=new Array(u=(r=this[0]).length);++o<u;)(s=r[o])&&(e[o]=s.__data__);return e}var a=M([]),f=m([]),l=m([]);if("function"==typeof e)for(;++o<u;)n(r=this[o],e.call(r,r.parentNode.__data__,o));else for(;++o<u;)n(r=this[o],e);return f.enter=function(){return a},f.exit=function(){return l},f},Uo.datum=function(e){return arguments.length?this.property("__data__",e):this.property("__data__")},Uo.filter=function(e){var t,n,r,i=[];"function"!=typeof e&&(e=L(e));for(var s=0,o=this.length;o>s;s++){i.push(t=[]),t.parentNode=(n=this[s]).parentNode;for(var u=0,a=n.length;a>u;u++)(r=n[u])&&e.call(r,r.__data__,u)&&t.push(r)}return m(i)},Uo.order=function(){for(var e=-1,t=this.length;++e<t;)for(var n,r=this[e],i=r.length-1,s=r[i];--i>=0;)(n=r[i])&&(s&&s!==n.nextSibling&&s.parentNode.insertBefore(n,s),s=n);return this},Uo.sort=function(e){e=A.apply(this,arguments);for(var t=-1,n=this.length;++t<n;)this[t].sort(e);return this.order()},Uo.each=function(e){return O(this,function(t,n,r){e.call(t,t.__data__,n,r)})},Uo.call=function(e){var t=Po(arguments);return e.apply(t[0]=this,t),this},Uo.empty=function(){return!this.node()},Uo.node=function(){for(var e=0,t=this.length;t>e;e++)for(var n=this[e],r=0,i=n.length;i>r;r++){var s=n[r];if(s)return s}return null},Uo.size=function(){var e=0;return this.each(function(){++e}),e};var Wo=[];wo.selection.enter=M,wo.selection.enter.prototype=Wo,Wo.append=Uo.append,Wo.empty=Uo.empty,Wo.node=Uo.node,Wo.call=Uo.call,Wo.size=Uo.size,Wo.select=function(e){for(var t,n,r,i,s,o=[],u=-1,a=this.length;++u<a;){r=(i=this[u]).update,o.push(t=[]),t.parentNode=i.parentNode;for(var f=-1,l=i.length;++f<l;)(s=i[f])?(t.push(r[f]=n=e.call(i.parentNode,s.__data__,f,u)),n.__data__=s.__data__):t.push(null)}return m(o)},Wo.insert=function(e,t){return arguments.length<2&&(t=_(this)),Uo.insert.call(this,e,t)},Uo.transition=function(){for(var e,t,n=ja||++Ua,r=[],i=Fa||{time:Date.now(),ease:_r,delay:0,duration:250},s=-1,o=this.length;++s<o;){r.push(e=[]);for(var u=this[s],a=-1,f=u.length;++a<f;)(t=u[a])&&As(t,a,n,i),e.push(t)}return Cs(r,n)},wo.select=function(e){var t=["string"==typeof e?Fo(e,Eo):e];return t.parentNode=So,m([t])},wo.selectAll=function(e){var t=Po("string"==typeof e?Io(e,Eo):e);return t.parentNode=So,m([t])};var Xo=wo.select(So);Uo.on=function(e,t,n){var r=arguments.length;if(3>r){if("string"!=typeof e){2>r&&(t=!1);for(n in e)this.each(D(n,e[n],t));return this}if(2>r)return(r=this.node()["__on"+e])&&r._;n=!1}return this.each(D(e,t,n))};var Vo=wo.map({mouseenter:"mouseover",mouseleave:"mouseout"});Vo.forEach(function(e){"on"+e in Eo&&Vo.remove(e)});var $o=u(So.style,"userSelect"),Jo=0;wo.mouse=function(e){return j(e,d())};var Ko=/WebKit/.test(xo.navigator.userAgent)?-1:0;wo.touches=function(e,t){return arguments.length<2&&(t=d().touches),t?Po(t).map(function(t){var n=j(e,t);return n.identifier=t.identifier,n}):[]},wo.behavior.drag=function(){function e(){this.on("mousedown.drag",o).on("touchstart.drag",u)}function t(){return wo.event.changedTouches[0].identifier}function n(e,t){return wo.touches(e).filter(function(e){return e.identifier===t})[0]}function r(e,t,n,r){return function(){function o(){if(!l)return u();var e=t(l,p),n=e[0]-v[0],r=e[1]-v[1];m|=n|r,v=e,c({type:"drag",x:e[0]+a[0],y:e[1]+a[1],dx:n,dy:r})}function u(){g.on(n+"."+d,null).on(r+"."+d,null),y(m&&wo.event.target===h),c({type:"dragend"})}var a,f=this,l=f.parentNode,c=i.of(f,arguments),h=wo.event.target,p=e(),d=null==p?"drag":"drag-"+p,v=t(l,p),m=0,g=wo.select(xo).on(n+"."+d,o).on(r+"."+d,u),y=B();s?(a=s.apply(f,arguments),a=[a.x-v[0],a.y-v[1]]):a=[0,0],c({type:"dragstart"})}}var i=v(e,"drag","dragstart","dragend"),s=null,o=r(l,wo.mouse,"mousemove","mouseup"),u=r(t,n,"touchmove","touchend");return e.origin=function(t){return arguments.length?(s=t,e):s},wo.rebind(e,i,"on")},wo.behavior.zoom=function(){function e(){this.on(x,u).on(Yo+".zoom",f).on(T,l).on("dblclick.zoom",c).on(C,a)}function t(e){return[(e[0]-w[0])/E,(e[1]-w[1])/E]}function n(e){return[e[0]*E+w[0],e[1]*E+w[1]]}function r(e){E=Math.max(S[0],Math.min(S[1],e))}function i(e,t){t=n(t),w[0]+=e[0]-t[0],w[1]+=e[1]-t[1]}function s(){g&&g.domain(m.range().map(function(e){return(e-w[0])/E}).map(m.invert)),b&&b.domain(y.range().map(function(e){return(e-w[1])/E}).map(y.invert))}function o(e){s(),e({type:"zoom",scale:E,translate:w})}function u(){function e(){a=1,i(wo.mouse(r),c),o(s)}function n(){f.on(T,xo===r?l:null).on(N,null),h(a&&wo.event.target===u)}var r=this,s=A.of(r,arguments),u=wo.event.target,a=0,f=wo.select(xo).on(T,e).on(N,n),c=t(wo.mouse(r)),h=B()}function a(){function e(){var e=wo.touches(h);return c=E,l={},e.forEach(function(e){l[e.identifier]=t(e)}),e}function n(){var t=Date.now(),n=e();if(1===n.length){if(500>t-d){var s=n[0],u=l[s.identifier];r(2*E),i(s,u),p(),o(v)}d=t}else if(n.length>1){var s=n[0],a=n[1],f=s[0]-a[0],c=s[1]-a[1];m=f*f+c*c}}function s(){var e=wo.touches(h),t=e[0],n=l[t.identifier];if(s=e[1]){var s,u=l[s.identifier],a=wo.event.scale;if(null==a){var f=(f=s[0]-t[0])*f+(f=s[1]-t[1])*f;a=m&&Math.sqrt(f/m)}t=[(t[0]+s[0])/2,(t[1]+s[1])/2],n=[(n[0]+u[0])/2,(n[1]+u[1])/2],r(a*c)}d=null,i(t,n),o(v)}function f(){wo.event.touches.length?e():(g.on(k,null).on(L,null),y.on(x,u).on(C,a),b())}var l,c,h=this,v=A.of(h,arguments),m=0,g=wo.select(xo).on(k,s).on(L,f),y=wo.select(h).on(x,null).on(C,n),b=B();n()}function f(){p(),h||(h=t(wo.mouse(this))),r(Math.pow(2,.002*Qo())*E),i(wo.mouse(this),h),o(A.of(this,arguments))}function l(){h=null}function c(){var e=wo.mouse(this),n=t(e),s=Math.log(E)/Math.LN2;r(Math.pow(2,wo.event.shiftKey?Math.ceil(s)-1:Math.floor(s)+1)),i(e,n),o(A.of(this,arguments))}var h,d,m,g,y,b,w=[0,0],E=1,S=Go,x="mousedown.zoom",T="mousemove.zoom",N="mouseup.zoom",C="touchstart.zoom",k="touchmove.zoom",L="touchend.zoom",A=v(e,"zoom");return e.translate=function(t){return arguments.length?(w=t.map(Number),s(),e):w},e.scale=function(t){return arguments.length?(E=+t,s(),e):E},e.scaleExtent=function(t){return arguments.length?(S=null==t?Go:t.map(Number),e):S},e.x=function(t){return arguments.length?(g=t,m=t.copy(),w=[0,0],E=1,e):g},e.y=function(t){return arguments.length?(b=t,y=t.copy(),w=[0,0],E=1,e):b},wo.rebind(e,A,"on")};var Qo,Go=[0,1/0],Yo="onwheel"in Eo?(Qo=function(){return-wo.event.deltaY*(wo.event.deltaMode?120:1)},"wheel"):"onmousewheel"in Eo?(Qo=function(){return wo.event.wheelDelta},"mousewheel"):(Qo=function(){return-wo.event.detail},"MozMousePixelScroll");F.prototype.toString=function(){return this.rgb()+""},wo.hsl=function(e,t,n){return 1===arguments.length?e instanceof q?I(e.h,e.s,e.l):ft(""+e,lt,I):I(+e,+t,+n)};var Zo=q.prototype=new F;Zo.brighter=function(e){return e=Math.pow(.7,arguments.length?e:1),I(this.h,this.s,this.l/e)},Zo.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),I(this.h,this.s,e*this.l)},Zo.rgb=function(){return R(this.h,this.s,this.l)};var eu=Math.PI,tu=1e-6,nu=tu*tu,ru=eu/180,iu=180/eu;wo.hcl=function(e,t,n){return 1===arguments.length?e instanceof K?J(e.h,e.c,e.l):e instanceof Y?et(e.l,e.a,e.b):et((e=ct((e=wo.rgb(e)).r,e.g,e.b)).l,e.a,e.b):J(+e,+t,+n)};var su=K.prototype=new F;su.brighter=function(e){return J(this.h,this.c,Math.min(100,this.l+ou*(arguments.length?e:1)))},su.darker=function(e){return J(this.h,this.c,Math.max(0,this.l-ou*(arguments.length?e:1)))},su.rgb=function(){return Q(this.h,this.c,this.l).rgb()},wo.lab=function(e,t,n){return 1===arguments.length?e instanceof Y?G(e.l,e.a,e.b):e instanceof K?Q(e.l,e.c,e.h):ct((e=wo.rgb(e)).r,e.g,e.b):G(+e,+t,+n)};var ou=18,uu=.95047,au=1,fu=1.08883,lu=Y.prototype=new F;lu.brighter=function(e){return G(Math.min(100,this.l+ou*(arguments.length?e:1)),this.a,this.b)},lu.darker=function(e){return G(Math.max(0,this.l-ou*(arguments.length?e:1)),this.a,this.b)},lu.rgb=function(){return Z(this.l,this.a,this.b)},wo.rgb=function(e,t,n){return 1===arguments.length?e instanceof ut?ot(e.r,e.g,e.b):ft(""+e,ot,R):ot(~~e,~~t,~~n)};var cu=ut.prototype=new F;cu.brighter=function(e){e=Math.pow(.7,arguments.length?e:1);var t=this.r,n=this.g,r=this.b,i=30;return t||n||r?(t&&i>t&&(t=i),n&&i>n&&(n=i),r&&i>r&&(r=i),ot(Math.min(255,~~(t/e)),Math.min(255,~~(n/e)),Math.min(255,~~(r/e)))):ot(i,i,i)},cu.darker=function(e){return e=Math.pow(.7,arguments.length?e:1),ot(~~(e*this.r),~~(e*this.g),~~(e*this.b))},cu.hsl=function(){return lt(this.r,this.g,this.b)},cu.toString=function(){return"#"+at(this.r)+at(this.g)+at(this.b)};var hu=wo.map({aliceblue:15792383,antiquewhite:16444375,aqua:65535,aquamarine:8388564,azure:15794175,beige:16119260,bisque:16770244,black:0,blanchedalmond:16772045,blue:255,blueviolet:9055202,brown:10824234,burlywood:14596231,cadetblue:6266528,chartreuse:8388352,chocolate:13789470,coral:16744272,cornflowerblue:6591981,cornsilk:16775388,crimson:14423100,cyan:65535,darkblue:139,darkcyan:35723,darkgoldenrod:12092939,darkgray:11119017,darkgreen:25600,darkgrey:11119017,darkkhaki:12433259,darkmagenta:9109643,darkolivegreen:5597999,darkorange:16747520,darkorchid:10040012,darkred:9109504,darksalmon:15308410,darkseagreen:9419919,darkslateblue:4734347,darkslategray:3100495,darkslategrey:3100495,darkturquoise:52945,darkviolet:9699539,deeppink:16716947,deepskyblue:49151,dimgray:6908265,dimgrey:6908265,dodgerblue:2003199,firebrick:11674146,floralwhite:16775920,forestgreen:2263842,fuchsia:16711935,gainsboro:14474460,ghostwhite:16316671,gold:16766720,goldenrod:14329120,gray:8421504,green:32768,greenyellow:11403055,grey:8421504,honeydew:15794160,hotpink:16738740,indianred:13458524,indigo:4915330,ivory:16777200,khaki:15787660,lavender:15132410,lavenderblush:16773365,lawngreen:8190976,lemonchiffon:16775885,lightblue:11393254,lightcoral:15761536,lightcyan:14745599,lightgoldenrodyellow:16448210,lightgray:13882323,lightgreen:9498256,lightgrey:13882323,lightpink:16758465,lightsalmon:16752762,lightseagreen:2142890,lightskyblue:8900346,lightslategray:7833753,lightslategrey:7833753,lightsteelblue:11584734,lightyellow:16777184,lime:65280,limegreen:3329330,linen:16445670,magenta:16711935,maroon:8388608,mediumaquamarine:6737322,mediumblue:205,mediumorchid:12211667,mediumpurple:9662683,mediumseagreen:3978097,mediumslateblue:8087790,mediumspringgreen:64154,mediumturquoise:4772300,mediumvioletred:13047173,midnightblue:1644912,mintcream:16121850,mistyrose:16770273,moccasin:16770229,navajowhite:16768685,navy:128,oldlace:16643558,olive:8421376,olivedrab:7048739,orange:16753920,orangered:16729344,orchid:14315734,palegoldenrod:15657130,palegreen:10025880,paleturquoise:11529966,palevioletred:14381203,papayawhip:16773077,peachpuff:16767673,peru:13468991,pink:16761035,plum:14524637,powderblue:11591910,purple:8388736,red:16711680,rosybrown:12357519,royalblue:4286945,saddlebrown:9127187,salmon:16416882,sandybrown:16032864,seagreen:3050327,seashell:16774638,sienna:10506797,silver:12632256,skyblue:8900331,slateblue:6970061,slategray:7372944,slategrey:7372944,snow:16775930,springgreen:65407,steelblue:4620980,tan:13808780,teal:32896,thistle:14204888,tomato:16737095,turquoise:4251856,violet:15631086,wheat:16113331,white:16777215,whitesmoke:16119285,yellow:16776960,yellowgreen:10145074});hu.forEach(function(e,t){hu.set(e,it(t))}),wo.functor=dt,wo.xhr=mt(vt),wo.dsv=function(e,t){function n(e,n,s){arguments.length<3&&(s=n,n=null);var o=wo.xhr(e,t,s);return o.row=function(e){return arguments.length?o.response(null==(n=e)?r:i(e)):n},o.row(n)}function r(e){return n.parse(e.responseText)}function i(e){return function(t){return n.parse(t.responseText,e)}}function o(t){return t.map(u).join(e)}function u(e){return a.test(e)?'"'+e.replace(/\"/g,'""')+'"':e}var a=new RegExp('["'+e+"\n]"),f=e.charCodeAt(0);return n.parse=function(e,t){var r;return n.parseRows(e,function(e,n){if(r)return r(e,n-1);var i=new Function("d","return {"+e.map(function(e,t){return JSON.stringify(e)+": d["+t+"]"}).join(",")+"}");r=t?function(e,n){return t(i(e),n)}:i})},n.parseRows=function(e,t){function n(){if(l>=a)return o;if(i)return i=!1,s;var t=l;if(34===e.charCodeAt(t)){for(var n=t;n++<a;)if(34===e.charCodeAt(n)){if(34!==e.charCodeAt(n+1))break;++n}l=n+2;var r=e.charCodeAt(n+1);return 13===r?(i=!0,10===e.charCodeAt(n+2)&&++l):10===r&&(i=!0),e.substring(t+1,n).replace(/""/g,'"')}for(;a>l;){var r=e.charCodeAt(l++),u=1;if(10===r)i=!0;else if(13===r)i=!0,10===e.charCodeAt(l)&&(++l,++u);else if(r!==f)continue;return e.substring(t,l-u)}return e.substring(t)}for(var r,i,s={},o={},u=[],a=e.length,l=0,c=0;(r=n())!==o;){for(var h=[];r!==s&&r!==o;)h.push(r),r=n();(!t||(h=t(h,c++)))&&u.push(h)}return u},n.format=function(t){if(Array.isArray(t[0]))return n.formatRows(t);var r=new s,i=[];return t.forEach(function(e){for(var t in e)r.has(t)||i.push(r.add(t))}),[i.map(u).join(e)].concat(t.map(function(t){return i.map(function(e){return u(t[e])}).join(e)})).join("\n")},n.formatRows=function(e){return e.map(o).join("\n")},n},wo.csv=wo.dsv(",","text/csv"),wo.tsv=wo.dsv("	","text/tab-separated-values");var pu,du,vu,mu,gu,yu=xo[u(xo,"requestAnimationFrame")]||function(e){setTimeout(e,17)};wo.timer=function(e,t,n){var r=arguments.length;2>r&&(t=0),3>r&&(n=Date.now());var i=n+t,s={callback:e,time:i,next:null};du?du.next=s:pu=s,du=s,vu||(mu=clearTimeout(mu),vu=1,yu(bt))},wo.timer.flush=function(){Et(),St()};var bu=".",wu=",",Eu=[3,3],Su="$",xu=["y","z","a","f","p","n","µ","m","","k","M","G","T","P","E","Z","Y"].map(xt);wo.formatPrefix=function(e,t){var n=0;return e&&(0>e&&(e*=-1),t&&(e=wo.round(e,Tt(e,t))),n=1+Math.floor(1e-12+Math.log(e)/Math.LN10),n=Math.max(-24,Math.min(24,3*Math.floor((0>=n?n+1:n-1)/3)))),xu[8+n/3]},wo.round=function(e,t){return t?Math.round(e*(t=Math.pow(10,t)))/t:Math.round(e)},wo.format=function(e){var t=Tu.exec(e),n=t[1]||" ",r=t[2]||">",i=t[3]||"",s=t[4]||"",o=t[5],u=+t[6],a=t[7],f=t[8],l=t[9],c=1,h="",p=!1;switch(f&&(f=+f.substring(1)),(o||"0"===n&&"="===r)&&(o=n="0",r="=",a&&(u-=Math.floor((u-1)/4))),l){case"n":a=!0,l="g";break;case"%":c=100,h="%",l="f";break;case"p":c=100,h="%",l="r";break;case"b":case"o":case"x":case"X":"#"===s&&(s="0"+l.toLowerCase());case"c":case"d":p=!0,f=0;break;case"s":c=-1,l="r"}"#"===s?s="":"$"===s&&(s=Su),"r"!=l||f||(l="g"),null!=f&&("g"==l?f=Math.max(1,Math.min(21,f)):("e"==l||"f"==l)&&(f=Math.max(0,Math.min(20,f)))),l=Nu.get(l)||Nt;var d=o&&a;return function(e){if(p&&e%1)return"";var t=0>e||0===e&&0>1/e?(e=-e,"-"):i;if(0>c){var v=wo.formatPrefix(e,f);e=v.scale(e),h=v.symbol}else e*=c;e=l(e,f);var m=e.lastIndexOf("."),g=0>m?e:e.substring(0,m),y=0>m?"":bu+e.substring(m+1);!o&&a&&(g=Cu(g));var b=s.length+g.length+y.length+(d?0:t.length),w=u>b?(new Array(b=u-b+1)).join(n):"";return d&&(g=Cu(w+g)),t+=s,e=g+y,("<"===r?t+e+w:">"===r?w+t+e:"^"===r?w.substring(0,b>>=1)+t+e+w.substring(b):t+(d?e:w+e))+h}};var Tu=/(?:([^{])?([<>=^]))?([+\- ])?([$#])?(0)?(\d+)?(,)?(\.-?\d+)?([a-z%])?/i,Nu=wo.map({b:function(e){return e.toString(2)},c:function(e){return String.fromCharCode(e)},o:function(e){return e.toString(8)},x:function(e){return e.toString(16)},X:function(e){return e.toString(16).toUpperCase()},g:function(e,t){return e.toPrecision(t)},e:function(e,t){return e.toExponential(t)},f:function(e,t){return e.toFixed(t)},r:function(e,t){return(e=wo.round(e,Tt(e,t))).toFixed(Math.max(0,Math.min(20,Tt(e*(1+1e-15),t))))}}),Cu=vt;if(Eu){var ku=Eu.length;Cu=function(e){for(var t=e.length,n=[],r=0,i=Eu[0];t>0&&i>0;)n.push(e.substring(t-=i,t+i)),i=Eu[r=(r+1)%ku];return n.reverse().join(wu)}}wo.geo={},Ct.prototype={s:0,t:0,add:function(e){kt(e,this.t,Lu),kt(Lu.s,this.s,this),this.s?this.t+=Lu.t:this.s=Lu.t},reset:function(){this.s=this.t=0},valueOf:function(){return this.s}};var Lu=new Ct;wo.geo.stream=function(e,t){e&&Au.hasOwnProperty(e.type)?Au[e.type](e,t):Lt(e,t)};var Au={Feature:function(e,t){Lt(e.geometry,t)},FeatureCollection:function(e,t){for(var n=e.features,r=-1,i=n.length;++r<i;)Lt(n[r].geometry,t)}},Ou={Sphere:function(e,t){t.sphere()},Point:function(e,t){var n=e.coordinates;t.point(n[0],n[1])},MultiPoint:function(e,t){for(var n,r=e.coordinates,i=-1,s=r.length;++i<s;)n=r[i],t.point(n[0],n[1])},LineString:function(e,t){At(e.coordinates,t,0)},MultiLineString:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)At(n[r],t,0)},Polygon:function(e,t){Ot(e.coordinates,t)},MultiPolygon:function(e,t){for(var n=e.coordinates,r=-1,i=n.length;++r<i;)Ot(n[r],t)},GeometryCollection:function(e,t){for(var n=e.geometries,r=-1,i=n.length;++r<i;)Lt(n[r],t)}};wo.geo.area=function(e){return Mu=0,wo.geo.stream(e,Du),Mu};var Mu,_u=new Ct,Du={sphere:function(){Mu+=4*eu},point:l,lineStart:l,lineEnd:l,polygonStart:function(){_u.reset(),Du.lineStart=Mt},polygonEnd:function(){var e=2*_u;Mu+=0>e?4*eu+e:e,Du.lineStart=Du.lineEnd=Du.point=l}};wo.geo.bounds=function(){function e(e,t){b.push(w=[l=e,h=e]),c>t&&(c=t),t>p&&(p=t)}function t(t,n){var r=_t([t*ru,n*ru]);if(g){var i=Pt(g,r),s=[i[1],-i[0],0],o=Pt(s,i);jt(o),o=Ft(o);var a=t-d,f=a>0?1:-1,v=o[0]*iu*f,m=Math.abs(a)>180;if(m^(v>f*d&&f*t>v)){var y=o[1]*iu;y>p&&(p=y)}else if(v=(v+360)%360-180,m^(v>f*d&&f*t>v)){var y=-o[1]*iu;c>y&&(c=y)}else c>n&&(c=n),n>p&&(p=n);m?d>t?u(l,t)>u(l,h)&&(h=t):u(t,h)>u(l,h)&&(l=t):h>=l?(l>t&&(l=t),t>h&&(h=t)):t>d?u(l,t)>u(l,h)&&(h=t):u(t,h)>u(l,h)&&(l=t)}else e(t,n);g=r,d=t}function n(){E.point=t}function r(){w[0]=l,w[1]=h,E.point=e,g=null}function i(e,n){if(g){var r=e-d;y+=Math.abs(r)>180?r+(r>0?360:-360):r}else v=e,m=n;Du.point(e,n),t(e,n)}function s(){Du.lineStart()}function o(){i(v,m),Du.lineEnd(),Math.abs(y)>tu&&(l=-(h=180)),w[0]=l,w[1]=h,g=null}function u(e,t){return(t-=e)<0?t+360:t}function a(e,t){return e[0]-t[0]}function f(e,t){return t[0]<=t[1]?t[0]<=e&&e<=t[1]:e<t[0]||t[1]<e}var l,c,h,p,d,v,m,g,y,b,w,E={point:e,lineStart:n,lineEnd:r,polygonStart:function(){E.point=i,E.lineStart=s,E.lineEnd=o,y=0,Du.polygonStart()},polygonEnd:function(){Du.polygonEnd(),E.point=e,E.lineStart=n,E.lineEnd=r,0>_u?(l=-(h=180),c=-(p=90)):y>tu?p=90:-tu>y&&(c=-90),w[0]=l,w[1]=h}};return function(e){p=h=-(l=c=1/0),b=[],wo.geo.stream(e,E);var t=b.length;if(t){b.sort(a);for(var n,r=1,i=b[0],s=[i];t>r;++r)n=b[r],f(n[0],i)||f(n[1],i)?(u(i[0],n[1])>u(i[0],i[1])&&(i[1]=n[1]),u(n[0],i[1])>u(i[0],i[1])&&(i[0]=n[0])):s.push(i=n);for(var o,n,d=-1/0,t=s.length-1,r=0,i=s[t];t>=r;i=n,++r)n=s[r],(o=u(i[1],n[0]))>d&&(d=o,l=n[0],h=i[1])}return b=w=null,1/0===l||1/0===c?[[0/0,0/0],[0/0,0/0]]:[[l,c],[h,p]]}}(),wo.geo.centroid=function(e){Pu=Hu=Bu=ju=Fu=Iu=qu=Ru=Uu=zu=Wu=0,wo.geo.stream(e,Xu);var t=Uu,n=zu,r=Wu,i=t*t+n*n+r*r;return nu>i&&(t=Iu,n=qu,r=Ru,tu>Hu&&(t=Bu,n=ju,r=Fu),i=t*t+n*n+r*r,nu>i)?[0/0,0/0]:[Math.atan2(n,t)*iu,W(r/Math.sqrt(i))*iu]};var Pu,Hu,Bu,ju,Fu,Iu,qu,Ru,Uu,zu,Wu,Xu={sphere:l,point:qt,lineStart:Ut,lineEnd:zt,polygonStart:function(){Xu.lineStart=Wt},polygonEnd:function(){Xu.lineStart=Ut}},Vu=Jt(Xt,Zt,tn,nn),$u=[-eu,0],Ju=1e9;(wo.geo.conicEqualArea=function(){return an(fn)}).raw=fn,wo.geo.albers=function(){return wo.geo.conicEqualArea().rotate([96,0]).center([-0.6,38.7]).parallels([29.5,45.5]).scale(1070)},wo.geo.albersUsa=function(){function e(e){var s=e[0],o=e[1];return t=null,n(s,o),t||(r(s,o),t)||i(s,o),t}var t,n,r,i,s=wo.geo.albers(),o=wo.geo.conicEqualArea().rotate([154,0]).center([-2,58.5]).parallels([55,65]),u=wo.geo.conicEqualArea().rotate([157,0]).center([-3,19.9]).parallels([8,18]),a={point:function(e,n){t=[e,n]}};return e.invert=function(e){var t=s.scale(),n=s.translate(),r=(e[0]-n[0])/t,i=(e[1]-n[1])/t;return(i>=.12&&.234>i&&r>=-0.425&&-0.214>r?o:i>=.166&&.234>i&&r>=-0.214&&-0.115>r?u:s).invert(e)},e.stream=function(e){var t=s.stream(e),n=o.stream(e),r=u.stream(e);return{point:function(e,i){t.point(e,i),n.point(e,i),r.point(e,i)},sphere:function(){t.sphere(),n.sphere(),r.sphere()},lineStart:function(){t.lineStart(),n.lineStart(),r.lineStart()},lineEnd:function(){t.lineEnd(),n.lineEnd(),r.lineEnd()},polygonStart:function(){t.polygonStart(),n.polygonStart(),r.polygonStart()},polygonEnd:function(){t.polygonEnd(),n.polygonEnd(),r.polygonEnd()}}},e.precision=function(t){return arguments.length?(s.precision(t),o.precision(t),u.precision(t),e):s.precision()},e.scale=function(t){return arguments.length?(s.scale(t),o.scale(.35*t),u.scale(t),e.translate(s.translate())):s.scale()},e.translate=function(t){if(!arguments.length)return s.translate();var f=s.scale(),l=+t[0],c=+t[1];return n=s.translate(t).clipExtent([[l-.455*f,c-.238*f],[l+.455*f,c+.238*f]]).stream(a).point,r=o.translate([l-.307*f,c+.201*f]).clipExtent([[l-.425*f+tu,c+.12*f+tu],[l-.214*f-tu,c+.234*f-tu]]).stream(a).point,i=u.translate([l-.205*f,c+.212*f]).clipExtent([[l-.214*f+tu,c+.166*f+tu],[l-.115*f-tu,c+.234*f-tu]]).stream(a).point,e},e.scale(1070)};var Ku,Qu,Gu,Yu,Zu,ea,ta={point:l,lineStart:l,lineEnd:l,polygonStart:function(){Qu=0,ta.lineStart=ln},polygonEnd:function(){ta.lineStart=ta.lineEnd=ta.point=l,Ku+=Math.abs(Qu/2)}},na={point:cn,lineStart:l,lineEnd:l,polygonStart:l,polygonEnd:l},ra={point:dn,lineStart:vn,lineEnd:mn,polygonStart:function(){ra.lineStart=gn},polygonEnd:function(){ra.point=dn,ra.lineStart=vn,ra.lineEnd=mn}};wo.geo.path=function(){function e(e){return e&&("function"==typeof u&&s.pointRadius(+u.apply(this,arguments)),o&&o.valid||(o=i(s)),wo.geo.stream(e,o)),s.result()}function t(){return o=null,e}var n,r,i,s,o,u=4.5;return e.area=function(e){return Ku=0,wo.geo.stream(e,i(ta)),Ku},e.centroid=function(e){return Bu=ju=Fu=Iu=qu=Ru=Uu=zu=Wu=0,wo.geo.stream(e,i(ra)),Wu?[Uu/Wu,zu/Wu]:Ru?[Iu/Ru,qu/Ru]:Fu?[Bu/Fu,ju/Fu]:[0/0,0/0]},e.bounds=function(e){return Zu=ea=-(Gu=Yu=1/0),wo.geo.stream(e,i(na)),[[Gu,Yu],[Zu,ea]]},e.projection=function(e){return arguments.length?(i=(n=e)?e.stream||wn(e):vt,t()):n},e.context=function(e){return arguments.length?(s=null==(r=e)?new hn:new yn(e),"function"!=typeof u&&s.pointRadius(u),t()):r},e.pointRadius=function(t){return arguments.length?(u="function"==typeof t?t:(s.pointRadius(+t),+t),e):u},e.projection(wo.geo.albersUsa()).context(null)},wo.geo.projection=En,wo.geo.projectionMutator=Sn,(wo.geo.equirectangular=function(){return En(Tn)}).raw=Tn.invert=Tn,wo.geo.rotation=function(e){function t(t){return t=e(t[0]*ru,t[1]*ru),t[0]*=iu,t[1]*=iu,t}return e=Nn(e[0]%360*ru,e[1]*ru,e.length>2?e[2]*ru:0),t.invert=function(t){return t=e.invert(t[0]*ru,t[1]*ru),t[0]*=iu,t[1]*=iu,t},t},wo.geo.circle=function(){function e(){var e="function"==typeof r?r.apply(this,arguments):r,t=Nn(-e[0]*ru,-e[1]*ru,0).invert,i=[];return n(null,null,1,{point:function(e,n){i.push(e=t(e,n)),e[0]*=iu,e[1]*=iu}}),{type:"Polygon",coordinates:[i]}}var t,n,r=[0,0],i=6;return e.origin=function(t){return arguments.length?(r=t,e):r},e.angle=function(r){return arguments.length?(n=An((t=+r)*ru,i*ru),e):t},e.precision=function(r){return arguments.length?(n=An(t*ru,(i=+r)*ru),e):i},e.angle(90)},wo.geo.distance=function(e,t){var n,r=(t[0]-e[0])*ru,i=e[1]*ru,s=t[1]*ru,o=Math.sin(r),u=Math.cos(r),a=Math.sin(i),f=Math.cos(i),l=Math.sin(s),c=Math.cos(s);return Math.atan2(Math.sqrt((n=c*o)*n+(n=f*l-a*c*u)*n),a*l+f*c*u)},wo.geo.graticule=function(){function e(){return{type:"MultiLineString",coordinates:t()}}function t(){return wo.range(Math.ceil(s/m)*m,i,m).map(h).concat(wo.range(Math.ceil(f/g)*g,a,g).map(p)).concat(wo.range(Math.ceil(r/d)*d,n,d).filter(function(e){return Math.abs(e%m)>tu}).map(l)).concat(wo.range(Math.ceil(u/v)*v,o,v).filter(function(e){return Math.abs(e%g)>tu}).map(c))}var n,r,i,s,o,u,a,f,l,c,h,p,d=10,v=d,m=90,g=360,y=2.5;return e.lines=function(){return t().map(function(e){return{type:"LineString",coordinates:e}})},e.outline=function(){return{type:"Polygon",coordinates:[h(s).concat(p(a).slice(1),h(i).reverse().slice(1),p(f).reverse().slice(1))]}},e.extent=function(t){return arguments.length?e.majorExtent(t).minorExtent(t):e.minorExtent()},e.majorExtent=function(t){return arguments.length?(s=+t[0][0],i=+t[1][0],f=+t[0][1],a=+t[1][1],s>i&&(t=s,s=i,i=t),f>a&&(t=f,f=a,a=t),e.precision(y)):[[s,f],[i,a]]},e.minorExtent=function(t){return arguments.length?(r=+t[0][0],n=+t[1][0],u=+t[0][1],o=+t[1][1],r>n&&(t=r,r=n,n=t),u>o&&(t=u,u=o,o=t),e.precision(y)):[[r,u],[n,o]]},e.step=function(t){return arguments.length?e.majorStep(t).minorStep(t):e.minorStep()},e.majorStep=function(t){return arguments.length?(m=+t[0],g=+t[1],e):[m,g]},e.minorStep=function(t){return arguments.length?(d=+t[0],v=+t[1],e):[d,v]},e.precision=function(t){return arguments.length?(y=+t,l=Mn(u,o,90),c=_n(r,n,y),h=Mn(f,a,90),p=_n(s,i,y),e):y},e.majorExtent([[-180,-90+tu],[180,90-tu]]).minorExtent([[-180,-80-tu],[180,80+tu]])},wo.geo.greatArc=function(){function e(){return{type:"LineString",coordinates:[t||r.apply(this,arguments),n||i.apply(this,arguments)]}}var t,n,r=Dn,i=Pn;return e.distance=function(){return wo.geo.distance(t||r.apply(this,arguments),n||i.apply(this,arguments))},e.source=function(n){return arguments.length?(r=n,t="function"==typeof n?null:n,e):r},e.target=function(t){return arguments.length?(i=t,n="function"==typeof t?null:t,e):i},e.precision=function(){return arguments.length?e:0},e},wo.geo.interpolate=function(e,t){return Hn(e[0]*ru,e[1]*ru,t[0]*ru,t[1]*ru)},wo.geo.length=function(e){return ia=0,wo.geo.stream(e,sa),ia};var ia,sa={sphere:l,point:l,lineStart:Bn,lineEnd:l,polygonStart:l,polygonEnd:l},oa=jn(function(e){return Math.sqrt(2/(1+e))},function(e){return 2*Math.asin(e/2)});(wo.geo.azimuthalEqualArea=function(){return En(oa)}).raw=oa;var ua=jn(function(e){var t=Math.acos(e);return t&&t/Math.sin(t)},vt);(wo.geo.azimuthalEquidistant=function(){return En(ua)}).raw=ua,(wo.geo.conicConformal=function(){return an(Fn)}).raw=Fn,(wo.geo.conicEquidistant=function(){return an(In)}).raw=In;var aa=jn(function(e){return 1/e},Math.atan);(wo.geo.gnomonic=function(){return En(aa)}).raw=aa,qn.invert=function(e,t){return[e,2*Math.atan(Math.exp(t))-eu/2]},(wo.geo.mercator=function(){return Rn(qn)}).raw=qn;var fa=jn(function(){return 1},Math.asin);(wo.geo.orthographic=function(){return En(fa)}).raw=fa;var la=jn(function(e){return 1/(1+e)},function(e){return 2*Math.atan(e)});(wo.geo.stereographic=function(){return En(la)}).raw=la,Un.invert=function(e,t){return[Math.atan2(X(e),Math.cos(t)),W(Math.sin(t)/V(e))]},(wo.geo.transverseMercator=function(){return Rn(Un)}).raw=Un,wo.geom={},wo.svg={},wo.svg.line=function(){return zn(vt)};var ca=wo.map({linear:Vn,"linear-closed":$n,step:Jn,"step-before":Kn,"step-after":Qn,basis:nr,"basis-open":rr,"basis-closed":ir,bundle:sr,cardinal:Zn,"cardinal-open":Gn,"cardinal-closed":Yn,monotone:cr});ca.forEach(function(e,t){t.key=e,t.closed=/-closed$/.test(e)});var ha=[0,2/3,1/3,0],pa=[0,1/3,2/3,0],da=[0,1/6,2/3,1/6];wo.geom.hull=function(e){function t(e){if(e.length<3)return[];var t,i,s,o,u,a,f,l,c,h,p,d,v=dt(n),m=dt(r),g=e.length,y=g-1,b=[],w=[],E=0;if(v===Wn&&r===Xn)t=e;else for(s=0,t=[];g>s;++s)t.push([+v.call(this,i=e[s],s),+m.call(this,i,s)]);for(s=1;g>s;++s)(t[s][1]<t[E][1]||t[s][1]==t[E][1]&&t[s][0]<t[E][0])&&(E=s);for(s=0;g>s;++s)s!==E&&(a=t[s][1]-t[E][1],u=t[s][0]-t[E][0],b.push({angle:Math.atan2(a,u),index:s}));for(b.sort(function(e,t){return e.angle-t.angle}),p=b[0].angle,h=b[0].index,c=0,s=1;y>s;++s){if(o=b[s].index,p==b[s].angle){if(u=t[h][0]-t[E][0],a=t[h][1]-t[E][1],f=t[o][0]-t[E][0],l=t[o][1]-t[E][1],u*u+a*a>=f*f+l*l){b[s].index=-1;continue}b[c].index=-1}p=b[s].angle,c=s,h=o}for(w.push(E),s=0,o=0;2>s;++o)b[o].index>-1&&(w.push(b[o].index),s++);for(d=w.length;y>o;++o)if(!(b[o].index<0)){for(;!hr(w[d-2],w[d-1],b[o].index,t);)--d;w[d++]=b[o].index}var S=[];for(s=d-1;s>=0;--s)S.push(e[w[s]]);return S}var n=Wn,r=Xn;return arguments.length?t(e):(t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t)},wo.geom.polygon=function(e){return jo(e,va),e};var va=wo.geom.polygon.prototype=[];va.area=function(){for(var e,t=-1,n=this.length,r=this[n-1],i=0;++t<n;)e=r,r=this[t],i+=e[1]*r[0]-e[0]*r[1];return.5*i},va.centroid=function(e){var t,n,r=-1,i=this.length,s=0,o=0,u=this[i-1];for(arguments.length||(e=-1/(6*this.area()));++r<i;)t=u,u=this[r],n=t[0]*u[1]-u[0]*t[1],s+=(t[0]+u[0])*n,o+=(t[1]+u[1])*n;return[s*e,o*e]},va.clip=function(e){for(var t,n,r,i,s,o,u=vr(e),a=-1,f=this.length-vr(this),l=this[f-1];++a<f;){for(t=e.slice(),e.length=0,i=this[a],s=t[(r=t.length-u)-1],n=-1;++n<r;)o=t[n],pr(o,l,i)?(pr(s,l,i)||e.push(dr(s,o,l,i)),e.push(o)):pr(s,l,i)&&e.push(dr(s,o,l,i)),s=o;u&&e.push(e[0]),l=i}return e},wo.geom.delaunay=function(e){var t=e.map(function(){return[]}),n=[];return mr(e,function(n){t[n.region.l.index].push(e[n.region.r.index])}),t.forEach(function(t,r){var i=e[r],s=i[0],o=i[1];t.forEach(function(e){e.angle=Math.atan2(e[0]-s,e[1]-o)}),t.sort(function(e,t){return e.angle-t.angle});for(var u=0,a=t.length-1;a>u;u++)n.push([i,t[u],t[u+1]])}),n},wo.geom.voronoi=function(e){function t(e){var t,s,o,u=e.map(function(){return[]}),a=dt(n),f=dt(r),l=e.length,c=1e6;if(a===Wn&&f===Xn)t=e;else for(t=new Array(l),o=0;l>o;++o)t[o]=[+a.call(this,s=e[o],o),+f.call(this,s,o)];if(mr(t,function(e){var t,n,r,i,s,o;1===e.a&&e.b>=0?(t=e.ep.r,n=e.ep.l):(t=e.ep.l,n=e.ep.r),1===e.a?(s=t?t.y:-c,r=e.c-e.b*s,o=n?n.y:c,i=e.c-e.b*o):(r=t?t.x:-c,s=e.c-e.a*r,i=n?n.x:c,o=e.c-e.a*i);var a=[r,s],f=[i,o];u[e.region.l.index].push(a,f),u[e.region.r.index].push(a,f)}),u=u.map(function(e,n){var r=t[n][0],i=t[n][1],s=e.map(function(e){return Math.atan2(e[0]-r,e[1]-i)}),o=wo.range(e.length).sort(function(e,t){return s[e]-s[t]});return o.filter(function(e,t){return!t||s[e]-s[o[t-1]]>tu}).map(function(t){return e[t]})}),u.forEach(function(e,n){var r=e.length;if(!r)return e.push([-c,-c],[-c,c],[c,c],[c,-c]);if(!(r>2)){var i=t[n],s=e[0],o=e[1],u=i[0],a=i[1],f=s[0],l=s[1],h=o[0],p=o[1],d=Math.abs(h-f),v=p-l;if(Math.abs(v)<tu){var m=l>a?-c:c;e.push([-c,m],[c,m])}else if(tu>d){var g=f>u?-c:c;e.push([g,-c],[g,c])}else{var m=(f-u)*(p-l)>(h-f)*(l-a)?c:-c,y=Math.abs(v)-d;Math.abs(y)<tu?e.push([0>v?m:-m,m]):(y>0&&(m*=-1),e.push([-c,m],[c,m]))}}}),i)for(o=0;l>o;++o)i.clip(u[o]);for(o=0;l>o;++o)u[o].point=e[o];return u}var n=Wn,r=Xn,i=null;return arguments.length?t(e):(t.x=function(e){return arguments.length?(n=e,t):n},t.y=function(e){return arguments.length?(r=e,t):r},t.clipExtent=function(e){if(!arguments.length)return i&&[i[0],i[2]];if(null==e)i=null;else{var n=+e[0][0],r=+e[0][1],s=+e[1][0],o=+e[1][1];i=wo.geom.polygon([[n,r],[n,o],[s,o],[s,r]])}return t},t.size=function(e){return arguments.length?t.clipExtent(e&&[[0,0],e]):i&&i[2]},t.links=function(e){var t,i,s,o=e.map(function(){return[]}),u=[],a=dt(n),f=dt(r),l=e.length;if(a===Wn&&f===Xn)t=e;else for(t=new Array(l),s=0;l>s;++s)t[s]=[+a.call(this,i=e[s],s),+f.call(this,i,s)];return mr(t,function(t){var n=t.region.l.index,r=t.region.r.index;o[n][r]||(o[n][r]=o[r][n]=!0,u.push({source:e[n],target:e[r]}))}),u},t.triangles=function(e){if(n===Wn&&r===Xn)return wo.geom.delaunay(e);for(var t,i=new Array(a),s=dt(n),o=dt(r),u=-1,a=e.length;++u<a;)(i[u]=[+s.call(this,t=e[u],u),+o.call(this,t,u)]).data=t;return wo.geom.delaunay(i).map(function(e){return e.map(function(e){return e.data})})},t)};var ma={l:"r",r:"l"};wo.geom.quadtree=function(e,t,n,r,i){function s(e){function s(e,t,n,r,i,s,o,u){if(!isNaN(n)&&!isNaN(r))if(e.leaf){var a=e.x,l=e.y;if(null!=a)if(Math.abs(a-n)+Math.abs(l-r)<.01)f(e,t,n,r,i,s,o,u);else{var c=e.point;e.x=e.y=e.point=null,f(e,c,a,l,i,s,o,u),f(e,t,n,r,i,s,o,u)}else e.x=n,e.y=r,e.point=t}else f(e,t,n,r,i,s,o,u)}function f(e,t,n,r,i,o,u,a){var f=.5*(i+u),l=.5*(o+a),c=n>=f,h=r>=l,p=(h<<1)+c;e.leaf=!1,e=e.nodes[p]||(e.nodes[p]=br()),c?i=f:u=f,h?o=l:a=l,s(e,t,n,r,i,o,u,a)}var l,c,h,p,d,v,m,g,y,b=dt(u),w=dt(a);if(null!=t)v=t,m=n,g=r,y=i;else if(g=y=-(v=m=1/0),c=[],h=[],d=e.length,o)for(p=0;d>p;++p)l=e[p],l.x<v&&(v=l.x),l.y<m&&(m=l.y),l.x>g&&(g=l.x),l.y>y&&(y=l.y),c.push(l.x),h.push(l.y);else for(p=0;d>p;++p){var E=+b(l=e[p],p),S=+w(l,p);v>E&&(v=E),m>S&&(m=S),E>g&&(g=E),S>y&&(y=S),c.push(E),h.push(S)}var x=g-v,T=y-m;x>T?y=m+x:g=v+T;var N=br();if(N.add=function(e){s(N,e,+b(e,++p),+w(e,p),v,m,g,y)},N.visit=function(e){wr(e,N,v,m,g,y)},p=-1,null==t){for(;++p<d;)s(N,e[p],c[p],h[p],v,m,g,y);--p}else e.forEach(N.add);return c=h=e=l=null,N}var o,u=Wn,a=Xn;return(o=arguments.length)?(u=gr,a=yr,3===o&&(i=n,r=t,n=t=0),s(e)):(s.x=function(e){return arguments.length?(u=e,s):u},s.y=function(e){return arguments.length?(a=e,s):a},s.extent=function(e){return arguments.length?(null==e?t=n=r=i=null:(t=+e[0][0],n=+e[0][1],r=+e[1][0],i=+e[1][1]),s):null==t?null:[[t,n],[r,i]]},s.size=function(e){return arguments.length?(null==e?t=n=r=i=null:(t=n=0,r=+e[0],i=+e[1]),s):null==t?null:[r-t,i-n]},s)},wo.interpolateRgb=Er,wo.interpolateObject=Sr,wo.interpolateNumber=xr,wo.interpolateString=Tr;var ga=/[-+]?(?:\d+\.?\d*|\.?\d+)(?:[eE][-+]?\d+)?/g;wo.interpolate=Nr,wo.interpolators=[function(e,t){var n=typeof t;return("string"===n?hu.has(t)||/^(#|rgb\(|hsl\()/.test(t)?Er:Tr:t instanceof F?Er:"object"===n?Array.isArray(t)?Cr:Sr:xr)(e,t)}],wo.interpolateArray=Cr;var ya=function(){return vt},ba=wo.map({linear:ya,poly:Dr,quad:function(){return Or},cubic:function(){return Mr},sin:function(){return Pr},exp:function(){return Hr},circle:function(){return Br},elastic:jr,back:Fr,bounce:function(){return Ir}}),wa=wo.map({"in":vt,out:Lr,"in-out":Ar,"out-in":function(e){return Ar(Lr(e))}});wo.ease=function(e){var t=e.indexOf("-"),n=t>=0?e.substring(0,t):e,r=t>=0?e.substring(t+1):"in";return n=ba.get(n)||ya,r=wa.get(r)||vt,kr(r(n.apply(null,Array.prototype.slice.call(arguments,1))))},wo.interpolateHcl=qr,wo.interpolateHsl=Rr,wo.interpolateLab=Ur,wo.interpolateRound=zr,wo.transform=function(e){var t=Eo.createElementNS(wo.ns.prefix.svg,"g");return(wo.transform=function(e){if(null!=e){t.setAttribute("transform",e);var n=t.transform.baseVal.consolidate()}return new Wr(n?n.matrix:Ea)})(e)},Wr.prototype.toString=function(){return"translate("+this.translate+")rotate("+this.rotate+")skewX("+this.skew+")scale("+this.scale+")"};var Ea={a:1,b:0,c:0,d:1,e:0,f:0};wo.interpolateTransform=Jr,wo.layout={},wo.layout.bundle=function(){return function(e){for(var t=[],n=-1,r=e.length;++n<r;)t.push(Gr(e[n]));return t}},wo.layout.chord=function(){function e(){var e,f,c,h,p,d={},v=[],m=wo.range(s),g=[];for(n=[],r=[],e=0,h=-1;++h<s;){for(f=0,p=-1;++p<s;)f+=i[h][p];v.push(f),g.push(wo.range(s)),e+=f}for(o&&m.sort(function(e,t){return o(v[e],v[t])}),u&&g.forEach(function(e,t){e.sort(function(e,n){return u(i[t][e],i[t][n])})}),e=(2*eu-l*s)/e,f=0,h=-1;++h<s;){for(c=f,p=-1;++p<s;){var y=m[h],b=g[y][p],w=i[y][b],E=f,S=f+=w*e;d[y+"-"+b]={index:y,subindex:b,startAngle:E,endAngle:S,value:w}}r[y]={index:y,startAngle:c,endAngle:f,value:(f-c)/e},f+=l}for(h=-1;++h<s;)for(p=h-1;++p<s;){var x=d[h+"-"+p],T=d[p+"-"+h];(x.value||T.value)&&n.push(x.value<T.value?{source:T,target:x}:{source:x,target:T})}a&&t()}function t(){n.sort(function(e,t){return a((e.source.value+e.target.value)/2,(t.source.value+t.target.value)/2)})}var n,r,i,s,o,u,a,f={},l=0;return f.matrix=function(e){return arguments.length?(s=(i=e)&&i.length,n=r=null,f):i},f.padding=function(e){return arguments.length?(l=e,n=r=null,f):l},f.sortGroups=function(e){return arguments.length?(o=e,n=r=null,f):o},f.sortSubgroups=function(e){return arguments.length?(u=e,n=null,f):u},f.sortChords=function(e){return arguments.length?(a=e,n&&t(),f):a},f.chords=function(){return n||e(),n},f.groups=function(){return r||e(),r},f},wo.layout.force=function(){function e(e){return function(t,n,r,i){if(t.point!==e){var s=t.cx-e.x,o=t.cy-e.y,u=1/Math.sqrt(s*s+o*o);if(v>(i-n)*u){var a=t.charge*u*u;return e.px-=s*a,e.py-=o*a,!0}if(t.point&&isFinite(u)){var a=t.pointCharge*u*u;e.px-=s*a,e.py-=o*a}}return!t.charge}}function t(e){e.px=wo.event.x,e.py=wo.event.y,u.resume()}var n,r,i,s,o,u={},a=wo.dispatch("start","tick","end"),f=[1,1],l=.9,c=Sa,h=xa,p=-30,d=.1,v=.8,m=[],g=[];return u.tick=function(){if((r*=.99)<.005)return a.end({type:"end",alpha:r=0}),!0;var t,n,u,c,h,v,y,b,w,E=m.length,S=g.length;for(n=0;S>n;++n)u=g[n],c=u.source,h=u.target,b=h.x-c.x,w=h.y-c.y,(v=b*b+w*w)&&(v=r*s[n]*((v=Math.sqrt(v))-i[n])/v,b*=v,w*=v,h.x-=b*(y=c.weight/(h.weight+c.weight)),h.y-=w*y,c.x+=b*(y=1-y),c.y+=w*y);if((y=r*d)&&(b=f[0]/2,w=f[1]/2,n=-1,y))for(;++n<E;)u=m[n],u.x+=(b-u.x)*y,u.y+=(w-u.y)*y;if(p)for(ii(t=wo.geom.quadtree(m),r,o),n=-1;++n<E;)(u=m[n]).fixed||t.visit(e(u));for(n=-1;++n<E;)u=m[n],u.fixed?(u.x=u.px,u.y=u.py):(u.x-=(u.px-(u.px=u.x))*l,u.y-=(u.py-(u.py=u.y))*l);a.tick({type:"tick",alpha:r})},u.nodes=function(e){return arguments.length?(m=e,u):m},u.links=function(e){return arguments.length?(g=e,u):g},u.size=function(e){return arguments.length?(f=e,u):f},u.linkDistance=function(e){return arguments.length?(c="function"==typeof e?e:+e,u):c},u.distance=u.linkDistance,u.linkStrength=function(e){return arguments.length?(h="function"==typeof e?e:+e,u):h},u.friction=function(e){return arguments.length?(l=+e,u):l},u.charge=function(e){return arguments.length?(p="function"==typeof e?e:+e,u):p},u.gravity=function(e){return arguments.length?(d=+e,u):d},u.theta=function(e){return arguments.length?(v=+e,u):v},u.alpha=function(e){return arguments.length?(e=+e,r?r=e>0?e:0:e>0&&(a.start({type:"start",alpha:r=e}),wo.timer(u.tick)),u):r},u.start=function(){function e(e,r){for(var i,s=t(n),o=-1,u=s.length;++o<u;)if(!isNaN(i=s[o][e]))return i;return Math.random()*r}function t(){if(!a){for(a=[],r=0;d>r;++r)a[r]=[];for(r=0;v>r;++r){var e=g[r];a[e.source.index].push(e.target),a[e.target.index].push(e.source)}}return a[n]}var n,r,a,l,d=m.length,v=g.length,y=f[0],b=f[1];for(n=0;d>n;++n)(l=m[n]).index=n,l.weight=0;for(n=0;v>n;++n)l=g[n],"number"==typeof l.source&&(l.source=m[l.source]),"number"==typeof l.target&&(l.target=m[l.target]),++l.source.weight,++l.target.weight;for(n=0;d>n;++n)l=m[n],isNaN(l.x)&&(l.x=e("x",y)),isNaN(l.y)&&(l.y=e("y",b)),isNaN(l.px)&&(l.px=l.x),isNaN(l.py)&&(l.py=l.y);if(i=[],"function"==typeof c)for(n=0;v>n;++n)i[n]=+c.call(this,g[n],n);else for(n=0;v>n;++n)i[n]=c;if(s=[],"function"==typeof h)for(n=0;v>n;++n)s[n]=+h.call(this,g[n],n);else for(n=0;v>n;++n)s[n]=h;if(o=[],"function"==typeof p)for(n=0;d>n;++n)o[n]=+p.call(this,m[n],n);else for(n=0;d>n;++n)o[n]=p;return u.resume()},u.resume=function(){return u.alpha(.1)},u.stop=function(){return u.alpha(0)},u.drag=function(){return n||(n=wo.behavior.drag().origin(vt).on("dragstart.force",ei).on("drag.force",t).on("dragend.force",ti)),arguments.length?(this.on("mouseover.force",ni).on("mouseout.force",ri).call(n),void 0):n},wo.rebind(u,a,"on")};var Sa=20,xa=1;wo.layout.hierarchy=function(){function e(t,o,u){var a=i.call(n,t,o);if(t.depth=o,u.push(t),a&&(f=a.length)){for(var f,l,c=-1,h=t.children=[],p=0,d=o+1;++c<f;)l=e(a[c],d,u),l.parent=t,h.push(l),p+=l.value;r&&h.sort(r),s&&(t.value=p)}else s&&(t.value=+s.call(n,t,o)||0);return t}function t(e,r){var i=e.children,o=0;if(i&&(u=i.length))for(var u,a=-1,f=r+1;++a<u;)o+=t(i[a],f);else s&&(o=+s.call(n,e,r)||0);return s&&(e.value=o),o}function n(t){var n=[];return e(t,0,n),n}var r=ai,i=oi,s=ui;return n.sort=function(e){return arguments.length?(r=e,n):r},n.children=function(e){return arguments.length?(i=e,n):i},n.value=function(e){return arguments.length?(s=e,n):s},n.revalue=function(e){return t(e,0),e},n},wo.layout.partition=function(){function e(t,n,r,i){var s=t.children;if(t.x=n,t.y=t.depth*i,t.dx=r,t.dy=i,s&&(o=s.length)){var o,u,a,f=-1;for(r=t.value?r/t.value:0;++f<o;)e(u=s[f],n,a=u.value*r,i),n+=a}}function t(e){var n=e.children,r=0;if(n&&(i=n.length))for(var i,s=-1;++s<i;)r=Math.max(r,t(n[s]));return 1+r}function n(n,s){var o=r.call(this,n,s);return e(o[0],0,i[0],i[1]/t(o[0])),o}var r=wo.layout.hierarchy(),i=[1,1];return n.size=function(e){return arguments.length?(i=e,n):i},si(n,r)},wo.layout.pie=function(){function e(s){var o=s.map(function(n,r){return+t.call(e,n,r)}),u=+("function"==typeof r?r.apply(this,arguments):r),a=(("function"==typeof i?i.apply(this,arguments):i)-u)/wo.sum(o),f=wo.range(s.length);null!=n&&f.sort(n===Ta?function(e,t){return o[t]-o[e]}:function(e,t){return n(s[e],s[t])});var l=[];return f.forEach(function(e){var t;l[e]={data:s[e],value:t=o[e],startAngle:u,endAngle:u+=t*a}}),l}var t=Number,n=Ta,r=0,i=2*eu;return e.value=function(n){return arguments.length?(t=n,e):t},e.sort=function(t){return arguments.length?(n=t,e):n},e.startAngle=function(t){return arguments.length?(r=t,e):r},e.endAngle=function(t){return arguments.length?(i=t,e):i},e};var Ta={};wo.layout.stack=function(){function e(u,a){var f=u.map(function(n,r){return t.call(e,n,r)}),l=f.map(function(t){return t.map(function(t,n){return[s.call(e,t,n),o.call(e,t,n)]})}),c=n.call(e,l,a);f=wo.permute(f,c),l=wo.permute(l,c);var h,p,d,v=r.call(e,l,a),m=f.length,g=f[0].length;for(p=0;g>p;++p)for(i.call(e,f[0][p],d=v[p],l[0][p][1]),h=1;m>h;++h)i.call(e,f[h][p],d+=l[h-1][p][1],l[h][p][1]);return u}var t=vt,n=pi,r=di,i=hi,s=li,o=ci;return e.values=function(n){return arguments.length?(t=n,e):t},e.order=function(t){return arguments.length?(n="function"==typeof t?t:Na.get(t)||pi,e):n},e.offset=function(t){return arguments.length?(r="function"==typeof t?t:Ca.get(t)||di,e):r},e.x=function(t){return arguments.length?(s=t,e):s},e.y=function(t){return arguments.length?(o=t,e):o},e.out=function(t){return arguments.length?(i=t,e):i},e};var Na=wo.map({"inside-out":function(e){var t,n,r=e.length,i=e.map(vi),s=e.map(mi),o=wo.range(r).sort(function(e,t){return i[e]-i[t]}),u=0,a=0,f=[],l=[];for(t=0;r>t;++t)n=o[t],a>u?(u+=s[n],f.push(n)):(a+=s[n],l.push(n));return l.reverse().concat(f)},reverse:function(e){return wo.range(e.length).reverse()},"default":pi}),Ca=wo.map({silhouette:function(e){var t,n,r,i=e.length,s=e[0].length,o=[],u=0,a=[];for(n=0;s>n;++n){for(t=0,r=0;i>t;t++)r+=e[t][n][1];r>u&&(u=r),o.push(r)}for(n=0;s>n;++n)a[n]=(u-o[n])/2;return a},wiggle:function(e){var t,n,r,i,s,o,u,a,f,l=e.length,c=e[0],h=c.length,p=[];for(p[0]=a=f=0,n=1;h>n;++n){for(t=0,i=0;l>t;++t)i+=e[t][n][1];for(t=0,s=0,u=c[n][0]-c[n-1][0];l>t;++t){for(r=0,o=(e[t][n][1]-e[t][n-1][1])/(2*u);t>r;++r)o+=(e[r][n][1]-e[r][n-1][1])/u;s+=o*e[t][n][1]}p[n]=a-=i?s/i*u:0,f>a&&(f=a)}for(n=0;h>n;++n)p[n]-=f;return p},expand:function(e){var t,n,r,i=e.length,s=e[0].length,o=1/i,u=[];for(n=0;s>n;++n){for(t=0,r=0;i>t;t++)r+=e[t][n][1];if(r)for(t=0;i>t;t++)e[t][n][1]/=r;else for(t=0;i>t;t++)e[t][n][1]=o}for(n=0;s>n;++n)u[n]=0;return u},zero:di});wo.layout.histogram=function(){function e(e,s){for(var o,u,a=[],f=e.map(n,this),l=r.call(this,f,s),c=i.call(this,l,f,s),s=-1,h=f.length,p=c.length-1,d=t?1:1/h;++s<p;)o=a[s]=[],o.dx=c[s+1]-(o.x=c[s]),o.y=0;if(p>0)for(s=-1;++s<h;)u=f[s],u>=l[0]&&u<=l[1]&&(o=a[wo.bisect(c,u,1,p)-1],o.y+=d,o.push(e[s]));return a}var t=!0,n=Number,r=wi,i=yi;return e.value=function(t){return arguments.length?(n=t,e):n},e.range=function(t){return arguments.length?(r=dt(t),e):r},e.bins=function(t){return arguments.length?(i="number"==typeof t?function(e){return bi(e,t)}:dt(t),e):i},e.frequency=function(n){return arguments.length?(t=!!n,e):t},e},wo.layout.tree=function(){function e(e,s){function o(e,t){var r=e.children,i=e._tree;if(r&&(s=r.length)){for(var s,u,f,l=r[0],c=l,h=-1;++h<s;)f=r[h],o(f,u),c=a(f,u,c),u=f;Ai(e);var p=.5*(l._tree.prelim+f._tree.prelim);t?(i.prelim=t._tree.prelim+n(e,t),i.mod=i.prelim-p):i.prelim=p}else t&&(i.prelim=t._tree.prelim+n(e,t))}function u(e,t){e.x=e._tree.prelim+t;var n=e.children;if(n&&(r=n.length)){var r,i=-1;for(t+=e._tree.mod;++i<r;)u(n[i],t)}}function a(e,t,r){if(t){for(var i,s=e,o=e,u=t,a=e.parent.children[0],f=s._tree.mod,l=o._tree.mod,c=u._tree.mod,h=a._tree.mod;u=xi(u),s=Si(s),u&&s;)a=Si(a),o=xi(o),o._tree.ancestor=e,i=u._tree.prelim+c-s._tree.prelim-f+n(u,s),i>0&&(Oi(Mi(u,e,r),e,i),f+=i,l+=i),c+=u._tree.mod,f+=s._tree.mod,h+=a._tree.mod,l+=o._tree.mod;u&&!xi(o)&&(o._tree.thread=u,o._tree.mod+=c-l),s&&!Si(a)&&(a._tree.thread=s,a._tree.mod+=f-h,r=e)}return r}var f=t.call(this,e,s),l=f[0];Li(l,function(e,t){e._tree={ancestor:e,prelim:0,mod:0,change:0,shift:0,number:t?t._tree.number+1:0}}),o(l),u(l,-l._tree.prelim);var c=Ti(l,Ci),h=Ti(l,Ni),p=Ti(l,ki),d=c.x-n(c,h)/2,v=h.x+n(h,c)/2,m=p.depth||1;return Li(l,i?function(e){e.x*=r[0],e.y=e.depth*r[1],delete e._tree}:function(e){e.x=(e.x-d)/(v-d)*r[0],e.y=e.depth/m*r[1],delete e._tree}),f}var t=wo.layout.hierarchy().sort(null).value(null),n=Ei,r=[1,1],i=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(i=null==(r=t),e):i?null:r},e.nodeSize=function(t){return arguments.length?(i=null!=(r=t),e):i?r:null},si(e,t)},wo.layout.pack=function(){function e(e,s){var o=n.call(this,e,s),u=o[0],a=i[0],f=i[1],l=null==t?Math.sqrt:"function"==typeof t?t:function(){return t};if(u.x=u.y=0,Li(u,function(e){e.r=+l(e.value)}),Li(u,Bi),r){var c=r*(t?1:Math.max(2*u.r/a,2*u.r/f))/2;Li(u,function(e){e.r+=c}),Li(u,Bi),Li(u,function(e){e.r-=c})}return Ii(u,a/2,f/2,t?1:1/Math.max(2*u.r/a,2*u.r/f)),o}var t,n=wo.layout.hierarchy().sort(_i),r=0,i=[1,1];return e.size=function(t){return arguments.length?(i=t,e):i},e.radius=function(n){return arguments.length?(t=null==n||"function"==typeof n?n:+n,e):t},e.padding=function(t){return arguments.length?(r=+t,e):r},si(e,n)},wo.layout.cluster=function(){function e(e,s){var o,u=t.call(this,e,s),a=u[0],f=0;Li(a,function(e){var t=e.children;t&&t.length?(e.x=Ui(t),e.y=Ri(t)):(e.x=o?f+=n(e,o):0,e.y=0,o=e)});var l=zi(a),c=Wi(a),h=l.x-n(l,c)/2,p=c.x+n(c,l)/2;return Li(a,i?function(e){e.x=(e.x-a.x)*r[0],e.y=(a.y-e.y)*r[1]}:function(e){e.x=(e.x-h)/(p-h)*r[0],e.y=(1-(a.y?e.y/a.y:1))*r[1]}),u}var t=wo.layout.hierarchy().sort(null).value(null),n=Ei,r=[1,1],i=!1;return e.separation=function(t){return arguments.length?(n=t,e):n},e.size=function(t){return arguments.length?(i=null==(r=t),e):i?null:r},e.nodeSize=function(t){return arguments.length?(i=null!=(r=t),e):i?r:null},si(e,t)},wo.layout.treemap=function(){function e(e,t){for(var n,r,i=-1,s=e.length;++i<s;)r=(n=e[i]).value*(0>t?0:t),n.area=isNaN(r)||0>=r?0:r}function t(n){var s=n.children;if(s&&s.length){var o,u,a,f=c(n),l=[],h=s.slice(),d=1/0,v="slice"===p?f.dx:"dice"===p?f.dy:"slice-dice"===p?1&n.depth?f.dy:f.dx:Math.min(f.dx,f.dy);for(e(h,f.dx*f.dy/n.value),l.area=0;(a=h.length)>0;)l.push(o=h[a-1]),l.area+=o.area,"squarify"!==p||(u=r(l,v))<=d?(h.pop(),d=u):(l.area-=l.pop().area,i(l,v,f,!1),v=Math.min(f.dx,f.dy),l.length=l.area=0,d=1/0);l.length&&(i(l,v,f,!0),l.length=l.area=0),s.forEach(t)}}function n(t){var r=t.children;if(r&&r.length){var s,o=c(t),u=r.slice(),a=[];for(e(u,o.dx*o.dy/t.value),a.area=0;s=u.pop();)a.push(s),a.area+=s.area,null!=s.z&&(i(a,s.z?o.dx:o.dy,o,!u.length),a.length=a.area=0);r.forEach(n)}}function r(e,t){for(var n,r=e.area,i=0,s=1/0,o=-1,u=e.length;++o<u;)(n=e[o].area)&&(s>n&&(s=n),n>i&&(i=n));return r*=r,t*=t,r?Math.max(t*i*d/r,r/(t*s*d)):1/0}function i(e,t,n,r){var i,s=-1,o=e.length,u=n.x,f=n.y,l=t?a(e.area/t):0;if(t==n.dx){for((r||l>n.dy)&&(l=n.dy);++s<o;)i=e[s],i.x=u,i.y=f,i.dy=l,u+=i.dx=Math.min(n.x+n.dx-u,l?a(i.area/l):0);i.z=!0,i.dx+=n.x+n.dx-u,n.y+=l,n.dy-=l}else{for((r||l>n.dx)&&(l=n.dx);++s<o;)i=e[s],i.x=u,i.y=f,i.dx=l,f+=i.dy=Math.min(n.y+n.dy-f,l?a(i.area/l):0);i.z=!1,i.dy+=n.y+n.dy-f,n.x+=l,n.dx-=l}}function s(r){var i=o||u(r),s=i[0];return s.x=0,s.y=0,s.dx=f[0],s.dy=f[1],o&&u.revalue(s),e([s],s.dx*s.dy/s.value),(o?n:t)(s),h&&(o=i),i}var o,u=wo.layout.hierarchy(),a=Math.round,f=[1,1],l=null,c=Xi,h=!1,p="squarify",d=.5*(1+Math.sqrt(5));return s.size=function(e){return arguments.length?(f=e,s):f},s.padding=function(e){function t(t){var n=e.call(s,t,t.depth);return null==n?Xi(t):Vi(t,"number"==typeof n?[n,n,n,n]:n)}function n(t){return Vi(t,e)}if(!arguments.length)return l;var r;return c=null==(l=e)?Xi:"function"==(r=typeof e)?t:"number"===r?(e=[e,e,e,e],n):n,s},s.round=function(e){return arguments.length?(a=e?Math.round:Number,s):a!=Number},s.sticky=function(e){return arguments.length?(h=e,o=null,s):h},s.ratio=function(e){return arguments.length?(d=e,s):d},s.mode=function(e){return arguments.length?(p=e+"",s):p},si(s,u)},wo.random={normal:function(e,t){var n=arguments.length;return 2>n&&(t=1),1>n&&(e=0),function(){var n,r,i;do n=2*Math.random()-1,r=2*Math.random()-1,i=n*n+r*r;while(!i||i>1);return e+t*n*Math.sqrt(-2*Math.log(i)/i)}},logNormal:function(){var e=wo.random.normal.apply(wo,arguments);return function(){return Math.exp(e())}},irwinHall:function(e){return function(){for(var t=0,n=0;e>n;n++)t+=Math.random();return t/e}}},wo.scale={};var ka={floor:vt,ceil:vt};wo.scale.linear=function(){return Zi([0,1],[0,1],Nr,!1)},wo.scale.log=function(){return os(wo.scale.linear().domain([0,1]),10,!0,[1,10])};var La=wo.format(".0e"),Aa={floor:function(e){return-Math.ceil(-e)},ceil:function(e){return-Math.floor(-e)}};wo.scale.pow=function(){return us(wo.scale.linear(),1,[0,1])},wo.scale.sqrt=function(){return wo.scale.pow().exponent(.5)},wo.scale.ordinal=function(){return fs([],{t:"range",a:[[]]})},wo.scale.category10=function(){return wo.scale.ordinal().range(Oa)},wo.scale.category20=function(){return wo.scale.ordinal().range(Ma)},wo.scale.category20b=function(){return wo.scale.ordinal().range(_a)},wo.scale.category20c=function(){return wo.scale.ordinal().range(Da)};var Oa=[2062260,16744206,2924588,14034728,9725885,9197131,14907330,8355711,12369186,1556175].map(st),Ma=[2062260,11454440,16744206,16759672,2924588,10018698,14034728,16750742,9725885,12955861,9197131,12885140,14907330,16234194,8355711,13092807,12369186,14408589,1556175,10410725].map(st),_a=[3750777,5395619,7040719,10264286,6519097,9216594,11915115,13556636,9202993,12426809,15186514,15190932,8666169,11356490,14049643,15177372,8077683,10834324,13528509,14589654].map(st),Da=[3244733,7057110,10406625,13032431,15095053,16616764,16625259,16634018,3253076,7652470,10607003,13101504,7695281,10394312,12369372,14342891,6513507,9868950,12434877,14277081].map(st);wo.scale.quantile=function(){return ls([],[])},wo.scale.quantize=function(){return cs(0,1,[0,1])},wo.scale.threshold=function(){return hs([.5],[0,1])},wo.scale.identity=function(){return ps([0,1])},wo.svg.arc=function(){function e(){var e=t.apply(this,arguments),s=n.apply(this,arguments),o=r.apply(this,arguments)+Pa,u=i.apply(this,arguments)+Pa,a=(o>u&&(a=o,o=u,u=a),u-o),f=eu>a?"0":"1",l=Math.cos(o),c=Math.sin(o),h=Math.cos(u),p=Math.sin(u);return a>=Ha?e?"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"M0,"+e+"A"+e+","+e+" 0 1,0 0,"+ -e+"A"+e+","+e+" 0 1,0 0,"+e+"Z":"M0,"+s+"A"+s+","+s+" 0 1,1 0,"+ -s+"A"+s+","+s+" 0 1,1 0,"+s+"Z":e?"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L"+e*h+","+e*p+"A"+e+","+e+" 0 "+f+",0 "+e*l+","+e*c+"Z":"M"+s*l+","+s*c+"A"+s+","+s+" 0 "+f+",1 "+s*h+","+s*p+"L0,0"+"Z"}var t=ds,n=vs,r=ms,i=gs;return e.innerRadius=function(n){return arguments.length?(t=dt(n),e):t},e.outerRadius=function(t){return arguments.length?(n=dt(t),e):n},e.startAngle=function(t){return arguments.length?(r=dt(t),e):r},e.endAngle=function(t){return arguments.length?(i=dt(t),e):i},e.centroid=function(){var e=(t.apply(this,arguments)+n.apply(this,arguments))/2,s=(r.apply(this,arguments)+i.apply(this,arguments))/2+Pa;return[Math.cos(s)*e,Math.sin(s)*e]},e};var Pa=-eu/2,Ha=2*eu-1e-6;wo.svg.line.radial=function(){var e=zn(ys);return e.radius=e.x,delete e.x,e.angle=e.y,delete e.y,e},Kn.reverse=Qn,Qn.reverse=Kn,wo.svg.area=function(){return bs(vt)},wo.svg.area.radial=function(){var e=bs(ys);return e.radius=e.x,delete e.x,e.innerRadius=e.x0,delete e.x0,e.outerRadius=e.x1,delete e.x1,e.angle=e.y,delete e.y,e.startAngle=e.y0,delete e.y0,e.endAngle=e.y1,delete e.y1,e},wo.svg.chord=function(){function e(e,u){var a=t(this,s,e,u),f=t(this,o,e,u);return"M"+a.p0+r(a.r,a.p1,a.a1-a.a0)+(n(a,f)?i(a.r,a.p1,a.r,a.p0):i(a.r,a.p1,f.r,f.p0)+r(f.r,f.p1,f.a1-f.a0)+i(f.r,f.p1,a.r,a.p0))+"Z"}function t(e,t,n,r){var i=t.call(e,n,r),s=u.call(e,i,r),o=a.call(e,i,r)+Pa,l=f.call(e,i,r)+Pa;return{r:s,a0:o,a1:l,p0:[s*Math.cos(o),s*Math.sin(o)],p1:[s*Math.cos(l),s*Math.sin(l)]}}function n(e,t){return e.a0==t.a0&&e.a1==t.a1}function r(e,t,n){return"A"+e+","+e+" 0 "+ +(n>eu)+",1 "+t}function i(e,t,n,r){return"Q 0,0 "+r}var s=Dn,o=Pn,u=ws,a=ms,f=gs;return e.radius=function(t){return arguments.length?(u=dt(t),e):u},e.source=function(t){return arguments.length?(s=dt(t),e):s},e.target=function(t){return arguments.length?(o=dt(t),e):o},e.startAngle=function(t){return arguments.length?(a=dt(t),e):a},e.endAngle=function(t){return arguments.length?(f=dt(t),e):f},e},wo.svg.diagonal=function(){function e(e,i){var s=t.call(this,e,i),o=n.call(this,e,i),u=(s.y+o.y)/2,a=[s,{x:s.x,y:u},{x:o.x,y:u},o];return a=a.map(r),"M"+a[0]+"C"+a[1]+" "+a[2]+" "+a[3]}var t=Dn,n=Pn,r=Es;return e.source=function(n){return arguments.length?(t=dt(n),e):t},e.target=function(t){return arguments.length?(n=dt(t),e):n},e.projection=function(t){return arguments.length?(r=t,e):r},e},wo.svg.diagonal.radial=function(){var e=wo.svg.diagonal(),t=Es,n=e.projection;return e.projection=function(e){return arguments.length?n(Ss(t=e)):t},e},wo.svg.symbol=function(){function e(e,r){return(Ba.get(t.call(this,e,r))||Ns)(n.call(this,e,r))}var t=Ts,n=xs;return e.type=function(n){return arguments.length?(t=dt(n),e):t},e.size=function(t){return arguments.length?(n=dt(t),e):n},e};var Ba=wo.map({circle:Ns,cross:function(e){var t=Math.sqrt(e/5)/2;return"M"+ -3*t+","+ -t+"H"+ -t+"V"+ -3*t+"H"+t+"V"+ -t+"H"+3*t+"V"+t+"H"+t+"V"+3*t+"H"+ -t+"V"+t+"H"+ -3*t+"Z"},diamond:function(e){var t=Math.sqrt(e/(2*qa)),n=t*qa;return"M0,"+ -t+"L"+n+",0"+" 0,"+t+" "+ -n+",0"+"Z"},square:function(e){var t=Math.sqrt(e)/2;return"M"+ -t+","+ -t+"L"+t+","+ -t+" "+t+","+t+" "+ -t+","+t+"Z"},"triangle-down":function(e){var t=Math.sqrt(e/Ia),n=t*Ia/2;return"M0,"+n+"L"+t+","+ -n+" "+ -t+","+ -n+"Z"},"triangle-up":function(e){var t=Math.sqrt(e/Ia),n=t*Ia/2;return"M0,"+ -n+"L"+t+","+n+" "+ -t+","+n+"Z"}});wo.svg.symbolTypes=Ba.keys();var ja,Fa,Ia=Math.sqrt(3),qa=Math.tan(30*ru),Ra=[],Ua=0;Ra.call=Uo.call,Ra.empty=Uo.empty,Ra.node=Uo.node,Ra.size=Uo.size,wo.transition=function(e){return arguments.length?ja?e.transition():e:Xo.transition()},wo.transition.prototype=Ra,Ra.select=function(e){var t,n,r,i=this.id,s=[];e=g(e);for(var o=-1,u=this.length;++o<u;){s.push(t=[]);for(var a=this[o],f=-1,l=a.length;++f<l;)(r=a[f])&&(n=e.call(r,r.__data__,f,o))?("__data__"in r&&(n.__data__=r.__data__),As(n,f,i,r.__transition__[i]),t.push(n)):t.push(null)}return Cs(s,i)},Ra.selectAll=function(e){var t,n,r,i,s,o=this.id,u=[];e=y(e);for(var a=-1,f=this.length;++a<f;)for(var l=this[a],c=-1,h=l.length;++c<h;)if(r=l[c]){s=r.__transition__[o],n=e.call(r,r.__data__,c,a),u.push(t=[]);for(var p=-1,d=n.length;++p<d;)(i=n[p])&&As(i,p,o,s),t.push(i)}return Cs(u,o)},Ra.filter=function(e){var t,n,r,i=[];"function"!=typeof e&&(e=L(e));for(var s=0,o=this.length;o>s;s++){i.push(t=[]);for(var n=this[s],u=0,a=n.length;a>u;u++)(r=n[u])&&e.call(r,r.__data__,u)&&t.push(r)}return Cs(i,this.id)},Ra.tween=function(e,t){var n=this.id;return arguments.length<2?this.node().__transition__[n].tween.get(e):O(this,null==t?function(t){t.__transition__[n].tween.remove(e)}:function(r){r.__transition__[n].tween.set(e,t)})},Ra.attr=function(e,t){function n(){this.removeAttribute(u)}function r(){this.removeAttributeNS(u.space,u.local)}function i(e){return null==e?n:(e+="",function(){var t,n=this.getAttribute(u);return n!==e&&(t=o(n,e),function(e){this.setAttribute(u,t(e))})})}function s(e){return null==e?r:(e+="",function(){var t,n=this.getAttributeNS(u.space,u.local);return n!==e&&(t=o(n,e),function(e){this.setAttributeNS(u.space,u.local,t(e))})})}if(arguments.length<2){for(t in e)this.attr(t,e[t]);return this}var o="transform"==e?Jr:Nr,u=wo.ns.qualify(e);return ks(this,"attr."+e,t,u.local?s:i)},Ra.attrTween=function(e,t){function n(e,n){var r=t.call(this,e,n,this.getAttribute(i));return r&&function(e){this.setAttribute(i,r(e))}}function r(e,n){var r=t.call(this,e,n,this.getAttributeNS(i.space,i.local));return r&&function(e){this.setAttributeNS(i.space,i.local,r(e))}}var i=wo.ns.qualify(e);return this.tween("attr."+e,i.local?r:n)},Ra.style=function(e,t,n){function r(){this.style.removeProperty(e)}function i(t){return null==t?r:(t+="",function(){var r,i=xo.getComputedStyle(this,null).getPropertyValue(e);return i!==t&&(r=Nr(i,t),function(t){this.style.setProperty(e,r(t),n)})})}var s=arguments.length;if(3>s){if("string"!=typeof e){2>s&&(t="");for(n in e)this.style(n,e[n],t);return this}n=""}return ks(this,"style."+e,t,i)},Ra.styleTween=function(e,t,n){function r(r,i){var s=t.call(this,r,i,xo.getComputedStyle(this,null).getPropertyValue(e));return s&&function(t){this.style.setProperty(e,s(t),n)}}return arguments.length<3&&(n=""),this.tween("style."+e,r)},Ra.text=function(e){return ks(this,"text",e,Ls)},Ra.remove=function(){return this.each("end.transition",function(){var e;!this.__transition__&&(e=this.parentNode)&&e.removeChild(this)})},Ra.ease=function(e){var t=this.id;return arguments.length<1?this.node().__transition__[t].ease:("function"!=typeof e&&(e=wo.ease.apply(wo,arguments)),O(this,function(n){n.__transition__[t].ease=e}))},Ra.delay=function(e){var t=this.id;return O(this,"function"==typeof e?function(n,r,i){n.__transition__[t].delay=0|e.call(n,n.__data__,r,i)}:(e|=0,function(n){n.__transition__[t].delay=e}))},Ra.duration=function(e){var t=this.id;return O(this,"function"==typeof e?function(n,r,i){n.__transition__[t].duration=Math.max(1,0|e.call(n,n.__data__,r,i))}:(e=Math.max(1,0|e),function(n){n.__transition__[t].duration=e}))},Ra.each=function(e,t){var n=this.id;if(arguments.length<2){var r=Fa,i=ja;ja=n,O(this,function(t,r,i){Fa=t.__transition__[n],e.call(t,t.__data__,r,i)}),Fa=r,ja=i}else O(this,function(r){var i=r.__transition__[n];(i.event||(i.event=wo.dispatch("start","end"))).on(e,t)});return this},Ra.transition=function(){for(var e,t,n,r,i=this.id,s=++Ua,o=[],u=0,a=this.length;a>u;u++){o.push(e=[]);for(var t=this[u],f=0,l=t.length;l>f;f++)(n=t[f])&&(r=Object.create(n.__transition__[i]),r.delay+=r.duration,As(n,f,s,r)),e.push(n)}return Cs(o,s)},wo.svg.axis=function(){function e(e){e.each(function(){var e,c=wo.select(this),h=null==f?n.ticks?n.ticks.apply(n,a):n.domain():f,p=null==t?n.tickFormat?n.tickFormat.apply(n,a):String:t,d=_s(n,h,l),v=c.selectAll(".tick.minor").data(d,String),m=v.enter().insert("line",".tick").attr("class","tick minor").style("opacity",1e-6),g=wo.transition(v.exit()).style("opacity",1e-6).remove(),y=wo.transition(v).style("opacity",1),b=c.selectAll(".tick.major").data(h,String),w=b.enter().insert("g",".domain").attr("class","tick major").style("opacity",1e-6),E=wo.transition(b.exit()).style("opacity",1e-6).remove(),S=wo.transition(b).style("opacity",1),x=Ji(n),T=c.selectAll(".domain").data([0]),N=(T.enter().append("path").attr("class","domain"),wo.transition(T)),C=n.copy(),k=this.__chart__||C;this.__chart__=C,w.append("line"),w.append("text");var L=w.select("line"),A=S.select("line"),O=b.select("text").text(p),M=w.select("text"),_=S.select("text");switch(r){case"bottom":e=Os,m.attr("y2",s),y.attr("x2",0).attr("y2",s),L.attr("y2",i),M.attr("y",Math.max(i,0)+u),A.attr("x2",0).attr("y2",i),_.attr("x",0).attr("y",Math.max(i,0)+u),O.attr("dy",".71em").style("text-anchor","middle"),N.attr("d","M"+x[0]+","+o+"V0H"+x[1]+"V"+o);break;case"top":e=Os,m.attr("y2",-s),y.attr("x2",0).attr("y2",-s),L.attr("y2",-i),M.attr("y",-(Math.max(i,0)+u)),A.attr("x2",0).attr("y2",-i),_.attr("x",0).attr("y",-(Math.max(i,0)+u)),O.attr("dy","0em").style("text-anchor","middle"),N.attr("d","M"+x[0]+","+ -o+"V0H"+x[1]+"V"+ -o);break;case"left":e=Ms,m.attr("x2",-s),y.attr("x2",-s).attr("y2",0),L.attr("x2",-i),M.attr("x",-(Math.max(i,0)+u)),A.attr("x2",-i).attr("y2",0),_.attr("x",-(Math.max(i,0)+u)).attr("y",0),O.attr("dy",".32em").style("text-anchor","end"),N.attr("d","M"+ -o+","+x[0]+"H0V"+x[1]+"H"+ -o);break;case"right":e=Ms,m.attr("x2",s),y.attr("x2",s).attr("y2",0),L.attr("x2",i),M.attr("x",Math.max(i,0)+u),A.attr("x2",i).attr("y2",0),_.attr("x",Math.max(i,0)+u).attr("y",0),O.attr("dy",".32em").style("text-anchor","start"),N.attr("d","M"+o+","+x[0]+"H0V"+x[1]+"H"+o)}if(n.rangeBand){var D=C.rangeBand()/2,P=function(e){return C(e)+D};w.call(e,P),S.call(e,P)}else w.call(e,k),S.call(e,C),E.call(e,C),m.call(e,k),y.call(e,C),g.call(e,C)})}var t,n=wo.scale.linear(),r=za,i=6,s=6,o=6,u=3,a=[10],f=null,l=0;return e.scale=function(t){return arguments.length?(n=t,e):n},e.orient=function(t){return arguments.length?(r=t in Wa?t+"":za,e):r},e.ticks=function(){return arguments.length?(a=arguments,e):a},e.tickValues=function(t){return arguments.length?(f=t,e):f},e.tickFormat=function(n){return arguments.length?(t=n,e):t},e.tickSize=function(t,n){if(!arguments.length)return i;var r=arguments.length-1;return i=+t,s=r>1?+n:i,o=r>0?+arguments[r]:i,e},e.tickPadding=function(t){return arguments.length?(u=+t,e):u},e.tickSubdivide=function(t){return arguments.length?(l=+t,e):l},e};var za="bottom",Wa={top:1,right:1,bottom:1,left:1};wo.svg.brush=function(){function e(s){s.each(function(){var s,o=wo.select(this),l=o.selectAll(".background").data([0]),c=o.selectAll(".extent").data([0]),h=o.selectAll(".resize").data(f,String);o.style("pointer-events","all").on("mousedown.brush",i).on("touchstart.brush",i),l.enter().append("rect").attr("class","background").style("visibility","hidden").style("cursor","crosshair"),c.enter().append("rect").attr("class","extent").style("cursor","move"),h.enter().append("g").attr("class",function(e){return"resize "+e}).style("cursor",function(e){return Xa[e]}).append("rect").attr("x",function(e){return/[ew]$/.test(e)?-3:null}).attr("y",function(e){return/^[ns]/.test(e)?-3:null}).attr("width",6).attr("height",6).style("visibility","hidden"),h.style("display",e.empty()?"none":null),h.exit().remove(),u&&(s=Ji(u),l.attr("x",s[0]).attr("width",s[1]-s[0]),n(o)),a&&(s=Ji(a),l.attr("y",s[0]).attr("height",s[1]-s[0]),r(o)),t(o)})}function t(e){e.selectAll(".resize").attr("transform",function(e){return"translate("+l[+/e$/.test(e)][0]+","+l[+/^s/.test(e)][1]+")"})}function n(e){e.select(".extent").attr("x",l[0][0]),e.selectAll(".extent,.n>rect,.s>rect").attr("width",l[1][0]-l[0][0])}function r(e){e.select(".extent").attr("y",l[0][1]),e.selectAll(".extent,.e>rect,.w>rect").attr("height",l[1][1]-l[0][1])}function i(){function i(){var e=wo.event.changedTouches;return e?wo.touches(b,e)[0]:wo.mouse(b)}function f(){32==wo.event.keyCode&&(C||(g=null,L[0]-=l[1][0],L[1]-=l[1][1],C=2),p())}function h(){32==wo.event.keyCode&&2==C&&(L[0]+=l[1][0],L[1]+=l[1][1],C=0,p())}function d(){var e=i(),s=!1;y&&(e[0]+=y[0],e[1]+=y[1]),C||(wo.event.altKey?(g||(g=[(l[0][0]+l[1][0])/2,(l[0][1]+l[1][1])/2]),L[0]=l[+(e[0]<g[0])][0],L[1]=l[+(e[1]<g[1])][1]):g=null),T&&v(e,u,0)&&(n(S),s=!0),N&&v(e,a,1)&&(r(S),s=!0),s&&(t(S),E({type:"brush",mode:C?"move":"resize"}))}function v(e,t,n){var r,i,o=Ji(t),u=o[0],a=o[1],f=L[n],h=l[1][n]-l[0][n];return C&&(u-=f,a-=h+f),r=c[n]?Math.max(u,Math.min(a,e[n])):e[n],C?i=(r+=f)+h:(g&&(f=Math.max(u,Math.min(a,2*g[n]-r))),r>f?(i=r,r=f):i=f),l[0][n]!==r||l[1][n]!==i?(s=null,l[0][n]=r,l[1][n]=i,!0):void 0}function m(){d(),S.style("pointer-events","all").selectAll(".resize").style("display",e.empty()?"none":null),wo.select("body").style("cursor",null),A.on("mousemove.brush",null).on("mouseup.brush",null).on("touchmove.brush",null).on("touchend.brush",null).on("keydown.brush",null).on("keyup.brush",null),k(),E({type:"brushend"})}var g,y,b=this,w=wo.select(wo.event.target),E=o.of(b,arguments),S=wo.select(b),x=w.datum(),T=!/^(n|s)$/.test(x)&&u,N=!/^(e|w)$/.test(x)&&a,C=w.classed("extent"),k=B(),L=i(),A=wo.select(xo).on("keydown.brush",f).on("keyup.brush",h);if(wo.event.changedTouches?A.on("touchmove.brush",d).on("touchend.brush",m):A.on("mousemove.brush",d).on("mouseup.brush",m),C)L[0]=l[0][0]-L[0],L[1]=l[0][1]-L[1];else if(x){var O=+/w$/.test(x),M=+/^n/.test(x);y=[l[1-O][0]-L[0],l[1-M][1]-L[1]],L[0]=l[O][0],L[1]=l[M][1]}else wo.event.altKey&&(g=L.slice());S.style("pointer-events","none").selectAll(".resize").style("display",null),wo.select("body").style("cursor",w.style("cursor")),E({type:"brushstart"}),d()}var s,o=v(e,"brushstart","brush","brushend"),u=null,a=null,f=Va[0],l=[[0,0],[0,0]],c=[!0,!0];return e.x=function(t){return arguments.length?(u=t,f=Va[!u<<1|!a],e):u},e.y=function(t){return arguments.length?(a=t,f=Va[!u<<1|!a],e):a},e.clamp=function(t){return arguments.length?(u&&a?c=[!!t[0],!!t[1]]:(u||a)&&(c[+!u]=!!t),e):u&&a?c:u||a?c[+!u]:null},e.extent=function(t){var n,r,i,o,f;return arguments.length?(s=[[0,0],[0,0]],u&&(n=t[0],r=t[1],a&&(n=n[0],r=r[0]),s[0][0]=n,s[1][0]=r,u.invert&&(n=u(n),r=u(r)),n>r&&(f=n,n=r,r=f),l[0][0]=0|n,l[1][0]=0|r),a&&(i=t[0],o=t[1],u&&(i=i[1],o=o[1]),s[0][1]=i,s[1][1]=o,a.invert&&(i=a(i),o=a(o)),i>o&&(f=i,i=o,o=f),l[0][1]=0|i,l[1][1]=0|o),e):(t=s||l,u&&(n=t[0][0],r=t[1][0],s||(n=l[0][0],r=l[1][0],u.invert&&(n=u.invert(n),r=u.invert(r)),n>r&&(f=n,n=r,r=f))),a&&(i=t[0][1],o=t[1][1],s||(i=l[0][1],o=l[1][1],a.invert&&(i=a.invert(i),o=a.invert(o)),i>o&&(f=i,i=o,o=f))),u&&a?[[n,i],[r,o]]:u?[n,r]:a&&[i,o])},e.clear=function(){return s=null,l[0][0]=l[0][1]=l[1][0]=l[1][1]=0,e},e.empty=function(){return u&&l[0][0]===l[1][0]||a&&l[0][1]===l[1][1]},wo.rebind(e,o,"on")};var Xa={n:"ns-resize",e:"ew-resize",s:"ns-resize",w:"ew-resize",nw:"nwse-resize",ne:"nesw-resize",se:"nwse-resize",sw:"nesw-resize"},Va=[["n","e","s","w","nw","ne","se","sw"],["e","w"],["n","s"],[]];wo.time={};var $a=Date,Ja=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"];Ds.prototype={getDate:function(){return this._.getUTCDate()},getDay:function(){return this._.getUTCDay()},getFullYear:function(){return this._.getUTCFullYear()},getHours:function(){return this._.getUTCHours()},getMilliseconds:function(){return this._.getUTCMilliseconds()},getMinutes:function(){return this._.getUTCMinutes()},getMonth:function(){return this._.getUTCMonth()},getSeconds:function(){return this._.getUTCSeconds()},getTime:function(){return this._.getTime()},getTimezoneOffset:function(){return 0},valueOf:function(){return this._.valueOf()},setDate:function(){Ka.setUTCDate.apply(this._,arguments)},setDay:function(){Ka.setUTCDay.apply(this._,arguments)},setFullYear:function(){Ka.setUTCFullYear.apply(this._,arguments)},setHours:function(){Ka.setUTCHours.apply(this._,arguments)},setMilliseconds:function(){Ka.setUTCMilliseconds.apply(this._,arguments)},setMinutes:function(){Ka.setUTCMinutes.apply(this._,arguments)},setMonth:function(){Ka.setUTCMonth.apply(this._,arguments)},setSeconds:function(){Ka.setUTCSeconds.apply(this._,arguments)},setTime:function(){Ka.setTime.apply(this._,arguments)}};var Ka=Date.prototype,Qa="%a %b %e %X %Y",Ga="%m/%d/%Y",Ya="%H:%M:%S",Za=["Sunday","Monday","Tuesday","Wednesday","Thursday","Friday","Saturday"],ef=["Sun","Mon","Tue","Wed","Thu","Fri","Sat"],tf=["January","February","March","April","May","June","July","August","September","October","November","December"],nf=["Jan","Feb","Mar","Apr","May","Jun","Jul","Aug","Sep","Oct","Nov","Dec"];wo.time.year=Ps(function(e){return e=wo.time.day(e),e.setMonth(0,1),e},function(e,t){e.setFullYear(e.getFullYear()+t)},function(e){return e.getFullYear()}),wo.time.years=wo.time.year.range,wo.time.years.utc=wo.time.year.utc.range,wo.time.day=Ps(function(e){var t=new $a(2e3,0);return t.setFullYear(e.getFullYear(),e.getMonth(),e.getDate()),t},function(e,t){e.setDate(e.getDate()+t)},function(e){return e.getDate()-1}),wo.time.days=wo.time.day.range,wo.time.days.utc=wo.time.day.utc.range,wo.time.dayOfYear=function(e){var t=wo.time.year(e);return Math.floor((e-t-6e4*(e.getTimezoneOffset()-t.getTimezoneOffset()))/864e5)},Ja.forEach(function(e,t){e=e.toLowerCase(),t=7-t;var n=wo.time[e]=Ps(function(e){return(e=wo.time.day(e)).setDate(e.getDate()-(e.getDay()+t)%7),e},function(e,t){e.setDate(e.getDate()+7*Math.floor(t))},function(e){var n=wo.time.year(e).getDay();return Math.floor((wo.time.dayOfYear(e)+(n+t)%7)/7)-(n!==t)});wo.time[e+"s"]=n.range,wo.time[e+"s"].utc=n.utc.range,wo.time[e+"OfYear"]=function(e){var n=wo.time.year(e).getDay();return Math.floor((wo.time.dayOfYear(e)+(n+t)%7)/7)}}),wo.time.week=wo.time.sunday,wo.time.weeks=wo.time.sunday.range,wo.time.weeks.utc=wo.time.sunday.utc.range,wo.time.weekOfYear=wo.time.sundayOfYear,wo.time.format=function(e){function t(t){for(var r,i,s,o=[],u=-1,a=0;++u<n;)37===e.charCodeAt(u)&&(o.push(e.substring(a,u)),null!=(i=pf[r=e.charAt(++u)])&&(r=e.charAt(++u)),(s=df[r])&&(r=s(t,null==i?"e"===r?" ":"0":i)),o.push(r),a=u+1);return o.push(e.substring(a,u)),o.join("")}var n=e.length;return t.parse=function(t){var n={y:1900,m:0,d:1,H:0,M:0,S:0,L:0},r=Bs(n,e,t,0);if(r!=t.length)return null;"p"in n&&(n.H=n.H%12+12*n.p);var i=new $a;return"j"in n?i.setFullYear(n.y,0,n.j):"w"in n&&("W"in n||"U"in n)?(i.setFullYear(n.y,0,1),i.setFullYear(n.y,0,"W"in n?(n.w+6)%7+7*n.W-(i.getDay()+5)%7:n.w+7*n.U-(i.getDay()+6)%7)):i.setFullYear(n.y,n.m,n.d),i.setHours(n.H,n.M,n.S,n.L),i},t.toString=function(){return e},t};var rf=js(Za),sf=Fs(Za),of=js(ef),uf=Fs(ef),af=js(tf),ff=Fs(tf),lf=js(nf),cf=Fs(nf),hf=/^%/,pf={"-":"",_:" ",0:"0"},df={a:function(e){return ef[e.getDay()]},A:function(e){return Za[e.getDay()]},b:function(e){return nf[e.getMonth()]},B:function(e){return tf[e.getMonth()]},c:wo.time.format(Qa),d:function(e,t){return Is(e.getDate(),t,2)},e:function(e,t){return Is(e.getDate(),t,2)},H:function(e,t){return Is(e.getHours(),t,2)},I:function(e,t){return Is(e.getHours()%12||12,t,2)},j:function(e,t){return Is(1+wo.time.dayOfYear(e),t,3)},L:function(e,t){return Is(e.getMilliseconds(),t,3)},m:function(e,t){return Is(e.getMonth()+1,t,2)},M:function(e,t){return Is(e.getMinutes(),t,2)},p:function(e){return e.getHours()>=12?"PM":"AM"},S:function(e,t){return Is(e.getSeconds(),t,2)},U:function(e,t){return Is(wo.time.sundayOfYear(e),t,2)},w:function(e){return e.getDay()},W:function(e,t){return Is(wo.time.mondayOfYear(e),t,2)},x:wo.time.format(Ga),X:wo.time.format(Ya),y:function(e,t){return Is(e.getFullYear()%100,t,2)},Y:function(e,t){return Is(e.getFullYear()%1e4,t,4)},Z:uo,"%":function(){return"%"}},vf={a:qs,A:Rs,b:Xs,B:Vs,c:$s,d:eo,e:eo,H:no,I:no,j:to,L:so,m:Zs,M:ro,p:oo,S:io,U:zs,w:Us,W:Ws,x:Js,X:Ks,y:Gs,Y:Qs,"%":ao},mf=/^\s*\d+/,gf=wo.map({am:0,pm:1});wo.time.format.utc=function(e){function t(e){try{$a=Ds;var t=new $a;return t._=e,n(t)}finally{$a=Date}}var n=wo.time.format(e);return t.parse=function(e){try{$a=Ds;var t=n.parse(e);return t&&t._}finally{$a=Date}},t.toString=n.toString,t};var yf=wo.time.format.utc("%Y-%m-%dT%H:%M:%S.%LZ");wo.time.format.iso=Date.prototype.toISOString&&+(new Date("2000-01-01T00:00:00.000Z"))?fo:yf,fo.parse=function(e){var t=new Date(e);return isNaN(t)?null:t},fo.toString=yf.toString,wo.time.second=Ps(function(e){return new $a(1e3*Math.floor(e/1e3))},function(e,t){e.setTime(e.getTime()+1e3*Math.floor(t))},function(e){return e.getSeconds()}),wo.time.seconds=wo.time.second.range,wo.time.seconds.utc=wo.time.second.utc.range,wo.time.minute=Ps(function(e){return new $a(6e4*Math.floor(e/6e4))},function(e,t){e.setTime(e.getTime()+6e4*Math.floor(t))},function(e){return e.getMinutes()}),wo.time.minutes=wo.time.minute.range,wo.time.minutes.utc=wo.time.minute.utc.range,wo.time.hour=Ps(function(e){var t=e.getTimezoneOffset()/60;return new $a(36e5*(Math.floor(e/36e5-t)+t))},function(e,t){e.setTime(e.getTime()+36e5*Math.floor(t))},function(e){return e.getHours()}),wo.time.hours=wo.time.hour.range,wo.time.hours.utc=wo.time.hour.utc.range,wo.time.month=Ps(function(e){return e=wo.time.day(e),e.setDate(1),e},function(e,t){e.setMonth(e.getMonth()+t)},function(e){return e.getMonth()}),wo.time.months=wo.time.month.range,wo.time.months.utc=wo.time.month.utc.range;var bf=[1e3,5e3,15e3,3e4,6e4,3e5,9e5,18e5,36e5,108e5,216e5,432e5,864e5,1728e5,6048e5,2592e6,7776e6,31536e6],wf=[[wo.time.second,1],[wo.time.second,5],[wo.time.second,15],[wo.time.second,30],[wo.time.minute,1],[wo.time.minute,5],[wo.time.minute,15],[wo.time.minute,30],[wo.time.hour,1],[wo.time.hour,3],[wo.time.hour,6],[wo.time.hour,12],[wo.time.day,1],[wo.time.day,2],[wo.time.week,1],[wo.time.month,1],[wo.time.month,3],[wo.time.year,1]],Ef=[[wo.time.format("%Y"),Xt],[wo.time.format("%B"),function(e){return e.getMonth()}],[wo.time.format("%b %d"),function(e){return 1!=e.getDate()}],[wo.time.format("%a %d"),function(e){return e.getDay()&&1!=e.getDate()}],[wo.time.format("%I %p"),function(e){return e.getHours()}],[wo.time.format("%I:%M"),function(e){return e.getMinutes()}],[wo.time.format(":%S"),function(e){return e.getSeconds()}],[wo.time.format(".%L"),function(e){return e.getMilliseconds()}]],Sf=wo.scale.linear(),xf=ho(Ef);wf.year=function(e,t){return Sf.domain(e.map(vo)).ticks(t).map(po)},wo.time.scale=function(){return lo(wo.scale.linear(),wf,xf)};var Tf=wf.map(function(e){return[e[0].utc,e[1]]}),Nf=[[wo.time.format.utc("%Y"),Xt],[wo.time.format.utc("%B"),function(e){return e.getUTCMonth()}],[wo.time.format.utc("%b %d"),function(e){return 1!=e.getUTCDate()}],[wo.time.format.utc("%a %d"),function(e){return e.getUTCDay()&&1!=e.getUTCDate()}],[wo.time.format.utc("%I %p"),function(e){return e.getUTCHours()}],[wo.time.format.utc("%I:%M"),function(e){return e.getUTCMinutes()}],[wo.time.format.utc(":%S"),function(e){return e.getUTCSeconds()}],[wo.time.format.utc(".%L"),function(e){return e.getUTCMilliseconds()}]],Cf=ho(Nf);return Tf.year=function(e,t){return Sf.domain(e.map(go)).ticks(t).map(mo)},wo.time.scale.utc=function(){return lo(wo.scale.linear(),Tf,Cf)},wo.text=mt(function(e){return e.responseText}),wo.json=function(e,t){return gt(e,"application/json",yo,t)},wo.html=function(e,t){return gt(e,"text/html",bo,t)},wo.xml=mt(function(e){return e.responseXML}),wo}(),define("d3",function(){}),define("kbaseVisWidget",["jquery","d3","kbwidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseVisWidget",version:"1.0.0",options:{xGutter:20,xPadding:30,yGutter:20,yPadding:30,xScaleType:"linear",yScaleType:"linear",useIDMapping:!1,bgColor:"white",scaleXAxis:!1,scaleYAxis:!1,scaleAxes:!1,useUniqueID:!1,transitionTime:1750,ulIcon:"/narrative/static/kbase/js/ui-common/root/img/labs_icon.png",ticker:0,radialGradientStopColor:"black",linearGradientStopColor:"black",defaultDataset:function(){return[]},width:"100%",height:"100%"},shouldScaleAxis:function(e){return this.options.scaleAxes?!0:e=="x"&&this.options.scaleXAxis?!0:e=="y"&&this.options.scaleYAxis?!0:!1},_accessors:["xGutter","xPadding","yGutter","yPadding","width","height",{name:"dataset",setter:"setDataset"},{name:"input",setter:"setInput"},{name:"xLabel",setter:"setXLabel"},{name:"yLabel",setter:"setYLabel"},{name:"xScale",setter:"setXScale"},{name:"yScale",setter:"setYScale"},"xScaleType","yScaleType","yHeightScaleType","xIDMap","yIDMap","radialGradients","linearGradients","children"],input:function(){return this.dataset()},setInput:function(t){return e.isPlainObject(t)&&t.dataset!=undefined?this.setValuesForKeys(t):this.setDataset(t)},setXLabel:function(e){this.setValueForKey("xLabel",e),this.render("xLabel")},setYLabel:function(e){this.setValueForKey("yLabel",e),this.render("yLabel")},setXScale:function(e){this.setValueForKey("xScale",e),this.render("xAxis")},setYScale:function(e){this.setValueForKey("yScale",e),this.render("yAxis")},createIDMapForDomain:function(t){var n={};return e.each(t,function(e,t){n[e]=t}),n},setXScaleDomain:function(e,t){var n=this.xScale();return n==undefined&&(t==undefined&&(t=this.xScaleType()||this.options.xScaleType),n=d3.scale[t](),this.setXScaleRange([0,this.chartBounds().size.width],n),this.setValueForKey("xScale",n)),n.domain(e),this.options.useIDMapping&&this.xIDMap()==undefined&&this.xIDMap(this.createIDMapForDomain(e)),this.render("xAxis"),n},setXScaleRange:function(e,t){return t==undefined&&(t=this.xScale()),t.range(e),t},setYScaleDomain:function(e,t){var n=this.yScale();return n==undefined&&(t==undefined&&(t=this.yScaleType()||this.options.yScaleType),n=d3.scale[t](),this.setYScaleRange([0,this.chartBounds().size.height],n),this.setValueForKey("yScale",n)),n.domain(e),this.options.useIDMapping&&this.yIDMap()==undefined&&this.yIDMap(this.createIDMapForDomain(e)),this.render("yAxis"),n},setYScaleRange:function(e,t){return t==undefined&&(t=this.yScale()),t.range(e),t},init:function(t){return this._super(t),this.children()==undefined&&this.children([]),this.options.transformations==undefined&&(this.options.transformations={}),this.radialGradients()==undefined&&this.radialGradients({}),this.linearGradients()==undefined&&this.linearGradients({}),this.options.chartID==undefined&&(this.options.chartID=this.uuid()),this.ticker=function(){return++this.options.ticker},this.uniqueID=e.proxy(function(e){return e.id==undefined&&(e.id=this.ticker()),e.id},this),this.options.width!=undefined&&this.options.width.match(/px/)?this.width(parseInt(this.options.width)):this.width(this.$elem.width()),this.options.height!=undefined&&this.options.height.match(/px/)?this.height(parseInt(this.options.height)):this.height(this.$elem.height()),this.appendUI(this.$elem),this.xScale()&&this.setXScaleRange([0,this.chartBounds().size.width],this.xScale()),this.yScale()&&this.setYScaleRange([0,this.chartBounds().size.height],this.yScale()),this.callAfterInit(e.proxy(function(){this.render()},this)),this},render:function(e){if(!this._init)return;(e==undefined||e=="chart")&&this.renderChart(),(e==undefined||e=="xAxis")&&this.renderXAxis(),(e==undefined||e=="yAxis")&&this.renderYAxis(),(e==undefined||e=="xLabel")&&this.renderXLabel(),(e==undefined||e=="yLabel")&&this.renderYLabel(),(e==undefined||e=="ulCorner")&&this.renderULCorner()},renderULCorner:function(){var e=this.ULBounds(),t=new Size(e.size.width,e.size.height),n=5;t.width-=n,t.height-=n,t.width>t.height?t.width=t.height:t.height>t.width&&(t.height=t.width);if(t.width<25)return;var r=[this.options.ulIcon];if(this.options.ulIcon){var i=this.D3svg().select(this.region("UL")).selectAll(".ULLabel");i.data(r).enter().append("image").attr("x",n/2).attr("y",n/2).attr("width",t.width).attr("height",t.height).attr("xlink:href",function(e){return e})}},setDataset:function(e){e==undefined&&(e=this.options.defaultDataset()),this.setValueForKey("dataset",e),this.shouldScaleAxis("x")&&this.setXScaleDomain(this.defaultXDomain()),this.shouldScaleAxis("y")&&this.setYScaleDomain(this.defaultYDomain()),this.render()},setDatasets:function(t){t==undefined&&(t=[]),this.children()==undefined&&this.children([]);var n=t.shift(),r=this,i=function(){r.setDataset(n);for(var i=0;i<t.length;i++){var s;if(i<r.children().length)s=r.children()[i],s.reenter(i,t[i],r);else{var o=r.childOptions(r.children().length,t[i]);o.parent=r,s=e.jqElem("div")[r.name](o),r.children().push(s)}s.setDataset(t[i])}for(var i=t.length;i<r.children().length;i++)r.children()[i].setDataset(undefined);r.render()};this.callAfterInit(i)},reenter:function(e,t,n){},childOptions:function(t,n){return e.extend(!0,{},n.options||this.options.childOptions||this.options)},defaultXDomain:function(){return[0,100]},defaultYDomain:function(){return[0,100]},renderXLabel:function(){var e=this.yGutterBounds(),t=[this.xLabel()],n=this.D3svg().select(this.region("yGutter")).selectAll(".xLabel");n.data(t).text(this.xLabel()).enter().append("text").attr("class","xLabel").attr("x",e.size.width/2).attr("y",e.size.height/2+3).attr("text-anchor","middle").attr("font-size","11px").attr("font-family","sans-serif").attr("fill","black").text(this.xLabel())},renderYLabel:function(){var e=this.xGutterBounds(),t=[this.yLabel()],n=this.D3svg().select(this.region("xGutter")).selectAll(".yLabel");n.data(t).text(this.yLabel()).enter().append("text").attr("class","yLabel").attr("x",e.size.width/2).attr("y",e.size.height/2+3).attr("text-anchor","middle").attr("font-size","11px").attr("font-family","sans-serif").attr("fill","black").attr("transform","rotate(90,"+(e.size.width/2-7)+","+e.size.height/2+")").text(this.yLabel())},xTickValues:function(){return},xTickLabel:function(e){return e},renderXAxis:function(){var e=this;if(this.xScale()==undefined||this.xScale().domain==undefined)return;var t=d3.svg.axis().scale(this.xScale()).orient("bottom"),n=this.xTickValues();n!=undefined&&t.tickValues(n).tickSubdivide(0).tickFormat(function(t){return e.xTickLabel.call(e,t)});var r=this.D3svg().select(this.region("yPadding")).select(".xAxis");r[0][0]==undefined&&(r=this.D3svg().select(this.region("yPadding")).append("g").attr("class","xAxis axis")),r.transition().call(t)},svg2HTML:function(){var t=e.jqElem("div").append(this.data("$svg"));return t.html()},renderYAxis:function(){if(this.yScale()==undefined)return;var e=d3.svg.axis().scale(this.yScale()).orient("left"),t=this.D3svg().select(this.region("xPadding")).select(".yAxis");t[0][0]==undefined&&(t=this.D3svg().select(this.region("xPadding")).append("g").attr("class","yAxis axis").attr("transform","translate("+this.xPaddingBounds().size.width+",0)")),t.transition().call(e)},renderChart:function(){},setGutter:function(e){this.xGutter(e),this.yGutter(e)},setPadding:function(e){this.xPadding(e),this.yPadding(e)},appendUI:function(t){var n;if(!this.options.parent){t.append(e.jqElem("style").html(".axis path, .axis line { fill : none; stroke : black; shape-rendering : crispEdges;} .axis text                             {font-family : sans-serif; font-size : 11px}")),n=d3.select(t.get(0)).append("svg").attr("style","width : "+this.options.width+"; height : "+this.options.height);var r=d3.select("body").selectAll(".visToolTip").data([0]).enter().append("div").attr("class","visToolTip").style({position:"absolute","max-width":"300px",height:"auto",padding:"10px","background-color":"white","-webkit-border-radius":"10px","-moz-border-radius":"10px","border-radius":"10px","-webkit-box-shadow":"4px 4px 10px rgba(0, 0, 0, 0.4)","-moz-box-shadow":"4px 4px 10px rgba(0, 0, 0, 0.4)","box-shadow":"4px 4px 10px rgba(0, 0, 0, 0.4)","pointer-events":"none",display:"none","font-family":"sans-serif","font-size":"12px","line-height":"20px",display:"none"});this.data("D3svg",n)}else this.$elem=this.options.parent.$elem,this.width(this.$elem.width()),this.height(this.$elem.height()),n=this.D3svg();var i=["chart","UL","UR","LL","LR","yGutter","xGutter","yPadding","xPadding"],s=["red","green","blue","cyan","magenta","yellow","purple","orange","gray"];n.selectAll("defs").data([null]).enter().append("defs").attr("class","definitions");var o=this,u=n.selectAll("g").data(i).enter().append("g").attr("class",function(e){return e}).attr("data-x",e.proxy(function(e){var t=this[e+"Bounds"]();return t.origin.x},this)).attr("data-y",e.proxy(function(e){var t=this[e+"Bounds"]();return t.origin.y},this)).attr("data-width",e.proxy(function(e){var t=this[e+"Bounds"]();return t.size.width},this)).attr("data-height",e.proxy(function(e){var t=this[e+"Bounds"]();return t.size.height},this)).attr("transform",e.proxy(function(e){var t=this[e+"Bounds"]();return"translate("+t.origin.x+","+t.origin.y+")"},this));u.append("rect").attr("x",0).attr("y",0).attr("width",e.proxy(function(e){var t=this[e+"Bounds"]();return t.size.width},this)).attr("height",e.proxy(function(e){var t=this[e+"Bounds"]();return t.size.height},this)).attr("fill",function(e){return o.options.debug?s.shift():o.options.bgColor}).attr("class","background"),e.each(i,function(t,r){n.selectAll("."+r).selectAll("g").data([{region:o.region(r,!0),r:r}],function(e){return e.region}).enter().append("g").attr("class",function(e){return e.region}).attr("transform",function(t){var n=o.options.transformations[t.r]||o.options.transformations.global;if(n==undefined)return;return n=e.extend(!0,{translate:{x:0,y:0},scale:{width:1,height:1}},n),"translate("+n.translate.x+","+n.translate.y+")"+" scale("+n.scale.width+","+n.scale.height+")"})})},D3svg:function(){return this.options.parent?this.options.parent.D3svg():this.data("D3svg")},region:function(e,t){var n="";return t||(n="."),n+e+"-"+this.options.chartID},ULBounds:function(){return new Rectangle(new Point(0,0),new Size(this.xPadding(),this.yGutter()))},URBounds:function(){return new Rectangle(new Point(this.xPadding()+this.chartBounds().size.width,0),new Size(this.xGutter(),this.yGutter()))},LLBounds:function(){return new Rectangle(new Point(0,this.yGutter()+this.chartBounds().size.height),new Size(this.xPadding(),this.yPadding()))},LRBounds:function(){return new Rectangle(new Point(this.xPadding()+this.chartBounds().size.width,this.yGutter()+this.chartBounds().size.height),new Size(this.xPadding(),this.yPadding()))},xPaddingBounds:function(){return new Rectangle(new Point(0,this.yGutter()),new Size(this.xPadding(),this.chartBounds().size.height))},xGutterBounds:function(){return new Rectangle(new Point(this.xPadding()+this.chartBounds().size.width,this.yGutter()),new Size(this.xGutter(),this.chartBounds().size.height))},yGutterBounds:function(){return new Rectangle(new Point(this.xPadding(),0),new Size(this.chartBounds().size.width,this.yGutter()))},yPaddingBounds:function(){return new Rectangle(new Point(this.xPadding(),this.yGutter()+this.chartBounds().size.height),new Size(this.chartBounds().size.width,this.yPadding()))},chartBounds:function(){var e=this.width(),t=this.height();return new Rectangle(new Point(this.xPadding(),this.yGutter()),new Size(e-this.xPadding()-this.xGutter(),t-this.yGutter()-this.yPadding()))},showToolTip:function(e){e.event==undefined&&(e.event=d3.event),d3.selectAll(".visToolTip").style("display","block").html(e.label).style("left",e.event.pageX+10+"px").style("top",e.event.pageY-10+"px")},hideToolTip:function(e){d3.selectAll(".visToolTip").style("display","none")},radialGradient:function(t){t=e.extend(!0,{cx:0,cy:0,stopColor:this.options.radialGradientStopColor,r:this.chartBounds().size.width/2},t);var n=[t.cx,t.cy,t.r,t.startColor,t.stopColor].join(",");this.radialGradients()[n]!=undefined&&t.id==undefined&&(t.id=this.radialGradients()[n]),t.id==undefined&&(t.id=this.uuid());var r=this.D3svg().select(".definitions").selectAll("#"+t.id).data([t]),i=!1;r.enter().append("radialGradient").attr("id",function(e){return i=!0,e.id}).attr("gradientUnits","userSpaceOnUse").attr("cx",function(e){return e.cx}).attr("cy",function(e){return e.cy}).attr("r",function(e){return 2.5*e.r}).attr("spreadMethod","pad");var s=i?0:this.options.transitionTime,o=r.selectAll('stop[offset="0%"]').data([t]);o.enter().append("stop").attr("offset","0%"),o.transition().duration(s).attr("stop-color",function(e){return e.startColor});var u=r.selectAll('stop[offset="30%"]').data([t]);u.enter().append("stop").attr("offset","30%").attr("stop-opacity",1),u.transition().duration(s).attr("stop-color",function(e){return e.startColor});var a=r.selectAll('stop[offset="70%"]').data([t]);return a.enter().append("stop").attr("stop-opacity",1).attr("offset","70%"),a.transition().duration(s).attr("stop-color",function(e){return e.stopColor}),this.radialGradients()[n]=t.id},linearGradient:function(t){var n=this.chartBounds();t=e.extend(!0,{x1:0,x2:0,y1:n.size.height,y2:0,width:0,height:n.size.height},t);var r=[t.cx,t.cy,t.r,t.startColor,t.stopColor].join(",");this.linearGradients()[r]!=undefined&&t.id==undefined&&(t.id=this.linearGradients()[r]),t.id==undefined&&(t.id=this.uuid());var i=this.D3svg().select(".definitions").selectAll("#"+t.id).data([t]),s=!1;i.enter().append("linearGradient").attr("id",function(e){return s=!0,e.id}).attr("gradientUnits","userSpaceOnUse").attr("x1",function(e){return e.x1}).attr("x2",function(e){return e.x2}).attr("y1",function(e){return e.y1}).attr("y2",function(e){return e.y2}).attr("spreadMethod","pad");var o=s?0:this.options.transitionTime,u=i.selectAll("stop").data(t.colors);return u.enter().append("stop"),u.transition().duration(o).attr("offset",function(e,n){var r=0;return n==t.colors.length-1?r=1:n>0&&(r=n/(t.colors.length-1)),Math.round(1e4*r)/100+"%"}).attr("stop-color",function(e){return e}),this.linearGradients()[r]=t.id},wrap:function(e,t,n){n==undefined&&(n=function(){return 0}),e.each(function(){var e=d3.select(this),r=e.text().split(/\s+/).reverse(),i,s=[],o=0,u=1.1,a=e.attr("y"),f=parseFloat(e.attr("dy"))||0,l=e.text(null).append("tspan").attr("x",n).attr("y",a).attr("dy",f+"em");while(i=r.pop())s.push(i),l.text(s.join(" ")),l.node().getComputedTextLength()>t&&(s.pop(),l.text(s.join(" ")),s=[i],l=e.append("tspan").attr("x",n).attr("y",a).attr("dy",u+"em").text(i))})},absPos:function(e){var t=e.getBBox(),n=e.getScreenCTM();return{x:t.x+n.e,y:t.y+n.f}},endall:function(e,t){var n=0;e.each(function(){++n}).each("end",function(){--n||t.apply(this,arguments)})},uniqueness:function(e){return e==undefined&&(e=this.uniqueID),this.options.useUniqueID?e:undefined}})}),define("kbaseBarchart",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseBarchart",parent:"kbaseVisWidget",version:"1.0.0",options:{xScaleType:"ordinal",overColor:"yellow",strokeWidth:"2"},_accessors:[],defaultXDomain:function(){return this.dataset()==undefined?[0,0]:this.dataset().map(function(e){return e.bar})},defaultYDomain:function(){if(this.dataset()==undefined)return[0,0];var t=.9*d3.min(this.dataset().map(function(t){return e.isArray(t.value)?t.stacked?d3.sum(t.value):d3.min(t.value):t.value}));return t>0&&(t=0),[t,1.1*d3.max(this.dataset().map(function(t){return e.isArray(t.value)?t.stacked?d3.sum(t.value):d3.max(t.value):t.value}))]},renderChart:function(){if(this.dataset()==undefined)return;var t=this.chartBounds(),n=this,r=function(t,r,i){return this.attr("width",t.rangeBand()).attr("height",function(e,t){return Math.abs(n.yScale()(0)-n.yScale()(e))}).attr("x",function(e,i){var s=r.bar;return n.options.useIDMapping&&(s=n.xIDMap()[s]),n.xScale()(s)+t(i)}).attr("y",function(t,i){var s=t;return r.stacked&&e.isArray(r.value)&&(s=d3.sum(r.value.slice(0,i+1))),n.yScale()(Math.max(0,s))}).attr("fill",function(e,t){return r.color[t%r.color.length]}).attr("stroke",function(e,t){return r.stroke?r.stroke[t%r.stroke.length]:"none"}).attr("stroke-width",function(e,t){return r.strokeWidth||n.options.strokeWidth}).attr("data-fill",function(e,t){return r.color[t%r.color.length]}),this},i=function(e,t){return this.on("mouseover",function(t,r){var i=e.bar;n.options.useIDMapping&&(i=n.xIDMap()[i]);if(n.options.overColor){d3.select(this).attr("stroke",n.options.overColor).attr("stroke-width",3),n.data("D3svg").select(".yPadding").selectAll("g g text").attr("fill",function(e,t){return e==i?n.options.overColor:"black"});var s=i;e.value.length>1&&(s+="["+(r+1)+"]");var o=e.label!=undefined?e.label[r%e.label.length]:s+" is "+e.value[r%e.value.length];o!=undefined&&n.showToolTip({label:o})}}).on("mouseout",function(t,r){n.options.overColor&&(d3.select(this).transition().attr("stroke",function(t){return e.stroke?e.stroke[r%e.stroke.length]:"none"}).attr("stroke-width",function(t){return e.strokeWidth||n.options.strokeWidth}),n.data("D3svg").select(".yPadding").selectAll("g g text").attr("fill",function(e,t){return"black"}),n.hideToolTip())}),this},s=function(){return this.each(function(t,s){t.value!=undefined&&!e.isArray(t.value)&&(t.value=[t.value]),t.color!=undefined&&!e.isArray(t.color)&&(t.color=[t.color]),t.stroke!=undefined&&!e.isArray(t.stroke)&&(t.stroke=[t.stroke]),t.label!=undefined&&!e.isArray(t.label)&&(t.label=[t.label]);var o=t.value;t.stacked&&e.isArray(t.value)&&(o=[d3.sum(t.value)]);var u=d3.scale.ordinal().domain(o).rangeBands([0,n.xScale().rangeBand()],.05);d3.select(this).selectAll(".bar").data(t.value).enter().append("rect").attr("class","bar").call(function(){return r.call(this,u,t,s)}),d3.select(this).selectAll(".bar").data(t.value).call(function(){return i.call(this,t,s)}).transition().duration(n.options.transitionTime).call(function(){return r.call(this,u,t,s)})}),this},o=this.D3svg().select(this.region("chart")).selectAll(".barGroup");o.data(this.dataset()).enter().append("g").attr("class","barGroup").call(s),o.data(this.dataset()).call(s),o.data(this.dataset()).exit().remove()},setXScaleRange:function(e,t){return t==undefined&&(t=this.xScale()),t.rangeBands(e,.05),t},setYScaleRange:function(e,t){return this._super(e.reverse(),t.nice())}})}),define("kbaseHistogram",["jquery","d3","kbaseBarchart"],function(e){e.KBWidget({name:"kbaseHistogram",parent:"kbaseBarchart",version:"1.0.0",options:{scaleAxes:!0,height:"500px",xPadding:80,yPadding:40},_accessors:["minBin","maxBin"],setDataset:function(t){e.isArray(t.data)||(t=t.data);var n=[],r=0;for(r=0;r<t.data[0].length-1;r++){var i=t.data[0][r],s=t.data[1][r],o=r<t.data[0].length-1?" to "+t.data[0][r+1]:" and up",u="Bin "+i+o;n.push({bar:u,value:s,color:"white",stroke:"black",strokeWidth:1})}this.setYLabel(t.column_labels[0]),this.setXLabel(t.row_labels[0]),this.minBin(t.data[0][0]),this.maxBin(t.data[0][t.data[0].length-1]),this._super(n)},renderXAxis:function(){if(this.xScale()==undefined||this.xScale().domain==undefined)return;var e=d3.scale.linear().domain([this.minBin(),this.maxBin()]).range([0,this.chartBounds().size.width]),t=d3.svg.axis().scale(e).orient("bottom").ticks(10),n=this.D3svg().select(".yPadding").select(".xAxis");n[0][0]==undefined&&(n=this.D3svg().select(".yPadding").append("g").attr("class","xAxis axis"));var r=this;n.transition().duration(0).call(t)},renderXLabel:function(){var e=this.yGutterBounds(),t=[this.xLabel()],n=this.D3svg().select(this.region("yPadding")).selectAll(".xLabel");n.data(t).text(this.xLabel()).enter().append("text").attr("class","xLabel").attr("x",e.size.width/2).attr("y",25+e.size.height/2+3).attr("text-anchor","middle").attr("font-size","11px").attr("font-family","sans-serif").attr("fill","black").text(this.xLabel())},renderYLabel:function(){var e=this.xGutterBounds(),t=[this.yLabel()],n=this.D3svg().select(this.region("xPadding")).selectAll(".yLabel");n.data(t).text(this.yLabel()).enter().append("text").attr("class","yLabel").attr("x",e.size.width/2).attr("y",10+e.size.height/2+3).attr("text-anchor","middle").attr("font-size","11px").attr("font-family","sans-serif").attr("fill","black").attr("transform","rotate(270,"+(e.size.width/2-7)+","+e.size.height/2+")").text(this.yLabel())}})}),define("kbaseHeatmap",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseHeatmap",parent:"kbaseVisWidget",version:"1.0.0",options:{scaleAxes:!0,xScaleType:"ordinal",yScaleType:"ordinal",yGutter:80,yPadding:20,xPadding:150,xGutter:110,overColor:"#999900",hmBGColor:"lightgray",colors:["#ffff00","#000000","#0000ff"],rx:2,ry:2,cellPadding:1},_accessors:["spectrum"],init:function(e){return this._super(e),this.options.gradientID=this.linearGradient({colors:this.options.colors}),this},setDataset:function(t){t.data!=undefined&&!e.isArray(t.data)&&(t=t.data),this._super(t)},setSpectrum:function(e){this.spectrum(d3.scale.ordinal().domain(d3.range(0,1)).range(e))},defaultXDomain:function(){return this.dataset()==undefined?[0,0]:this.dataset().column_labels},defaultYDomain:function(){return this.dataset()==undefined?[0,0]:this.dataset().row_labels},setXScaleRange:function(e,t){return t==undefined&&(t=this.xScale()),t.rangeBands(e),t},setYScaleRange:function(e,t){return t==undefined&&(t=this.yScale()),t.rangeBands(e),t},renderXAxis:function(){if(this.xScale()==undefined||this.xScale().domain==undefined)return;var e=d3.svg.axis().scale(this.xScale()).orient("top"),t=this.D3svg().select(".yGutter").select(".xAxis");t[0][0]==undefined&&(t=this.D3svg().select(".yGutter").append("g").attr("class","xAxis axis").attr("transform","translate(0,"+this.yGutterBounds().size.height+")"));var n=this;t.transition().duration(0).call(e).selectAll("text").attr("transform",function(e,t){var r=n.yGutterBounds(),i=d3.select(this).node().getComputedTextLength();return"rotate(-45,0,0) translate("+(i/2+5)+",5)"}),t.selectAll("text").each(function(e,t){var r=d3.select(this).text();r.length>15&&d3.select(this).text(r.substring(0,12)+"...");var i=n.dataset().column_labels.indexOf(r);d3.select(this).attr("data-id",n.dataset().column_ids[i]),d3.select(this).on("mouseover",function(e){d3.select(this).attr("fill",n.options.overColor);var t=d3.select(this);t.text()!=r&&n.showToolTip({label:r})}).on("mouseout",function(e){d3.select(this).attr("fill","black"),n.hideToolTip()})})},renderXLabel:function(){var e=this.yGutterBounds(),t=[this.xLabel()],n=this.D3svg().select(".yPadding").selectAll(".xLabel");n.data(t).text(this.xLabel()).enter().append("text").attr("class","xLabel").attr("x",e.size.width/2).attr("y",e.size.height/2+3).attr("text-anchor","middle").attr("font-size","11px").attr("font-family","sans-serif").attr("fill","black").text(this.xLabel())},renderYLabel:function(){var e=this.xGutterBounds(),t=this.D3svg().select(this.region("xGutter")).selectAll(".yLabel").data([0]);t.enter().append("rect").attr("x",5).attr("y",0).attr("width",e.size.width/3).attr("height",e.size.height).attr("fill","url(#"+this.options.gradientID+")");var n=this.colorScale(),r=[n.domain()[n.domain().length-1],n.domain()[0]],i=d3.scale.linear().domain(r).range([0,e.size.height]).nice(),s=d3.svg.axis().scale(i).orient("right"),o=this.D3svg().select(this.region("xGutter")).select(".tempAxis"),u=this;o[0][0]==undefined&&(o=this.D3svg().select(this.region("xGutter")).append("g").attr("class","tempAxis axis").attr("transform","translate("+(e.size.width/3+6)+",0)")),s.tickFormat(function(e){return e.length>23?e.substring(0,20)+"...":e}),o.transition().call(s)},renderYAxis:function(){if(this.yScale()==undefined)return;var e=d3.svg.axis().scale(this.yScale()).orient("left"),t=this.D3svg().select(this.region("xPadding")).select(".yAxis"),n=this;t[0][0]==undefined&&(t=this.D3svg().select(this.region("xPadding")).append("g").attr("class","yAxis axis").attr("transform","translate("+this.xPaddingBounds().size.width+",0)")),t.transition().call(e),t.selectAll("text").each(function(e,t){var r=d3.select(this).text();r.length>23&&d3.select(this).text(r.substring(0,20)+"...");var i=n.dataset().row_labels.indexOf(r);d3.select(this).attr("data-id",n.dataset().row_ids[i]),d3.select(this).on("mouseover",function(e){d3.select(this).attr("fill",n.options.overColor);var t=d3.select(this);t.text()!=r&&n.showToolTip({label:r})}).on("mouseout",function(e){d3.select(this).attr("fill","black"),n.hideToolTip()})})},colorScale:function(){var e=this.options.colorScale;if(e==undefined){var t=this.options.maxValue,n=this.options.minValue;if(t==undefined||n==undefined){t=0,n=0;for(var r=0;r<this.dataset().data.length;r++){var i=this.dataset().data[r];for(var s=0;s<i.length;s++)i[s]>t&&(t=i[s]),i[s]<n&&(n=i[s])}}var o=d3.range(n,t,(t-n)/this.options.colors.length);o[0]=n,o[o.length-1]=t,e=d3.scale.linear().domain(o).range(this.options.colors)}return e},renderChart:function(){var e=this,t=this.chartBounds();if(this.dataset()==undefined)return;var n=this.yScale().copy();n.domain(this.dataset().row_ids);var r=this.xScale().copy();r.domain(this.dataset().column_ids);var i=function(){return this.attr("x",function(t){var n=t.x;e.options.useIDMapping&&(n=e.xIDMap()[n]);var i=r(n)+1;return i}).attr("y",function(t){var r=t.y;e.options.useIDMapping&&(r=e.yIDMap()[r]);var i=n(r)+1;return i}).attr("width",e.xScale().rangeBand()-e.options.cellPadding*2).attr("height",e.yScale().rangeBand()-e.options.cellPadding*2).attr("rx",e.options.rx).attr("ry",e.options.ry).attr("fill",function(e){return e.color}),this},s=function(){return this.on("mouseover",function(t){if(e.options.overColor){d3.select(this).attr("stroke",e.options.overColor).attr("stroke-width",5),e.D3svg().select(".yGutter").selectAll("g g text").attr("fill",function(n,r){var i=t.x;e.options.useIDMapping&&(i=e.xIDMap()[i]);if(d3.select(this).attr("data-id")==i)return e.options.overColor}),e.D3svg().select(".xPadding").selectAll("g g text").attr("fill",function(n,r){var i=t.y;e.options.useIDMapping&&(i=e.yIDMap()[i]);if(d3.select(this).attr("data-id")==i)return e.options.overColor});var n=t.x;e.options.useIDMapping&&(n=e.xIDMap()[n]);var r=t.y;e.options.useIDMapping&&(r=e.yIDMap()[r]),e.showToolTip({label:t.label||"Value for: "+t.row+" - "+t.column+"<br>is "+t.value})}}).on("mouseout",function(t){e.options.overColor&&(d3.select(this).attr("stroke",0),e.D3svg().select(".yGutter").selectAll("g g text").attr("fill",function(e,t){return"black"}),e.D3svg().select(".xPadding").selectAll("g g text").attr("fill",function(e,t){return"black"}),e.hideToolTip())}).on("click",function(t){e.options.clickCallback&&e.options.clickCallback(t,e)}),this},o=this.initialized?this.options.transitionTime:0,u=this.D3svg().select(this.region("chart")).selectAll(".hmBG").data([0]);u.enter().append("rect").attr("x",0).attr("y",0).attr("width",t.size.width).attr("height",t.size.height).attr("fill",e.options.hmBGColor).attr("class","hmBG");var a=[],f=this.colorScale();for(var l=0;l<this.dataset().data.length;l++){var c=this.dataset().data[l];for(var h=0;h<c.length;h++)a.push({x:this.dataset().column_ids[h],y:this.dataset().row_ids[l],column:this.dataset().column_labels[h],row:this.dataset().row_labels[l],value:c[h],color:f(c[h])})}var p=this.D3svg().select(this.region("chart")).selectAll(".cell").data(a);p.enter().append("rect").attr("class","cell"),p.call(s).transition().duration(o).call(i).call(e.endall,function(){e.initialized=!0}),p.data(a).exit().remove()}})}),define("kbaseLinechart",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseLinechart",parent:"kbaseVisWidget",version:"1.0.0",options:{overColor:"yellow",lineWidth:3,lineCap:"round",color:"black"},_accessors:[],defaultXDomain:function(){return this.dataset()==undefined?[0,0]:[.9*d3.min(this.dataset(),function(e){return d3.min(e.values.map(function(e){return e.x}))}),1.1*d3.max(this.dataset(),function(e){return d3.max(e.values.map(function(e){return e.x}))})]},defaultYDomain:function(){return this.dataset()==undefined?[0,0]:[.9*d3.min(this.dataset(),function(e){return d3.min(e.values.map(function(e){return e.y}))}),1.1*d3.max(this.dataset(),function(e){return d3.max(e.values.map(function(e){return e.y}))})]},renderChart:function(){if(this.dataset()==undefined)return;var e=this.chartBounds(),t=this,n=d3.svg.line().x(function(e){return t.xScale()(e.x)}).y(function(e){return t.yScale()(e.y)}),r=function(){return this.attr("d",function(e){return n(e.values)}).attr("stroke",function(e){return e.color||t.options.color}).attr("fill","none").attr("stroke-width",function(e){return e.width||t.options.lineWidth}).attr("stroke-linecap",function(e){return e.linecap||t.options.lineCap}).attr("stroke-dasharray",function(e){return e.dasharray}),this},i=function(){return this.on("mouseover",function(e){t.options.overColor&&d3.select(this).attr("stroke",t.options.overColor).attr("stroke-width",(e.width||t.options.lineWidth)+5),e.label&&t.showToolTip({label:e.label})}).on("mouseout",function(e){t.options.overColor&&(d3.select(this).attr("stroke",function(e){return e.color||t.options.color}).attr("stroke-width",e.width||t.options.lineWidth),t.hideToolTip())}),this},s=this.data("D3svg").select(".chart").selectAll(".line");s.data(this.dataset()).enter().append("path").attr("class","line").call(r).call(i),s.data(this.dataset()).call(i).transition().duration(this.options.transitionTime).call(r),s.data(this.dataset()).exit().remove()},setYScaleRange:function(e,t){return this._super(e.reverse(),t)}})}),define("kbaseLineSerieschart",["jquery","d3","kbaseLinechart","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseLineSerieschart",parent:"kbaseLinechart",version:"1.0.0",options:{},_accessors:["labels"],xTickValues:function(){var e=this,t=d3.merge(this.dataset().map(function(e){return e.values.map(function(e){return e.x})}));return t=d3.set(t).values(),t},xTickLabel:function(e){return this.labels()!=undefined?this.labels()[e]:e}})}),define("kbaseScatterplot",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseScatterplot",parent:"kbaseVisWidget",version:"1.0.0",options:{overColor:"yellow"},_accessors:[],defaultXDomain:function(){if(this.dataset()==undefined)return[0,0];var e=.9*d3.min(this.dataset().map(function(e){return e.x}));return e>0&&(e=0),[e,1.1*d3.max(this.dataset().map(function(e){return e.x}))]},defaultYDomain:function(){if(this.dataset()==undefined)return[0,0];var e=.9*d3.min(this.dataset().map(function(e){return e.y}));return e>0&&(e=0),[e,1.1*d3.max(this.dataset().map(function(e){return e.y}))]},renderChart:function(){if(this.dataset()==undefined)return;var e=this.chartBounds(),t=this,n=function(){this.attr("cx",function(e){return t.xScale()(e.x)}).attr("cy",function(e){return t.yScale()(e.y)}).attr("r",function(e){return e.weight}).attr("fill",function(e){return e.color})},r=function(){return this.on("mouseover",function(e){t.options.overColor&&d3.select(this).attr("stroke",t.options.overColor).attr("stroke-width",3);var n=e.label?e.label:e.weight+" at ("+e.x+","+e.y+")";n!=undefined&&t.showToolTip({label:n})}).on("mouseout",function(e){t.options.overColor&&d3.select(this).transition().attr("stroke","none"),t.data("D3svg").select(".yPadding").selectAll("g g text").attr("fill",function(e,t){return"black"}),t.hideToolTip()}),this},i=this.data("D3svg").select(".chart").selectAll(".point");i.data(this.dataset()).enter().append("circle").attr("class","point").call(n).call(r),i.data(this.dataset()).exit().remove(),i.data(this.dataset()).call(r).transition().duration(500).call(n)},setYScaleRange:function(e,t){return this._super(e.reverse(),t)}})}),define("kbasePiechart",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbasePiechart",parent:"kbaseVisWidget",version:"1.0.0",options:{xGutter:0,xPadding:0,yPadding:0,overColor:"blue",innerRadius:0,outerRadius:0,startAngle:0,gradient:!0,startingPosition:"final",strokeWidth:1,strokeColor:"white",highlightColor:"black",sliceOffset:25,bgColor:"rgba(0,0,0,0)",xOffset:0,yOffset:0,outsideLabels:!0,labels:!0,autoEndAngle:!1,colorScale:d3.scale.category20(),outerArcOpacity:.4,cornerToolTip:!1,draggable:!0,tooltips:!0,rescaleChildren:!0},_accessors:[],init:function(t){return this._super(t),this.options.endAngle==undefined&&(this.options.endAngle=this.options.startAngle+2*Math.PI),this.pieSize=this.options.endAngle-this.options.startAngle,this.uniqueID=e.proxy(function(e){e.data==undefined&&(e.data={});var t=e.data.id||(e.data.id=this.ticker());return t},this),this},childOptions:function(e,t){var n=this._super(e,t);return this.options.rescaleChildren&&(n.outerRadius=this.options.innerRadius*(e+1),n.innerRadius=this.options.innerRadius),n},reenter:function(e,t,n){return this.options.rescaleChildren&&(this.options.outerRadius=n.options.innerRadius*(e+1),this.options.innerRadius=n.options.innerRadius),this},startingPosition:function(e,t){if(this.initialized)return t<this.lastPieData.length-1?{startAngle:this.lastPieData[t+1].startAngle,endAngle:this.lastPieData[t+1].startAngle}:{startAngle:this.options.endAngle,endAngle:this.options.endAngle};if(this.options.startingPosition=="slice")return{startAngle:e.startAngle,endAngle:e.startAngle};if(this.options.startingPosition=="top")return{startAngle:this.options.startAngle,endAngle:this.options.startAngle};if(this.options.startingPosition=="final")return{startAngle:e.startAngle,endAngle:e.endAngle}},midAngle:function(e){var t=e.startAngle+(e.endAngle-e.startAngle)/2;return t},midPosition:function(e){var t=this.midAngle(e),n=t%(2*Math.PI),r=0<n&&n<Math.PI||n<-Math.PI?1:-1;return r},useOutsideLabels:function(e){return this.options.outsideLabels&&e.data.outsideLabel==undefined||e.data.outsideLabel},setDataset:function(t){t!=undefined&&e.each(t,function(e,n){typeof n=="number"&&(t[e]={value:n})}),this._super(t)},outerRadius:function(){var e=this.chartBounds(),t=this.options.outerRadius;if(t<=0){var n=e.size.width<e.size.height?e.size.width:e.size.height;t=n/2+t,n<0&&(n=0),t<0&&(t=n/2)}return t},innerRadius:function(){var e=this.options.innerRadius;return e<0&&(e=this.outerRadius()+this.options.innerRadius),e<0&&(e=0),e},sliceAction:function(e){return function(){var t=e.outerRadius(),n=d3.svg.arc().innerRadius(t).outerRadius(t+10);return this.on("mouseover",function(t){if(t.data.gap)return;var r=this;if(e.dragging)return;e.outerArc.transition().duration(0).attr("fill-opacity",e.options.outerArcOpacity).attr("fill",function(n,r){return t.data.color||e.options.colorScale(r,t.data,e)}).attr("transform",function(e){return d3.select(r).attr("transform")}).attr("d",function(e){return n({startAngle:t.startAngle,endAngle:t.endAngle})});var i=[0,0];i=d3.mouse(this);var s=i[0],o=i[1];if(e.options.tooltips){var u=e.tooltip(t);u&&e.showToolTip({label:u,event:{pageX:e.options.cornerToolTip?e.$elem.prop("offsetLeft")+5:d3.event.pageX,pageY:e.options.cornerToolTip?e.$elem.prop("offsetTop")+20:d3.event.pageY}})}}).on("mouseout",function(t){if(t.data.gap)return;e.options.tooltips&&e.hideToolTip(),e.outerArc.attr("fill-opacity",0)}).on("dblclick",function(t){if(t.data.gap)return;e.options.draggable&&(e.options.startAngle=e.options.startAngle-t.startAngle,e.renderChart())}),this}},tooltip:function(e){return e.data.tooltip!=undefined?e.data.tooltip:e.data.label!=undefined?e.data.label+" : "+e.data.value:undefined},pieData:function(e){return this.pieLayout=d3.layout.pie().sort(null).startAngle(this.options.startAngle).endAngle(this.options.endAngle).value(function(e,t){return e.value}),this.pieLayout(e)},renderChart:function(){if(this.dataset()==undefined)return;this.dataset().length==0&&(this.initialized=!1,this.lastPieData=undefined);var t=0;this.options.startingPosition=="final"&&(t=1);var n=this.chartBounds(),r=this;if(this.options.autoEndAngle){var i=0;e.each(r.dataset(),function(e,t){i+=t.value}),i>1&&(i=1),this.options.endAngle=i*2*Math.PI}else this.options.endAngle=this.options.startAngle+this.pieSize;var s=this.pieData(r.dataset()),o=this.outerRadius(),u=this.innerRadius(),a=d3.svg.arc().innerRadius(u).outerRadius(o),f=d3.svg.arc().innerRadius(u+(o-u)*8/10).outerRadius(u+(o-u)*8/10),l=d3.svg.arc().innerRadius(u+(o-u)/2).outerRadius(u+(o-u)/2),c=function(){return this.attr("transform",function(e,t){if(e.data.offset==undefined)return;var n=d3.svg.arc().innerRadius(0).outerRadius(e.data.offset||0),r=n.centroid(e);return"translate("+r+")"}).attr("fill-opacity",function(e){return e.data.gap?0:1}).attr("stroke-opacity",function(e){return e.data.gap?0:1}),r.options.gradient||this.attr("fill",function(e,t){return e.data.color==undefined&&(e.data.color=r.options.colorScale(t,e.data,r)),e.data.color}),this.attrTween&&(r.options.gradient&&this.attrTween("fill",function(t,n){var i=r.uniqueness(),s=i==undefined?undefined:i(t),u=t.data.gradID;if(u==undefined){var a;r.lastPieData!=undefined&&n<r.lastPieData.length&&(s==undefined?a=r.lastPieData[n].data.gradID:e.each(r.lastPieData,function(e,t){var n=i(t);if(n==s){a=t.data.gradID;return}})),a==undefined&&(a=r.uuid()),u=t.data.gradID=a}var f=t.data.color;return t.data.color==undefined&&(t.data.color=r.options.colorScale(n,t.data,r)),f="url(#"+r.radialGradient({startColor:t.data.color,stopColor:r.options.gradient?r.options.radialGradientStopColor:t.data.color,id:u,r:o})+")",function(e){return f}}),this.attrTween("d",function(e,t){this._current==undefined&&(this._current=r.startingPosition(e,t));var n=d3.interpolate(this._current,e);return this._current=n(0),function(e){return a(n(e))}})),this},h=function(e){return e==undefined&&(e=1),this.attr("text-anchor","middle"),this.attrTween&&this.text(function(e){return e.data.label}).attrTween("fill-opacity",function(n,i){this._currentOpacity==undefined&&(this._currentOpacity=r.initialized?0:t);var s=d3.interpolate(this._currentOpacity,e);this._currentOpacity=s(0);var o=this;return function(e){return o._currentOpacity=s(e)}}).attrTween("transform",function(t,n){this._current==undefined&&(this._current=r.startingPosition(t,n));var i=t;e==0&&(i={startAngle:t.startAngle,endAngle:t.startAngle},n>0&&s.length&&(n>s.length&&(n=s.length),i={startAngle:s[n-1].endAngle,endAngle:s[n-1].endAngle}));var u=d3.interpolate(this._current,i);this._current=u(0);var l=r.useOutsideLabels(t),c=l?f:a;return function(e){var t=u(e),n=c.centroid(t);return l&&(n[0]=o*1.05*r.midPosition(t)),"translate("+n+")"}}).styleTween("text-anchor",function(e){this._current=this._current||e;var t=d3.interpolate(this._current,e);this._current=t(0);var n=r.useOutsideLabels(e);return function(e){var i=t(e);return n?r.midPosition(i)>0?"start":"end":"middle"}}),this},p=d3.behavior.drag();p.on("dragstart",function(e){this.__delta=0,r.outerArc.attr("fill-opacity",0),r.dragging=!0}).on("drag",function(e){this.__delta+=r.midPosition(e)*d3.event.dy;var t=20;if(this.__delta>t||this.__delta<-1*t){var n=this.__delta,i=r.options.startAngle,s=i+Math.PI*(n/2)/o;r.options.startAngle=s,r.renderChart(),this.__delta=0}}).on("dragend",function(e){delete this.__delta,r.dragging=!1});var d=function(){return this},v=this.D3svg().select(this.region("chart")).selectAll(".pie").data([0]);v.enter().append("g").attr("class","pie").attr("transform","translate("+(n.size.width/2+this.options.xOffset)+","+(n.size.height/2+this.options.yOffset)+")"),e.each(s,function(e,t){t.data.id!=undefined&&(t.id=t.data.id)});if(r.options.pieColor!=undefined){var m=this.D3svg().select(this.region("chart")).data([0]),g=m.selectAll(".pieBG").data([0]),y=d3.svg.arc().innerRadius(0).outerRadius(o);g.enter().insert("path",".pie").attr("class","pieBG").attr("transform","translate("+(n.size.width/2+this.options.xOffset)+","+(n.size.height/2+this.options.yOffset)+")").attr("d",function(e){return y({startAngle:0,endAngle:2*Math.PI})}),g.attr("fill",r.options.pieColor)}r.outerArc=v.selectAll(".outerArc").data([0]),r.outerArc.enter().append("path").attr("class","outerArc");var b=v.selectAll(".slice").data(s,this.uniqueness());b.enter().append("path").attr("class","slice").attr("fill",function(e,t){return e.data.color==undefined&&(e.data.color=r.options.colorScale(t,e.data,r)),e.data.color}).attr("stroke",r.options.strokeColor).attr("stroke-width",r.options.strokeWidth).attr("stroke-linejoin","bevel");var w=this.initialized||this.options.startingPosition!="final"?this.options.transitionTime:0;b.call(r.sliceAction(r)).transition().duration(w).call(c).call(r.endall,function(){r.initialized=!0,r.lastPieData=s}),r.options.draggable&&b.call(p),b.exit().transition().duration(w).attrTween("d",function(e,t){var n={startAngle:e.startAngle,endAngle:e.startAngle};t>0&&s.length&&t<=s.length&&(n={startAngle:s[t-1].endAngle,endAngle:s[t-1].endAngle});var r=d3.interpolate(this._current,n);return this._current=r(0),function(e){return a(r(e))}}).each("end",function(e){d3.select(this).remove()});var E=this.D3svg().select(this.region("chart")).selectAll(".labelG").data([0]);E.enter().append("g").attr("class","labelG").attr("transform","translate("+(n.size.width/2+this.options.xOffset)+","+(n.size.height/2+this.options.yOffset)+")");var S=E.selectAll(".label").data(s.filter(function(e){return(r.options.labels||e.data.forceLabel)&&e.data.label!=undefined&&e.data.label.length}),this.uniqueness());S.enter().append("text").attr("class","label").call(function(){h.call(this,1)}),S.call(d).transition().duration(w).call(function(){h.call(this,1)}),S.exit().transition().duration(w).call(function(){h.call(this,0)}).each("end",function(e){d3.select(this).remove()});var x=function(e){return e==undefined&&(e=1),this.attrTween&&this.attrTween("stroke-opacity",function(n,i){this._currentOpacity==undefined&&(this._currentOpacity=r.initialized?0:t);var s=d3.interpolate(this._currentOpacity,e);this._currentOpacity=s(0);var o=this;return function(e){return o._currentOpacity=s(e)}}).attrTween("points",function(t,n){this._current=this._current||r.startingPosition(t,n);var i=t;e==0&&(i={startAngle:t.startAngle,endAngle:t.startAngle},n>0&&s.length&&(n>s.length&&(n=s.length),i={startAngle:s[n-1].endAngle,endAngle:s[n-1].endAngle}));var u=d3.interpolate(this._current,i),c=r.useOutsideLabels(t),h=c?f:a;return this._current=u(0),function(e){var t=u(e),n=h.centroid(t);return c&&(n[0]=o*1.05*r.midPosition(t)),[l.centroid(t),h.centroid(t),n]}}),this},T=E.selectAll("polyline").data(s.filter(function(e){return(r.options.labels||e.data.forceLabel)&&(r.options.outsideLabels||e.data.outsideLabel)&&e.data.label!=undefined&&e.data.label.length}),this.uniqueness());T.enter().append("polyline").attr("stroke","black").attr("stroke-width",1).attr("fill","rgba(0,0,0,0)"),T.transition().duration(w).call(function(){x.call(this,1)}),T.exit().transition().duration(w).call(function(){x.call(this,0)}).each("end",function(e){d3.select(this).remove()})},renderXAxis:function(){},renderYAxis:function(){}})}),define("kbaseForcedNetwork",["jquery","kbaseSearchControls","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseForcedNetwork",parent:"kbaseVisWidget",version:"1.0.0",options:{overColor:"blue",nodeColor:"gray",lineColor:"gray",lineWeight:3,nodeStrokeColor:"black",nodeStrokeWeight:1,nodeRadius:10,filteredNodeColor:"#BFBFBF",linkDistance:100,charge:-10,xGutter:0,xPadding:0,yPadding:0,maxCurveWeight:100,searchBox:!0,filter:!1,cornerToolTip:!1},_accessors:["forceLayout","restart"],defaultXDomain:function(){if(this.dataset()==undefined)return[0,0];var e=2*d3.min(this.dataset().nodes.map(function(e){return e.x}));return e>0&&(e=0),[e,2*d3.max(this.dataset().nodes.map(function(e){return e.x}))]},defaultYDomain:function(){if(this.dataset()==undefined)return[0,0];var e=2*d3.min(this.dataset().nodes.map(function(e){return e.y}));return e>0&&(e=0),[e,2*d3.max(this.dataset().nodes.map(function(e){return e.y}))]},appendUI:function(e){this._super(e);var t=undefined,n=this.data("D3svg").select(".chart"),r=this.chartBounds(),i=undefined,s=this,o=[];return n.on("mousedown",function(){if(d3.select(d3.event.target).attr("class")!="background")return;var e=d3.mouse(this);t=new Point(e[0]+r.origin.x,e[1]+r.origin.y),i=n.append("rect").attr("class","selectionBox").attr("x",t.x).attr("y",t.y).attr("width",0).attr("height",0).attr("stroke","#222").attr("stroke-width","3").attr("fill",(new RGBColor(0,0,0)).asStringWithAlpha(.1))}).on("mousemove",function(){if(t!=undefined){var e=d3.mouse(this),n=new Point(e[0]+r.origin.x,e[1]+r.origin.y),u=t.rectWithPoint(n);u.origin.x-=r.origin.x,u.origin.y-=r.origin.y,i.attr("x",u.origin.x),i.attr("y",u.origin.y),i.attr("width",u.size.width),i.attr("height",u.size.height);var a=s.forceLayout().nodes();a.forEach(function(e,t){var n=new Rectangle(new Point(e.x-e.radius,e.y-e.radius),new Size(e.radius*2,e.radius*2));n.intersects(u)?(o.push(e),e.highlighted=3):e.highlighted=-1}),s.restart()()}}).on("mouseup",function(){if(t==undefined)return;var e=d3.mouse(this),u=new Point(e[0]+r.origin.x,e[1]+r.origin.y),a=t.rectWithPoint(u);t=undefined,i=undefined,n.select(".selectionBox").remove(),o.forEach(function(e,t){e.highlighted=!1}),o=[],s.restart()()}),this},renderChart:function(){if(this.dataset()==undefined)return;this.options.filter&&(this.$elem.kbaseSearchControls({context:this,searchCallback:function(e,t,n){n.options.filterVal=new RegExp(t,"i"),n.restart()()}}),this.$elem.data("searchControls").addClass("col-md-6"));var e=this.chartBounds(),t=this,n=this.data("D3svg").select(".chart").selectAll(".node"),r=this.data("D3svg").select(".chart").selectAll(".tag"),i=this.data("D3svg").select(".chart").selectAll(".edge"),s=this.forceLayout();if(s!=undefined){this.forceLayout().nodes(this.dataset().nodes),this.forceLayout().links(this.dataset().edges),t.restart()();return}var o=function(){i.attr("d",function(e){if(e.curveStrength){var n=e.target.x-e.source.x,r=e.target.y-e.source.y,i=d3.scale.linear().domain([-t.options.maxCurveWeight,t.options.maxCurveWeight]).range([0,n]),s=d3.scale.linear().domain([-t.options.maxCurveWeight,t.options.maxCurveWeight]).range([0,r]),o=e.source.x+i(e.curveStrength),u=e.target.y-s(e.curveStrength),a=" M"+e.source.x+","+e.source.y+" Q"+o+","+u+"  "+e.target.x+","+e.target.y;return a}return"M"+e.source.x+","+e.source.y+"L"+e.target.x+","+e.target.y}),n.attr("cx",function(e){return e.x}).attr("cy",function(e){return e.y}),r.attr("x",function(e){return e.x+(e.tagOffsetX||0)}).attr("y",function(e){return e.y+(e.tagOffsetY||0)}),r.attr("fill-opacity",function(e){var n=e.search;return n==undefined&&(n=e.tag),t.options.filterVal==undefined||n.match(t.options.filterVal)?1:.25})};s=d3.layout.force().nodes(t.dataset().nodes).links(t.dataset().edges).size([e.size.width,e.size.height]).charge(function(e,n){return e.charge||t.options.charge}).linkDistance(function(e,n){return e.linkDistance||t.options.linkDistance}).on("tick",o),this.forceLayout(s);var u=function(){i=i.data(s.links());var o=function(){return this.on("mouseover",function(e){var n=[0,0];n=d3.mouse(this);var r=n[0],i=n[1];t.showToolTip({label:e.label||"Node: "+e.name,event:{pageX:d3.event.pageX-(t.options.cornerToolTip?r+300:0),pageY:d3.event.pageY}}),e.source.highlighted=1,e.target.highlighted=1,e.highlighted=2,t.forceLayout().links().forEach(function(e,t){e.highlighted!=2&&(e.highlighted=-1)}),t.forceLayout().nodes().forEach(function(e,t){e.highlighted!=2&&e.highlighted!=1&&(e.highlighted=-1)}),u()}).on("mouseout",function(e){t.hideToolTip(),t.forceLayout().links().forEach(function(e,t){e.highlighted=0,e.source.highlighted=0,e.target.highlighted=0}),t.forceLayout().nodes().forEach(function(e,t){e.highlighted=0}),u()}).call(s.drag),this},a=function(){return this.attr("class","edge").attr("stroke",function(e){return e.color||t.options.lineColor}).attr("stroke-width",function(e){return e.weight||t.options.lineWeight}).attr("fill","none").attr("stroke-opacity",function(e){if(t.options.filterVal!=undefined||e.highlighted==-1)if(e.highlighted==-1||!e.source.tag.match(t.options.filterVal)||!e.target.tag.match(t.options.filterVal))return.25;return 1}),this};i.enter().insert("path",".node").call(o).call(a),i.call(o).transition().duration(100).call(a),i.exit().remove(),n=n.data(s.nodes());var f=function(){return this.on("mouseover",function(e){var n=[0,0];n=d3.mouse(this);var r=n[0],i=n[1];t.showToolTip({label:e.label||"Node: "+e.name,event:{pageX:d3.event.pageX-(t.options.cornerToolTip?r+300:0),pageY:d3.event.pageY}}),t.forceLayout().links().forEach(function(t,n){t.source==e&&(t.target.highlighted=1,t.highlighted=1),t.target==e&&(t.source.highlighted=1,t.highlighted=1),t.highlighted!=1&&(t.highlighted=-1)}),t.forceLayout().nodes().forEach(function(e,t){e.highlighted!=1&&(e.highlighted=-1)}),e.highlighted=2,u()}).on("mouseout",function(e){t.hideToolTip(),e.highlighted=0,t.forceLayout().links().forEach(function(e,t){e.highlighted=0,e.source.highlighted=0,e.target.highlighted=0}),t.forceLayout().nodes().forEach(function(e,t){e.highlighted=0}),u()}).on("mousedown",function(e){e.fixed=!1}).on("dblclick",function(e){e.fixed=!1}).on("mouseup",function(t){t.x<e.origin.x||t.y<e.origin.y||t.x>e.origin.x+e.size.width||t.y>e.origin.y+e.size.height?t.fixed=!1:t.fixed=!0}).call(s.drag),this},l=function(){return this.attr("r",function(e){return e.radius||t.options.nodeRadius}).attr("fill",function(e){var n=e.search;n==undefined&&(n=e.tag);if(e.highlighted==2)return e.highlightColor||t.options.nodeHighlightColor||e.color||t.options.nodeColor;if(e.highlighted==1)return e.relatedHighlightColor||t.options.relatedNodeHighlightColor||e.color||t.options.nodeColor;if(t.options.filteredNodeColor!=undefined&&t.options.filterVal!=undefined&&!n.match(t.options.filterVal)||e.highlighted==-1){var r=RGBColor.prototype.rgbFromString(e.color||t.options.nodeColor);if(r){var i=new RGBColor(r.r,r.g,r.b);return i.lightenBy(191).asString()}return t.options.filteredNodeColor||e.color||t.options.nodeColor}return e.color||t.options.nodeColor}).attr("stroke",function(e){return e.stroke||t.options.nodeStrokeColor}).attr("stroke-width",function(e){return e.strokeWidth||t.options.nodeStrokeWeight}).attr("data-name",function(e){return e.name}),this};n.enter().append("circle").attr("class","node").call(l).call(f),n.call(f).transition().duration(100).call(l),n.exit().remove(),r=r.data(s.nodes());var c=function(){return this.text(function(e){return e.tag}).attr("text-anchor","middle").attr("alignment-baseline","middle").attr("style",function(e){return e.tagStyle}),this};r.enter().append("text").attr("text","tag").call(c).call(f),r.call(f).transition().duration(100).call(c),r.exit().remove(),s.start()};t.restart(u),u()},renderXAxis:function(){},renderYAxis:function(){}})}),define("kbaseTreechart",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseTreechart",parent:"kbaseVisWidget",version:"1.0.0",options:{debug:!1,xGutter:20,xPadding:20,yGutter:20,yPadding:20,bgColor:"none",red:undefined,blue:undefined,distance:100},_accessors:["comparison"],afterInArray:function(e,t){var n=t.indexOf(e)+1;return n>=t.length&&(n=0),t[n]},countVisibleNodes:function(e){var t=1;if(e.children!=undefined&&(e.open==1||e.open==undefined))for(var n=0;n<e.children.length;n++)t+=this.countVisibleNodes(e.children[n]);return t},findInChildren:function(e,t){if(e==t)return!0;if(t!=undefined&&t.children!=undefined)for(var n=0;n<t.children.length;n++)if(this.findInChildren(e,t.children[n]))return!0;return!1},updateTree:function(e){function c(e){var t=n.options.distance;return e.distance!=undefined&&(t*=e.distance),e.parent!=undefined?t+=c(e.parent):t=i+l,t}var t=this.data("D3svg").select(".chart"),n=this,r=500,i=0,s=this.chartBounds(),o=document.createElement("div"),u=e;while(u.parent!=undefined)u=u.parent;var a=t.append("text").attr("style","visibility : hidden; font-size : 11px;cursor : pointer;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;").attr("class","fake").text(u.name);i=a[0][0].getBBox().width-10+s.origin.x;var f=15*this.countVisibleNodes(this.dataset());this.height(this.$elem.height()),s.size.height=f,this.treeLayout=d3.layout.tree().size([s.size.height,s.size.width]),this.nodes=this.treeLayout.nodes(this.dataset()).reverse();var l=0,h=0,p=5e9;this.nodes.forEach(function(e){e.y=c(e);var n=t.append("text").attr("style","visibility : hidden;font-size : 11px;cursor : pointer;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;").attr("class","fake").text(e.name),r=n[0][0].getBBox(),i=e.children||e._children?e.y+10:e.y+r.width+10,s=e.children||e._children?e.y+10-r.width:e.y+10;i>h&&(h=i),s<p&&(p=s)});var d=0;p<s.origin.x&&(d+=s.origin.x-p,l=d),h>s.origin.x+s.size.width&&(d+=h-s.size.width),this.nodes.forEach(function(e){e.y=c(e)}),t.selectAll(".fake").remove();var v=this.options.xGutter+this.options.yGutter+d+s.size.width;v<n.options.originalWidth&&(v=n.options.originalWidth),this.$elem.animate({width:v,height:f+this.options.yGutter+this.options.yPadding},r);var m=t.selectAll("g.node").data(this.nodes,this.uniqueID),g=m.enter().append("g").attr("class","node").attr("transform",function(t){return"translate("+e.y0+","+e.x0+")"});g.append("circle").attr("r",1e-6).attr("style","cursor : pointer; fill : #fff; stroke : steelblue; stroke-width : 1.5px").style("fill",function(e){return e._children?"lightsteelblue":"#fff"}).on("click",function(e){!n.findInChildren(n.options.red,e)&&!n.findInChildren(n.options.blue,e)&&(n.toggle(e),n.updateTree(e))}),g.append("text").attr("style","font-size : 11px;cursor : pointer;-webkit-touch-callout: none;-webkit-user-select: none;-khtml-user-select: none;-moz-user-select: none;-ms-user-select: none;user-select: none;").attr("x",function(e){return e.children||e._children?-10:10}).attr("dy",".35em").attr("text-anchor",function(e){return e.children||e._children?"end":"start"}).text(function(e){return e.name}).style("fill-opacity",1e-6).attr("fill",function(e){return e.fill||"black"}).on("click",function(e){n.options.red==e&&(n.options.red=undefined,n.options.redNode=undefined),n.options.blue==e&&(n.options.blue=undefined,n.options.blueNode=undefined);var t=["red","black"];n.options.red!=undefined&&n.options.blue!=undefined?(n.options.red.fill="black",d3.select(n.options.redNode).attr("fill",n.options.red.fill),n.options.red=undefined,t=["red","black"]):n.options.red!=undefined?t=["blue","black"]:n.options.red==undefined&&n.options.blue!=undefined&&(t=["red","black"]),e.fill=n.afterInArray(e.fill,t),e.fill!="black"&&e.children!=undefined&&!n.findInChildren(n.options.red,e)&&!n.findInChildren(n.options.blue,e)&&(n.toggle(e),n.updateTree(e)),e.fill!="black"&&(n.options[e.fill]=e,n.options[e.fill+"Node"]=this),d3.select(this).attr("fill",e.fill),n.options.red!=undefined&&n.options.blue!=undefined?n.comparison("Comparing "+n.options.red.name+" vs "+n.options.blue.name):n.comparison("")});var y=m.transition().duration(r).attr("transform",function(e){return"translate("+e.y+","+e.x+")"});y.select("circle").attr("r",4.5).style("fill",function(e){return e._children?"lightsteelblue":"#fff"}),y.select("text").style("fill-opacity",1);var b=m.exit().transition().duration(r).attr("transform",function(t){return"translate("+e.y+","+e.x+")"}).remove();b.select("circle").attr("r",1e-6),b.select("text").style("fill-opacity",1e-6);var w=t.selectAll("path.link").data(n.treeLayout.links(n.nodes),function(e){return e.target.id});w.enter().insert("path","g").attr("class","link").attr("fill","none").attr("stroke","#ccc").attr("stroke-width","1.5px").attr("d",function(t){var r={x:e.x0,y:e.y0};return n.diagonal({source:r,target:r})}).transition().duration(r).attr("d",n.diagonal),w.transition().duration(r).attr("d",n.diagonal),w.exit().transition().duration(r).attr("d",function(t){var r={x:e.x,y:e.y};return n.diagonal({source:r,target:r})}).remove(),n.nodes.forEach(function(e){e.x0=e.x,e.y0=e.y})},renderChart:function(){function r(e){e.children&&(e.children.forEach(r),e.open==0&&n.toggle(e))}if(this.dataset()==undefined)return;this.$elem.height(30*this.countVisibleNodes(this.dataset())),this.height(this.$elem.height()),this.options.originalWidth=this.$elem.width();var e=0,t=this.chartBounds();this.treeLayout==undefined&&(this.treeLayout=d3.layout.tree().size([t.size.height,t.size.width]));var n=this;this.diagonal=d3.svg.diagonal().projection(function(e){return[e.y,e.x]}),this.nodes=this.treeLayout.nodes(this.dataset()).reverse(),this.dataset().x0=t.size.height/2,this.dataset().y0=0;var i=this.dataset();i.children.forEach(r),this.updateTree(this.dataset())},toggle:function(e){e.children!=undefined?(e._children=e.children,e.children=null):(e.children=e._children,e._children=null)}})}),define("kbaseCircularHeatmap",["jquery","d3","kbasePiechart"],function(e){e.KBWidget({name:"kbaseCircularHeatmap",parent:"kbasePiechart",version:"1.0.0",options:{labels:!1,draggable:!1,gradient:!1,pieColor:"black",gbgColor:"#00FF00",gmidColor:"black",gfgColor:"#FF0000",highlightColor:"cyan",colorScale:function(e,t,n){if(n.colorScale==undefined){var r=[0,1],i=[n.options.gbgColor||n.options.pieColor,n.options.gfgColor];n.options.gmidColor&&(i.splice(1,0,n.options.gmidColor),r.splice(1,0,.5)),n.colorScale=d3.scale.linear().domain(r).range(i)}return n.colorScale(t.val)}},_accessors:[{name:"datasets",setter:"setDatasets"}],init:function(e){return this._super(e),this.options.parent&&(this.options.gbgColor==undefined&&(this.options.gbgColor=this.options.pieColor),delete this.options.pieColor),this},setDatasets:function(e){var t=this,n=t._super,r=function(){var r=e.length?e[0]:0;for(var i=0;i<e.length;i++){if(e[i].length!=r.length)throw"Cannot set datasets! Non-standard lengths of circles!";for(var s=0;s<e[i].length;s++)e[i][s].value=1/e[i].length}return t.originalInnerRadius==undefined&&(t.originalInnerRadius=t.innerRadius()),t.options.innerRadius=0-(t.outerRadius()-t.originalInnerRadius)/e.length,n.call(t,e)};t.callAfterInit(r)},sliceAction:function(e){var t=e.outerRadius();return function(){return this.on("mouseover",function(t){if(t.data.gap)return;var n=e.options.highlightColor;n==undefined,d3.select(this).attr("fill",n);var r=[0,0];r=d3.mouse(this);var i=r[0],s=r[1];e.options.tooltips&&e.showToolTip({label:t.data.tooltip||t.data.label+" : "+t.data.value,event:{pageX:e.options.cornerToolTip?e.$elem.prop("offsetLeft")+5:d3.event.pageX,pageY:e.options.cornerToolTip?e.$elem.prop("offsetTop")+20:d3.event.pageY}})}).on("mouseout",function(t){if(t.data.gap)return;e.options.tooltips&&e.hideToolTip(),d3.select(this).attr("fill",function(n,r){return t.data.color||e.options.colorScale(r,t.data,e)})}).on("dblclick",function(t){if(t.data.gap)return;e.options.draggable&&(e.options.startAngle=e.options.startAngle-t.startAngle,e.renderChart())}),this}}})}),define("kbaseChordchart",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size","kbasePiechart"],function(e){e.KBWidget({name:"kbaseChordchart",parent:"kbasePiechart",version:"1.0.0",options:{chordPadding:.1,xOffset:0,yOffset:0,innerRadius:-25,outerRadius:-25,strokeWidth:.5,strokeColor:"black",choppedGroups:!1,sortGroups:undefined,drawArcs:!0,drawChords:!0,sortSubgroups:d3.descending,chordColorScale:function(e,t,n){return n.options.colorScale(e,t,n)}},_accessors:["calculatedPieData"],init:function(e){return this._super(e),this},pieData:function(){return this.calculatedPieData()},startingChordPosition:function(e,t){if(this.initialized)return t<this.lastChordData.length-1?{source:{startAngle:this.lastChordData[t+1].source.startAngle,endAngle:this.lastChordData[t+1].source.startAngle},target:{startAngle:this.lastChordData[t+1].target.startAngle,endAngle:this.lastChordData[t+1].target.startAngle}}:{source:{startAngle:this.options.endAngle,endAngle:this.options.endAngle},target:{startAngle:this.options.endAngle,endAngle:this.options.endAngle}};if(this.options.startingPosition=="slice")return{source:{startAngle:e.source.startAngle,endAngle:e.source.startAngle},target:{startAngle:e.target.startAngle,endAngle:e.target.startAngle}};if(this.options.startingPosition=="top")return{source:{startAngle:this.options.startAngle,endAngle:this.options.startAngle},target:{startAngle:this.options.startAngle,endAngle:this.options.startAngle}};if(this.options.startingPosition=="final")return{source:{startAngle:e.source.startAngle,endAngle:e.source.endAngle},target:{startAngle:e.target.startAngle,endAngle:e.target.endAngle}}},sliceAction:function(t){var n=e.KBWidget.registry()[t.parent].prototype.sliceAction;return n=n.call(this,t),function(){return this.call(n),this}},renderChart:function(){function b(e){var t=(e.endAngle-e.startAngle)/e.value;return d3.range(0,e.value,1e3).map(function(n,r){return{angle:n*t+e.startAngle,label:r%5?null:n/1e3+"k"}})}function w(e){return function(t,n){chord.selectAll(".chord path").filter(function(e){return e.source.index!=n&&e.target.index!=n}).transition().style("opacity",e)}}var t=this.chartBounds(),n=this,r=d3.layout.chord().padding(this.options.chordPadding).sortGroups(this.options.sortGroups).sortSubgroups(this.options.sortSubgroups).matrix(n.dataset()),i=r.groups(),s=[];e.each(i,function(t,r){r.startAngle+=n.options.startAngle,r.endAngle+=n.options.startAngle;var i=r.endAngle-r.startAngle;r.data={};if(n.options.choppedGroups){var o=r.startAngle,u=n.dataset()[t].slice(),a=0;u.forEach(function(e){a+=e});var f=r.data.color||n.options.chordColorScale(t,r.data,n),l=d3.rgb(f),c=.15,h=l.darker(c),p=l.brighter(c),d=d3.scale.linear().domain([0,1]).range([h,p]),v=n.options.colorScale;u.sort(n.options.sortSubgroups).forEach(function(t,n){var u=i*t/a,f=o+u,l=e.extend(!0,{},r.data);l.color=d(n),s.push({startAngle:o,endAngle:f,index:r.index,value:r.value,data:l}),o=f})}else s.push(r)}),this.calculatedPieData(s),this.options.drawArcs&&this._super();var o=d3.scale.ordinal().domain(d3.range(4)).range(["#000000","#FFDD89","#957244","#F26223"]);if(this.options.drawChords){var u=this.data("D3svg").select(this.region("chart")).selectAll(".chords").data([0]);u.enter().insert("g",".labelG").attr("class","chords").attr("transform","translate("+(t.size.width/2+this.options.xOffset)+","+(t.size.height/2+this.options.yOffset)+")");var a=this.innerRadius(),f=this.outerRadius(),l=d3.svg.arc().innerRadius(a).outerRadius(f),c=[];r.chords().forEach(function(t,r){newVal=e.extend(!0,{},t),newVal.data={},newVal.source.startAngle+=n.options.startAngle,newVal.source.endAngle+=n.options.startAngle,newVal.target.startAngle+=n.options.startAngle,newVal.target.endAngle+=n.options.startAngle,c.push(newVal);var i=newVal.source.index;newVal.target.value>newVal.source.value&&(i=newVal.target.index),newVal.data.colorIdx=i});var h=function(){return this.attr("fill-opacity",.67).attr("fill",function(e,t){return e.data.color||n.options.colorScale(e.data.colorIdx,e.data,n)}).attr("stroke","black").attr("stroke-width",.5).attr("fill-opacity",.5),this.attrTween&&this.attrTween("d",function(e,t){this._current==undefined&&(this._current=n.startingChordPosition(e,t));var r=d3.interpolate(this._current,e);return this._current=r(0),function(e){var t=d3.svg.chord().radius(a)(r(e));return t}}),this},p=this.initialized||this.options.startingPosition!="final"?this.options.transitionTime:0,d=u.selectAll("path").data(c);d.enter().append("path").attr("fill",function(e){return o(e.target.index)}),d.transition().duration(p).call(h).call(n.endall,function(){n.lastChordData=r.chords}),d.exit().remove()}var v=this.data("D3svg").select(this.region("chart")).selectAll(".ticks").data([0]);v.enter().insert("g",".labelG").attr("class","ticks"),v.attr("transform","translate("+(t.size.width/2+this.options.xOffset)+","+(t.size.height/2+this.options.yOffset)+")");var m=v.selectAll(".tickArcs").data(r.groups);m.enter().append("g").attr("class","tickArcs"),m.exit().transition().duration(p).attr("opacity",0).each("end",function(e){d3.select(this).remove()});var g=m.selectAll("g").data(b),y=g.enter().append("g").attr("opacity",1);y.append("line"),y.append("text"),g.exit().transition().duration(p).attr("opacity",0).each("end",function(e){d3.select(this).remove()}),g.transition().duration(p).attrTween("transform",function(e,t){this._current==undefined&&(this._current=n.startingChordPosition(e,t));var r=d3.interpolate(this._current,e);return this._current=r(0),function(e){var t=r(e);return"rotate("+(t.angle*180/Math.PI-90)+")"+"translate("+f+",0)"}}),g.select("line").attr("x1",1).attr("y1",0).attr("x2",5).attr("y2",0).style("stroke","#000").attr("stroke-opacity",function(e){return d3.select(this).attr("stroke-opacity")||0}),g.select("line").transition().duration(p).attr("stroke-opacity",1),g.select("text").attr("x",8).attr("dy",".35em").attr("transform",function(e){return e.angle%(2*Math.PI)>Math.PI?"rotate(180)translate(-16)":null}).style("text-anchor",function(e){return e.angle%(2*Math.PI)>Math.PI?"end":null}).text(function(e){return e.label}).attr("opacity",function(e){return d3.select(this).attr("opacity")||0}),g.select("text").transition().duration(p).attr("opacity",1)},renderXAxis:function(){},renderYAxis:function(){}})}),define("kbaseVenndiagram",["jquery","d3","kbaseVisWidget","RGBColor","geometry_rectangle","geometry_point","geometry_size"],function(e){e.KBWidget({name:"kbaseVenndiagram",parent:"kbaseVisWidget",version:"1.0.0",options:{xGutter:0,xPadding:0,yPadding:0,xOffset:0,yOffset:0,overlap:.2,fillOpacity:.8,startAngle:2*Math.PI*150/360,strokeWidth:2,strokeColor:function(){return"black"},fillColor:function(t,n,r){r.fillScale==undefined&&(r.fillScale=d3.scale.category20()),r.circleColors==undefined&&(r.circleColors=[]);if(n.data.fillColor)return r.circleColors[t]=n.data.fillColor,n.data.fillColor;if(n.fillColor)return r.circleColors[t]=n.fillColor,n.fillColor;if(e.isArray(t)){var i=[];e.each(t,function(e,t){i.push(d3.rgb(r.options.fillColor(t,n,r)))});var s=d3.rgb(),o=2;return e.each(i,function(e,t){s.r+=Math.floor(t.r/o),s.g+=Math.floor(t.g/o),s.b+=Math.floor(t.b/o)}),s.toString()}var u=r.circleColors[t];return u==undefined&&(u=r.circleColors[t]=r.fillScale(t)),u},circleFontSize:"18pt",intersectFontSize:"24pt",drawLabels:!0,tooltips:!0,radiusScale:1},_accessors:[],init:function(e){return this._super(e),this},intersectCircles:function(e,t){var n={x:Math.cos(e.angle)*e.originDistance,y:-Math.sin(e.angle)*e.originDistance},r={x:Math.cos(t.angle)*e.originDistance,y:-Math.sin(t.angle)*e.originDistance},i={x:Math.min(n.x,r.x),y:Math.min(n.y,r.y)},s={x:i.x+Math.abs(n.x-r.x)/2,y:i.y+Math.abs(n.y-r.y)/2},o=n.x-r.x,u=n.y-r.y,a=Math.PI/2;o!=0&&(a=Math.atan(u/o));var f=Math.PI/2-a,l=Math.sqrt(Math.pow(s.x-i.x,2)+Math.pow(s.y-i.y,2)),c=Math.sin(Math.acos(l/t.r))*t.r,h=c,p={x:s.x+Math.cos(f)*h,y:s.y-Math.sin(f)*h},d={x:s.x+Math.cos(f+Math.PI)*h,y:s.y-Math.sin(f+Math.PI)*h},v=Math.sqrt(Math.pow(p.x,2)+Math.pow(p.y,2)),m=Math.sqrt(Math.pow(d.x,2)+Math.pow(d.y,2)),g=v>m?[p,d,s]:[d,p,s];return g},renderChart:function(){var e=this.chartBounds(),t=this,n=t.dataset();if(n==undefined)return;var r=this.options.radius||Math.min(e.size.width,e.size.height)/2;r*=this.options.radiusScale;var i=this.data("D3svg").select(this.region("chart")).selectAll(".venn").data([0]);i.enter().append("g").attr("class","venn").attr("transform","translate("+(e.size.width/2+this.options.xOffset)+","+(e.size.height/2+this.options.yOffset)+")"),r*=.5,r=this.options.radius||r;var s=this.options.overlap,o=r*(1-s),u=3,a=[{id:0,angle:t.options.startAngle,r:r,originDistance:o},{id:1,angle:t.options.startAngle+2*Math.PI/u,r:r,originDistance:o},{id:2,angle:t.options.startAngle+2*(2*Math.PI/u),r:r,originDistance:o}],f=this.intersectCircles(a[0],a[1]),l=this.intersectCircles(a[1],a[2]),c=this.intersectCircles(a[0],a[2]),h=[{angle:a[0].angle,label:n.c1.label,value:n.c1.value,radius:o*1.3,anchor:"end",fontSize:this.options.circleFontSize},{angle:a[0].angle,value:n.c1.value,radius:o*1.3,anchor:"end",fontSize:this.options.circleFontSize,dy:"1.5em"},{angle:a[1].angle,label:n.c2.label,value:n.c2.value,radius:o*1.3,anchor:"start",fontSize:this.options.circleFontSize},{angle:a[1].angle,value:n.c2.value,radius:o*1.3,anchor:"start",fontSize:this.options.circleFontSize,dy:"1.5em"},{angle:a[2].angle,label:n.c3.label,value:n.c3.value,radius:o*1.3,anchor:"middle",fontSize:this.options.circleFontSize},{angle:a[2].angle,value:n.c3.value,radius:o*1.3,anchor:"middle",fontSize:this.options.circleFontSize,dy:"1.5em"},{angle:2*Math.PI*90/360,value:n.c1c3.value,radius:o*.7,fontSize:this.options.intersectFontSize},{angle:2*Math.PI*210/360,value:n.c1c2.value,radius:o*.7,fontSize:this.options.intersectFontSize},{angle:2*Math.PI*330/360,value:n.c2c3.value,radius:o*.7,fontSize:this.options.intersectFontSize},{angle:0,value:n.c1c2c3.value,radius:0,fontSize:this.options.intersectFontSize}],p=this.initialized?this.options.transitionTime:0,d=function(){this.on("mouseover",function(e){d3.select(this).attr("fill-opacity",1);if(t.options.tooltips){var n=t.tooltip(e);n&&t.showToolTip({label:n,event:{pageX:t.options.cornerToolTip?t.$elem.prop("offsetLeft")+5:d3.event.pageX,pageY:t.options.cornerToolTip?t.$elem.prop("offsetTop")+20:d3.event.pageY}})}}).on("mouseout",function(e){var n=d3.event.toElement;n&&n.tagName!="text"&&(d3.select(this).attr("fill-opacity",e.fillOpacity||t.options.fillOpacity),t.options.tooltips&&t.hideToolTip())}).on("click",function(e){if(e.data.action){var t=e.data.action;typeof t=="string"&&(t=Function("d",t)),t(e.data)}})},v=[{d:"M "+c[0].x+" "+c[0].y+" A "+r+" "+r+" 0 1 0 "+f[0].x+" "+f[0].y+" A "+r+" "+r+" 0 0 1 "+l[1].x+" "+l[1].y+" A "+r+" "+r+" 0 0 1 "+c[0].x+" "+c[0].y+" Z",circle:0,fillColor:"#F00",data:n.c1},{d:"M "+c[0].x+" "+c[0].y+" A "+r+" "+r+" 0 1 1 "+l[0].x+" "+l[0].y+" A "+r+" "+r+" 0 0 0 "+f[1].x+" "+f[1].y+" A "+r+" "+r+" 0 0 0 "+c[0].x+" "+c[0].y+" Z",circle:1,fillColor:"#00F",data:n.c2},{d:"M "+l[0].x+" "+l[0].y+" A "+r+" "+r+" 0 1 1 "+f[0].x+" "+f[0].y+" A "+r+" "+r+" 0 0 0 "+c[1].x+" "+c[1].y+" A "+r+" "+r+" 0 0 0 "+l[0].x+" "+l[0].y+" Z",circle:2,fillColor:"#0F0",data:n.c3},{d:"M "+f[1].x+" "+f[1].y+" A "+r+" "+r+" 0 0 0 "+l[1].x+" "+l[1].y+" A "+r+" "+r+" 0 0 0 "+c[1].x+" "+c[1].y+" A "+r+" "+r+" 0 0 0 "+f[1].x+" "+f[1].y+" Z",circle:[0,1,2],data:n.c1c2c3},{d:"M "+f[0].x+" "+f[0].y+" A "+r+" "+r+" 0 0 1 "+l[1].x+" "+l[1].y+" A "+r+" "+r+" 0 0 0 "+c[1].x+" "+c[1].y+" A "+r+" "+r+" 0 0 1 "+f[0].x+" "+f[0].y+" Z",circle:[0,2],data:n.c1c3},{d:"M "+c[0].x+" "+c[0].y+" A "+r+" "+r+" 0 0 0 "+l[1].x+" "+l[1].y+" A "+r+" "+r+" 0 0 1 "+f[1].x+" "+f[1].y+" A "+r+" "+r+" 0 0 0 "+c[0].x+" "+c[0].y+" Z",circle:[0,1],data:n.c1c2},{d:"M "+l[0].x+" "+l[0].y+" A "+r+" "+r+" 0 0 0 "+f[1].x+" "+f[1].y+" A "+r+" "+r+" 0 0 1 "+c[1].x+" "+c[1].y+" A "+r+" "+r+" 0 0 0 "+l[0].x+" "+l[0].y+" Z",circle:[1,2],data:n.c2c3}],v=i.selectAll(".arc").data(v);v.enter().append("path").attr("class","arc"),v.call(d).transition().duration(p).attr("d",function(e){return e.d}).attr("fill",function(e,n){var r=t.options.fillColor(e.circle,e,t);return r}).attr("stroke","none").attr("fill-opacity",function(e){return e.fillOpacity||t.options.fillOpacity}).call(t.endall,function(){t.initialized=!0}),v.exit().remove();var m=i.selectAll(".strokedCircle").data(a);m.enter().append("circle").attr("class","strokedCircle"),m.transition().duration(p).attr("cx",function(e){return e.cx||Math.cos(e.angle)*e.originDistance}).attr("cy",function(e){return e.cy||-Math.sin(e.angle)*e.originDistance}).attr("r",function(e){return e.r}).attr("fill","none").attr("stroke",function(e,n){return e.strokeColor||t.options.strokeColor(n,e)}).attr("stroke-width",function(e){return e.strokeWidth||t.options.strokeWidth}),m.exit().remove();var g=function(e){return e==undefined&&(e=1),this.attr("text-anchor","middle").attr("dy",function(e){return e.dy||"0.5em"}).attr("cursor","default"),this.attrTween&&this.text(function(e){return e.label||e.value}).attrTween("transform",function(e,t){this._current==undefined&&(this._current=e);var n=e;n.radius==undefined&&(n.radius=o*.7);var r=d3.interpolate(this._current,n);return this._current=r(0),function(e){var t=r(e),n=[Math.cos(t.angle)*t.radius,-Math.sin(t.angle)*t.radius];return"translate("+n+")"}}).attr("font-size",function(e){return e.fontSize||"12pt"}),this};if(t.options.labels){var y=i.selectAll("text").data(h);y.enter().append("text"),y.transition().duration(p).call(g),y.exit().remove()}},tooltip:function(e){return e.data.tooltip!=undefined?e.data.tooltip:e.data.label!=undefined?e.data.label:undefined},renderXAxis:function(){},renderYAxis:function(){}})}),define("kbaseJSONReflector",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbaseJSONReflector",version:"1.0.0",options:{},init:function(t){return this._super(t),this.$elem.append(e.jqElem("div").css("white-space","pre").append(JSON.stringify(t,undefined,2))),this}})}),define("vis",["kbaseBarchart","kbaseHistogram","kbaseHeatmap","kbaseLinechart","kbaseLineSerieschart","kbaseScatterplot","kbasePiechart","kbaseForcedNetwork","kbaseTreechart","kbaseCircularHeatmap","kbaseChordchart","kbaseVenndiagram","kbaseJSONReflector"],function(){}),define("iris",["kbaseIrisConfig","kbaseIrisProcessList","kbaseIrisTerminal","kbaseIrisWorkspace","kbaseIrisEchoWidget","kbaseIrisCommands","kbaseIrisGUIWidget","kbaseIrisFileBrowser","kbaseIrisFileEditor","kbaseIrisConfig","kbaseIrisWhatsNew","vis"],function(){}),function(e){e.KBApplication=e.fn.KBApplication=function(t){return this.constructor=e.KBWidget.constructor,this}}(jQuery),define("kbapplication",function(){}),define("kbaseCarousel",["jquery","kbwidget"],function(e){e.KBWidget({name:"kbaseCarousel",parent:"kbaseWidget",version:"1.0.0",options:{color:"black",interval:5e3,example_carousel:[{name:"Assemble Genome from Fasta",id:"assemble_genome_from_fasta",caption:'<h3 style = "padding : 0px; margin : 0px">This assembles a ContigSet into a Genome object in your workspace. This should be run before trying to annotate a Genome. [2]</h3><p>This assembles a ContigSet into a Genome object in your workspace. This should be run before trying to annotate a Genome. [2]</p>'},{name:"Build Gene Tree",id:"build_gene_tree",caption:'<h3 style = "padding : 0px; margin : 0px">Build phylogenetic tree for multiple alignmnet of protein sequences [28]</h3><p>Build phylogenetic tree for multiple alignmnet of protein sequences [28]</p>'},{name:"View Proteome Comparison",id:"view_proteome_comparison",caption:'<h3 style = "padding : 0px; margin : 0px">Show the hit map result of running a comparison between two proteomes, which includes information about best-bidirectional hits. [18]</h3><p>Show the hit map result of running a comparison between two proteomes, which includes information about best-bidirectional hits. [18]</p>'}]},init:function(t){this._super(t);var n=this.uuid();console.log("CAOURSEL",this.options.carousel);var r=e.jqElem("div").addClass("carousel").addClass("slide").attr("data-interval",this.options.interval).attr("data-ride","carousel").attr("id",n),i=e.jqElem("ol").addClass("carousel-indicators");e.each(this.options.carousel,e.proxy(function(t,r){i.append(e.jqElem("li").attr("data-target","#"+n).attr("data-slide-to",t))},this));var s=e.jqElem("div").addClass("carousel-inner");return e.each(this.options.carousel,e.proxy(function(t,n){var r=t?"item":"active item";s.append(e.jqElem("div").addClass(r).css("text-align","center").css("height","250px").append(e.jqElem("h2").addClass("slide").css({margin:0,"padding-top":"30px","padding-bottom":"20px","font-size":"200%","font-family":"trebuchet ms sans-serif"}).append(n.caption)))},this)),r.append(i).append(s).append(e.jqElem("a").addClass("carousel-control").css("color","black").addClass("left").attr("href","#"+n).attr("data-slide","prev").append(e.jqElem("span").addClass("glyphicon glyphicon-chevron-left"))).append(e.jqElem("a").addClass("carousel-control").css("color","black").addClass("right").attr("href","#"+n).attr("data-slide","next").append(e.jqElem("span").addClass("glyphicon glyphicon-chevron-right"))),this.$elem.append(r),e(".carousel").carousel({interval:this.options.interval}),this}})}),define("kbaseErrorPrompt",["jquery","kbasePrompt"],function(e){e.KBWidget({name:"kbaseErrorPrompt",parent:"kbasePrompt",version:"1.0.0",options:{controls:["cancelButton","okayButton"]},init:function(t){return this._super(t),e("<div></div>").kbasePrompt({title:t.title,body:e("<div></div>").attr("class","alert alert-error").append(e("<div></div>").append(e("<div></div>").addClass("pull-left").append(e("<i></i>").addClass("fa fa-warning-sign").attr("style","float: left; margin-right: .3em;"))).append(e("<div></div>").append(e("<strong></strong>").append(t.message)))),controls:["okayButton"]})}})}),define("kbaseLogin",["jquery","kbwidget","kbasePrompt"],function(e){e.KBWidget({name:"kbaseLogin",version:"1.0.0",options:{style:"text",loginURL:"http://kbase.us/services/authorization/Sessions/Login",possibleFields:["verified","name","opt_in","kbase_sessionid","token","groups","user_id","email","system_admin"],fields:["name","kbase_sessionid","user_id","token"]},get_kbase_cookie:function(e){var t=localStorage.getItem("kbase_session");return t!=undefined?t=JSON.parse(t):t={},e==undefined?t:t[e]},sessionId:function(){return this.get_kbase_cookie("kbase_sessionid")},token:function(){return this.get_kbase_cookie("token")},init:function(t){this._super(t);var n=this.get_kbase_cookie();this.$elem.empty();var r="_"+this.options.style+"Style";return this.ui=this[r](),this.ui&&this.$elem.append(this.ui),n.user_id&&(this.registerLogin&&this.registerLogin(n),this.options.prior_login_callback&&this.options.prior_login_callback.call(this,n),this.data("_session",n),this.trigger("loggedIn",this.get_kbase_cookie())),e(document).on("loggedInQuery.kbase",e.proxy(function(e,t){var n=this.get_kbase_cookie();t&&t(n)},this)),e(document).on("promptForLogin.kbase",e.proxy(function(e,t){t.user_id&&this.data("passed_user_id",t.user_id),this.openDialog()},this)),e(document).on("logout.kbase",e.proxy(function(e,t){this.logout(t)},this)),this},registerLoginFunc:function(){return this.registerLogin},specificLogoutFunc:function(){return this.specificLogout},populateLoginInfo:function(e){e.success?(this.data("_session",e),this._error=undefined):(this.data("_session",{}),this._error=e.message)},session:function(e,t){this.data("_session")==undefined&&this.data("_session",{});var n=this.data("_session");return arguments.length==2&&(n[e]=t),arguments.length>0?n[e]:n},error:function(e){return e&&(this._error=e),this._error},openDialog:function(){if(this.data("loginDialog")){var t=this.data("loginDialog");e("form",t.dialogModal()).get(0).reset(),t.dialogModal().data("user_id").val(this.session("user_id")||this.data("passed_user_id")||this.options.user_id),delete this.options.user_id,this.session("user_id",undefined),t.dialogModal().trigger("clearMessages"),this.data("loginDialog").openPrompt()}},_textStyle:function(){this._createLoginDialog(),this.$elem.css("padding","9px 15px 7px 10px");var t=e("<span></span>").append(e("<a></a>").attr("id","loginlink").attr("href","#").text("Sign In").bind("click",e.proxy(function(e){e.preventDefault(),e.stopPropagation(),this.openDialog()},this))).append(e("<div></div>").addClass("btn-group").attr("id","userdisplay").css("display","none").append(e("<button></button>").addClass("btn btn-default").addClass("btn-xs").addClass("dropdown-toggle").append(e("<span></span>").addClass("fa fa-user")).append(e("<span></span>").addClass("caret")).bind("click",function(t){t.preventDefault(),t.stopPropagation(),e(this).next().toggle()})).append(e("<ul></ul>").addClass("dropdown-menu").addClass("pull-right").css("padding","3px").attr("id","login-dropdown-menu").append(e("<li></li>").css("border-bottom","1px solid lightgray").css("white-space","nowrap").append(e.jqElem("div").css("text-align","right").append(e("<a></a>").attr("id","loggedinuser_id").css("font-weight","bold").attr("href","https://gologin.kbase.us/account/UpdateProfile").attr("target","_blank").css("padding-right","0px").css("padding-left","0px")))).append(e("<li></li>").addClass("pull-right").append(e("<span></span>").append(e("<a></a>").css("padding-right","0px").css("padding-left","0px").append("Sign out")).bind("click",e.proxy(function(e){e.stopPropagation(),e.preventDefault(),this.data("login-dropdown-menu").hide(),this.logout()},this))))));return this._rewireIds(t,this),this.registerLogin=function(e){e.success?(this.data("loginlink").hide(),this.data("loggedinuser_id").text(e.name),this.data("userdisplay").show(),this.data("loginDialog").closePrompt()):this.data("loginDialog").dialogModal().trigger("error",e.message)},this.specificLogout=function(e){this.data("userdisplay").hide(),this.data("loginlink").show()},t},_hiddenStyle:function(){return this._createLoginDialog(),this.registerLogin=function(e){e.success?this.data("loginDialog").closePrompt():this.data("loginDialog").dialogModal().trigger("error",e.message)},undefined},_slimStyle:function(){this.data("loginDialog",undefined);var t=e("<span></span>").addClass("form-inline").append(e("<span></span>").attr("id","entrance").append(e("<span></span>").addClass("input-group").append(e("<span></span>").addClass("input-group-addon").append("username: ").bind("click",function(t){e(this).next().focus()})).append(e("<input>").attr("type","text").attr("name","user_id").attr("id","user_id").attr("size","20").val(this.options.user_id)).append(e("<span></span>").addClass("input-group-addon").append(" password: ").bind("click",function(t){e(this).next().focus()})).append(e("<input>").attr("type","password").attr("name","password").attr("id","password").attr("size","20")).append(e("<button></button>").attr("id","loginbutton").addClass("btn btn-primary").append(e("<i></i>").attr("id","loginicon").addClass("fa fa-lock"))))).append(e("<span></span>").attr("id","userdisplay").attr("style","display : none;").addClass("input-group").append(e("<span></span>").addClass("input-group-addon").append("Logged in as ").append(e("<span></span>").attr("id","loggedinuser_id").attr("style","font-weight : bold").append("user_id\n"))).append(e("<button></button>").addClass("btn btn-default").attr("id","logoutbutton").append(e("<i></i>").attr("id","logouticon").addClass("fa fa-signout"))));return this._rewireIds(t,this),this.data("password").keypress(e.proxy(function(e){e.keyCode==13&&(this.data("loginbutton").trigger("click"),e.stopPropagation())},this)),this.registerLogin=function(t){this.data("loginicon").removeClass().addClass("fa fa-lock");if(t.success)this.data("entrance").hide(),this.data("user_id").val(""),this.data("password").val(""),this.data("loggedinuser_id").text(t.name),this.data("userdisplay").show();else{var n=e("<div></div>").kbasePrompt({title:"Login failed",body:e("<div></div>").attr("class","alert alert-danger").append(e("<div></div>").append(e("<div></div>").addClass("pull-left").append(e("<i></i>").addClass("fa fa-warning-sign").attr("style","float: left; margin-right: .3em;"))).append(e("<div></div>").append(e("<strong></strong>").append(t.message)))),controls:["okayButton"]});n.openPrompt()}},this.specificLogout=function(e){this.data("userdisplay").hide(),this.data("entrance").show()},this.data("loginbutton").bind("click",e.proxy(function(e){this.data("loginicon").removeClass().addClass("fa fa-refresh"),this.login(this.data("user_id").val(),this.data("password").val(),function(e){this.registerLogin(e),this.options.login_callback&&this.options.login_callback.call(this,e)})},this)),this.data("logoutbutton").bind("click",e.proxy(function(e){this.logout(),this.data("user_id").focus()},this)),t},_microStyle:function(){var t=e("<span></span>").append(e("<button></button>").addClass("btn btn-primary").attr("id","loginbutton").append(e("<i></i>").attr("id","loginicon").addClass("fa fa-lock")));return this._rewireIds(t,this),this._createLoginDialog(),this.data("loginbutton").bind("click",e.proxy(function(e){this.openDialog()},this)),this.registerLogin=function(t){t.success?(this.data("loginDialog").dialogModal().trigger("clearMessages"),this.data("loginDialog").closePrompt(),this.data("loginbutton").tooltip({title:"Logged in as "+t.name}),this.data("loginicon").removeClass().addClass("fa fa-user"),this.data("loginbutton").bind("click",e.proxy(function(e){this.logout()},this))):this.data("loginDialog").dialogModal().trigger("error",t.message)},this.specificLogout=function(){this.data("loginbutton").tooltip("destroy"),this.data("loginicon").removeClass().addClass("fa fa-lock")},t},_buttonStyle:function(){var t=e("<div></div>").attr("style","width : 250px; border : 1px solid gray").append(e("<h4></h4>").attr("style","padding : 5px; margin-top : 0px; background-color : lightgray ").addClass("text-center").append("User\n")).append(e("<div></div>").attr("id","entrance").append(e("<p></p>").attr("style","text-align : center").append(e("<button></button>").attr("id","loginbutton").append("Login").addClass("btn btn-primary")))).append(e("<div></div>").attr("id","userdisplay").attr("style","display : none;").append(e("<p></p>").attr("style","text-align : center").append("Logged in as ").append(e("<span></span>").attr("id","loggedinuser_id").attr("style","font-weight : bold").append("user_id\n")).append(e("<button></button>").attr("id","logoutbutton").append("Logout\n").addClass("btn btn-default"))));return this._rewireIds(t,this),this._createLoginDialog(),this.data("loginbutton").bind("click",e.proxy(function(e){this.openDialog()},this)),this.data("logoutbutton").bind("click",e.proxy(this.logout,this)),this.registerLogin=function(e){e.success?(this.data("loginDialog").dialogModal().trigger("clearMessages"),this.data("entrance").hide(),this.data("loggedinuser_id").text(e.name),this.data("userdisplay").show(),this.data("loginDialog").closePrompt()):this.data("loginDialog").dialogModal().trigger("error",e.message)},this.specificLogout=function(e){this.data("userdisplay").hide(),this.data("entrance").show()},t},_createLoginDialog:function(){var t=this.$elem,n=e("<div></div").kbasePrompt({keyboard:!1,title:"Login to KBase",controls:[{name:"Cancel",callback:e.proxy(function(e,t){t.closePrompt(),this.trigger("logInCanceled",{status:0,message:"Log in canceled"})},this)},{name:"Login",type:"primary",id:"loginbutton",callback:e.proxy(function(e){var t=this.data("loginDialog").dialogModal().data("user_id").val(),n=this.data("loginDialog").dialogModal().data("password").val();this.data("loginDialog").dialogModal().trigger("message",t),this.login(t,n,function(e){this.registerLogin&&this.registerLogin(e),this.options.login_callback&&this.options.login_callback.call(this,e)})},this)}],body:e("<p></p>").append(e("<form></form>").attr("name","form").attr("id","form").addClass("form-horizontal").append(e("<fieldset></fieldset>").append(e("<div></div>").attr("class","alert alert-danger").attr("id","error").attr("style","display : none").append(e("<div></div>").append(e("<div></div>").addClass("pull-left").append(e("<i></i>").addClass("fa fa-warning-sign").attr("style","float: left; margin-right: .3em;"))).append(e("<div></div>").append(e("<strong></strong>").append("Error:\n")).append(e("<span></span>").attr("id","errormsg"))))).append(e("<div></div>").attr("class","alert alert-success").attr("id","pending").attr("style","display : none").append(e("<div></div>").append(e("<div></div>").append(e("<strong></strong>").append("Logging in as:\n")).append(e("<span></span>").attr("id","pendinguser"))))).append(e("<div></div>").attr("class","form-group").append(e("<label></label>").addClass("control-label").addClass("col-md-2").attr("for","user_id").css("margin-right","10px").append("Username:\n")).append(e.jqElem("div").addClass("col-md-9").append(e("<input>").addClass("form-control").attr("type","text").attr("name","user_id").attr("id","user_id").attr("size","20")))).append(e("<div></div>").attr("class","form-group").append(e("<label></label>").addClass("control-label").addClass("col-md-2").attr("for","password").css("margin-right","10px").append("Password:\n")).append(e.jqElem("div").addClass("col-md-9").append(e("<input>").addClass("form-control").attr("type","password").attr("name","password").attr("id","password").attr("size","20")))))),footer:e("<span></span").append(e("<a></a>").attr("href","https://gologin.kbase.us/ResetPassword").attr("target","_blank").text("Forgot password?")).append("&nbsp;|&nbsp;").append(e("<a></a>").attr("href"," https://gologin.kbase.us/OAuth?response_type=code&step=SignUp&redirect_uri="+encodeURIComponent(location.href)).attr("target","_blank").text("Sign up"))});return this._rewireIds(n.dialogModal(),n.dialogModal()),this.data("loginDialog",n),n.dialogModal().bind("error",function(t,n){e(this).trigger("clearMessages"),e(this).data("error").show(),e(this).data("errormsg").html(n)}),n.dialogModal().bind("message",function(t,n){e(this).trigger("clearMessages"),e(this).data("pending").show(),e(this).data("pendinguser").html(n)}),n.dialogModal().bind("clearMessages",function(t){e(this).data("error").hide(),e(this).data("pending").hide()}),n.dialogModal().on("shown.bs.modal",function(t){e(this).data("user_id").val().length==0?e(this).data("user_id").focus():e(this).data("password").focus()}),n.dialogModal().unbind("keyup"),n.dialogModal().keyup(e.proxy(function(e){e.keyCode==27&&(e.stopPropagation(),e.preventDefault(),n.closePrompt(),this.trigger("logInCanceled",{status:0,message:"Log in canceled"}))},this)),n},login:function(t,n,r){var i={user_id:t,status:1};t.length==0?(i.message="Cannot login w/o user_id",i.status=0,r.call(this,i)):n==undefined||n.length==0?(i.message="Cannot login w/o password",i.status=0,r!=undefined&&r.call(this,i)):(i.password=n,i.cookie=1,i.fields=this.options.fields.join(","),e.support.cors=!0,e.ajax({type:"POST",url:this.options.loginURL,data:i,dataType:"json",crossDomain:!0,xhrFields:{withCredentials:!0},success:e.proxy(function(t,n,i){if(t.kbase_sessionid){e.cookie&&e.cookie("kbase_session","unEQUALSSIGN"+t.user_id+"PIPESIGN"+"kbase_sessionidEQUALSSIGN"+t.kbase_sessionid+"PIPESIGN"+"token_idEQUALSSIGN"+t.kbase_sessionid);var s=[],o={success:1},u=this.options.fields;for(var a=0;a<u.length;a++){var f=t[u[a]];o[u[a]]=f}var l=JSON.stringify(o);localStorage.setItem("kbase_session",l),this.populateLoginInfo(o),this.trigger("loggedIn",this.get_kbase_cookie()),r.call(this,o)}else localStorage.removeItem("kbase_session"),this.populateLoginInfo({}),r.call(this,{status:0,message:t.error_msg}),this.trigger("loggedInFailure",{status:0,message:t.error_msg})},this),error:e.proxy(function(e,t,n){var i=t;e.responseJSON&&(i=e.responseJSON.error_msg),i=="error"&&(i="Error connecting to KBase login server"),this.populateLoginInfo({}),r.call(this,{status:0,message:i})},this),xhrFields:{withCredentials:!0},beforeSend:function(e){e.withCredentials=!0}}))},logout:function(e){e==undefined&&(e=!0);var t=this.get_kbase_cookie("kbase_sessionid");if(t==undefined)return;localStorage.removeItem("kbase_session"),this.specificLogout&&this.specificLogout(),this.populateLoginInfo({}),this.data("loginDialog")!=undefined&&e&&this.openDialog(),this.trigger("loggedOut"),this.options.logout_callback&&this.options.logout_callback.call(this)}})}),define("kbasePlantsNTO",["jquery","kbaseIrisWidget","kbaseTable"],function(e){e.KBWidget({name:"kbasePlantsNTO",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:["terminal","networkGraph"],options:{maxVisibleRowIndex:5,navControls:!0,extractHeaders:!1},setInput:function(e){typeof e=="string"&&(e=JSON.parse(e)),e.data&&(e=e.data),this.setValueForKey("input",e),this.appendUI(this.$elem)},appendUI:function(t){t.empty();var n=this;if(this.input()==undefined)this.setError("Cannot use network table widget w/o input file");else{var r=[],i=d3.scale.category20();e.each(this.input().nodes,function(e,t){if(t.type=="CLUSTER"){var n=t.user_annotations.go_enrichnment_annotation,s=[],o=[],u=[];if(n!=undefined){var a=n.split(/\n/);for(var f=0;f<a.length;f++){var l;if(l=a[f].match(/(GO:\d+)\(([\d.]+)\)(.+)/))s.push(l[1]),u.push(l[2]),o.push(l[3])}}r.push({id:t.id,cluster_id:t.entity_id,styled_cluster_id:{value:t.entity_id,style:"color : "+i(r.length%20)},color:i(r.length%20),num_genes:0,num_edges:0,go_enrichment:t.user_annotations.go_enrichnment_annotation||"No enrichment",go_id:s,p_value:u,go_term:o,nodes:[],edges:[],nodesByName:{},edgesByName:{},dataset:t.id,type:t.network_type,source:t.source_ref,description:t.name+" ("+t.description+")"})}});var s=0,o=[],u={};e.each(this.input().edges,function(t,n){e.each(r,function(e,t){t.gene_ids==undefined&&(t.gene_ids=[]),n.node_id1==t.id?(t.gene_ids.push(n.node_id2),o.push(n.node_id2),t.num_genes++,u[n.node_id2]=t):n.node_id2==t.id&&(t.gene_ids.push(n.node_id1),o.push(n.node_id1),t.num_genes++,u[n.node_id1]=t)})});var a={},f={};e.each(this.input().nodes,function(t,n){e.each(o,function(e,t){if(n.id==t){var r=u[n.id];r.gene_data==undefined&&(r.gene_data=[]),r.gene_data.push({external_id:n.user_annotations.external_id||n.entity_id,kbase_id:n.entity_id,func:n.user_annotations.functions||"",cluster:r.cluster_id}),n.func=n.user_annotations.functions;if(n.func==undefined||n.func.match(/unknown/i))n.func="";n.associations="(not sure yet)",a[n.id]={name:n.name,func:n.func,associations:n.associations,activeDatasets:{},id:n.id,radius:10,tag:n.name,search:[n.name,n.func,JSON.stringify(n.associations)].join(""),tagStyle:"font : 12px sans-serif",color:"black",type:n.type};return}})});var l=d3.scale.pow().domain([0,r.length]).range([-100,100]);e.each(this.input().edges,function(t,n){e.each(r,function(e,t){var i=!1,s;u[n.node_id1].id==t.id&&(u[n.node_id2]||{}).id==t.id?(t.num_edges++,i=!0,s=u[n.node_id1]):u[n.node_id2]==t.id&&(u[n.node_id1]||{}).id==t.id&&(t.num_edges++,i=!0,s=u[n.node_id2]);if(i){var o=a[n.node_id1],c=a[n.node_id2];s.nodesByName[o.name]||(s.nodesByName[o.name]=1,s.nodes.push(o)),s.nodesByName[c.name]||(s.nodesByName[c.name]=1,s.nodes.push(c));var h=[n.dataset_id,o.name,c.name].sort().join("-"),p=f[h],d=r.indexOf(s);n.name=="is interact with"&&(n.name="interacts with"),p==undefined&&(p=f[h]={source:o,target:c,activeDatasets:{},name:h,description:o.name+" "+n.name+" "+c.name+" ("+n.strength.toFixed(3)+")",colors:{},curveStrength:l(d)*(d%2?-1:1)});var v=s.color;p.colors[n.dataset_id]=v,s.edgesByName[h]||(s.edgesByName[h]=1,s.edges.push(p))}})});var c=this,h=e.jqElem("input").attr("type","checkbox");e.each(r,function(t,r){var i={externalSortValue:!0,value:h.clone(),sortValue:!1};i.setup=function(t,i){t.on("click",function(t){var s=this;if(n.networkGraph==undefined)return;i.sortValue=s.checked;var o=n.networkGraph().dataset();o==undefined&&(o={nodes:[],edges:[]});var u={nodes:[],edges:[]},a={},f={};e.each(o.nodes,function(e,t){t.activeDatasets[r.cluster_id]&&!s.checked&&delete t.activeDatasets[r.cluster_id],d3.keys(t.activeDatasets).length&&(u.nodes.push(t),a[t.name]=1)}),e.each(o.edges,function(e,t){t.activeDatasets[r.cluster_id]&&!s.checked&&delete t.activeDatasets[r.cluster_id],d3.keys(t.activeDatasets).length&&(u.edges.push(t),f[t.name]=1)});if(s.checked){e.each(r.nodes,function(e,t){t.activeDatasets[r.cluster_id]=1,a[t.name]||(u.nodes.push(t),a[t.name]=1),t.label="<b>"+t.name+"</b>"+"<hr>"+d3.keys(t.activeDatasets).sort().join("<br>")});var l=r.color;e.each(r.edges,function(e,t){t.activeDatasets[r.cluster_id]=1,t.color=l,f[t.name]||(u.edges.push(t),f[t.name]=1)})}e.each(u.nodes,function(e,t){t.label="<b>"+t.name+"</b>"+"<hr>"+t.func+"<hr>"+d3.keys(t.activeDatasets).sort().join("<br>"),t.radius=8+3*d3.keys(t.activeDatasets).length,t.tagOffsetY=t.radius+7}),e.each(u.edges,function(e,t){t.label="<b>"+t.description+"</b>"+"<hr>"+d3.keys(t.activeDatasets).sort().join("<br>"),t.weight=1.5,d3.keys(t.activeDatasets).length>1&&(t.color="black")}),u.nodes.length?n.networkGraph().$elem.show():n.networkGraph().$elem.hide(),n.networkGraph().setDataset(u),n.networkGraph().renderChart()})},r.checkbox=i});var p={structure:{header:[{value:"styled_cluster_id",label:"Cluster ID",style:"width : 80px; background-color : black; color : white"},{value:"num_genes",label:"No. of genes",style:"min-width : 130px; width : 130px; background-color : black; color : white"},{value:"num_edges",label:"No. of edges",style:"min-width : 130px; width : 130px; background-color : black; color : white"},{value:"go_id",label:"GO ID",style:"width : 70px; background-color : black; color : white"},{value:"go_term",label:"GO term",style:"width : 110px; background-color : black; color : white"},{value:"p_value",label:"p-value",style:"min-width : 90px; width : 90px; background-color : black; color : white"},{value:"gene_list",label:"Gene List",style:"width : 250px; background-color : black; color : white"}],rows:r},row_callback:function(t,n,r,i){if(n=="gene_list"){r.gene_data=r.gene_data.sort(i.sortByKey("external_id",!0));var s=e.jqElem("ul").css("list-style","none").css("padding-left","0px");for(var o=0;o<3&&o<r.gene_data.length;o++){var u=r.gene_data[o].external_id;u=u.replace(/\.CDS$/,""),s.append(e.jqElem("li").append(u))}return r.gene_data.length>3&&s.append(e.jqElem("li").append(e.jqElem("a").attr("href","#").append("more...").on("click",function(e){e.stopPropagation(),e.preventDefault(),c.display_gene_list(r.gene_data)}))),s}if(n.match(/^(go_id|go_term|p_value)$/)){var s=e.jqElem("ul").css("list-style","none").css("padding-left","0px");for(var o=0;o<r[n].length;o++)s.append(e.jqElem("li").append(r[n][o]));return s}return n=="network_comparison"?e.jqElem("a").attr("href","#").append("Compare with KBase networks"+r.id).on("click",function(e){c.display_gene_list(r.gene_data)}):i.default_row_callback(t,n,r,i)},sortable:!0,hover:!0,headerOptions:{style:"background-color : black; color : white;",sortable:!0},maxVisibleRowIndex:this.options.maxVisibleRowIndex,navControls:this.options.navControls},d=e.jqElem("div").attr("id","tables").append(e.jqElem("div").attr("id","cluster_table")).append(e.jqElem("div").attr("id","gene_table")).append(e.jqElem("div").attr("id","network"));this._rewireIds(d,this);var v=this.data("network").css({width:700,height:600}).attr("align","center").kbaseForcedNetwork({linkDistance:200,filter:!0,nodeHighlightColor:"#002200",relatedNodeHighlightColor:"black"});v.$elem.hide(),this.networkGraph(v);var m=e.jqElem("div").kbaseTable(p),g=m.data("headerRow");g.find("th:nth-child(3)").after(e.jqElem("th").attr("style","background-color : black; color : white").append("GO enrichment"));var y=e.jqElem("tr");y.append(g.find("th:nth-child(5)")),y.append(g.find("th:nth-child(5)")),y.append(g.find("th:nth-child(5)")),m.data("headerRow").find("th").attr("rowspan",2),m.data("headerRow").find("th:nth-child(4)").attr("rowspan",1).attr("colspan",3),m.data("thead").append(y),this.data("cluster_table").append(m.$elem),t.append(d)}},display_gene_list:function(t){if(t==this.data("last_gene_data")){this.data("gene_table").empty(),this.data("last_gene_data",undefined);return}var n={structure:{header:[{value:"external_id",label:"External gene ID",style:"max-width : 190px; background-color : black; color : white"},{value:"kbase_id",label:"KBase gene ID",style:"min-width : 250px; background-color : black; color : white"},{value:"func",label:"Gene Function",style:"min-width : 75px; background-color : black; color : white"},{value:"cluster",label:"Cluster name",style:"min-width : 75px; background-color : black; color : white"}],rows:t},row_callback:function(e,t,n,r){return t=="external_id"?e.replace(/\.CDS$/,""):r.default_row_callback(e,t,n,r)},sortable:!0,hover:!0,headerOptions:{style:"background-color : black; color : white;",sortable:!0},navControls:this.options.navControls},r=e.jqElem("div").kbaseTable(n);this.data("gene_table").empty(),this.data("gene_table").append(r.$elem),this.data("last_gene_data",t);var i=this;setTimeout(function(){$parent=e("html,body"),offset=i.data("gene_table").prop("offsetTop"),$parent.animate({scrollTop:offset},500)},0)}})}),define("kbasePlantsNetworkTable",["jquery","kbaseIrisWidget","kbaseTable"],function(e){e.KBWidget({name:"kbasePlantsNetworkTable",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:["terminal","networkGraph","msgBox"],options:{maxVisibleRowIndex:5,navControls:!0,extractHeaders:!1},setInput:function(e){this.setValueForKey("input",e),this.appendUI(this.$elem)},appendUI:function(t){t.empty();var n=this;if(this.input()==undefined)this.setError("Cannot use network table widget w/o input file");else{var r=this.input();if(r.length>0){var i=e.jqElem("input").attr("type","checkbox"),s={structure:{header:[{value:"dataset",label:"Dataset",style:"max-width : 190px; background-color : black; color : white"},{value:"description",label:"Description",style:"width : 300px; max-width : 300px;  background-color : black; color : white"},{value:"num_nodes",label:"Nodes",style:"min-width : 75px; background-color : black; color : white"},{value:"num_edges",label:"Edges",style:"min-width : 75px; background-color : black; color : white"},{value:"density",label:"Density",style:"min-width : 90px; background-color : black; color : white"},{value:"type",label:"Type",style:"max-width : 125px; background-color : black; color : white"},{value:"source",label:"Source",style:"min-width : 80px; background-color : black; color : white"}],rows:[]},sortable:!0,hover:!0,headerOptions:{style:"background-color : black; color : white;",sortable:!0},maxVisibleRowIndex:this.options.maxVisibleRowIndex,navControls:this.options.navControls,row_callback:function(t,n,r,i){if(n=="description"){var s=i.default_row_callback(t,n,r,i);if(s.length<12)return s;var o="18px",u=e.jqElem("div").css({"max-height":o,overflow:"hidden",display:"inline-block"}).attr("class","truncated").append(s);return e.jqElem("div").append(u).append(e.jqElem("div").attr("class","dots").css({"font-style":"italic","text-align":"right"}).append("...more"))}return i.default_row_callback(t,n,r,i)}};this.networkGraph()!=undefined&&s.structure.header.unshift({value:"checkbox",label:""});var o=d3.scale.category20();e.each(r,function(t,r){var u={externalSortValue:!0,value:i.clone(),sortValue:!1};u.setup=function(i,s){i.on("click",function(i){var u=this;if(n.networkGraph==undefined)return;s.sortValue=u.checked;var a=n.networkGraph().dataset();a==undefined&&(a={nodes:[],edges:[]});var f={nodes:[],edges:[]},l={},c={};e.each(a.nodes,function(e,t){t.activeDatasets[r.datasetID]&&!u.checked&&delete t.activeDatasets[r.datasetID],d3.keys(t.activeDatasets).length&&(f.nodes.push(t),l[t.name]=1)}),e.each(a.edges,function(e,t){t.activeDatasets[r.datasetID]&&!u.checked&&delete t.activeDatasets[r.datasetID],d3.keys(t.activeDatasets).length&&(f.edges.push(t),c[t.name]=1)});if(u.checked){e.each(r.nodes,function(e,t){t.activeDatasets[r.datasetID]=1,l[t.name]||(f.nodes.push(t),l[t.name]=1),t.label="<b>"+t.name+"</b>"+"<hr>"+d3.keys(t.activeDatasets).sort().join("<br>")});var h=o(t%20);e.each(r.edges,function(e,t){t.activeDatasets[r.datasetID]=1,t.color=h,c[t.name]||(f.edges.push(t),c[t.name]=1)})}e.each(f.nodes,function(e,t){t.label="<b>"+t.name+"</b>"+"<hr>"+t.func+"<hr>"+d3.keys(t.activeDatasets).sort().join("<br>"),t.radius=8+3*d3.keys(t.activeDatasets).length,t.tagOffsetY=t.radius+7}),e.each(f.edges,function(e,t){t.label="<b>Dataset source for this edge:</b><br>"+d3.keys(t.activeDatasets).sort().join("<br>"),t.weight=1.5,d3.keys(t.activeDatasets).length>1?t.color="black":t.color=t.colors[d3.keys(t.activeDatasets)[0]]}),f.nodes.length?(n.msgBox().hide(),n.networkGraph().$elem.show()):(n.msgBox().show(),n.networkGraph().$elem.hide()),n.networkGraph().setDataset(f),n.networkGraph().renderChart()})},r.checkbox=u,r.num_nodes=r.nodes.length,r.num_edges=r.edges.length,r.density=(r.num_edges/r.num_nodes).toFixed(3),s.structure.rows.push(r)});var u=e.jqElem("div").kbaseTable(s);u.sort("num_nodes",-1),u.$elem.css("font-size","85%");var a="18px";u.$elem.find("tr").on("mouseover",function(t){e(this).find(".truncated").css("max-height",""),e(this).find(".dots").css("display","none")}).on("mouseout",function(t){e(this).find(".truncated").css("max-height",a),e(this).find(".dots").css("display","")}),this.setOutput(u.$elem),this.$elem.append(u.$elem),this.options.$terminal&&this.options.$terminal.scroll(),this.setValue(r)}}}})}),define("kbasePlantsNetworkNarrative",["jquery","kbasePlantsNetworkTable","kbaseForcedNetwork","kbaseTable"],function(e){e.KBWidget({name:"kbasePlantsNetworkNarrative",parent:"kbaseIrisWidget",version:"1.0.0",_accessors:["networkTable","networkGraph","networkClient","cdmiClient","ontologyClient","idmapClient","tabularData"],options:{},setInput:function(t){t.data&&(t=t.data);var n=d3.scale.category20();this.setValueForKey("input",t);var r={},i=[];e.each(t.datasets,function(e,t){i.push(t.id);var n=t.description;t.name!=t.id&&(n=t.name+" ("+t.description+")"),r[t.id]={nodes:[],edges:[],nodesByName:{},edgesByName:{},dataset:t.id,type:t.network_type,source:t.source_ref,description:n}});var s=d3.scale.pow().domain([0,i.length]).range([-100,100]),o={},u={};e.each(t.nodes,function(e,t){var n=o[t.name];n==undefined&&(t.func=t.user_annotations.functions||"",t.func.match(/unknown/i)&&(t.func=""),t.associations="(not sure yet)",t.name=t.name.replace(/\.CDS$/,""),n=o[t.id]={name:t.name,func:t.func,associations:t.associations,activeDatasets:{},id:t.id,radius:10,tag:t.name,search:[t.name,t.func,JSON.stringify(t.associations)].join(""),tagStyle:"font : 12px sans-serif",color:"black"})}),e.each(t.edges,function(e,t){var a=o[t.node_id1],f=o[t.node_id2],l=r[t.dataset_id];a.name=a.name.replace(/\.CDS$/,""),f.name=f.name.replace(/\.CDS$/,""),l.nodesByName[a.name]||(l.nodesByName[a.name]=1,l.nodes.push(a)),l.nodesByName[f.name]||(l.nodesByName[f.name]=1,l.nodes.push(f));var c=[t.dataset_id,a.name,f.name].sort().join("-"),h=u[c],p=i.indexOf(t.dataset_id);t.name=="is interact with"&&(t.name="interacts with"),h==undefined&&(h=u[c]={source:a,target:f,activeDatasets:{},name:c,description:a.name+" "+t.name+" "+f.name+" ("+t.strength.toFixed(3)+")",colors:{},curveStrength:s(p)*(p%2?-1:1)});var d=n(i.indexOf(t.dataset_id)%20);h.colors[t.dataset_id]=d,l.edgesByName[c]||(l.edgesByName[c]=1,l.edges.push(h))});var a=[];e.each(r,function(e,t){t.nodes.length&&a.push({datasetID:t.dataset,dataset:{value:t.dataset,style:"color : "+n(i.indexOf(t.dataset)%20)},nodes:t.nodes,edges:t.edges,description:t.description,type:t.type,source:t.source})}),this.setValueForKey("tabularData",a),this.networkTable()&&(this.data("loader").remove(),this.data("msgBox").show(),this.networkTable().setInput(a))},appendUI:function(t){t.empty(),t.css("border","1px solid gray"),t.empty();var n=e.jqElem("div").append("<br>&nbsp;Loading data...<br>&nbsp;please wait...").append(e.jqElem("br")).append(e.jqElem("div").attr("align","center").append(e.jqElem("i").addClass("fa fa-spinner").addClass("fa fa-spin fa fa-4x")));t.append(n),this.data("loader",n);var r=e.jqElem("div").css({width:700,height:600}).attr("align","center").kbaseForcedNetwork({linkDistance:200,filter:!0,nodeHighlightColor:"#002200",relatedNodeHighlightColor:"black"});this.networkGraph(r);var i=e.jqElem("div").attr("align","center").css("font-style","italic").html("No datasets with nodes selected");this.data("msgBox",i);var s=e.jqElem("div").kbasePlantsNetworkTable({$terminal:this.options.$terminal,networkGraph:r,msgBox:i});this.networkTable(s),i.hide(),r.$elem.hide(),t.append(s.$elem).append(i).append(e.jqElem("div").attr("align","center").append(r.$elem)),this.input()&&(this.data("loader").remove(),this.data("msgBox").show(),this.networkTable().setInput(this.tabularData()))}})}),define("kbaseWalkablePath",["jquery","kbwidget","kbaseAccordion"],function(e){e.KBWidget({name:"kbaseWalkablePath",parent:"kbaseWidget",version:"1.0.0",options:{narrativeMethodStoreURL:"https://kbase.us/services/narrative_method_store/rpc",tree:[{val:"I'm interested in genes",children:[{val:"I want to upload them",details:"upload_file"}]},{val:"I'm interested in communities",children:[{val:"I want to work with metabolic models",children:[{val:"Compare Metabolic Model",details:"compare_metabolic_model"},{val:"Create Metabolic Model",details:"create_metabolic_model"},{val:"Gapfill Metabolic Model",details:"gapfill_metabolic_model"}]},{val:"I want to work with abundance profiles",children:[{val:"I want to add metadata",details:"add_metadata_to_abundance_profile"},{val:"I want to view a boxplot",details:"boxplots_from_abundance_profile"},{val:"I'm interested in heatmaps",children:[{val:"I want to see an interactive heatmap",details:"interactive_heatmap_from_abundance_profile"},{val:"I want to see a non-interactive heatmap",details:"heatmap_from_abundance_profile"}]},{val:"I want to merge profiles",details:"merge_abundance_profiles"},{val:"I'm interested in PCoA",details:"pcoa_from_abundance_profile"},{val:"I'm interested in PICRUSt predictions",details:"picrust_predicted_abundance_profile"},{val:"I want to rank them",details:"rank_abundance_from_abundance_profile"},{val:"I want annotations",details:"retrieve_annotation_abundance_profile"},{val:"I want to sub select them",details:"sub_select_abundance_profile"},{val:"I want to see metadata",details:"view_abundance_profile_metadata"},{val:"I want to sub profile values",details:"view_abundance_profile_values"}]}]},{val:"I'm interested in microbes",children:[{val:"I want to annotate them",children:[{val:"Add KBase Annotation",details:"add_kbase_annotation"},{val:"Annotate ContigSet",details:"annotate_contigset"},{val:"Annotate Genome",details:"annotate_genome"}]},{val:"I want to build something with them",children:[{val:"Build Gene Tree",details:"build_gene_tree"},{val:"Build Genome Set From Tree",details:"build_genome_set_from_tree"},{val:"Build Genome Set Object",details:"build_genome_set_object"}]},{val:"I have data to upload",children:[{val:"Upload Contigs (FASTA-file)",details:"upload_contigs_fasta_file"},{val:"Upload Genome (GBK-file)",details:"upload_genome_gbk_file"}]},{val:"I want to view a pangenome",details:"view_pangenome"},{val:"I want to view a a proteome comparison",details:"view_proteome_comparison"},{val:"I want to view a tree",details:"view_tree"}]},{val:"I'm interested in plants",children:[{val:"I want to annotate clusters",details:"annotate_clusters_with_enriched_ontology_terms"},{val:"I want to annotate networks",details:"annotate_network_genes_with_ontology_terms"},{val:"I want to construct a network",details:"construct_co_expression_network_and_clusters"}]},{val:"I want help with common tasks",children:[{val:"I want to do something with a data file",children:[{val:"Delete File",details:"delete_file"},{val:"Download File",details:"download_file"},{val:"Rename File",details:"rename_file"},{val:"Upload File",details:"upload_file"},{val:"View Files",details:"view_files"}]},{val:"I want to run a command",details:"execute_kbase_command"},{val:"I'm interested in annotations",children:[{val:"Add KBase Annotation",details:"add_kbase_annotation"},{val:"Annotate Genome",details:"annotate_genome"}]}]},{val:"I want to see everything",bodyKey:"everything"},{val:"I want to see the most popular methods",staticKey:"mostPopular"}],ulStyle:{"list-style-type":"none",margin:"0px",padding:"0px"}},init:function(t){this._super(t);var n=new NarrativeMethodStore(this.options.narrativeMethodStoreURL),r=this;return n.list_methods({},function(t){var n=e.jqElem("div").kbaseAccordion({elements:[]}),i={},s={plants:{list:[],$elem:e.jqElem("ul").css({"font-size":"100%"}).css(r.options.ulStyle)},microbes:{list:[],$elem:e.jqElem("ul").css({"font-size":"100%"}).css(r.options.ulStyle)},communities:{list:[],$elem:e.jqElem("ul").css({"font-size":"100%"}).css(r.options.ulStyle)}};e.each(t,function(t,n){e.each(n.categories,function(e,t){i[t]==undefined&&(i[t]=[]),i[t].push(n),t.match(/microbe/i||n.name.match(/microbe/i))&&s.microbes.list.push({val:n.name,details:n.id}),t.match(/plant/i||n.name.match(/plant/i))&&s.plants.list.push({val:n.name,details:n.id}),t.match(/commun/i||n.name.match(/commun/i))&&s.communities.list.push({val:n.name,details:n.id})})});var o=[];e.each(i,function(t,i){var s=e.jqElem("ul").css("padding-left","0px").css(r.options.ulStyle);e.each(i.sort(n.sortByKey("name")),function(t,n){var i=e.jqElem("a").attr("title",n.tooltip).tooltip().on("click",function(){r.options.methodDetails&&r.options.methodDetails.details(n.id)}).append(n.name);s.append(e.jqElem("li").css("list-style","none").append(i))}),t=t.replace(/_/g," "),t=t.replace(/ (\w)/g,function(e){return e.toUpperCase()}),t=t.charAt(0).toUpperCase()+t.slice(1),o.push({title:t,body:s})}),o=o.sort(n.sortByKey("title"));var u=e.jqElem("div").kbaseAccordion({elements:o});r.options.keys==undefined&&(r.options.keys={}),r.options.keys.everything=u.$elem,r.options.keys.plantsList=s.plants.list,r.options.keys.microbesList=s.microbes.list,r.options.keys.communitiesList=s.communities.list,r.options.keys.mostPopular=r.options.mostPopular.$elem,r.appendUI(r.$elem)}),this},appendUI:function(t){t.css("overflow","hidden"),this.$floater=e.jqElem("div").css({position:"relative",left:"0px",width:"200%"}),t.append(this.$floater);var n=e.jqElem("div").addClass("tile").css({width:"50%","float":"left",padding:"0px"});this.$floater.append(n);var r=e.jqElem("ul").css(this.options.ulStyle);n.append(r);var i=this;e.each(this.options.tree,function(t,n){n.childrenKey&&(n.children=i.options.keys[n.childrenKey]),n.bodyKey&&(n.body=i.options.keys[n.bodyKey]),n.staticKey&&(n.staticDetails=i.options.keys[n.staticKey]),r.append(e.jqElem("li").css({margin:"0px",padding:"1px"}).append(e.jqElem("button").addClass("btn btn-primary").css({width:"100%",height:"100%","text-align":"left","line-height":"1em",padding:"6px 4px"}).on("click",function(e){e.preventDefault(),e.stopPropagation(),n.details?i.options.methodDetails&&i.options.methodDetails.details(n.details):n.staticDetails?i.options.methodDetails&&(i.options.methodDetails.$elem.empty(),i.options.methodDetails.$elem.append(n.staticDetails)):i.magicmove(e,"right",n)}).append(n.val).append(e.jqElem("i").addClass("pull-right fa").addClass(n.details||n.staticDetails?"fa-search":"fa-arrow-right"))))})},magicmove:function(t,n,r){var i=this,s=this.$elem.width();this.bullshitHack||(this.bullshitHack=!0,s+=50);var o=(n=="right"?"-":"+")+"="+s+"px",u=e(t.target).parent().parent().parent();if(n=="right"){var a=u.next();u.css("float","left");if(a.get(0)==undefined){a=e.jqElem("div").addClass("tile").css("float","right");var f=this.$floater.children().length,l=(f+1)*100;this.$floater.css("width",l+"%");var c=100/(f+1);this.$floater.append(a),e("div.tile").css("width",c+"%")}else a.empty();var h=e.jqElem("button").addClass("btn btn-info").css({width:"100%",height:"100%","text-align":"left","line-height":"1em"}).on("click",function(e){e.preventDefault(),e.stopPropagation(),i.magicmove(e,"left")}).append(e.jqElem("i").addClass("fa fa-arrow-left")).append(" "+r.val);r.childrenKey&&(r.children=i.options.keys[r.childrenKey]),r.bodyKey&&(r.body=i.options.keys[r.bodyKey]),r.staticKey&&(r.staticDetails=i.options.keys[r.staticKey]);if(r.children){var p=e.jqElem("ul").css(i.options.ulStyle);a.append(p),e.each(r.children,function(t,n){p.append(e.jqElem("li").append(e.jqElem("button").addClass("btn btn-primary").css({width:"100%",height:"100%","text-align":"left","line-height":"1em",padding:"6px 4px"}).on("click",function(e){e.preventDefault(),e.stopPropagation(),n.details&&i.options.methodDetails?i.options.methodDetails.details(n.details):n.staticDetails?i.options.methodDetails&&(i.options.methodDetails.$elem.empty(),i.options.methodDetails.$elem.append(n.staticDetails)):i.magicmove(e,"right",n)}).append(n.val).append(e.jqElem("i").addClass("pull-right fa").addClass(n.details||n.staticDetails?"fa-search":"fa-arrow-right"))))}),p.append(e.jqElem("li").css("text-align","right").css("list-style-type","none").append(h))}else r.body?a.append(r.body).append(e.jqElem("div").css("text-align","right").append(h)):a.append("Nothing here. :-(").append(e.jqElem("div").css("text-align","right").append(h))}this.$floater.animate({left:o})}})}),define("all",["RGBColor","geometry_point","geometry_rectangle","geometry_size","iris","kbapplication","kbaseAccordion","kbaseAuthenticatedWidget","kbaseBarchart","kbaseBox","kbaseButtonControls","kbaseCarousel","kbaseChordchart","kbaseCircularHeatmap","kbaseDataBrowser","kbaseDeletePrompt","kbaseErrorPrompt","kbaseForcedNetwork","kbaseFormBuilder","kbaseHeatmap","kbaseHistogram","kbaseIrisCommands","kbaseIrisConfig","kbaseIrisContainerWidget","kbaseIrisEchoWidget","kbaseIrisFileBrowser","kbaseIrisFileEditor","kbaseIrisGUIWidget","kbaseIrisGrammar","kbaseIrisProcessList","kbaseIrisTerminal","kbaseIrisTerminalDispatch","kbaseIrisTerminalDispatchAuth","kbaseIrisTerminalDispatchEnv","kbaseIrisTerminalDispatchFile","kbaseIrisTerminalDispatchHelp","kbaseIrisTerminalDispatchHistory","kbaseIrisTerminalDispatchScript","kbaseIrisTerminalDispatchTutorial","kbaseIrisTerminalWidget","kbaseIrisTextWidget","kbaseIrisTutorial","kbaseIrisWhatsNew","kbaseIrisWidget","kbaseIrisWorkspace","kbaseJSONReflector","kbaseLineSerieschart","kbaseLinechart","kbaseLogin","kbasePiechart","kbasePlantsNTO","kbasePlantsNetworkNarrative","kbasePlantsNetworkTable","kbasePrompt","kbaseScatterplot","kbaseSearchControls","kbaseTable","kbaseTabs","kbaseTreechart","kbaseVenndiagram","kbaseVisWidget","kbaseWalkablePath","kbwidget","vis"],function(){});